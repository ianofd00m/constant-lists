const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Bfk2rq25.js","assets/vendor-Csw2ODfV.js","assets/DeckViewEdit-BphapFfS.js","assets/router-CYt2ycax.js","assets/jspdf.es.min-DtPQpl4u.js","assets/html2canvas.esm-CBrSDip1.js","assets/DeckViewEdit-BV8Agq1K.css"])))=>i.map(i=>d[i]);
var a0=Object.defineProperty;var r0=(a,r,s)=>r in a?a0(a,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[r]=s;var lr=(a,r,s)=>r0(a,typeof r!="symbol"?r+"":r,s);import{r as v,R as ke,u as o0,a as ma,L as Hn,b as ns,c as s0,B as l0,d as i0,e as xt,N as c0}from"./router-CYt2ycax.js";import{r as d0,a as u0,c as kl,g as f0}from"./vendor-Csw2ODfV.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))i(d);new MutationObserver(d=>{for(const f of d)if(f.type==="childList")for(const g of f.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&i(g)}).observe(document,{childList:!0,subtree:!0});function s(d){const f={};return d.integrity&&(f.integrity=d.integrity),d.referrerPolicy&&(f.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?f.credentials="include":d.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function i(d){if(d.ep)return;d.ep=!0;const f=s(d);fetch(d.href,f)}})();var ed={exports:{}},es={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vp;function g0(){if(vp)return es;vp=1;var a=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function s(i,d,f){var g=null;if(f!==void 0&&(g=""+f),d.key!==void 0&&(g=""+d.key),"key"in d){f={};for(var p in d)p!=="key"&&(f[p]=d[p])}else f=d;return d=f.ref,{$$typeof:a,type:i,key:g,ref:d!==void 0?d:null,props:f}}return es.Fragment=r,es.jsx=s,es.jsxs=s,es}var Sp;function p0(){return Sp||(Sp=1,ed.exports=g0()),ed.exports}var l=p0(),td={exports:{}},ts={},nd={exports:{}},ad={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wp;function h0(){return wp||(wp=1,function(a){function r(R,M){var W=R.length;R.push(M);e:for(;0<W;){var se=W-1>>>1,he=R[se];if(0<d(he,M))R[se]=M,R[W]=he,W=se;else break e}}function s(R){return R.length===0?null:R[0]}function i(R){if(R.length===0)return null;var M=R[0],W=R.pop();if(W!==M){R[0]=W;e:for(var se=0,he=R.length,fe=he>>>1;se<fe;){var te=2*(se+1)-1,K=R[te],ae=te+1,re=R[ae];if(0>d(K,W))ae<he&&0>d(re,K)?(R[se]=re,R[ae]=W,se=ae):(R[se]=K,R[te]=W,se=te);else if(ae<he&&0>d(re,W))R[se]=re,R[ae]=W,se=ae;else break e}}return M}function d(R,M){var W=R.sortIndex-M.sortIndex;return W!==0?W:R.id-M.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var f=performance;a.unstable_now=function(){return f.now()}}else{var g=Date,p=g.now();a.unstable_now=function(){return g.now()-p}}var m=[],h=[],y=1,b=null,S=3,E=!1,_=!1,j=!1,T=!1,N=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function L(R){for(var M=s(h);M!==null;){if(M.callback===null)i(h);else if(M.startTime<=R)i(h),M.sortIndex=M.expirationTime,r(m,M);else break;M=s(h)}}function $(R){if(j=!1,L(R),!_)if(s(m)!==null)_=!0,V||(V=!0,ee());else{var M=s(h);M!==null&&P($,M.startTime-R)}}var V=!1,H=-1,C=5,I=-1;function U(){return T?!0:!(a.unstable_now()-I<C)}function A(){if(T=!1,V){var R=a.unstable_now();I=R;var M=!0;try{e:{_=!1,j&&(j=!1,O(H),H=-1),E=!0;var W=S;try{t:{for(L(R),b=s(m);b!==null&&!(b.expirationTime>R&&U());){var se=b.callback;if(typeof se=="function"){b.callback=null,S=b.priorityLevel;var he=se(b.expirationTime<=R);if(R=a.unstable_now(),typeof he=="function"){b.callback=he,L(R),M=!0;break t}b===s(m)&&i(m),L(R)}else i(m);b=s(m)}if(b!==null)M=!0;else{var fe=s(h);fe!==null&&P($,fe.startTime-R),M=!1}}break e}finally{b=null,S=W,E=!1}M=void 0}}finally{M?ee():V=!1}}}var ee;if(typeof D=="function")ee=function(){D(A)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,G=oe.port2;oe.port1.onmessage=A,ee=function(){G.postMessage(null)}}else ee=function(){N(A,0)};function P(R,M){H=N(function(){R(a.unstable_now())},M)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(R){R.callback=null},a.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<R?Math.floor(1e3/R):5},a.unstable_getCurrentPriorityLevel=function(){return S},a.unstable_next=function(R){switch(S){case 1:case 2:case 3:var M=3;break;default:M=S}var W=S;S=M;try{return R()}finally{S=W}},a.unstable_requestPaint=function(){T=!0},a.unstable_runWithPriority=function(R,M){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var W=S;S=R;try{return M()}finally{S=W}},a.unstable_scheduleCallback=function(R,M,W){var se=a.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?se+W:se):W=se,R){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=W+he,R={id:y++,callback:M,priorityLevel:R,startTime:W,expirationTime:he,sortIndex:-1},W>se?(R.sortIndex=W,r(h,R),s(m)===null&&R===s(h)&&(j?(O(H),H=-1):j=!0,P($,W-se))):(R.sortIndex=he,r(m,R),_||E||(_=!0,V||(V=!0,ee()))),R},a.unstable_shouldYield=U,a.unstable_wrapCallback=function(R){var M=S;return function(){var W=S;S=M;try{return R.apply(this,arguments)}finally{S=W}}}}(ad)),ad}var Cp;function m0(){return Cp||(Cp=1,nd.exports=h0()),nd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jp;function y0(){if(jp)return ts;jp=1;var a=m0(),r=d0(),s=u0();function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function f(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function g(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(f(e)!==e)throw Error(i(188))}function m(e){var t=e.alternate;if(!t){if(t=f(e),t===null)throw Error(i(188));return t!==e?null:e}for(var n=e,o=t;;){var c=n.return;if(c===null)break;var u=c.alternate;if(u===null){if(o=c.return,o!==null){n=o;continue}break}if(c.child===u.child){for(u=c.child;u;){if(u===n)return p(c),e;if(u===o)return p(c),t;u=u.sibling}throw Error(i(188))}if(n.return!==o.return)n=c,o=u;else{for(var x=!1,w=c.child;w;){if(w===n){x=!0,n=c,o=u;break}if(w===o){x=!0,o=c,n=u;break}w=w.sibling}if(!x){for(w=u.child;w;){if(w===n){x=!0,n=u,o=c;break}if(w===o){x=!0,o=u,n=c;break}w=w.sibling}if(!x)throw Error(i(189))}}if(n.alternate!==o)throw Error(i(190))}if(n.tag!==3)throw Error(i(188));return n.stateNode.current===n?e:t}function h(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=h(e),t!==null)return t;e=e.sibling}return null}var y=Object.assign,b=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),O=Symbol.for("react.consumer"),D=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),A=Symbol.iterator;function ee(e){return e===null||typeof e!="object"?null:(e=A&&e[A]||e["@@iterator"],typeof e=="function"?e:null)}var oe=Symbol.for("react.client.reference");function G(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===oe?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case _:return"Fragment";case T:return"Profiler";case j:return"StrictMode";case $:return"Suspense";case V:return"SuspenseList";case I:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case E:return"Portal";case D:return(e.displayName||"Context")+".Provider";case O:return(e._context.displayName||"Context")+".Consumer";case L:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case H:return t=e.displayName||null,t!==null?t:G(e.type)||"Memo";case C:t=e._payload,e=e._init;try{return G(e(t))}catch{}}return null}var P=Array.isArray,R=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},se=[],he=-1;function fe(e){return{current:e}}function te(e){0>he||(e.current=se[he],se[he]=null,he--)}function K(e,t){he++,se[he]=e.current,e.current=t}var ae=fe(null),re=fe(null),ue=fe(null),me=fe(null);function Ce(e,t){switch(K(ue,t),K(re,e),K(ae,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Vg(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Vg(t),e=Wg(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}te(ae),K(ae,e)}function Te(){te(ae),te(re),te(ue)}function _e(e){e.memoizedState!==null&&K(me,e);var t=ae.current,n=Wg(t,e.type);t!==n&&(K(re,e),K(ae,n))}function Pe(e){re.current===e&&(te(ae),te(re)),me.current===e&&(te(me),Wo._currentValue=W)}var rt=Object.prototype.hasOwnProperty,nt=a.unstable_scheduleCallback,_t=a.unstable_cancelCallback,en=a.unstable_shouldYield,It=a.unstable_requestPaint,Rt=a.unstable_now,$n=a.unstable_getCurrentPriorityLevel,vt=a.unstable_ImmediatePriority,pt=a.unstable_UserBlockingPriority,ht=a.unstable_NormalPriority,Nt=a.unstable_LowPriority,sn=a.unstable_IdlePriority,Fn=a.log,ya=a.unstable_setDisableYieldValue,tn=null,it=null;function Tt(e){if(typeof Fn=="function"&&ya(e),it&&typeof it.setStrictMode=="function")try{it.setStrictMode(tn,e)}catch{}}var yt=Math.clz32?Math.clz32:Cn,wn=Math.log,Ht=Math.LN2;function Cn(e){return e>>>=0,e===0?32:31-(wn(e)/Ht|0)|0}var jn=256,_n=4194304;function X(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ae(e,t,n){var o=e.pendingLanes;if(o===0)return 0;var c=0,u=e.suspendedLanes,x=e.pingedLanes;e=e.warmLanes;var w=o&134217727;return w!==0?(o=w&~u,o!==0?c=X(o):(x&=w,x!==0?c=X(x):n||(n=w&~e,n!==0&&(c=X(n))))):(w=o&~u,w!==0?c=X(w):x!==0?c=X(x):n||(n=o&~e,n!==0&&(c=X(n)))),c===0?0:t!==0&&t!==c&&(t&u)===0&&(u=c&-c,n=t&-t,u>=n||u===32&&(n&4194048)!==0)?t:c}function Tn(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function xa(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fa(){var e=jn;return jn<<=1,(jn&4194048)===0&&(jn=256),e}function Kn(){var e=_n;return _n<<=1,(_n&62914560)===0&&(_n=4194304),e}function Ln(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ot(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function St(e,t,n,o,c,u){var x=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var w=e.entanglements,z=e.expirationTimes,Z=e.hiddenUpdates;for(n=x&~n;0<n;){var le=31-yt(n),de=1<<le;w[le]=0,z[le]=-1;var J=Z[le];if(J!==null)for(Z[le]=null,le=0;le<J.length;le++){var ne=J[le];ne!==null&&(ne.lane&=-536870913)}n&=~de}o!==0&&Et(e,o,0),u!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=u&~(x&~t))}function Et(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var o=31-yt(t);e.entangledLanes|=t,e.entanglements[o]=e.entanglements[o]|1073741824|n&4194090}function an(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var o=31-yt(n),c=1<<o;c&t|e[o]&t&&(e[o]|=t),n&=~c}}function wt(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function kt(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Be(){var e=M.p;return e!==0?e:(e=window.event,e===void 0?32:pp(e.type))}function Wt(e,t){var n=M.p;try{return M.p=e,t()}finally{M.p=n}}var Ke=Math.random().toString(36).slice(2),Je="__reactFiber$"+Ke,Ne="__reactProps$"+Ke,et="__reactContainer$"+Ke,k="__reactEvents$"+Ke,B="__reactListeners$"+Ke,q="__reactHandles$"+Ke,ge="__reactResources$"+Ke,ve="__reactMarker$"+Ke;function $e(e){delete e[Je],delete e[Ne],delete e[k],delete e[B],delete e[q]}function be(e){var t=e[Je];if(t)return t;for(var n=e.parentNode;n;){if(t=n[et]||n[Je]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Jg(e);e!==null;){if(n=e[Je])return n;e=Jg(e)}return t}e=n,n=e.parentNode}return null}function pe(e){if(e=e[Je]||e[et]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function Se(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(i(33))}function Ee(e){var t=e[ge];return t||(t=e[ge]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function ye(e){e[ve]=!0}var Ie=new Set,qe={};function Oe(e,t){ft(e,t),ft(e+"Capture",t)}function ft(e,t){for(qe[e]=t,e=0;e<t.length;e++)Ie.add(t[e])}var we=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),xe={},Re={};function Ue(e){return rt.call(Re,e)?!0:rt.call(xe,e)?!1:we.test(e)?Re[e]=!0:(xe[e]=!0,!1)}function He(e,t,n){if(Ue(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var o=t.toLowerCase().slice(0,5);if(o!=="data-"&&o!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function Ct(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function qt(e,t,n,o){if(o===null)e.removeAttribute(n);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+o)}}var Ft,ba;function Jn(e){if(Ft===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ft=t&&t[1]||"",ba=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ft+e+ba}var Ga=!1;function so(e,t){if(!e||Ga)return"";Ga=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var o={DetermineComponentFrameRoot:function(){try{if(t){var de=function(){throw Error()};if(Object.defineProperty(de.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(de,[])}catch(ne){var J=ne}Reflect.construct(e,[],de)}else{try{de.call()}catch(ne){J=ne}e.call(de.prototype)}}else{try{throw Error()}catch(ne){J=ne}(de=e())&&typeof de.catch=="function"&&de.catch(function(){})}}catch(ne){if(ne&&J&&typeof ne.stack=="string")return[ne.stack,J.stack]}return[null,null]}};o.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(o.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(o.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var u=o.DetermineComponentFrameRoot(),x=u[0],w=u[1];if(x&&w){var z=x.split(`
`),Z=w.split(`
`);for(c=o=0;o<z.length&&!z[o].includes("DetermineComponentFrameRoot");)o++;for(;c<Z.length&&!Z[c].includes("DetermineComponentFrameRoot");)c++;if(o===z.length||c===Z.length)for(o=z.length-1,c=Z.length-1;1<=o&&0<=c&&z[o]!==Z[c];)c--;for(;1<=o&&0<=c;o--,c--)if(z[o]!==Z[c]){if(o!==1||c!==1)do if(o--,c--,0>c||z[o]!==Z[c]){var le=`
`+z[o].replace(" at new "," at ");return e.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",e.displayName)),le}while(1<=o&&0<=c);break}}}finally{Ga=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Jn(n):""}function Ql(e){switch(e.tag){case 26:case 27:case 5:return Jn(e.type);case 16:return Jn("Lazy");case 13:return Jn("Suspense");case 19:return Jn("SuspenseList");case 0:case 15:return so(e.type,!1);case 11:return so(e.type.render,!1);case 1:return so(e.type,!0);case 31:return Jn("Activity");default:return""}}function hr(e){try{var t="";do t+=Ql(e),e=e.return;while(e);return t}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function pn(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function bs(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Kh(e){var t=bs(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var c=n.get,u=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(x){o=""+x,u.call(this,x)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return o},setValue:function(x){o=""+x},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function vs(e){e._valueTracker||(e._valueTracker=Kh(e))}function Fd(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),o="";return e&&(o=bs(e)?e.checked?"true":"false":e.value),e=o,e!==n?(t.setValue(e),!0):!1}function Ss(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Jh=/[\n"\\]/g;function En(e){return e.replace(Jh,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Zl(e,t,n,o,c,u,x,w){e.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?e.type=x:e.removeAttribute("type"),t!=null?x==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+pn(t)):e.value!==""+pn(t)&&(e.value=""+pn(t)):x!=="submit"&&x!=="reset"||e.removeAttribute("value"),t!=null?Kl(e,x,pn(t)):n!=null?Kl(e,x,pn(n)):o!=null&&e.removeAttribute("value"),c==null&&u!=null&&(e.defaultChecked=!!u),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?e.name=""+pn(w):e.removeAttribute("name")}function Gd(e,t,n,o,c,u,x,w){if(u!=null&&typeof u!="function"&&typeof u!="symbol"&&typeof u!="boolean"&&(e.type=u),t!=null||n!=null){if(!(u!=="submit"&&u!=="reset"||t!=null))return;n=n!=null?""+pn(n):"",t=t!=null?""+pn(t):n,w||t===e.value||(e.value=t),e.defaultValue=t}o=o??c,o=typeof o!="function"&&typeof o!="symbol"&&!!o,e.checked=w?e.checked:!!o,e.defaultChecked=!!o,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(e.name=x)}function Kl(e,t,n){t==="number"&&Ss(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function mr(e,t,n,o){if(e=e.options,t){t={};for(var c=0;c<n.length;c++)t["$"+n[c]]=!0;for(n=0;n<e.length;n++)c=t.hasOwnProperty("$"+e[n].value),e[n].selected!==c&&(e[n].selected=c),c&&o&&(e[n].defaultSelected=!0)}else{for(n=""+pn(n),t=null,c=0;c<e.length;c++){if(e[c].value===n){e[c].selected=!0,o&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function Pd(e,t,n){if(t!=null&&(t=""+pn(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+pn(n):""}function Yd(e,t,n,o){if(t==null){if(o!=null){if(n!=null)throw Error(i(92));if(P(o)){if(1<o.length)throw Error(i(93));o=o[0]}n=o}n==null&&(n=""),t=n}n=pn(t),e.defaultValue=n,o=e.textContent,o===n&&o!==""&&o!==null&&(e.value=o)}function yr(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var em=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Xd(e,t,n){var o=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?o?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":o?e.setProperty(t,n):typeof n!="number"||n===0||em.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Vd(e,t,n){if(t!=null&&typeof t!="object")throw Error(i(62));if(e=e.style,n!=null){for(var o in n)!n.hasOwnProperty(o)||t!=null&&t.hasOwnProperty(o)||(o.indexOf("--")===0?e.setProperty(o,""):o==="float"?e.cssFloat="":e[o]="");for(var c in t)o=t[c],t.hasOwnProperty(c)&&n[c]!==o&&Xd(e,c,o)}else for(var u in t)t.hasOwnProperty(u)&&Xd(e,u,t[u])}function Jl(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tm=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),nm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ws(e){return nm.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var ei=null;function ti(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var xr=null,br=null;function Wd(e){var t=pe(e);if(t&&(e=t.stateNode)){var n=e[Ne]||null;e:switch(e=t.stateNode,t.type){case"input":if(Zl(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+En(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var o=n[t];if(o!==e&&o.form===e.form){var c=o[Ne]||null;if(!c)throw Error(i(90));Zl(o,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(t=0;t<n.length;t++)o=n[t],o.form===e.form&&Fd(o)}break e;case"textarea":Pd(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&mr(e,!!n.multiple,t,!1)}}}var ni=!1;function Qd(e,t,n){if(ni)return e(t,n);ni=!0;try{var o=e(t);return o}finally{if(ni=!1,(xr!==null||br!==null)&&(ll(),xr&&(t=xr,e=br,br=xr=null,Wd(t),e)))for(t=0;t<e.length;t++)Wd(e[t])}}function lo(e,t){var n=e.stateNode;if(n===null)return null;var o=n[Ne]||null;if(o===null)return null;n=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(i(231,t,typeof n));return n}var ea=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ai=!1;if(ea)try{var io={};Object.defineProperty(io,"passive",{get:function(){ai=!0}}),window.addEventListener("test",io,io),window.removeEventListener("test",io,io)}catch{ai=!1}var va=null,ri=null,Cs=null;function Zd(){if(Cs)return Cs;var e,t=ri,n=t.length,o,c="value"in va?va.value:va.textContent,u=c.length;for(e=0;e<n&&t[e]===c[e];e++);var x=n-e;for(o=1;o<=x&&t[n-o]===c[u-o];o++);return Cs=c.slice(e,1<o?1-o:void 0)}function js(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function _s(){return!0}function Kd(){return!1}function ln(e){function t(n,o,c,u,x){this._reactName=n,this._targetInst=c,this.type=o,this.nativeEvent=u,this.target=x,this.currentTarget=null;for(var w in e)e.hasOwnProperty(w)&&(n=e[w],this[w]=n?n(u):u[w]);return this.isDefaultPrevented=(u.defaultPrevented!=null?u.defaultPrevented:u.returnValue===!1)?_s:Kd,this.isPropagationStopped=Kd,this}return y(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=_s)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=_s)},persist:function(){},isPersistent:_s}),t}var Pa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ts=ln(Pa),co=y({},Pa,{view:0,detail:0}),am=ln(co),oi,si,uo,Es=y({},co,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ii,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==uo&&(uo&&e.type==="mousemove"?(oi=e.screenX-uo.screenX,si=e.screenY-uo.screenY):si=oi=0,uo=e),oi)},movementY:function(e){return"movementY"in e?e.movementY:si}}),Jd=ln(Es),rm=y({},Es,{dataTransfer:0}),om=ln(rm),sm=y({},co,{relatedTarget:0}),li=ln(sm),lm=y({},Pa,{animationName:0,elapsedTime:0,pseudoElement:0}),im=ln(lm),cm=y({},Pa,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),dm=ln(cm),um=y({},Pa,{data:0}),eu=ln(um),fm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hm(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=pm[e])?!!t[e]:!1}function ii(){return hm}var mm=y({},co,{key:function(e){if(e.key){var t=fm[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=js(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?gm[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ii,charCode:function(e){return e.type==="keypress"?js(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?js(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ym=ln(mm),xm=y({},Es,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tu=ln(xm),bm=y({},co,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ii}),vm=ln(bm),Sm=y({},Pa,{propertyName:0,elapsedTime:0,pseudoElement:0}),wm=ln(Sm),Cm=y({},Es,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),jm=ln(Cm),_m=y({},Pa,{newState:0,oldState:0}),Tm=ln(_m),Em=[9,13,27,32],ci=ea&&"CompositionEvent"in window,fo=null;ea&&"documentMode"in document&&(fo=document.documentMode);var km=ea&&"TextEvent"in window&&!fo,nu=ea&&(!ci||fo&&8<fo&&11>=fo),au=" ",ru=!1;function ou(e,t){switch(e){case"keyup":return Em.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function su(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var vr=!1;function Am(e,t){switch(e){case"compositionend":return su(t);case"keypress":return t.which!==32?null:(ru=!0,au);case"textInput":return e=t.data,e===au&&ru?null:e;default:return null}}function Dm(e,t){if(vr)return e==="compositionend"||!ci&&ou(e,t)?(e=Zd(),Cs=ri=va=null,vr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return nu&&t.locale!=="ko"?null:t.data;default:return null}}var Rm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Rm[e.type]:t==="textarea"}function iu(e,t,n,o){xr?br?br.push(o):br=[o]:xr=o,t=gl(t,"onChange"),0<t.length&&(n=new Ts("onChange","change",null,n,o),e.push({event:n,listeners:t}))}var go=null,po=null;function Nm(e){Fg(e,0)}function ks(e){var t=Se(e);if(Fd(t))return e}function cu(e,t){if(e==="change")return t}var du=!1;if(ea){var di;if(ea){var ui="oninput"in document;if(!ui){var uu=document.createElement("div");uu.setAttribute("oninput","return;"),ui=typeof uu.oninput=="function"}di=ui}else di=!1;du=di&&(!document.documentMode||9<document.documentMode)}function fu(){go&&(go.detachEvent("onpropertychange",gu),po=go=null)}function gu(e){if(e.propertyName==="value"&&ks(po)){var t=[];iu(t,po,e,ti(e)),Qd(Nm,t)}}function Om(e,t,n){e==="focusin"?(fu(),go=t,po=n,go.attachEvent("onpropertychange",gu)):e==="focusout"&&fu()}function Mm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ks(po)}function zm(e,t){if(e==="click")return ks(t)}function $m(e,t){if(e==="input"||e==="change")return ks(t)}function Lm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var hn=typeof Object.is=="function"?Object.is:Lm;function ho(e,t){if(hn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(o=0;o<n.length;o++){var c=n[o];if(!rt.call(t,c)||!hn(e[c],t[c]))return!1}return!0}function pu(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hu(e,t){var n=pu(e);e=0;for(var o;n;){if(n.nodeType===3){if(o=e+n.textContent.length,e<=t&&o>=t)return{node:n,offset:t-e};e=o}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=pu(n)}}function mu(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?mu(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function yu(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Ss(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ss(e.document)}return t}function fi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Um=ea&&"documentMode"in document&&11>=document.documentMode,Sr=null,gi=null,mo=null,pi=!1;function xu(e,t,n){var o=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;pi||Sr==null||Sr!==Ss(o)||(o=Sr,"selectionStart"in o&&fi(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),mo&&ho(mo,o)||(mo=o,o=gl(gi,"onSelect"),0<o.length&&(t=new Ts("onSelect","select",null,t,n),e.push({event:t,listeners:o}),t.target=Sr)))}function Ya(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wr={animationend:Ya("Animation","AnimationEnd"),animationiteration:Ya("Animation","AnimationIteration"),animationstart:Ya("Animation","AnimationStart"),transitionrun:Ya("Transition","TransitionRun"),transitionstart:Ya("Transition","TransitionStart"),transitioncancel:Ya("Transition","TransitionCancel"),transitionend:Ya("Transition","TransitionEnd")},hi={},bu={};ea&&(bu=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);function Xa(e){if(hi[e])return hi[e];if(!wr[e])return e;var t=wr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in bu)return hi[e]=t[n];return e}var vu=Xa("animationend"),Su=Xa("animationiteration"),wu=Xa("animationstart"),Bm=Xa("transitionrun"),Im=Xa("transitionstart"),Hm=Xa("transitioncancel"),Cu=Xa("transitionend"),ju=new Map,mi="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");mi.push("scrollEnd");function Un(e,t){ju.set(e,t),Oe(t,[e])}var _u=new WeakMap;function kn(e,t){if(typeof e=="object"&&e!==null){var n=_u.get(e);return n!==void 0?n:(t={value:e,source:t,stack:hr(t)},_u.set(e,t),t)}return{value:e,source:t,stack:hr(t)}}var An=[],Cr=0,yi=0;function As(){for(var e=Cr,t=yi=Cr=0;t<e;){var n=An[t];An[t++]=null;var o=An[t];An[t++]=null;var c=An[t];An[t++]=null;var u=An[t];if(An[t++]=null,o!==null&&c!==null){var x=o.pending;x===null?c.next=c:(c.next=x.next,x.next=c),o.pending=c}u!==0&&Tu(n,c,u)}}function Ds(e,t,n,o){An[Cr++]=e,An[Cr++]=t,An[Cr++]=n,An[Cr++]=o,yi|=o,e.lanes|=o,e=e.alternate,e!==null&&(e.lanes|=o)}function xi(e,t,n,o){return Ds(e,t,n,o),Rs(e)}function jr(e,t){return Ds(e,null,null,t),Rs(e)}function Tu(e,t,n){e.lanes|=n;var o=e.alternate;o!==null&&(o.lanes|=n);for(var c=!1,u=e.return;u!==null;)u.childLanes|=n,o=u.alternate,o!==null&&(o.childLanes|=n),u.tag===22&&(e=u.stateNode,e===null||e._visibility&1||(c=!0)),e=u,u=u.return;return e.tag===3?(u=e.stateNode,c&&t!==null&&(c=31-yt(n),e=u.hiddenUpdates,o=e[c],o===null?e[c]=[t]:o.push(t),t.lane=n|536870912),u):null}function Rs(e){if(50<Ho)throw Ho=0,jc=null,Error(i(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var _r={};function qm(e,t,n,o){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mn(e,t,n,o){return new qm(e,t,n,o)}function bi(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ta(e,t){var n=e.alternate;return n===null?(n=mn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Eu(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ns(e,t,n,o,c,u){var x=0;if(o=e,typeof e=="function")bi(e)&&(x=1);else if(typeof e=="string")x=Gy(e,n,ae.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case I:return e=mn(31,n,t,c),e.elementType=I,e.lanes=u,e;case _:return Va(n.children,c,u,t);case j:x=8,c|=24;break;case T:return e=mn(12,n,t,c|2),e.elementType=T,e.lanes=u,e;case $:return e=mn(13,n,t,c),e.elementType=$,e.lanes=u,e;case V:return e=mn(19,n,t,c),e.elementType=V,e.lanes=u,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case N:case D:x=10;break e;case O:x=9;break e;case L:x=11;break e;case H:x=14;break e;case C:x=16,o=null;break e}x=29,n=Error(i(130,e===null?"null":typeof e,"")),o=null}return t=mn(x,n,t,c),t.elementType=e,t.type=o,t.lanes=u,t}function Va(e,t,n,o){return e=mn(7,e,o,t),e.lanes=n,e}function vi(e,t,n){return e=mn(6,e,null,t),e.lanes=n,e}function Si(e,t,n){return t=mn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Tr=[],Er=0,Os=null,Ms=0,Dn=[],Rn=0,Wa=null,na=1,aa="";function Qa(e,t){Tr[Er++]=Ms,Tr[Er++]=Os,Os=e,Ms=t}function ku(e,t,n){Dn[Rn++]=na,Dn[Rn++]=aa,Dn[Rn++]=Wa,Wa=e;var o=na;e=aa;var c=32-yt(o)-1;o&=~(1<<c),n+=1;var u=32-yt(t)+c;if(30<u){var x=c-c%5;u=(o&(1<<x)-1).toString(32),o>>=x,c-=x,na=1<<32-yt(t)+c|n<<c|o,aa=u+e}else na=1<<u|n<<c|o,aa=e}function wi(e){e.return!==null&&(Qa(e,1),ku(e,1,0))}function Ci(e){for(;e===Os;)Os=Tr[--Er],Tr[Er]=null,Ms=Tr[--Er],Tr[Er]=null;for(;e===Wa;)Wa=Dn[--Rn],Dn[Rn]=null,aa=Dn[--Rn],Dn[Rn]=null,na=Dn[--Rn],Dn[Rn]=null}var rn=null,At=null,at=!1,Za=null,Gn=!1,ji=Error(i(519));function Ka(e){var t=Error(i(418,""));throw bo(kn(t,e)),ji}function Au(e){var t=e.stateNode,n=e.type,o=e.memoizedProps;switch(t[Je]=e,t[Ne]=o,n){case"dialog":Xe("cancel",t),Xe("close",t);break;case"iframe":case"object":case"embed":Xe("load",t);break;case"video":case"audio":for(n=0;n<Fo.length;n++)Xe(Fo[n],t);break;case"source":Xe("error",t);break;case"img":case"image":case"link":Xe("error",t),Xe("load",t);break;case"details":Xe("toggle",t);break;case"input":Xe("invalid",t),Gd(t,o.value,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name,!0),vs(t);break;case"select":Xe("invalid",t);break;case"textarea":Xe("invalid",t),Yd(t,o.value,o.defaultValue,o.children),vs(t)}n=o.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||o.suppressHydrationWarning===!0||Xg(t.textContent,n)?(o.popover!=null&&(Xe("beforetoggle",t),Xe("toggle",t)),o.onScroll!=null&&Xe("scroll",t),o.onScrollEnd!=null&&Xe("scrollend",t),o.onClick!=null&&(t.onclick=pl),t=!0):t=!1,t||Ka(e)}function Du(e){for(rn=e.return;rn;)switch(rn.tag){case 5:case 13:Gn=!1;return;case 27:case 3:Gn=!0;return;default:rn=rn.return}}function yo(e){if(e!==rn)return!1;if(!at)return Du(e),at=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||Ic(e.type,e.memoizedProps)),n=!n),n&&At&&Ka(e),Du(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(n=e.data,n==="/$"){if(t===0){At=In(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++;e=e.nextSibling}At=null}}else t===27?(t=At,$a(e.type)?(e=Gc,Gc=null,At=e):At=t):At=rn?In(e.stateNode.nextSibling):null;return!0}function xo(){At=rn=null,at=!1}function Ru(){var e=Za;return e!==null&&(un===null?un=e:un.push.apply(un,e),Za=null),e}function bo(e){Za===null?Za=[e]:Za.push(e)}var _i=fe(null),Ja=null,ra=null;function Sa(e,t,n){K(_i,t._currentValue),t._currentValue=n}function oa(e){e._currentValue=_i.current,te(_i)}function Ti(e,t,n){for(;e!==null;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,o!==null&&(o.childLanes|=t)):o!==null&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===n)break;e=e.return}}function Ei(e,t,n,o){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var u=c.dependencies;if(u!==null){var x=c.child;u=u.firstContext;e:for(;u!==null;){var w=u;u=c;for(var z=0;z<t.length;z++)if(w.context===t[z]){u.lanes|=n,w=u.alternate,w!==null&&(w.lanes|=n),Ti(u.return,n,e),o||(x=null);break e}u=w.next}}else if(c.tag===18){if(x=c.return,x===null)throw Error(i(341));x.lanes|=n,u=x.alternate,u!==null&&(u.lanes|=n),Ti(x,n,e),x=null}else x=c.child;if(x!==null)x.return=c;else for(x=c;x!==null;){if(x===e){x=null;break}if(c=x.sibling,c!==null){c.return=x.return,x=c;break}x=x.return}c=x}}function vo(e,t,n,o){e=null;for(var c=t,u=!1;c!==null;){if(!u){if((c.flags&524288)!==0)u=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var x=c.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var w=c.type;hn(c.pendingProps.value,x.value)||(e!==null?e.push(w):e=[w])}}else if(c===me.current){if(x=c.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(Wo):e=[Wo])}c=c.return}e!==null&&Ei(t,e,n,o),t.flags|=262144}function zs(e){for(e=e.firstContext;e!==null;){if(!hn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function er(e){Ja=e,ra=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function nn(e){return Nu(Ja,e)}function $s(e,t){return Ja===null&&er(e),Nu(e,t)}function Nu(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},ra===null){if(e===null)throw Error(i(308));ra=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ra=ra.next=t;return n}var Fm=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,o){e.push(o)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Gm=a.unstable_scheduleCallback,Pm=a.unstable_NormalPriority,Lt={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ki(){return{controller:new Fm,data:new Map,refCount:0}}function So(e){e.refCount--,e.refCount===0&&Gm(Pm,function(){e.controller.abort()})}var wo=null,Ai=0,kr=0,Ar=null;function Ym(e,t){if(wo===null){var n=wo=[];Ai=0,kr=Rc(),Ar={status:"pending",value:void 0,then:function(o){n.push(o)}}}return Ai++,t.then(Ou,Ou),t}function Ou(){if(--Ai===0&&wo!==null){Ar!==null&&(Ar.status="fulfilled");var e=wo;wo=null,kr=0,Ar=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Xm(e,t){var n=[],o={status:"pending",value:null,reason:null,then:function(c){n.push(c)}};return e.then(function(){o.status="fulfilled",o.value=t;for(var c=0;c<n.length;c++)(0,n[c])(t)},function(c){for(o.status="rejected",o.reason=c,c=0;c<n.length;c++)(0,n[c])(void 0)}),o}var Mu=R.S;R.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&Ym(e,t),Mu!==null&&Mu(e,t)};var tr=fe(null);function Di(){var e=tr.current;return e!==null?e:mt.pooledCache}function Ls(e,t){t===null?K(tr,tr.current):K(tr,t.pool)}function zu(){var e=Di();return e===null?null:{parent:Lt._currentValue,pool:e}}var Co=Error(i(460)),$u=Error(i(474)),Us=Error(i(542)),Ri={then:function(){}};function Lu(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Bs(){}function Uu(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(Bs,Bs),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Iu(e),e;default:if(typeof t.status=="string")t.then(Bs,Bs);else{if(e=mt,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=t,e.status="pending",e.then(function(o){if(t.status==="pending"){var c=t;c.status="fulfilled",c.value=o}},function(o){if(t.status==="pending"){var c=t;c.status="rejected",c.reason=o}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Iu(e),e}throw jo=t,Co}}var jo=null;function Bu(){if(jo===null)throw Error(i(459));var e=jo;return jo=null,e}function Iu(e){if(e===Co||e===Us)throw Error(i(483))}var wa=!1;function Ni(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Oi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Ca(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ja(e,t,n){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,(st&2)!==0){var c=o.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),o.pending=t,t=Rs(e),Tu(e,null,n),t}return Ds(e,o,t,n),Rs(e)}function _o(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var o=t.lanes;o&=e.pendingLanes,n|=o,t.lanes=n,an(e,n)}}function Mi(e,t){var n=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,n===o)){var c=null,u=null;if(n=n.firstBaseUpdate,n!==null){do{var x={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};u===null?c=u=x:u=u.next=x,n=n.next}while(n!==null);u===null?c=u=t:u=u.next=t}else c=u=t;n={baseState:o.baseState,firstBaseUpdate:c,lastBaseUpdate:u,shared:o.shared,callbacks:o.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var zi=!1;function To(){if(zi){var e=Ar;if(e!==null)throw e}}function Eo(e,t,n,o){zi=!1;var c=e.updateQueue;wa=!1;var u=c.firstBaseUpdate,x=c.lastBaseUpdate,w=c.shared.pending;if(w!==null){c.shared.pending=null;var z=w,Z=z.next;z.next=null,x===null?u=Z:x.next=Z,x=z;var le=e.alternate;le!==null&&(le=le.updateQueue,w=le.lastBaseUpdate,w!==x&&(w===null?le.firstBaseUpdate=Z:w.next=Z,le.lastBaseUpdate=z))}if(u!==null){var de=c.baseState;x=0,le=Z=z=null,w=u;do{var J=w.lane&-536870913,ne=J!==w.lane;if(ne?(Ze&J)===J:(o&J)===J){J!==0&&J===kr&&(zi=!0),le!==null&&(le=le.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var Le=e,Me=w;J=t;var ut=n;switch(Me.tag){case 1:if(Le=Me.payload,typeof Le=="function"){de=Le.call(ut,de,J);break e}de=Le;break e;case 3:Le.flags=Le.flags&-65537|128;case 0:if(Le=Me.payload,J=typeof Le=="function"?Le.call(ut,de,J):Le,J==null)break e;de=y({},de,J);break e;case 2:wa=!0}}J=w.callback,J!==null&&(e.flags|=64,ne&&(e.flags|=8192),ne=c.callbacks,ne===null?c.callbacks=[J]:ne.push(J))}else ne={lane:J,tag:w.tag,payload:w.payload,callback:w.callback,next:null},le===null?(Z=le=ne,z=de):le=le.next=ne,x|=J;if(w=w.next,w===null){if(w=c.shared.pending,w===null)break;ne=w,w=ne.next,ne.next=null,c.lastBaseUpdate=ne,c.shared.pending=null}}while(!0);le===null&&(z=de),c.baseState=z,c.firstBaseUpdate=Z,c.lastBaseUpdate=le,u===null&&(c.shared.lanes=0),Na|=x,e.lanes=x,e.memoizedState=de}}function Hu(e,t){if(typeof e!="function")throw Error(i(191,e));e.call(t)}function qu(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)Hu(n[e],t)}var Dr=fe(null),Is=fe(0);function Fu(e,t){e=fa,K(Is,e),K(Dr,t),fa=e|t.baseLanes}function $i(){K(Is,fa),K(Dr,Dr.current)}function Li(){fa=Is.current,te(Dr),te(Is)}var _a=0,Fe=null,ct=null,zt=null,Hs=!1,Rr=!1,nr=!1,qs=0,ko=0,Nr=null,Vm=0;function Ot(){throw Error(i(321))}function Ui(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!hn(e[n],t[n]))return!1;return!0}function Bi(e,t,n,o,c,u){return _a=u,Fe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,R.H=e===null||e.memoizedState===null?Ef:kf,nr=!1,u=n(o,c),nr=!1,Rr&&(u=Pu(t,n,o,c)),Gu(e),u}function Gu(e){R.H=Vs;var t=ct!==null&&ct.next!==null;if(_a=0,zt=ct=Fe=null,Hs=!1,ko=0,Nr=null,t)throw Error(i(300));e===null||Gt||(e=e.dependencies,e!==null&&zs(e)&&(Gt=!0))}function Pu(e,t,n,o){Fe=e;var c=0;do{if(Rr&&(Nr=null),ko=0,Rr=!1,25<=c)throw Error(i(301));if(c+=1,zt=ct=null,e.updateQueue!=null){var u=e.updateQueue;u.lastEffect=null,u.events=null,u.stores=null,u.memoCache!=null&&(u.memoCache.index=0)}R.H=ty,u=t(n,o)}while(Rr);return u}function Wm(){var e=R.H,t=e.useState()[0];return t=typeof t.then=="function"?Ao(t):t,e=e.useState()[0],(ct!==null?ct.memoizedState:null)!==e&&(Fe.flags|=1024),t}function Ii(){var e=qs!==0;return qs=0,e}function Hi(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function qi(e){if(Hs){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Hs=!1}_a=0,zt=ct=Fe=null,Rr=!1,ko=qs=0,Nr=null}function cn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?Fe.memoizedState=zt=e:zt=zt.next=e,zt}function $t(){if(ct===null){var e=Fe.alternate;e=e!==null?e.memoizedState:null}else e=ct.next;var t=zt===null?Fe.memoizedState:zt.next;if(t!==null)zt=t,ct=e;else{if(e===null)throw Fe.alternate===null?Error(i(467)):Error(i(310));ct=e,e={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},zt===null?Fe.memoizedState=zt=e:zt=zt.next=e}return zt}function Fi(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ao(e){var t=ko;return ko+=1,Nr===null&&(Nr=[]),e=Uu(Nr,e,t),t=Fe,(zt===null?t.memoizedState:zt.next)===null&&(t=t.alternate,R.H=t===null||t.memoizedState===null?Ef:kf),e}function Fs(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Ao(e);if(e.$$typeof===D)return nn(e)}throw Error(i(438,String(e)))}function Gi(e){var t=null,n=Fe.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var o=Fe.alternate;o!==null&&(o=o.updateQueue,o!==null&&(o=o.memoCache,o!=null&&(t={data:o.data.map(function(c){return c.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Fi(),Fe.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),o=0;o<e;o++)n[o]=U;return t.index++,n}function sa(e,t){return typeof t=="function"?t(e):t}function Gs(e){var t=$t();return Pi(t,ct,e)}function Pi(e,t,n){var o=e.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var c=e.baseQueue,u=o.pending;if(u!==null){if(c!==null){var x=c.next;c.next=u.next,u.next=x}t.baseQueue=c=u,o.pending=null}if(u=e.baseState,c===null)e.memoizedState=u;else{t=c.next;var w=x=null,z=null,Z=t,le=!1;do{var de=Z.lane&-536870913;if(de!==Z.lane?(Ze&de)===de:(_a&de)===de){var J=Z.revertLane;if(J===0)z!==null&&(z=z.next={lane:0,revertLane:0,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),de===kr&&(le=!0);else if((_a&J)===J){Z=Z.next,J===kr&&(le=!0);continue}else de={lane:0,revertLane:Z.revertLane,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},z===null?(w=z=de,x=u):z=z.next=de,Fe.lanes|=J,Na|=J;de=Z.action,nr&&n(u,de),u=Z.hasEagerState?Z.eagerState:n(u,de)}else J={lane:de,revertLane:Z.revertLane,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},z===null?(w=z=J,x=u):z=z.next=J,Fe.lanes|=de,Na|=de;Z=Z.next}while(Z!==null&&Z!==t);if(z===null?x=u:z.next=w,!hn(u,e.memoizedState)&&(Gt=!0,le&&(n=Ar,n!==null)))throw n;e.memoizedState=u,e.baseState=x,e.baseQueue=z,o.lastRenderedState=u}return c===null&&(o.lanes=0),[e.memoizedState,o.dispatch]}function Yi(e){var t=$t(),n=t.queue;if(n===null)throw Error(i(311));n.lastRenderedReducer=e;var o=n.dispatch,c=n.pending,u=t.memoizedState;if(c!==null){n.pending=null;var x=c=c.next;do u=e(u,x.action),x=x.next;while(x!==c);hn(u,t.memoizedState)||(Gt=!0),t.memoizedState=u,t.baseQueue===null&&(t.baseState=u),n.lastRenderedState=u}return[u,o]}function Yu(e,t,n){var o=Fe,c=$t(),u=at;if(u){if(n===void 0)throw Error(i(407));n=n()}else n=t();var x=!hn((ct||c).memoizedState,n);x&&(c.memoizedState=n,Gt=!0),c=c.queue;var w=Wu.bind(null,o,c,e);if(Do(2048,8,w,[e]),c.getSnapshot!==t||x||zt!==null&&zt.memoizedState.tag&1){if(o.flags|=2048,Or(9,Ps(),Vu.bind(null,o,c,n,t),null),mt===null)throw Error(i(349));u||(_a&124)!==0||Xu(o,t,n)}return n}function Xu(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Fe.updateQueue,t===null?(t=Fi(),Fe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Vu(e,t,n,o){t.value=n,t.getSnapshot=o,Qu(t)&&Zu(e)}function Wu(e,t,n){return n(function(){Qu(t)&&Zu(e)})}function Qu(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!hn(e,n)}catch{return!0}}function Zu(e){var t=jr(e,2);t!==null&&Sn(t,e,2)}function Xi(e){var t=cn();if(typeof e=="function"){var n=e;if(e=n(),nr){Tt(!0);try{n()}finally{Tt(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:e},t}function Ku(e,t,n,o){return e.baseState=n,Pi(e,ct,typeof o=="function"?o:sa)}function Qm(e,t,n,o,c){if(Xs(e))throw Error(i(485));if(e=t.action,e!==null){var u={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){u.listeners.push(x)}};R.T!==null?n(!0):u.isTransition=!1,o(u),n=t.pending,n===null?(u.next=t.pending=u,Ju(t,u)):(u.next=n.next,t.pending=n.next=u)}}function Ju(e,t){var n=t.action,o=t.payload,c=e.state;if(t.isTransition){var u=R.T,x={};R.T=x;try{var w=n(c,o),z=R.S;z!==null&&z(x,w),ef(e,t,w)}catch(Z){Vi(e,t,Z)}finally{R.T=u}}else try{u=n(c,o),ef(e,t,u)}catch(Z){Vi(e,t,Z)}}function ef(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(o){tf(e,t,o)},function(o){return Vi(e,t,o)}):tf(e,t,n)}function tf(e,t,n){t.status="fulfilled",t.value=n,nf(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,Ju(e,n)))}function Vi(e,t,n){var o=e.pending;if(e.pending=null,o!==null){o=o.next;do t.status="rejected",t.reason=n,nf(t),t=t.next;while(t!==o)}e.action=null}function nf(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function af(e,t){return t}function rf(e,t){if(at){var n=mt.formState;if(n!==null){e:{var o=Fe;if(at){if(At){t:{for(var c=At,u=Gn;c.nodeType!==8;){if(!u){c=null;break t}if(c=In(c.nextSibling),c===null){c=null;break t}}u=c.data,c=u==="F!"||u==="F"?c:null}if(c){At=In(c.nextSibling),o=c.data==="F!";break e}}Ka(o)}o=!1}o&&(t=n[0])}}return n=cn(),n.memoizedState=n.baseState=t,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:af,lastRenderedState:t},n.queue=o,n=jf.bind(null,Fe,o),o.dispatch=n,o=Xi(!1),u=Ji.bind(null,Fe,!1,o.queue),o=cn(),c={state:t,dispatch:null,action:e,pending:null},o.queue=c,n=Qm.bind(null,Fe,c,u,n),c.dispatch=n,o.memoizedState=e,[t,n,!1]}function of(e){var t=$t();return sf(t,ct,e)}function sf(e,t,n){if(t=Pi(e,t,af)[0],e=Gs(sa)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var o=Ao(t)}catch(x){throw x===Co?Us:x}else o=t;t=$t();var c=t.queue,u=c.dispatch;return n!==t.memoizedState&&(Fe.flags|=2048,Or(9,Ps(),Zm.bind(null,c,n),null)),[o,u,e]}function Zm(e,t){e.action=t}function lf(e){var t=$t(),n=ct;if(n!==null)return sf(t,n,e);$t(),t=t.memoizedState,n=$t();var o=n.queue.dispatch;return n.memoizedState=e,[t,o,!1]}function Or(e,t,n,o){return e={tag:e,create:n,deps:o,inst:t,next:null},t=Fe.updateQueue,t===null&&(t=Fi(),Fe.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(o=n.next,n.next=e,e.next=o,t.lastEffect=e),e}function Ps(){return{destroy:void 0,resource:void 0}}function cf(){return $t().memoizedState}function Ys(e,t,n,o){var c=cn();o=o===void 0?null:o,Fe.flags|=e,c.memoizedState=Or(1|t,Ps(),n,o)}function Do(e,t,n,o){var c=$t();o=o===void 0?null:o;var u=c.memoizedState.inst;ct!==null&&o!==null&&Ui(o,ct.memoizedState.deps)?c.memoizedState=Or(t,u,n,o):(Fe.flags|=e,c.memoizedState=Or(1|t,u,n,o))}function df(e,t){Ys(8390656,8,e,t)}function uf(e,t){Do(2048,8,e,t)}function ff(e,t){return Do(4,2,e,t)}function gf(e,t){return Do(4,4,e,t)}function pf(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function hf(e,t,n){n=n!=null?n.concat([e]):null,Do(4,4,pf.bind(null,t,e),n)}function Wi(){}function mf(e,t){var n=$t();t=t===void 0?null:t;var o=n.memoizedState;return t!==null&&Ui(t,o[1])?o[0]:(n.memoizedState=[e,t],e)}function yf(e,t){var n=$t();t=t===void 0?null:t;var o=n.memoizedState;if(t!==null&&Ui(t,o[1]))return o[0];if(o=e(),nr){Tt(!0);try{e()}finally{Tt(!1)}}return n.memoizedState=[o,t],o}function Qi(e,t,n){return n===void 0||(_a&1073741824)!==0?e.memoizedState=t:(e.memoizedState=n,e=vg(),Fe.lanes|=e,Na|=e,n)}function xf(e,t,n,o){return hn(n,t)?n:Dr.current!==null?(e=Qi(e,n,o),hn(e,t)||(Gt=!0),e):(_a&42)===0?(Gt=!0,e.memoizedState=n):(e=vg(),Fe.lanes|=e,Na|=e,t)}function bf(e,t,n,o,c){var u=M.p;M.p=u!==0&&8>u?u:8;var x=R.T,w={};R.T=w,Ji(e,!1,t,n);try{var z=c(),Z=R.S;if(Z!==null&&Z(w,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var le=Xm(z,o);Ro(e,t,le,vn(e))}else Ro(e,t,o,vn(e))}catch(de){Ro(e,t,{then:function(){},status:"rejected",reason:de},vn())}finally{M.p=u,R.T=x}}function Km(){}function Zi(e,t,n,o){if(e.tag!==5)throw Error(i(476));var c=vf(e).queue;bf(e,c,t,W,n===null?Km:function(){return Sf(e),n(o)})}function vf(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:W},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function Sf(e){var t=vf(e).next.queue;Ro(e,t,{},vn())}function Ki(){return nn(Wo)}function wf(){return $t().memoizedState}function Cf(){return $t().memoizedState}function Jm(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=vn();e=Ca(n);var o=ja(t,e,n);o!==null&&(Sn(o,t,n),_o(o,t,n)),t={cache:ki()},e.payload=t;return}t=t.return}}function ey(e,t,n){var o=vn();n={lane:o,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Xs(e)?_f(t,n):(n=xi(e,t,n,o),n!==null&&(Sn(n,e,o),Tf(n,t,o)))}function jf(e,t,n){var o=vn();Ro(e,t,n,o)}function Ro(e,t,n,o){var c={lane:o,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xs(e))_f(t,c);else{var u=e.alternate;if(e.lanes===0&&(u===null||u.lanes===0)&&(u=t.lastRenderedReducer,u!==null))try{var x=t.lastRenderedState,w=u(x,n);if(c.hasEagerState=!0,c.eagerState=w,hn(w,x))return Ds(e,t,c,0),mt===null&&As(),!1}catch{}finally{}if(n=xi(e,t,c,o),n!==null)return Sn(n,e,o),Tf(n,t,o),!0}return!1}function Ji(e,t,n,o){if(o={lane:2,revertLane:Rc(),action:o,hasEagerState:!1,eagerState:null,next:null},Xs(e)){if(t)throw Error(i(479))}else t=xi(e,n,o,2),t!==null&&Sn(t,e,2)}function Xs(e){var t=e.alternate;return e===Fe||t!==null&&t===Fe}function _f(e,t){Rr=Hs=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Tf(e,t,n){if((n&4194048)!==0){var o=t.lanes;o&=e.pendingLanes,n|=o,t.lanes=n,an(e,n)}}var Vs={readContext:nn,use:Fs,useCallback:Ot,useContext:Ot,useEffect:Ot,useImperativeHandle:Ot,useLayoutEffect:Ot,useInsertionEffect:Ot,useMemo:Ot,useReducer:Ot,useRef:Ot,useState:Ot,useDebugValue:Ot,useDeferredValue:Ot,useTransition:Ot,useSyncExternalStore:Ot,useId:Ot,useHostTransitionStatus:Ot,useFormState:Ot,useActionState:Ot,useOptimistic:Ot,useMemoCache:Ot,useCacheRefresh:Ot},Ef={readContext:nn,use:Fs,useCallback:function(e,t){return cn().memoizedState=[e,t===void 0?null:t],e},useContext:nn,useEffect:df,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,Ys(4194308,4,pf.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ys(4194308,4,e,t)},useInsertionEffect:function(e,t){Ys(4,2,e,t)},useMemo:function(e,t){var n=cn();t=t===void 0?null:t;var o=e();if(nr){Tt(!0);try{e()}finally{Tt(!1)}}return n.memoizedState=[o,t],o},useReducer:function(e,t,n){var o=cn();if(n!==void 0){var c=n(t);if(nr){Tt(!0);try{n(t)}finally{Tt(!1)}}}else c=t;return o.memoizedState=o.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},o.queue=e,e=e.dispatch=ey.bind(null,Fe,e),[o.memoizedState,e]},useRef:function(e){var t=cn();return e={current:e},t.memoizedState=e},useState:function(e){e=Xi(e);var t=e.queue,n=jf.bind(null,Fe,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Wi,useDeferredValue:function(e,t){var n=cn();return Qi(n,e,t)},useTransition:function(){var e=Xi(!1);return e=bf.bind(null,Fe,e.queue,!0,!1),cn().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var o=Fe,c=cn();if(at){if(n===void 0)throw Error(i(407));n=n()}else{if(n=t(),mt===null)throw Error(i(349));(Ze&124)!==0||Xu(o,t,n)}c.memoizedState=n;var u={value:n,getSnapshot:t};return c.queue=u,df(Wu.bind(null,o,u,e),[e]),o.flags|=2048,Or(9,Ps(),Vu.bind(null,o,u,n,t),null),n},useId:function(){var e=cn(),t=mt.identifierPrefix;if(at){var n=aa,o=na;n=(o&~(1<<32-yt(o)-1)).toString(32)+n,t="«"+t+"R"+n,n=qs++,0<n&&(t+="H"+n.toString(32)),t+="»"}else n=Vm++,t="«"+t+"r"+n.toString(32)+"»";return e.memoizedState=t},useHostTransitionStatus:Ki,useFormState:rf,useActionState:rf,useOptimistic:function(e){var t=cn();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Ji.bind(null,Fe,!0,n),n.dispatch=t,[e,t]},useMemoCache:Gi,useCacheRefresh:function(){return cn().memoizedState=Jm.bind(null,Fe)}},kf={readContext:nn,use:Fs,useCallback:mf,useContext:nn,useEffect:uf,useImperativeHandle:hf,useInsertionEffect:ff,useLayoutEffect:gf,useMemo:yf,useReducer:Gs,useRef:cf,useState:function(){return Gs(sa)},useDebugValue:Wi,useDeferredValue:function(e,t){var n=$t();return xf(n,ct.memoizedState,e,t)},useTransition:function(){var e=Gs(sa)[0],t=$t().memoizedState;return[typeof e=="boolean"?e:Ao(e),t]},useSyncExternalStore:Yu,useId:wf,useHostTransitionStatus:Ki,useFormState:of,useActionState:of,useOptimistic:function(e,t){var n=$t();return Ku(n,ct,e,t)},useMemoCache:Gi,useCacheRefresh:Cf},ty={readContext:nn,use:Fs,useCallback:mf,useContext:nn,useEffect:uf,useImperativeHandle:hf,useInsertionEffect:ff,useLayoutEffect:gf,useMemo:yf,useReducer:Yi,useRef:cf,useState:function(){return Yi(sa)},useDebugValue:Wi,useDeferredValue:function(e,t){var n=$t();return ct===null?Qi(n,e,t):xf(n,ct.memoizedState,e,t)},useTransition:function(){var e=Yi(sa)[0],t=$t().memoizedState;return[typeof e=="boolean"?e:Ao(e),t]},useSyncExternalStore:Yu,useId:wf,useHostTransitionStatus:Ki,useFormState:lf,useActionState:lf,useOptimistic:function(e,t){var n=$t();return ct!==null?Ku(n,ct,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Gi,useCacheRefresh:Cf},Mr=null,No=0;function Ws(e){var t=No;return No+=1,Mr===null&&(Mr=[]),Uu(Mr,e,t)}function Oo(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Qs(e,t){throw t.$$typeof===b?Error(i(525)):(e=Object.prototype.toString.call(t),Error(i(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Af(e){var t=e._init;return t(e._payload)}function Df(e){function t(Y,F){if(e){var Q=Y.deletions;Q===null?(Y.deletions=[F],Y.flags|=16):Q.push(F)}}function n(Y,F){if(!e)return null;for(;F!==null;)t(Y,F),F=F.sibling;return null}function o(Y){for(var F=new Map;Y!==null;)Y.key!==null?F.set(Y.key,Y):F.set(Y.index,Y),Y=Y.sibling;return F}function c(Y,F){return Y=ta(Y,F),Y.index=0,Y.sibling=null,Y}function u(Y,F,Q){return Y.index=Q,e?(Q=Y.alternate,Q!==null?(Q=Q.index,Q<F?(Y.flags|=67108866,F):Q):(Y.flags|=67108866,F)):(Y.flags|=1048576,F)}function x(Y){return e&&Y.alternate===null&&(Y.flags|=67108866),Y}function w(Y,F,Q,ie){return F===null||F.tag!==6?(F=vi(Q,Y.mode,ie),F.return=Y,F):(F=c(F,Q),F.return=Y,F)}function z(Y,F,Q,ie){var je=Q.type;return je===_?le(Y,F,Q.props.children,ie,Q.key):F!==null&&(F.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===C&&Af(je)===F.type)?(F=c(F,Q.props),Oo(F,Q),F.return=Y,F):(F=Ns(Q.type,Q.key,Q.props,null,Y.mode,ie),Oo(F,Q),F.return=Y,F)}function Z(Y,F,Q,ie){return F===null||F.tag!==4||F.stateNode.containerInfo!==Q.containerInfo||F.stateNode.implementation!==Q.implementation?(F=Si(Q,Y.mode,ie),F.return=Y,F):(F=c(F,Q.children||[]),F.return=Y,F)}function le(Y,F,Q,ie,je){return F===null||F.tag!==7?(F=Va(Q,Y.mode,ie,je),F.return=Y,F):(F=c(F,Q),F.return=Y,F)}function de(Y,F,Q){if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return F=vi(""+F,Y.mode,Q),F.return=Y,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case S:return Q=Ns(F.type,F.key,F.props,null,Y.mode,Q),Oo(Q,F),Q.return=Y,Q;case E:return F=Si(F,Y.mode,Q),F.return=Y,F;case C:var ie=F._init;return F=ie(F._payload),de(Y,F,Q)}if(P(F)||ee(F))return F=Va(F,Y.mode,Q,null),F.return=Y,F;if(typeof F.then=="function")return de(Y,Ws(F),Q);if(F.$$typeof===D)return de(Y,$s(Y,F),Q);Qs(Y,F)}return null}function J(Y,F,Q,ie){var je=F!==null?F.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return je!==null?null:w(Y,F,""+Q,ie);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case S:return Q.key===je?z(Y,F,Q,ie):null;case E:return Q.key===je?Z(Y,F,Q,ie):null;case C:return je=Q._init,Q=je(Q._payload),J(Y,F,Q,ie)}if(P(Q)||ee(Q))return je!==null?null:le(Y,F,Q,ie,null);if(typeof Q.then=="function")return J(Y,F,Ws(Q),ie);if(Q.$$typeof===D)return J(Y,F,$s(Y,Q),ie);Qs(Y,Q)}return null}function ne(Y,F,Q,ie,je){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return Y=Y.get(Q)||null,w(F,Y,""+ie,je);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case S:return Y=Y.get(ie.key===null?Q:ie.key)||null,z(F,Y,ie,je);case E:return Y=Y.get(ie.key===null?Q:ie.key)||null,Z(F,Y,ie,je);case C:var Ge=ie._init;return ie=Ge(ie._payload),ne(Y,F,Q,ie,je)}if(P(ie)||ee(ie))return Y=Y.get(Q)||null,le(F,Y,ie,je,null);if(typeof ie.then=="function")return ne(Y,F,Q,Ws(ie),je);if(ie.$$typeof===D)return ne(Y,F,Q,$s(F,ie),je);Qs(F,ie)}return null}function Le(Y,F,Q,ie){for(var je=null,Ge=null,De=F,ze=F=0,Yt=null;De!==null&&ze<Q.length;ze++){De.index>ze?(Yt=De,De=null):Yt=De.sibling;var tt=J(Y,De,Q[ze],ie);if(tt===null){De===null&&(De=Yt);break}e&&De&&tt.alternate===null&&t(Y,De),F=u(tt,F,ze),Ge===null?je=tt:Ge.sibling=tt,Ge=tt,De=Yt}if(ze===Q.length)return n(Y,De),at&&Qa(Y,ze),je;if(De===null){for(;ze<Q.length;ze++)De=de(Y,Q[ze],ie),De!==null&&(F=u(De,F,ze),Ge===null?je=De:Ge.sibling=De,Ge=De);return at&&Qa(Y,ze),je}for(De=o(De);ze<Q.length;ze++)Yt=ne(De,Y,ze,Q[ze],ie),Yt!==null&&(e&&Yt.alternate!==null&&De.delete(Yt.key===null?ze:Yt.key),F=u(Yt,F,ze),Ge===null?je=Yt:Ge.sibling=Yt,Ge=Yt);return e&&De.forEach(function(Ha){return t(Y,Ha)}),at&&Qa(Y,ze),je}function Me(Y,F,Q,ie){if(Q==null)throw Error(i(151));for(var je=null,Ge=null,De=F,ze=F=0,Yt=null,tt=Q.next();De!==null&&!tt.done;ze++,tt=Q.next()){De.index>ze?(Yt=De,De=null):Yt=De.sibling;var Ha=J(Y,De,tt.value,ie);if(Ha===null){De===null&&(De=Yt);break}e&&De&&Ha.alternate===null&&t(Y,De),F=u(Ha,F,ze),Ge===null?je=Ha:Ge.sibling=Ha,Ge=Ha,De=Yt}if(tt.done)return n(Y,De),at&&Qa(Y,ze),je;if(De===null){for(;!tt.done;ze++,tt=Q.next())tt=de(Y,tt.value,ie),tt!==null&&(F=u(tt,F,ze),Ge===null?je=tt:Ge.sibling=tt,Ge=tt);return at&&Qa(Y,ze),je}for(De=o(De);!tt.done;ze++,tt=Q.next())tt=ne(De,Y,ze,tt.value,ie),tt!==null&&(e&&tt.alternate!==null&&De.delete(tt.key===null?ze:tt.key),F=u(tt,F,ze),Ge===null?je=tt:Ge.sibling=tt,Ge=tt);return e&&De.forEach(function(n0){return t(Y,n0)}),at&&Qa(Y,ze),je}function ut(Y,F,Q,ie){if(typeof Q=="object"&&Q!==null&&Q.type===_&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case S:e:{for(var je=Q.key;F!==null;){if(F.key===je){if(je=Q.type,je===_){if(F.tag===7){n(Y,F.sibling),ie=c(F,Q.props.children),ie.return=Y,Y=ie;break e}}else if(F.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===C&&Af(je)===F.type){n(Y,F.sibling),ie=c(F,Q.props),Oo(ie,Q),ie.return=Y,Y=ie;break e}n(Y,F);break}else t(Y,F);F=F.sibling}Q.type===_?(ie=Va(Q.props.children,Y.mode,ie,Q.key),ie.return=Y,Y=ie):(ie=Ns(Q.type,Q.key,Q.props,null,Y.mode,ie),Oo(ie,Q),ie.return=Y,Y=ie)}return x(Y);case E:e:{for(je=Q.key;F!==null;){if(F.key===je)if(F.tag===4&&F.stateNode.containerInfo===Q.containerInfo&&F.stateNode.implementation===Q.implementation){n(Y,F.sibling),ie=c(F,Q.children||[]),ie.return=Y,Y=ie;break e}else{n(Y,F);break}else t(Y,F);F=F.sibling}ie=Si(Q,Y.mode,ie),ie.return=Y,Y=ie}return x(Y);case C:return je=Q._init,Q=je(Q._payload),ut(Y,F,Q,ie)}if(P(Q))return Le(Y,F,Q,ie);if(ee(Q)){if(je=ee(Q),typeof je!="function")throw Error(i(150));return Q=je.call(Q),Me(Y,F,Q,ie)}if(typeof Q.then=="function")return ut(Y,F,Ws(Q),ie);if(Q.$$typeof===D)return ut(Y,F,$s(Y,Q),ie);Qs(Y,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,F!==null&&F.tag===6?(n(Y,F.sibling),ie=c(F,Q),ie.return=Y,Y=ie):(n(Y,F),ie=vi(Q,Y.mode,ie),ie.return=Y,Y=ie),x(Y)):n(Y,F)}return function(Y,F,Q,ie){try{No=0;var je=ut(Y,F,Q,ie);return Mr=null,je}catch(De){if(De===Co||De===Us)throw De;var Ge=mn(29,De,null,Y.mode);return Ge.lanes=ie,Ge.return=Y,Ge}finally{}}}var zr=Df(!0),Rf=Df(!1),Nn=fe(null),Pn=null;function Ta(e){var t=e.alternate;K(Ut,Ut.current&1),K(Nn,e),Pn===null&&(t===null||Dr.current!==null||t.memoizedState!==null)&&(Pn=e)}function Nf(e){if(e.tag===22){if(K(Ut,Ut.current),K(Nn,e),Pn===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(Pn=e)}}else Ea()}function Ea(){K(Ut,Ut.current),K(Nn,Nn.current)}function la(e){te(Nn),Pn===e&&(Pn=null),te(Ut)}var Ut=fe(0);function Zs(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||Fc(n)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function ec(e,t,n,o){t=e.memoizedState,n=n(o,t),n=n==null?t:y({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var tc={enqueueSetState:function(e,t,n){e=e._reactInternals;var o=vn(),c=Ca(o);c.payload=t,n!=null&&(c.callback=n),t=ja(e,c,o),t!==null&&(Sn(t,e,o),_o(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var o=vn(),c=Ca(o);c.tag=1,c.payload=t,n!=null&&(c.callback=n),t=ja(e,c,o),t!==null&&(Sn(t,e,o),_o(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=vn(),o=Ca(n);o.tag=2,t!=null&&(o.callback=t),t=ja(e,o,n),t!==null&&(Sn(t,e,n),_o(t,e,n))}};function Of(e,t,n,o,c,u,x){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,u,x):t.prototype&&t.prototype.isPureReactComponent?!ho(n,o)||!ho(c,u):!0}function Mf(e,t,n,o){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,o),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,o),t.state!==e&&tc.enqueueReplaceState(t,t.state,null)}function ar(e,t){var n=t;if("ref"in t){n={};for(var o in t)o!=="ref"&&(n[o]=t[o])}if(e=e.defaultProps){n===t&&(n=y({},n));for(var c in e)n[c]===void 0&&(n[c]=e[c])}return n}var Ks=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function zf(e){Ks(e)}function $f(e){console.error(e)}function Lf(e){Ks(e)}function Js(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(o){setTimeout(function(){throw o})}}function Uf(e,t,n){try{var o=e.onCaughtError;o(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function nc(e,t,n){return n=Ca(n),n.tag=3,n.payload={element:null},n.callback=function(){Js(e,t)},n}function Bf(e){return e=Ca(e),e.tag=3,e}function If(e,t,n,o){var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var u=o.value;e.payload=function(){return c(u)},e.callback=function(){Uf(t,n,o)}}var x=n.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(e.callback=function(){Uf(t,n,o),typeof c!="function"&&(Oa===null?Oa=new Set([this]):Oa.add(this));var w=o.stack;this.componentDidCatch(o.value,{componentStack:w!==null?w:""})})}function ny(e,t,n,o,c){if(n.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){if(t=n.alternate,t!==null&&vo(t,n,c,!0),n=Nn.current,n!==null){switch(n.tag){case 13:return Pn===null?Tc():n.alternate===null&&Dt===0&&(Dt=3),n.flags&=-257,n.flags|=65536,n.lanes=c,o===Ri?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([o]):t.add(o),kc(e,o,c)),!1;case 22:return n.flags|=65536,o===Ri?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([o])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([o]):n.add(o)),kc(e,o,c)),!1}throw Error(i(435,n.tag))}return kc(e,o,c),Tc(),!1}if(at)return t=Nn.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=c,o!==ji&&(e=Error(i(422),{cause:o}),bo(kn(e,n)))):(o!==ji&&(t=Error(i(423),{cause:o}),bo(kn(t,n))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,o=kn(o,n),c=nc(e.stateNode,o,c),Mi(e,c),Dt!==4&&(Dt=2)),!1;var u=Error(i(520),{cause:o});if(u=kn(u,n),Io===null?Io=[u]:Io.push(u),Dt!==4&&(Dt=2),t===null)return!0;o=kn(o,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=c&-c,n.lanes|=e,e=nc(n.stateNode,o,e),Mi(n,e),!1;case 1:if(t=n.type,u=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||u!==null&&typeof u.componentDidCatch=="function"&&(Oa===null||!Oa.has(u))))return n.flags|=65536,c&=-c,n.lanes|=c,c=Bf(c),If(c,e,n,o),Mi(n,c),!1}n=n.return}while(n!==null);return!1}var Hf=Error(i(461)),Gt=!1;function Qt(e,t,n,o){t.child=e===null?Rf(t,null,n,o):zr(t,e.child,n,o)}function qf(e,t,n,o,c){n=n.render;var u=t.ref;if("ref"in o){var x={};for(var w in o)w!=="ref"&&(x[w]=o[w])}else x=o;return er(t),o=Bi(e,t,n,x,u,c),w=Ii(),e!==null&&!Gt?(Hi(e,t,c),ia(e,t,c)):(at&&w&&wi(t),t.flags|=1,Qt(e,t,o,c),t.child)}function Ff(e,t,n,o,c){if(e===null){var u=n.type;return typeof u=="function"&&!bi(u)&&u.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=u,Gf(e,t,u,o,c)):(e=Ns(n.type,null,o,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(u=e.child,!dc(e,c)){var x=u.memoizedProps;if(n=n.compare,n=n!==null?n:ho,n(x,o)&&e.ref===t.ref)return ia(e,t,c)}return t.flags|=1,e=ta(u,o),e.ref=t.ref,e.return=t,t.child=e}function Gf(e,t,n,o,c){if(e!==null){var u=e.memoizedProps;if(ho(u,o)&&e.ref===t.ref)if(Gt=!1,t.pendingProps=o=u,dc(e,c))(e.flags&131072)!==0&&(Gt=!0);else return t.lanes=e.lanes,ia(e,t,c)}return ac(e,t,n,o,c)}function Pf(e,t,n){var o=t.pendingProps,c=o.children,u=e!==null?e.memoizedState:null;if(o.mode==="hidden"){if((t.flags&128)!==0){if(o=u!==null?u.baseLanes|n:n,e!==null){for(c=t.child=e.child,u=0;c!==null;)u=u|c.lanes|c.childLanes,c=c.sibling;t.childLanes=u&~o}else t.childLanes=0,t.child=null;return Yf(e,t,o,n)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Ls(t,u!==null?u.cachePool:null),u!==null?Fu(t,u):$i(),Nf(t);else return t.lanes=t.childLanes=536870912,Yf(e,t,u!==null?u.baseLanes|n:n,n)}else u!==null?(Ls(t,u.cachePool),Fu(t,u),Ea(),t.memoizedState=null):(e!==null&&Ls(t,null),$i(),Ea());return Qt(e,t,c,n),t.child}function Yf(e,t,n,o){var c=Di();return c=c===null?null:{parent:Lt._currentValue,pool:c},t.memoizedState={baseLanes:n,cachePool:c},e!==null&&Ls(t,null),$i(),Nf(t),e!==null&&vo(e,t,o,!0),null}function el(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(i(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function ac(e,t,n,o,c){return er(t),n=Bi(e,t,n,o,void 0,c),o=Ii(),e!==null&&!Gt?(Hi(e,t,c),ia(e,t,c)):(at&&o&&wi(t),t.flags|=1,Qt(e,t,n,c),t.child)}function Xf(e,t,n,o,c,u){return er(t),t.updateQueue=null,n=Pu(t,o,n,c),Gu(e),o=Ii(),e!==null&&!Gt?(Hi(e,t,u),ia(e,t,u)):(at&&o&&wi(t),t.flags|=1,Qt(e,t,n,u),t.child)}function Vf(e,t,n,o,c){if(er(t),t.stateNode===null){var u=_r,x=n.contextType;typeof x=="object"&&x!==null&&(u=nn(x)),u=new n(o,u),t.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=tc,t.stateNode=u,u._reactInternals=t,u=t.stateNode,u.props=o,u.state=t.memoizedState,u.refs={},Ni(t),x=n.contextType,u.context=typeof x=="object"&&x!==null?nn(x):_r,u.state=t.memoizedState,x=n.getDerivedStateFromProps,typeof x=="function"&&(ec(t,n,x,o),u.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(x=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),x!==u.state&&tc.enqueueReplaceState(u,u.state,null),Eo(t,o,u,c),To(),u.state=t.memoizedState),typeof u.componentDidMount=="function"&&(t.flags|=4194308),o=!0}else if(e===null){u=t.stateNode;var w=t.memoizedProps,z=ar(n,w);u.props=z;var Z=u.context,le=n.contextType;x=_r,typeof le=="object"&&le!==null&&(x=nn(le));var de=n.getDerivedStateFromProps;le=typeof de=="function"||typeof u.getSnapshotBeforeUpdate=="function",w=t.pendingProps!==w,le||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(w||Z!==x)&&Mf(t,u,o,x),wa=!1;var J=t.memoizedState;u.state=J,Eo(t,o,u,c),To(),Z=t.memoizedState,w||J!==Z||wa?(typeof de=="function"&&(ec(t,n,de,o),Z=t.memoizedState),(z=wa||Of(t,n,z,o,J,Z,x))?(le||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount()),typeof u.componentDidMount=="function"&&(t.flags|=4194308)):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=Z),u.props=o,u.state=Z,u.context=x,o=z):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),o=!1)}else{u=t.stateNode,Oi(e,t),x=t.memoizedProps,le=ar(n,x),u.props=le,de=t.pendingProps,J=u.context,Z=n.contextType,z=_r,typeof Z=="object"&&Z!==null&&(z=nn(Z)),w=n.getDerivedStateFromProps,(Z=typeof w=="function"||typeof u.getSnapshotBeforeUpdate=="function")||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(x!==de||J!==z)&&Mf(t,u,o,z),wa=!1,J=t.memoizedState,u.state=J,Eo(t,o,u,c),To();var ne=t.memoizedState;x!==de||J!==ne||wa||e!==null&&e.dependencies!==null&&zs(e.dependencies)?(typeof w=="function"&&(ec(t,n,w,o),ne=t.memoizedState),(le=wa||Of(t,n,le,o,J,ne,z)||e!==null&&e.dependencies!==null&&zs(e.dependencies))?(Z||typeof u.UNSAFE_componentWillUpdate!="function"&&typeof u.componentWillUpdate!="function"||(typeof u.componentWillUpdate=="function"&&u.componentWillUpdate(o,ne,z),typeof u.UNSAFE_componentWillUpdate=="function"&&u.UNSAFE_componentWillUpdate(o,ne,z)),typeof u.componentDidUpdate=="function"&&(t.flags|=4),typeof u.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof u.componentDidUpdate!="function"||x===e.memoizedProps&&J===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||x===e.memoizedProps&&J===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=ne),u.props=o,u.state=ne,u.context=z,o=le):(typeof u.componentDidUpdate!="function"||x===e.memoizedProps&&J===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||x===e.memoizedProps&&J===e.memoizedState||(t.flags|=1024),o=!1)}return u=o,el(e,t),o=(t.flags&128)!==0,u||o?(u=t.stateNode,n=o&&typeof n.getDerivedStateFromError!="function"?null:u.render(),t.flags|=1,e!==null&&o?(t.child=zr(t,e.child,null,c),t.child=zr(t,null,n,c)):Qt(e,t,n,c),t.memoizedState=u.state,e=t.child):e=ia(e,t,c),e}function Wf(e,t,n,o){return xo(),t.flags|=256,Qt(e,t,n,o),t.child}var rc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function oc(e){return{baseLanes:e,cachePool:zu()}}function sc(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=On),e}function Qf(e,t,n){var o=t.pendingProps,c=!1,u=(t.flags&128)!==0,x;if((x=u)||(x=e!==null&&e.memoizedState===null?!1:(Ut.current&2)!==0),x&&(c=!0,t.flags&=-129),x=(t.flags&32)!==0,t.flags&=-33,e===null){if(at){if(c?Ta(t):Ea(),at){var w=At,z;if(z=w){e:{for(z=w,w=Gn;z.nodeType!==8;){if(!w){w=null;break e}if(z=In(z.nextSibling),z===null){w=null;break e}}w=z}w!==null?(t.memoizedState={dehydrated:w,treeContext:Wa!==null?{id:na,overflow:aa}:null,retryLane:536870912,hydrationErrors:null},z=mn(18,null,null,0),z.stateNode=w,z.return=t,t.child=z,rn=t,At=null,z=!0):z=!1}z||Ka(t)}if(w=t.memoizedState,w!==null&&(w=w.dehydrated,w!==null))return Fc(w)?t.lanes=32:t.lanes=536870912,null;la(t)}return w=o.children,o=o.fallback,c?(Ea(),c=t.mode,w=tl({mode:"hidden",children:w},c),o=Va(o,c,n,null),w.return=t,o.return=t,w.sibling=o,t.child=w,c=t.child,c.memoizedState=oc(n),c.childLanes=sc(e,x,n),t.memoizedState=rc,o):(Ta(t),lc(t,w))}if(z=e.memoizedState,z!==null&&(w=z.dehydrated,w!==null)){if(u)t.flags&256?(Ta(t),t.flags&=-257,t=ic(e,t,n)):t.memoizedState!==null?(Ea(),t.child=e.child,t.flags|=128,t=null):(Ea(),c=o.fallback,w=t.mode,o=tl({mode:"visible",children:o.children},w),c=Va(c,w,n,null),c.flags|=2,o.return=t,c.return=t,o.sibling=c,t.child=o,zr(t,e.child,null,n),o=t.child,o.memoizedState=oc(n),o.childLanes=sc(e,x,n),t.memoizedState=rc,t=c);else if(Ta(t),Fc(w)){if(x=w.nextSibling&&w.nextSibling.dataset,x)var Z=x.dgst;x=Z,o=Error(i(419)),o.stack="",o.digest=x,bo({value:o,source:null,stack:null}),t=ic(e,t,n)}else if(Gt||vo(e,t,n,!1),x=(n&e.childLanes)!==0,Gt||x){if(x=mt,x!==null&&(o=n&-n,o=(o&42)!==0?1:wt(o),o=(o&(x.suspendedLanes|n))!==0?0:o,o!==0&&o!==z.retryLane))throw z.retryLane=o,jr(e,o),Sn(x,e,o),Hf;w.data==="$?"||Tc(),t=ic(e,t,n)}else w.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=z.treeContext,At=In(w.nextSibling),rn=t,at=!0,Za=null,Gn=!1,e!==null&&(Dn[Rn++]=na,Dn[Rn++]=aa,Dn[Rn++]=Wa,na=e.id,aa=e.overflow,Wa=t),t=lc(t,o.children),t.flags|=4096);return t}return c?(Ea(),c=o.fallback,w=t.mode,z=e.child,Z=z.sibling,o=ta(z,{mode:"hidden",children:o.children}),o.subtreeFlags=z.subtreeFlags&65011712,Z!==null?c=ta(Z,c):(c=Va(c,w,n,null),c.flags|=2),c.return=t,o.return=t,o.sibling=c,t.child=o,o=c,c=t.child,w=e.child.memoizedState,w===null?w=oc(n):(z=w.cachePool,z!==null?(Z=Lt._currentValue,z=z.parent!==Z?{parent:Z,pool:Z}:z):z=zu(),w={baseLanes:w.baseLanes|n,cachePool:z}),c.memoizedState=w,c.childLanes=sc(e,x,n),t.memoizedState=rc,o):(Ta(t),n=e.child,e=n.sibling,n=ta(n,{mode:"visible",children:o.children}),n.return=t,n.sibling=null,e!==null&&(x=t.deletions,x===null?(t.deletions=[e],t.flags|=16):x.push(e)),t.child=n,t.memoizedState=null,n)}function lc(e,t){return t=tl({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function tl(e,t){return e=mn(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function ic(e,t,n){return zr(t,e.child,null,n),e=lc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Zf(e,t,n){e.lanes|=t;var o=e.alternate;o!==null&&(o.lanes|=t),Ti(e.return,t,n)}function cc(e,t,n,o,c){var u=e.memoizedState;u===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:n,tailMode:c}:(u.isBackwards=t,u.rendering=null,u.renderingStartTime=0,u.last=o,u.tail=n,u.tailMode=c)}function Kf(e,t,n){var o=t.pendingProps,c=o.revealOrder,u=o.tail;if(Qt(e,t,o.children,n),o=Ut.current,(o&2)!==0)o=o&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Zf(e,n,t);else if(e.tag===19)Zf(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}switch(K(Ut,o),c){case"forwards":for(n=t.child,c=null;n!==null;)e=n.alternate,e!==null&&Zs(e)===null&&(c=n),n=n.sibling;n=c,n===null?(c=t.child,t.child=null):(c=n.sibling,n.sibling=null),cc(t,!1,c,n,u);break;case"backwards":for(n=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Zs(e)===null){t.child=c;break}e=c.sibling,c.sibling=n,n=c,c=e}cc(t,!0,n,null,u);break;case"together":cc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ia(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Na|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(vo(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(i(153));if(t.child!==null){for(e=t.child,n=ta(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ta(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function dc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&zs(e)))}function ay(e,t,n){switch(t.tag){case 3:Ce(t,t.stateNode.containerInfo),Sa(t,Lt,e.memoizedState.cache),xo();break;case 27:case 5:_e(t);break;case 4:Ce(t,t.stateNode.containerInfo);break;case 10:Sa(t,t.type,t.memoizedProps.value);break;case 13:var o=t.memoizedState;if(o!==null)return o.dehydrated!==null?(Ta(t),t.flags|=128,null):(n&t.child.childLanes)!==0?Qf(e,t,n):(Ta(t),e=ia(e,t,n),e!==null?e.sibling:null);Ta(t);break;case 19:var c=(e.flags&128)!==0;if(o=(n&t.childLanes)!==0,o||(vo(e,t,n,!1),o=(n&t.childLanes)!==0),c){if(o)return Kf(e,t,n);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),K(Ut,Ut.current),o)break;return null;case 22:case 23:return t.lanes=0,Pf(e,t,n);case 24:Sa(t,Lt,e.memoizedState.cache)}return ia(e,t,n)}function Jf(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Gt=!0;else{if(!dc(e,n)&&(t.flags&128)===0)return Gt=!1,ay(e,t,n);Gt=(e.flags&131072)!==0}else Gt=!1,at&&(t.flags&1048576)!==0&&ku(t,Ms,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var o=t.elementType,c=o._init;if(o=c(o._payload),t.type=o,typeof o=="function")bi(o)?(e=ar(o,e),t.tag=1,t=Vf(null,t,o,e,n)):(t.tag=0,t=ac(null,t,o,e,n));else{if(o!=null){if(c=o.$$typeof,c===L){t.tag=11,t=qf(null,t,o,e,n);break e}else if(c===H){t.tag=14,t=Ff(null,t,o,e,n);break e}}throw t=G(o)||o,Error(i(306,t,""))}}return t;case 0:return ac(e,t,t.type,t.pendingProps,n);case 1:return o=t.type,c=ar(o,t.pendingProps),Vf(e,t,o,c,n);case 3:e:{if(Ce(t,t.stateNode.containerInfo),e===null)throw Error(i(387));o=t.pendingProps;var u=t.memoizedState;c=u.element,Oi(e,t),Eo(t,o,null,n);var x=t.memoizedState;if(o=x.cache,Sa(t,Lt,o),o!==u.cache&&Ei(t,[Lt],n,!0),To(),o=x.element,u.isDehydrated)if(u={element:o,isDehydrated:!1,cache:x.cache},t.updateQueue.baseState=u,t.memoizedState=u,t.flags&256){t=Wf(e,t,o,n);break e}else if(o!==c){c=kn(Error(i(424)),t),bo(c),t=Wf(e,t,o,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(At=In(e.firstChild),rn=t,at=!0,Za=null,Gn=!0,n=Rf(t,null,o,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(xo(),o===c){t=ia(e,t,n);break e}Qt(e,t,o,n)}t=t.child}return t;case 26:return el(e,t),e===null?(n=ap(t.type,null,t.pendingProps,null))?t.memoizedState=n:at||(n=t.type,e=t.pendingProps,o=hl(ue.current).createElement(n),o[Je]=t,o[Ne]=e,Kt(o,n,e),ye(o),t.stateNode=o):t.memoizedState=ap(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return _e(t),e===null&&at&&(o=t.stateNode=ep(t.type,t.pendingProps,ue.current),rn=t,Gn=!0,c=At,$a(t.type)?(Gc=c,At=In(o.firstChild)):At=c),Qt(e,t,t.pendingProps.children,n),el(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&at&&((c=o=At)&&(o=Ry(o,t.type,t.pendingProps,Gn),o!==null?(t.stateNode=o,rn=t,At=In(o.firstChild),Gn=!1,c=!0):c=!1),c||Ka(t)),_e(t),c=t.type,u=t.pendingProps,x=e!==null?e.memoizedProps:null,o=u.children,Ic(c,u)?o=null:x!==null&&Ic(c,x)&&(t.flags|=32),t.memoizedState!==null&&(c=Bi(e,t,Wm,null,null,n),Wo._currentValue=c),el(e,t),Qt(e,t,o,n),t.child;case 6:return e===null&&at&&((e=n=At)&&(n=Ny(n,t.pendingProps,Gn),n!==null?(t.stateNode=n,rn=t,At=null,e=!0):e=!1),e||Ka(t)),null;case 13:return Qf(e,t,n);case 4:return Ce(t,t.stateNode.containerInfo),o=t.pendingProps,e===null?t.child=zr(t,null,o,n):Qt(e,t,o,n),t.child;case 11:return qf(e,t,t.type,t.pendingProps,n);case 7:return Qt(e,t,t.pendingProps,n),t.child;case 8:return Qt(e,t,t.pendingProps.children,n),t.child;case 12:return Qt(e,t,t.pendingProps.children,n),t.child;case 10:return o=t.pendingProps,Sa(t,t.type,o.value),Qt(e,t,o.children,n),t.child;case 9:return c=t.type._context,o=t.pendingProps.children,er(t),c=nn(c),o=o(c),t.flags|=1,Qt(e,t,o,n),t.child;case 14:return Ff(e,t,t.type,t.pendingProps,n);case 15:return Gf(e,t,t.type,t.pendingProps,n);case 19:return Kf(e,t,n);case 31:return o=t.pendingProps,n=t.mode,o={mode:o.mode,children:o.children},e===null?(n=tl(o,n),n.ref=t.ref,t.child=n,n.return=t,t=n):(n=ta(e.child,o),n.ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Pf(e,t,n);case 24:return er(t),o=nn(Lt),e===null?(c=Di(),c===null&&(c=mt,u=ki(),c.pooledCache=u,u.refCount++,u!==null&&(c.pooledCacheLanes|=n),c=u),t.memoizedState={parent:o,cache:c},Ni(t),Sa(t,Lt,c)):((e.lanes&n)!==0&&(Oi(e,t),Eo(t,null,null,n),To()),c=e.memoizedState,u=t.memoizedState,c.parent!==o?(c={parent:o,cache:o},t.memoizedState=c,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=c),Sa(t,Lt,o)):(o=u.cache,Sa(t,Lt,o),o!==c.cache&&Ei(t,[Lt],n,!0))),Qt(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function ca(e){e.flags|=4}function eg(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!ip(t)){if(t=Nn.current,t!==null&&((Ze&4194048)===Ze?Pn!==null:(Ze&62914560)!==Ze&&(Ze&536870912)===0||t!==Pn))throw jo=Ri,$u;e.flags|=8192}}function nl(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Kn():536870912,e.lanes|=t,Br|=t)}function Mo(e,t){if(!at)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function jt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,o=0;if(t)for(var c=e.child;c!==null;)n|=c.lanes|c.childLanes,o|=c.subtreeFlags&65011712,o|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)n|=c.lanes|c.childLanes,o|=c.subtreeFlags,o|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=o,e.childLanes=n,t}function ry(e,t,n){var o=t.pendingProps;switch(Ci(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jt(t),null;case 1:return jt(t),null;case 3:return n=t.stateNode,o=null,e!==null&&(o=e.memoizedState.cache),t.memoizedState.cache!==o&&(t.flags|=2048),oa(Lt),Te(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(yo(t)?ca(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Ru())),jt(t),null;case 26:return n=t.memoizedState,e===null?(ca(t),n!==null?(jt(t),eg(t,n)):(jt(t),t.flags&=-16777217)):n?n!==e.memoizedState?(ca(t),jt(t),eg(t,n)):(jt(t),t.flags&=-16777217):(e.memoizedProps!==o&&ca(t),jt(t),t.flags&=-16777217),null;case 27:Pe(t),n=ue.current;var c=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==o&&ca(t);else{if(!o){if(t.stateNode===null)throw Error(i(166));return jt(t),null}e=ae.current,yo(t)?Au(t):(e=ep(c,o,n),t.stateNode=e,ca(t))}return jt(t),null;case 5:if(Pe(t),n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==o&&ca(t);else{if(!o){if(t.stateNode===null)throw Error(i(166));return jt(t),null}if(e=ae.current,yo(t))Au(t);else{switch(c=hl(ue.current),e){case 1:e=c.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=c.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=c.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=c.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":e=c.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof o.is=="string"?c.createElement("select",{is:o.is}):c.createElement("select"),o.multiple?e.multiple=!0:o.size&&(e.size=o.size);break;default:e=typeof o.is=="string"?c.createElement(n,{is:o.is}):c.createElement(n)}}e[Je]=t,e[Ne]=o;e:for(c=t.child;c!==null;){if(c.tag===5||c.tag===6)e.appendChild(c.stateNode);else if(c.tag!==4&&c.tag!==27&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===t)break e;for(;c.sibling===null;){if(c.return===null||c.return===t)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}t.stateNode=e;e:switch(Kt(e,n,o),n){case"button":case"input":case"select":case"textarea":e=!!o.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&ca(t)}}return jt(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==o&&ca(t);else{if(typeof o!="string"&&t.stateNode===null)throw Error(i(166));if(e=ue.current,yo(t)){if(e=t.stateNode,n=t.memoizedProps,o=null,c=rn,c!==null)switch(c.tag){case 27:case 5:o=c.memoizedProps}e[Je]=t,e=!!(e.nodeValue===n||o!==null&&o.suppressHydrationWarning===!0||Xg(e.nodeValue,n)),e||Ka(t)}else e=hl(e).createTextNode(o),e[Je]=t,t.stateNode=e}return jt(t),null;case 13:if(o=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=yo(t),o!==null&&o.dehydrated!==null){if(e===null){if(!c)throw Error(i(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(i(317));c[Je]=t}else xo(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;jt(t),c=!1}else c=Ru(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return t.flags&256?(la(t),t):(la(t),null)}if(la(t),(t.flags&128)!==0)return t.lanes=n,t;if(n=o!==null,e=e!==null&&e.memoizedState!==null,n){o=t.child,c=null,o.alternate!==null&&o.alternate.memoizedState!==null&&o.alternate.memoizedState.cachePool!==null&&(c=o.alternate.memoizedState.cachePool.pool);var u=null;o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(u=o.memoizedState.cachePool.pool),u!==c&&(o.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),nl(t,t.updateQueue),jt(t),null;case 4:return Te(),e===null&&zc(t.stateNode.containerInfo),jt(t),null;case 10:return oa(t.type),jt(t),null;case 19:if(te(Ut),c=t.memoizedState,c===null)return jt(t),null;if(o=(t.flags&128)!==0,u=c.rendering,u===null)if(o)Mo(c,!1);else{if(Dt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(u=Zs(e),u!==null){for(t.flags|=128,Mo(c,!1),e=u.updateQueue,t.updateQueue=e,nl(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)Eu(n,e),n=n.sibling;return K(Ut,Ut.current&1|2),t.child}e=e.sibling}c.tail!==null&&Rt()>ol&&(t.flags|=128,o=!0,Mo(c,!1),t.lanes=4194304)}else{if(!o)if(e=Zs(u),e!==null){if(t.flags|=128,o=!0,e=e.updateQueue,t.updateQueue=e,nl(t,e),Mo(c,!0),c.tail===null&&c.tailMode==="hidden"&&!u.alternate&&!at)return jt(t),null}else 2*Rt()-c.renderingStartTime>ol&&n!==536870912&&(t.flags|=128,o=!0,Mo(c,!1),t.lanes=4194304);c.isBackwards?(u.sibling=t.child,t.child=u):(e=c.last,e!==null?e.sibling=u:t.child=u,c.last=u)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=Rt(),t.sibling=null,e=Ut.current,K(Ut,o?e&1|2:e&1),t):(jt(t),null);case 22:case 23:return la(t),Li(),o=t.memoizedState!==null,e!==null?e.memoizedState!==null!==o&&(t.flags|=8192):o&&(t.flags|=8192),o?(n&536870912)!==0&&(t.flags&128)===0&&(jt(t),t.subtreeFlags&6&&(t.flags|=8192)):jt(t),n=t.updateQueue,n!==null&&nl(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),o=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),o!==n&&(t.flags|=2048),e!==null&&te(tr),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),oa(Lt),jt(t),null;case 25:return null;case 30:return null}throw Error(i(156,t.tag))}function oy(e,t){switch(Ci(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return oa(Lt),Te(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Pe(t),null;case 13:if(la(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(i(340));xo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return te(Ut),null;case 4:return Te(),null;case 10:return oa(t.type),null;case 22:case 23:return la(t),Li(),e!==null&&te(tr),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return oa(Lt),null;case 25:return null;default:return null}}function tg(e,t){switch(Ci(t),t.tag){case 3:oa(Lt),Te();break;case 26:case 27:case 5:Pe(t);break;case 4:Te();break;case 13:la(t);break;case 19:te(Ut);break;case 10:oa(t.type);break;case 22:case 23:la(t),Li(),e!==null&&te(tr);break;case 24:oa(Lt)}}function zo(e,t){try{var n=t.updateQueue,o=n!==null?n.lastEffect:null;if(o!==null){var c=o.next;n=c;do{if((n.tag&e)===e){o=void 0;var u=n.create,x=n.inst;o=u(),x.destroy=o}n=n.next}while(n!==c)}}catch(w){gt(t,t.return,w)}}function ka(e,t,n){try{var o=t.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var u=c.next;o=u;do{if((o.tag&e)===e){var x=o.inst,w=x.destroy;if(w!==void 0){x.destroy=void 0,c=t;var z=n,Z=w;try{Z()}catch(le){gt(c,z,le)}}}o=o.next}while(o!==u)}}catch(le){gt(t,t.return,le)}}function ng(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{qu(t,n)}catch(o){gt(e,e.return,o)}}}function ag(e,t,n){n.props=ar(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(o){gt(e,t,o)}}function $o(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var o=e.stateNode;break;case 30:o=e.stateNode;break;default:o=e.stateNode}typeof n=="function"?e.refCleanup=n(o):n.current=o}}catch(c){gt(e,t,c)}}function Yn(e,t){var n=e.ref,o=e.refCleanup;if(n!==null)if(typeof o=="function")try{o()}catch(c){gt(e,t,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(c){gt(e,t,c)}else n.current=null}function rg(e){var t=e.type,n=e.memoizedProps,o=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&o.focus();break e;case"img":n.src?o.src=n.src:n.srcSet&&(o.srcset=n.srcSet)}}catch(c){gt(e,e.return,c)}}function uc(e,t,n){try{var o=e.stateNode;Ty(o,e.type,n,t),o[Ne]=t}catch(c){gt(e,e.return,c)}}function og(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&$a(e.type)||e.tag===4}function fc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||og(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&$a(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function gc(e,t,n){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=pl));else if(o!==4&&(o===27&&$a(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(gc(e,t,n),e=e.sibling;e!==null;)gc(e,t,n),e=e.sibling}function al(e,t,n){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(o!==4&&(o===27&&$a(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(al(e,t,n),e=e.sibling;e!==null;)al(e,t,n),e=e.sibling}function sg(e){var t=e.stateNode,n=e.memoizedProps;try{for(var o=e.type,c=t.attributes;c.length;)t.removeAttributeNode(c[0]);Kt(t,o,n),t[Je]=e,t[Ne]=n}catch(u){gt(e,e.return,u)}}var da=!1,Mt=!1,pc=!1,lg=typeof WeakSet=="function"?WeakSet:Set,Pt=null;function sy(e,t){if(e=e.containerInfo,Uc=Sl,e=yu(e),fi(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var o=n.getSelection&&n.getSelection();if(o&&o.rangeCount!==0){n=o.anchorNode;var c=o.anchorOffset,u=o.focusNode;o=o.focusOffset;try{n.nodeType,u.nodeType}catch{n=null;break e}var x=0,w=-1,z=-1,Z=0,le=0,de=e,J=null;t:for(;;){for(var ne;de!==n||c!==0&&de.nodeType!==3||(w=x+c),de!==u||o!==0&&de.nodeType!==3||(z=x+o),de.nodeType===3&&(x+=de.nodeValue.length),(ne=de.firstChild)!==null;)J=de,de=ne;for(;;){if(de===e)break t;if(J===n&&++Z===c&&(w=x),J===u&&++le===o&&(z=x),(ne=de.nextSibling)!==null)break;de=J,J=de.parentNode}de=ne}n=w===-1||z===-1?null:{start:w,end:z}}else n=null}n=n||{start:0,end:0}}else n=null;for(Bc={focusedElem:e,selectionRange:n},Sl=!1,Pt=t;Pt!==null;)if(t=Pt,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,Pt=e;else for(;Pt!==null;){switch(t=Pt,u=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&u!==null){e=void 0,n=t,c=u.memoizedProps,u=u.memoizedState,o=n.stateNode;try{var Le=ar(n.type,c,n.elementType===n.type);e=o.getSnapshotBeforeUpdate(Le,u),o.__reactInternalSnapshotBeforeUpdate=e}catch(Me){gt(n,n.return,Me)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)qc(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":qc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(i(163))}if(e=t.sibling,e!==null){e.return=t.return,Pt=e;break}Pt=t.return}}function ig(e,t,n){var o=n.flags;switch(n.tag){case 0:case 11:case 15:Aa(e,n),o&4&&zo(5,n);break;case 1:if(Aa(e,n),o&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(x){gt(n,n.return,x)}else{var c=ar(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(c,t,e.__reactInternalSnapshotBeforeUpdate)}catch(x){gt(n,n.return,x)}}o&64&&ng(n),o&512&&$o(n,n.return);break;case 3:if(Aa(e,n),o&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{qu(e,t)}catch(x){gt(n,n.return,x)}}break;case 27:t===null&&o&4&&sg(n);case 26:case 5:Aa(e,n),t===null&&o&4&&rg(n),o&512&&$o(n,n.return);break;case 12:Aa(e,n);break;case 13:Aa(e,n),o&4&&ug(e,n),o&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=hy.bind(null,n),Oy(e,n))));break;case 22:if(o=n.memoizedState!==null||da,!o){t=t!==null&&t.memoizedState!==null||Mt,c=da;var u=Mt;da=o,(Mt=t)&&!u?Da(e,n,(n.subtreeFlags&8772)!==0):Aa(e,n),da=c,Mt=u}break;case 30:break;default:Aa(e,n)}}function cg(e){var t=e.alternate;t!==null&&(e.alternate=null,cg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&$e(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var bt=null,dn=!1;function ua(e,t,n){for(n=n.child;n!==null;)dg(e,t,n),n=n.sibling}function dg(e,t,n){if(it&&typeof it.onCommitFiberUnmount=="function")try{it.onCommitFiberUnmount(tn,n)}catch{}switch(n.tag){case 26:Mt||Yn(n,t),ua(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Mt||Yn(n,t);var o=bt,c=dn;$a(n.type)&&(bt=n.stateNode,dn=!1),ua(e,t,n),Po(n.stateNode),bt=o,dn=c;break;case 5:Mt||Yn(n,t);case 6:if(o=bt,c=dn,bt=null,ua(e,t,n),bt=o,dn=c,bt!==null)if(dn)try{(bt.nodeType===9?bt.body:bt.nodeName==="HTML"?bt.ownerDocument.body:bt).removeChild(n.stateNode)}catch(u){gt(n,t,u)}else try{bt.removeChild(n.stateNode)}catch(u){gt(n,t,u)}break;case 18:bt!==null&&(dn?(e=bt,Kg(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Jo(e)):Kg(bt,n.stateNode));break;case 4:o=bt,c=dn,bt=n.stateNode.containerInfo,dn=!0,ua(e,t,n),bt=o,dn=c;break;case 0:case 11:case 14:case 15:Mt||ka(2,n,t),Mt||ka(4,n,t),ua(e,t,n);break;case 1:Mt||(Yn(n,t),o=n.stateNode,typeof o.componentWillUnmount=="function"&&ag(n,t,o)),ua(e,t,n);break;case 21:ua(e,t,n);break;case 22:Mt=(o=Mt)||n.memoizedState!==null,ua(e,t,n),Mt=o;break;default:ua(e,t,n)}}function ug(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Jo(e)}catch(n){gt(t,t.return,n)}}function ly(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new lg),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new lg),t;default:throw Error(i(435,e.tag))}}function hc(e,t){var n=ly(e);t.forEach(function(o){var c=my.bind(null,e,o);n.has(o)||(n.add(o),o.then(c,c))})}function yn(e,t){var n=t.deletions;if(n!==null)for(var o=0;o<n.length;o++){var c=n[o],u=e,x=t,w=x;e:for(;w!==null;){switch(w.tag){case 27:if($a(w.type)){bt=w.stateNode,dn=!1;break e}break;case 5:bt=w.stateNode,dn=!1;break e;case 3:case 4:bt=w.stateNode.containerInfo,dn=!0;break e}w=w.return}if(bt===null)throw Error(i(160));dg(u,x,c),bt=null,dn=!1,u=c.alternate,u!==null&&(u.return=null),c.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)fg(t,e),t=t.sibling}var Bn=null;function fg(e,t){var n=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:yn(t,e),xn(e),o&4&&(ka(3,e,e.return),zo(3,e),ka(5,e,e.return));break;case 1:yn(t,e),xn(e),o&512&&(Mt||n===null||Yn(n,n.return)),o&64&&da&&(e=e.updateQueue,e!==null&&(o=e.callbacks,o!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?o:n.concat(o))));break;case 26:var c=Bn;if(yn(t,e),xn(e),o&512&&(Mt||n===null||Yn(n,n.return)),o&4){var u=n!==null?n.memoizedState:null;if(o=e.memoizedState,n===null)if(o===null)if(e.stateNode===null){e:{o=e.type,n=e.memoizedProps,c=c.ownerDocument||c;t:switch(o){case"title":u=c.getElementsByTagName("title")[0],(!u||u[ve]||u[Je]||u.namespaceURI==="http://www.w3.org/2000/svg"||u.hasAttribute("itemprop"))&&(u=c.createElement(o),c.head.insertBefore(u,c.querySelector("head > title"))),Kt(u,o,n),u[Je]=e,ye(u),o=u;break e;case"link":var x=sp("link","href",c).get(o+(n.href||""));if(x){for(var w=0;w<x.length;w++)if(u=x[w],u.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&u.getAttribute("rel")===(n.rel==null?null:n.rel)&&u.getAttribute("title")===(n.title==null?null:n.title)&&u.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){x.splice(w,1);break t}}u=c.createElement(o),Kt(u,o,n),c.head.appendChild(u);break;case"meta":if(x=sp("meta","content",c).get(o+(n.content||""))){for(w=0;w<x.length;w++)if(u=x[w],u.getAttribute("content")===(n.content==null?null:""+n.content)&&u.getAttribute("name")===(n.name==null?null:n.name)&&u.getAttribute("property")===(n.property==null?null:n.property)&&u.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&u.getAttribute("charset")===(n.charSet==null?null:n.charSet)){x.splice(w,1);break t}}u=c.createElement(o),Kt(u,o,n),c.head.appendChild(u);break;default:throw Error(i(468,o))}u[Je]=e,ye(u),o=u}e.stateNode=o}else lp(c,e.type,e.stateNode);else e.stateNode=op(c,o,e.memoizedProps);else u!==o?(u===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):u.count--,o===null?lp(c,e.type,e.stateNode):op(c,o,e.memoizedProps)):o===null&&e.stateNode!==null&&uc(e,e.memoizedProps,n.memoizedProps)}break;case 27:yn(t,e),xn(e),o&512&&(Mt||n===null||Yn(n,n.return)),n!==null&&o&4&&uc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(yn(t,e),xn(e),o&512&&(Mt||n===null||Yn(n,n.return)),e.flags&32){c=e.stateNode;try{yr(c,"")}catch(ne){gt(e,e.return,ne)}}o&4&&e.stateNode!=null&&(c=e.memoizedProps,uc(e,c,n!==null?n.memoizedProps:c)),o&1024&&(pc=!0);break;case 6:if(yn(t,e),xn(e),o&4){if(e.stateNode===null)throw Error(i(162));o=e.memoizedProps,n=e.stateNode;try{n.nodeValue=o}catch(ne){gt(e,e.return,ne)}}break;case 3:if(xl=null,c=Bn,Bn=ml(t.containerInfo),yn(t,e),Bn=c,xn(e),o&4&&n!==null&&n.memoizedState.isDehydrated)try{Jo(t.containerInfo)}catch(ne){gt(e,e.return,ne)}pc&&(pc=!1,gg(e));break;case 4:o=Bn,Bn=ml(e.stateNode.containerInfo),yn(t,e),xn(e),Bn=o;break;case 12:yn(t,e),xn(e);break;case 13:yn(t,e),xn(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(Sc=Rt()),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,hc(e,o)));break;case 22:c=e.memoizedState!==null;var z=n!==null&&n.memoizedState!==null,Z=da,le=Mt;if(da=Z||c,Mt=le||z,yn(t,e),Mt=le,da=Z,xn(e),o&8192)e:for(t=e.stateNode,t._visibility=c?t._visibility&-2:t._visibility|1,c&&(n===null||z||da||Mt||rr(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){z=n=t;try{if(u=z.stateNode,c)x=u.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{w=z.stateNode;var de=z.memoizedProps.style,J=de!=null&&de.hasOwnProperty("display")?de.display:null;w.style.display=J==null||typeof J=="boolean"?"":(""+J).trim()}}catch(ne){gt(z,z.return,ne)}}}else if(t.tag===6){if(n===null){z=t;try{z.stateNode.nodeValue=c?"":z.memoizedProps}catch(ne){gt(z,z.return,ne)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}o&4&&(o=e.updateQueue,o!==null&&(n=o.retryQueue,n!==null&&(o.retryQueue=null,hc(e,n))));break;case 19:yn(t,e),xn(e),o&4&&(o=e.updateQueue,o!==null&&(e.updateQueue=null,hc(e,o)));break;case 30:break;case 21:break;default:yn(t,e),xn(e)}}function xn(e){var t=e.flags;if(t&2){try{for(var n,o=e.return;o!==null;){if(og(o)){n=o;break}o=o.return}if(n==null)throw Error(i(160));switch(n.tag){case 27:var c=n.stateNode,u=fc(e);al(e,u,c);break;case 5:var x=n.stateNode;n.flags&32&&(yr(x,""),n.flags&=-33);var w=fc(e);al(e,w,x);break;case 3:case 4:var z=n.stateNode.containerInfo,Z=fc(e);gc(e,Z,z);break;default:throw Error(i(161))}}catch(le){gt(e,e.return,le)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function gg(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;gg(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Aa(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)ig(e,t.alternate,t),t=t.sibling}function rr(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ka(4,t,t.return),rr(t);break;case 1:Yn(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&ag(t,t.return,n),rr(t);break;case 27:Po(t.stateNode);case 26:case 5:Yn(t,t.return),rr(t);break;case 22:t.memoizedState===null&&rr(t);break;case 30:rr(t);break;default:rr(t)}e=e.sibling}}function Da(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var o=t.alternate,c=e,u=t,x=u.flags;switch(u.tag){case 0:case 11:case 15:Da(c,u,n),zo(4,u);break;case 1:if(Da(c,u,n),o=u,c=o.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch(Z){gt(o,o.return,Z)}if(o=u,c=o.updateQueue,c!==null){var w=o.stateNode;try{var z=c.shared.hiddenCallbacks;if(z!==null)for(c.shared.hiddenCallbacks=null,c=0;c<z.length;c++)Hu(z[c],w)}catch(Z){gt(o,o.return,Z)}}n&&x&64&&ng(u),$o(u,u.return);break;case 27:sg(u);case 26:case 5:Da(c,u,n),n&&o===null&&x&4&&rg(u),$o(u,u.return);break;case 12:Da(c,u,n);break;case 13:Da(c,u,n),n&&x&4&&ug(c,u);break;case 22:u.memoizedState===null&&Da(c,u,n),$o(u,u.return);break;case 30:break;default:Da(c,u,n)}t=t.sibling}}function mc(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&So(n))}function yc(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&So(e))}function Xn(e,t,n,o){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)pg(e,t,n,o),t=t.sibling}function pg(e,t,n,o){var c=t.flags;switch(t.tag){case 0:case 11:case 15:Xn(e,t,n,o),c&2048&&zo(9,t);break;case 1:Xn(e,t,n,o);break;case 3:Xn(e,t,n,o),c&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&So(e)));break;case 12:if(c&2048){Xn(e,t,n,o),e=t.stateNode;try{var u=t.memoizedProps,x=u.id,w=u.onPostCommit;typeof w=="function"&&w(x,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(z){gt(t,t.return,z)}}else Xn(e,t,n,o);break;case 13:Xn(e,t,n,o);break;case 23:break;case 22:u=t.stateNode,x=t.alternate,t.memoizedState!==null?u._visibility&2?Xn(e,t,n,o):Lo(e,t):u._visibility&2?Xn(e,t,n,o):(u._visibility|=2,$r(e,t,n,o,(t.subtreeFlags&10256)!==0)),c&2048&&mc(x,t);break;case 24:Xn(e,t,n,o),c&2048&&yc(t.alternate,t);break;default:Xn(e,t,n,o)}}function $r(e,t,n,o,c){for(c=c&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var u=e,x=t,w=n,z=o,Z=x.flags;switch(x.tag){case 0:case 11:case 15:$r(u,x,w,z,c),zo(8,x);break;case 23:break;case 22:var le=x.stateNode;x.memoizedState!==null?le._visibility&2?$r(u,x,w,z,c):Lo(u,x):(le._visibility|=2,$r(u,x,w,z,c)),c&&Z&2048&&mc(x.alternate,x);break;case 24:$r(u,x,w,z,c),c&&Z&2048&&yc(x.alternate,x);break;default:$r(u,x,w,z,c)}t=t.sibling}}function Lo(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,o=t,c=o.flags;switch(o.tag){case 22:Lo(n,o),c&2048&&mc(o.alternate,o);break;case 24:Lo(n,o),c&2048&&yc(o.alternate,o);break;default:Lo(n,o)}t=t.sibling}}var Uo=8192;function Lr(e){if(e.subtreeFlags&Uo)for(e=e.child;e!==null;)hg(e),e=e.sibling}function hg(e){switch(e.tag){case 26:Lr(e),e.flags&Uo&&e.memoizedState!==null&&Yy(Bn,e.memoizedState,e.memoizedProps);break;case 5:Lr(e);break;case 3:case 4:var t=Bn;Bn=ml(e.stateNode.containerInfo),Lr(e),Bn=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=Uo,Uo=16777216,Lr(e),Uo=t):Lr(e));break;default:Lr(e)}}function mg(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Bo(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var o=t[n];Pt=o,xg(o,e)}mg(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)yg(e),e=e.sibling}function yg(e){switch(e.tag){case 0:case 11:case 15:Bo(e),e.flags&2048&&ka(9,e,e.return);break;case 3:Bo(e);break;case 12:Bo(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,rl(e)):Bo(e);break;default:Bo(e)}}function rl(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var o=t[n];Pt=o,xg(o,e)}mg(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:ka(8,t,t.return),rl(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,rl(t));break;default:rl(t)}e=e.sibling}}function xg(e,t){for(;Pt!==null;){var n=Pt;switch(n.tag){case 0:case 11:case 15:ka(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var o=n.memoizedState.cachePool.pool;o!=null&&o.refCount++}break;case 24:So(n.memoizedState.cache)}if(o=n.child,o!==null)o.return=n,Pt=o;else e:for(n=e;Pt!==null;){o=Pt;var c=o.sibling,u=o.return;if(cg(o),o===n){Pt=null;break e}if(c!==null){c.return=u,Pt=c;break e}Pt=u}}}var iy={getCacheForType:function(e){var t=nn(Lt),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n}},cy=typeof WeakMap=="function"?WeakMap:Map,st=0,mt=null,Ye=null,Ze=0,lt=0,bn=null,Ra=!1,Ur=!1,xc=!1,fa=0,Dt=0,Na=0,or=0,bc=0,On=0,Br=0,Io=null,un=null,vc=!1,Sc=0,ol=1/0,sl=null,Oa=null,Zt=0,Ma=null,Ir=null,Hr=0,wc=0,Cc=null,bg=null,Ho=0,jc=null;function vn(){if((st&2)!==0&&Ze!==0)return Ze&-Ze;if(R.T!==null){var e=kr;return e!==0?e:Rc()}return Be()}function vg(){On===0&&(On=(Ze&536870912)===0||at?Fa():536870912);var e=Nn.current;return e!==null&&(e.flags|=32),On}function Sn(e,t,n){(e===mt&&(lt===2||lt===9)||e.cancelPendingCommit!==null)&&(qr(e,0),za(e,Ze,On,!1)),ot(e,n),((st&2)===0||e!==mt)&&(e===mt&&((st&2)===0&&(or|=n),Dt===4&&za(e,Ze,On,!1)),Vn(e))}function Sg(e,t,n){if((st&6)!==0)throw Error(i(327));var o=!n&&(t&124)===0&&(t&e.expiredLanes)===0||Tn(e,t),c=o?fy(e,t):Ec(e,t,!0),u=o;do{if(c===0){Ur&&!o&&za(e,t,0,!1);break}else{if(n=e.current.alternate,u&&!dy(n)){c=Ec(e,t,!1),u=!1;continue}if(c===2){if(u=t,e.errorRecoveryDisabledLanes&u)var x=0;else x=e.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){t=x;e:{var w=e;c=Io;var z=w.current.memoizedState.isDehydrated;if(z&&(qr(w,x).flags|=256),x=Ec(w,x,!1),x!==2){if(xc&&!z){w.errorRecoveryDisabledLanes|=u,or|=u,c=4;break e}u=un,un=c,u!==null&&(un===null?un=u:un.push.apply(un,u))}c=x}if(u=!1,c!==2)continue}}if(c===1){qr(e,0),za(e,t,0,!0);break}e:{switch(o=e,u=c,u){case 0:case 1:throw Error(i(345));case 4:if((t&4194048)!==t)break;case 6:za(o,t,On,!Ra);break e;case 2:un=null;break;case 3:case 5:break;default:throw Error(i(329))}if((t&62914560)===t&&(c=Sc+300-Rt(),10<c)){if(za(o,t,On,!Ra),Ae(o,0,!0)!==0)break e;o.timeoutHandle=Qg(wg.bind(null,o,n,un,sl,vc,t,On,or,Br,Ra,u,2,-0,0),c);break e}wg(o,n,un,sl,vc,t,On,or,Br,Ra,u,0,-0,0)}}break}while(!0);Vn(e)}function wg(e,t,n,o,c,u,x,w,z,Z,le,de,J,ne){if(e.timeoutHandle=-1,de=t.subtreeFlags,(de&8192||(de&16785408)===16785408)&&(Vo={stylesheets:null,count:0,unsuspend:Py},hg(t),de=Xy(),de!==null)){e.cancelPendingCommit=de(Ag.bind(null,e,t,u,n,o,c,x,w,z,le,1,J,ne)),za(e,u,x,!Z);return}Ag(e,t,u,n,o,c,x,w,z)}function dy(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var o=0;o<n.length;o++){var c=n[o],u=c.getSnapshot;c=c.value;try{if(!hn(u(),c))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function za(e,t,n,o){t&=~bc,t&=~or,e.suspendedLanes|=t,e.pingedLanes&=~t,o&&(e.warmLanes|=t),o=e.expirationTimes;for(var c=t;0<c;){var u=31-yt(c),x=1<<u;o[u]=-1,c&=~x}n!==0&&Et(e,n,t)}function ll(){return(st&6)===0?(qo(0),!1):!0}function _c(){if(Ye!==null){if(lt===0)var e=Ye.return;else e=Ye,ra=Ja=null,qi(e),Mr=null,No=0,e=Ye;for(;e!==null;)tg(e.alternate,e),e=e.return;Ye=null}}function qr(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,ky(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),_c(),mt=e,Ye=n=ta(e.current,null),Ze=t,lt=0,bn=null,Ra=!1,Ur=Tn(e,t),xc=!1,Br=On=bc=or=Na=Dt=0,un=Io=null,vc=!1,(t&8)!==0&&(t|=t&32);var o=e.entangledLanes;if(o!==0)for(e=e.entanglements,o&=t;0<o;){var c=31-yt(o),u=1<<c;t|=e[c],o&=~u}return fa=t,As(),n}function Cg(e,t){Fe=null,R.H=Vs,t===Co||t===Us?(t=Bu(),lt=3):t===$u?(t=Bu(),lt=4):lt=t===Hf?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,bn=t,Ye===null&&(Dt=1,Js(e,kn(t,e.current)))}function jg(){var e=R.H;return R.H=Vs,e===null?Vs:e}function _g(){var e=R.A;return R.A=iy,e}function Tc(){Dt=4,Ra||(Ze&4194048)!==Ze&&Nn.current!==null||(Ur=!0),(Na&134217727)===0&&(or&134217727)===0||mt===null||za(mt,Ze,On,!1)}function Ec(e,t,n){var o=st;st|=2;var c=jg(),u=_g();(mt!==e||Ze!==t)&&(sl=null,qr(e,t)),t=!1;var x=Dt;e:do try{if(lt!==0&&Ye!==null){var w=Ye,z=bn;switch(lt){case 8:_c(),x=6;break e;case 3:case 2:case 9:case 6:Nn.current===null&&(t=!0);var Z=lt;if(lt=0,bn=null,Fr(e,w,z,Z),n&&Ur){x=0;break e}break;default:Z=lt,lt=0,bn=null,Fr(e,w,z,Z)}}uy(),x=Dt;break}catch(le){Cg(e,le)}while(!0);return t&&e.shellSuspendCounter++,ra=Ja=null,st=o,R.H=c,R.A=u,Ye===null&&(mt=null,Ze=0,As()),x}function uy(){for(;Ye!==null;)Tg(Ye)}function fy(e,t){var n=st;st|=2;var o=jg(),c=_g();mt!==e||Ze!==t?(sl=null,ol=Rt()+500,qr(e,t)):Ur=Tn(e,t);e:do try{if(lt!==0&&Ye!==null){t=Ye;var u=bn;t:switch(lt){case 1:lt=0,bn=null,Fr(e,t,u,1);break;case 2:case 9:if(Lu(u)){lt=0,bn=null,Eg(t);break}t=function(){lt!==2&&lt!==9||mt!==e||(lt=7),Vn(e)},u.then(t,t);break e;case 3:lt=7;break e;case 4:lt=5;break e;case 7:Lu(u)?(lt=0,bn=null,Eg(t)):(lt=0,bn=null,Fr(e,t,u,7));break;case 5:var x=null;switch(Ye.tag){case 26:x=Ye.memoizedState;case 5:case 27:var w=Ye;if(!x||ip(x)){lt=0,bn=null;var z=w.sibling;if(z!==null)Ye=z;else{var Z=w.return;Z!==null?(Ye=Z,il(Z)):Ye=null}break t}}lt=0,bn=null,Fr(e,t,u,5);break;case 6:lt=0,bn=null,Fr(e,t,u,6);break;case 8:_c(),Dt=6;break e;default:throw Error(i(462))}}gy();break}catch(le){Cg(e,le)}while(!0);return ra=Ja=null,R.H=o,R.A=c,st=n,Ye!==null?0:(mt=null,Ze=0,As(),Dt)}function gy(){for(;Ye!==null&&!en();)Tg(Ye)}function Tg(e){var t=Jf(e.alternate,e,fa);e.memoizedProps=e.pendingProps,t===null?il(e):Ye=t}function Eg(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Xf(n,t,t.pendingProps,t.type,void 0,Ze);break;case 11:t=Xf(n,t,t.pendingProps,t.type.render,t.ref,Ze);break;case 5:qi(t);default:tg(n,t),t=Ye=Eu(t,fa),t=Jf(n,t,fa)}e.memoizedProps=e.pendingProps,t===null?il(e):Ye=t}function Fr(e,t,n,o){ra=Ja=null,qi(t),Mr=null,No=0;var c=t.return;try{if(ny(e,c,t,n,Ze)){Dt=1,Js(e,kn(n,e.current)),Ye=null;return}}catch(u){if(c!==null)throw Ye=c,u;Dt=1,Js(e,kn(n,e.current)),Ye=null;return}t.flags&32768?(at||o===1?e=!0:Ur||(Ze&536870912)!==0?e=!1:(Ra=e=!0,(o===2||o===9||o===3||o===6)&&(o=Nn.current,o!==null&&o.tag===13&&(o.flags|=16384))),kg(t,e)):il(t)}function il(e){var t=e;do{if((t.flags&32768)!==0){kg(t,Ra);return}e=t.return;var n=ry(t.alternate,t,fa);if(n!==null){Ye=n;return}if(t=t.sibling,t!==null){Ye=t;return}Ye=t=e}while(t!==null);Dt===0&&(Dt=5)}function kg(e,t){do{var n=oy(e.alternate,e);if(n!==null){n.flags&=32767,Ye=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Ye=e;return}Ye=e=n}while(e!==null);Dt=6,Ye=null}function Ag(e,t,n,o,c,u,x,w,z){e.cancelPendingCommit=null;do cl();while(Zt!==0);if((st&6)!==0)throw Error(i(327));if(t!==null){if(t===e.current)throw Error(i(177));if(u=t.lanes|t.childLanes,u|=yi,St(e,n,u,x,w,z),e===mt&&(Ye=mt=null,Ze=0),Ir=t,Ma=e,Hr=n,wc=u,Cc=c,bg=o,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,yy(ht,function(){return Mg(),null})):(e.callbackNode=null,e.callbackPriority=0),o=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||o){o=R.T,R.T=null,c=M.p,M.p=2,x=st,st|=4;try{sy(e,t,n)}finally{st=x,M.p=c,R.T=o}}Zt=1,Dg(),Rg(),Ng()}}function Dg(){if(Zt===1){Zt=0;var e=Ma,t=Ir,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=R.T,R.T=null;var o=M.p;M.p=2;var c=st;st|=4;try{fg(t,e);var u=Bc,x=yu(e.containerInfo),w=u.focusedElem,z=u.selectionRange;if(x!==w&&w&&w.ownerDocument&&mu(w.ownerDocument.documentElement,w)){if(z!==null&&fi(w)){var Z=z.start,le=z.end;if(le===void 0&&(le=Z),"selectionStart"in w)w.selectionStart=Z,w.selectionEnd=Math.min(le,w.value.length);else{var de=w.ownerDocument||document,J=de&&de.defaultView||window;if(J.getSelection){var ne=J.getSelection(),Le=w.textContent.length,Me=Math.min(z.start,Le),ut=z.end===void 0?Me:Math.min(z.end,Le);!ne.extend&&Me>ut&&(x=ut,ut=Me,Me=x);var Y=hu(w,Me),F=hu(w,ut);if(Y&&F&&(ne.rangeCount!==1||ne.anchorNode!==Y.node||ne.anchorOffset!==Y.offset||ne.focusNode!==F.node||ne.focusOffset!==F.offset)){var Q=de.createRange();Q.setStart(Y.node,Y.offset),ne.removeAllRanges(),Me>ut?(ne.addRange(Q),ne.extend(F.node,F.offset)):(Q.setEnd(F.node,F.offset),ne.addRange(Q))}}}}for(de=[],ne=w;ne=ne.parentNode;)ne.nodeType===1&&de.push({element:ne,left:ne.scrollLeft,top:ne.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<de.length;w++){var ie=de[w];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}Sl=!!Uc,Bc=Uc=null}finally{st=c,M.p=o,R.T=n}}e.current=t,Zt=2}}function Rg(){if(Zt===2){Zt=0;var e=Ma,t=Ir,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=R.T,R.T=null;var o=M.p;M.p=2;var c=st;st|=4;try{ig(e,t.alternate,t)}finally{st=c,M.p=o,R.T=n}}Zt=3}}function Ng(){if(Zt===4||Zt===3){Zt=0,It();var e=Ma,t=Ir,n=Hr,o=bg;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Zt=5:(Zt=0,Ir=Ma=null,Og(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(Oa=null),kt(n),t=t.stateNode,it&&typeof it.onCommitFiberRoot=="function")try{it.onCommitFiberRoot(tn,t,void 0,(t.current.flags&128)===128)}catch{}if(o!==null){t=R.T,c=M.p,M.p=2,R.T=null;try{for(var u=e.onRecoverableError,x=0;x<o.length;x++){var w=o[x];u(w.value,{componentStack:w.stack})}}finally{R.T=t,M.p=c}}(Hr&3)!==0&&cl(),Vn(e),c=e.pendingLanes,(n&4194090)!==0&&(c&42)!==0?e===jc?Ho++:(Ho=0,jc=e):Ho=0,qo(0)}}function Og(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,So(t)))}function cl(e){return Dg(),Rg(),Ng(),Mg()}function Mg(){if(Zt!==5)return!1;var e=Ma,t=wc;wc=0;var n=kt(Hr),o=R.T,c=M.p;try{M.p=32>n?32:n,R.T=null,n=Cc,Cc=null;var u=Ma,x=Hr;if(Zt=0,Ir=Ma=null,Hr=0,(st&6)!==0)throw Error(i(331));var w=st;if(st|=4,yg(u.current),pg(u,u.current,x,n),st=w,qo(0,!1),it&&typeof it.onPostCommitFiberRoot=="function")try{it.onPostCommitFiberRoot(tn,u)}catch{}return!0}finally{M.p=c,R.T=o,Og(e,t)}}function zg(e,t,n){t=kn(n,t),t=nc(e.stateNode,t,2),e=ja(e,t,2),e!==null&&(ot(e,2),Vn(e))}function gt(e,t,n){if(e.tag===3)zg(e,e,n);else for(;t!==null;){if(t.tag===3){zg(t,e,n);break}else if(t.tag===1){var o=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Oa===null||!Oa.has(o))){e=kn(n,e),n=Bf(2),o=ja(t,n,2),o!==null&&(If(n,o,t,e),ot(o,2),Vn(o));break}}t=t.return}}function kc(e,t,n){var o=e.pingCache;if(o===null){o=e.pingCache=new cy;var c=new Set;o.set(t,c)}else c=o.get(t),c===void 0&&(c=new Set,o.set(t,c));c.has(n)||(xc=!0,c.add(n),e=py.bind(null,e,t,n),t.then(e,e))}function py(e,t,n){var o=e.pingCache;o!==null&&o.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,mt===e&&(Ze&n)===n&&(Dt===4||Dt===3&&(Ze&62914560)===Ze&&300>Rt()-Sc?(st&2)===0&&qr(e,0):bc|=n,Br===Ze&&(Br=0)),Vn(e)}function $g(e,t){t===0&&(t=Kn()),e=jr(e,t),e!==null&&(ot(e,t),Vn(e))}function hy(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),$g(e,n)}function my(e,t){var n=0;switch(e.tag){case 13:var o=e.stateNode,c=e.memoizedState;c!==null&&(n=c.retryLane);break;case 19:o=e.stateNode;break;case 22:o=e.stateNode._retryCache;break;default:throw Error(i(314))}o!==null&&o.delete(t),$g(e,n)}function yy(e,t){return nt(e,t)}var dl=null,Gr=null,Ac=!1,ul=!1,Dc=!1,sr=0;function Vn(e){e!==Gr&&e.next===null&&(Gr===null?dl=Gr=e:Gr=Gr.next=e),ul=!0,Ac||(Ac=!0,by())}function qo(e,t){if(!Dc&&ul){Dc=!0;do for(var n=!1,o=dl;o!==null;){if(e!==0){var c=o.pendingLanes;if(c===0)var u=0;else{var x=o.suspendedLanes,w=o.pingedLanes;u=(1<<31-yt(42|e)+1)-1,u&=c&~(x&~w),u=u&201326741?u&201326741|1:u?u|2:0}u!==0&&(n=!0,Ig(o,u))}else u=Ze,u=Ae(o,o===mt?u:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),(u&3)===0||Tn(o,u)||(n=!0,Ig(o,u));o=o.next}while(n);Dc=!1}}function xy(){Lg()}function Lg(){ul=Ac=!1;var e=0;sr!==0&&(Ey()&&(e=sr),sr=0);for(var t=Rt(),n=null,o=dl;o!==null;){var c=o.next,u=Ug(o,t);u===0?(o.next=null,n===null?dl=c:n.next=c,c===null&&(Gr=n)):(n=o,(e!==0||(u&3)!==0)&&(ul=!0)),o=c}qo(e)}function Ug(e,t){for(var n=e.suspendedLanes,o=e.pingedLanes,c=e.expirationTimes,u=e.pendingLanes&-62914561;0<u;){var x=31-yt(u),w=1<<x,z=c[x];z===-1?((w&n)===0||(w&o)!==0)&&(c[x]=xa(w,t)):z<=t&&(e.expiredLanes|=w),u&=~w}if(t=mt,n=Ze,n=Ae(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o=e.callbackNode,n===0||e===t&&(lt===2||lt===9)||e.cancelPendingCommit!==null)return o!==null&&o!==null&&_t(o),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||Tn(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(o!==null&&_t(o),kt(n)){case 2:case 8:n=pt;break;case 32:n=ht;break;case 268435456:n=sn;break;default:n=ht}return o=Bg.bind(null,e),n=nt(n,o),e.callbackPriority=t,e.callbackNode=n,t}return o!==null&&o!==null&&_t(o),e.callbackPriority=2,e.callbackNode=null,2}function Bg(e,t){if(Zt!==0&&Zt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(cl()&&e.callbackNode!==n)return null;var o=Ze;return o=Ae(e,e===mt?o:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),o===0?null:(Sg(e,o,t),Ug(e,Rt()),e.callbackNode!=null&&e.callbackNode===n?Bg.bind(null,e):null)}function Ig(e,t){if(cl())return null;Sg(e,t,!0)}function by(){Ay(function(){(st&6)!==0?nt(vt,xy):Lg()})}function Rc(){return sr===0&&(sr=Fa()),sr}function Hg(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ws(""+e)}function qg(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function vy(e,t,n,o,c){if(t==="submit"&&n&&n.stateNode===c){var u=Hg((c[Ne]||null).action),x=o.submitter;x&&(t=(t=x[Ne]||null)?Hg(t.formAction):x.getAttribute("formAction"),t!==null&&(u=t,x=null));var w=new Ts("action","action",null,o,c);e.push({event:w,listeners:[{instance:null,listener:function(){if(o.defaultPrevented){if(sr!==0){var z=x?qg(c,x):new FormData(c);Zi(n,{pending:!0,data:z,method:c.method,action:u},null,z)}}else typeof u=="function"&&(w.preventDefault(),z=x?qg(c,x):new FormData(c),Zi(n,{pending:!0,data:z,method:c.method,action:u},u,z))},currentTarget:c}]})}}for(var Nc=0;Nc<mi.length;Nc++){var Oc=mi[Nc],Sy=Oc.toLowerCase(),wy=Oc[0].toUpperCase()+Oc.slice(1);Un(Sy,"on"+wy)}Un(vu,"onAnimationEnd"),Un(Su,"onAnimationIteration"),Un(wu,"onAnimationStart"),Un("dblclick","onDoubleClick"),Un("focusin","onFocus"),Un("focusout","onBlur"),Un(Bm,"onTransitionRun"),Un(Im,"onTransitionStart"),Un(Hm,"onTransitionCancel"),Un(Cu,"onTransitionEnd"),ft("onMouseEnter",["mouseout","mouseover"]),ft("onMouseLeave",["mouseout","mouseover"]),ft("onPointerEnter",["pointerout","pointerover"]),ft("onPointerLeave",["pointerout","pointerover"]),Oe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Oe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Oe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Oe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Oe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Oe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cy=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Fo));function Fg(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var o=e[n],c=o.event;o=o.listeners;e:{var u=void 0;if(t)for(var x=o.length-1;0<=x;x--){var w=o[x],z=w.instance,Z=w.currentTarget;if(w=w.listener,z!==u&&c.isPropagationStopped())break e;u=w,c.currentTarget=Z;try{u(c)}catch(le){Ks(le)}c.currentTarget=null,u=z}else for(x=0;x<o.length;x++){if(w=o[x],z=w.instance,Z=w.currentTarget,w=w.listener,z!==u&&c.isPropagationStopped())break e;u=w,c.currentTarget=Z;try{u(c)}catch(le){Ks(le)}c.currentTarget=null,u=z}}}}function Xe(e,t){var n=t[k];n===void 0&&(n=t[k]=new Set);var o=e+"__bubble";n.has(o)||(Gg(t,e,2,!1),n.add(o))}function Mc(e,t,n){var o=0;t&&(o|=4),Gg(n,e,o,t)}var fl="_reactListening"+Math.random().toString(36).slice(2);function zc(e){if(!e[fl]){e[fl]=!0,Ie.forEach(function(n){n!=="selectionchange"&&(Cy.has(n)||Mc(n,!1,e),Mc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[fl]||(t[fl]=!0,Mc("selectionchange",!1,t))}}function Gg(e,t,n,o){switch(pp(t)){case 2:var c=Qy;break;case 8:c=Zy;break;default:c=Wc}n=c.bind(null,t,n,e),c=void 0,!ai||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),o?c!==void 0?e.addEventListener(t,n,{capture:!0,passive:c}):e.addEventListener(t,n,!0):c!==void 0?e.addEventListener(t,n,{passive:c}):e.addEventListener(t,n,!1)}function $c(e,t,n,o,c){var u=o;if((t&1)===0&&(t&2)===0&&o!==null)e:for(;;){if(o===null)return;var x=o.tag;if(x===3||x===4){var w=o.stateNode.containerInfo;if(w===c)break;if(x===4)for(x=o.return;x!==null;){var z=x.tag;if((z===3||z===4)&&x.stateNode.containerInfo===c)return;x=x.return}for(;w!==null;){if(x=be(w),x===null)return;if(z=x.tag,z===5||z===6||z===26||z===27){o=u=x;continue e}w=w.parentNode}}o=o.return}Qd(function(){var Z=u,le=ti(n),de=[];e:{var J=ju.get(e);if(J!==void 0){var ne=Ts,Le=e;switch(e){case"keypress":if(js(n)===0)break e;case"keydown":case"keyup":ne=ym;break;case"focusin":Le="focus",ne=li;break;case"focusout":Le="blur",ne=li;break;case"beforeblur":case"afterblur":ne=li;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ne=Jd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ne=om;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ne=vm;break;case vu:case Su:case wu:ne=im;break;case Cu:ne=wm;break;case"scroll":case"scrollend":ne=am;break;case"wheel":ne=jm;break;case"copy":case"cut":case"paste":ne=dm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ne=tu;break;case"toggle":case"beforetoggle":ne=Tm}var Me=(t&4)!==0,ut=!Me&&(e==="scroll"||e==="scrollend"),Y=Me?J!==null?J+"Capture":null:J;Me=[];for(var F=Z,Q;F!==null;){var ie=F;if(Q=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||Q===null||Y===null||(ie=lo(F,Y),ie!=null&&Me.push(Go(F,ie,Q))),ut)break;F=F.return}0<Me.length&&(J=new ne(J,Le,null,n,le),de.push({event:J,listeners:Me}))}}if((t&7)===0){e:{if(J=e==="mouseover"||e==="pointerover",ne=e==="mouseout"||e==="pointerout",J&&n!==ei&&(Le=n.relatedTarget||n.fromElement)&&(be(Le)||Le[et]))break e;if((ne||J)&&(J=le.window===le?le:(J=le.ownerDocument)?J.defaultView||J.parentWindow:window,ne?(Le=n.relatedTarget||n.toElement,ne=Z,Le=Le?be(Le):null,Le!==null&&(ut=f(Le),Me=Le.tag,Le!==ut||Me!==5&&Me!==27&&Me!==6)&&(Le=null)):(ne=null,Le=Z),ne!==Le)){if(Me=Jd,ie="onMouseLeave",Y="onMouseEnter",F="mouse",(e==="pointerout"||e==="pointerover")&&(Me=tu,ie="onPointerLeave",Y="onPointerEnter",F="pointer"),ut=ne==null?J:Se(ne),Q=Le==null?J:Se(Le),J=new Me(ie,F+"leave",ne,n,le),J.target=ut,J.relatedTarget=Q,ie=null,be(le)===Z&&(Me=new Me(Y,F+"enter",Le,n,le),Me.target=Q,Me.relatedTarget=ut,ie=Me),ut=ie,ne&&Le)t:{for(Me=ne,Y=Le,F=0,Q=Me;Q;Q=Pr(Q))F++;for(Q=0,ie=Y;ie;ie=Pr(ie))Q++;for(;0<F-Q;)Me=Pr(Me),F--;for(;0<Q-F;)Y=Pr(Y),Q--;for(;F--;){if(Me===Y||Y!==null&&Me===Y.alternate)break t;Me=Pr(Me),Y=Pr(Y)}Me=null}else Me=null;ne!==null&&Pg(de,J,ne,Me,!1),Le!==null&&ut!==null&&Pg(de,ut,Le,Me,!0)}}e:{if(J=Z?Se(Z):window,ne=J.nodeName&&J.nodeName.toLowerCase(),ne==="select"||ne==="input"&&J.type==="file")var je=cu;else if(lu(J))if(du)je=$m;else{je=Mm;var Ge=Om}else ne=J.nodeName,!ne||ne.toLowerCase()!=="input"||J.type!=="checkbox"&&J.type!=="radio"?Z&&Jl(Z.elementType)&&(je=cu):je=zm;if(je&&(je=je(e,Z))){iu(de,je,n,le);break e}Ge&&Ge(e,J,Z),e==="focusout"&&Z&&J.type==="number"&&Z.memoizedProps.value!=null&&Kl(J,"number",J.value)}switch(Ge=Z?Se(Z):window,e){case"focusin":(lu(Ge)||Ge.contentEditable==="true")&&(Sr=Ge,gi=Z,mo=null);break;case"focusout":mo=gi=Sr=null;break;case"mousedown":pi=!0;break;case"contextmenu":case"mouseup":case"dragend":pi=!1,xu(de,n,le);break;case"selectionchange":if(Um)break;case"keydown":case"keyup":xu(de,n,le)}var De;if(ci)e:{switch(e){case"compositionstart":var ze="onCompositionStart";break e;case"compositionend":ze="onCompositionEnd";break e;case"compositionupdate":ze="onCompositionUpdate";break e}ze=void 0}else vr?ou(e,n)&&(ze="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(ze="onCompositionStart");ze&&(nu&&n.locale!=="ko"&&(vr||ze!=="onCompositionStart"?ze==="onCompositionEnd"&&vr&&(De=Zd()):(va=le,ri="value"in va?va.value:va.textContent,vr=!0)),Ge=gl(Z,ze),0<Ge.length&&(ze=new eu(ze,e,null,n,le),de.push({event:ze,listeners:Ge}),De?ze.data=De:(De=su(n),De!==null&&(ze.data=De)))),(De=km?Am(e,n):Dm(e,n))&&(ze=gl(Z,"onBeforeInput"),0<ze.length&&(Ge=new eu("onBeforeInput","beforeinput",null,n,le),de.push({event:Ge,listeners:ze}),Ge.data=De)),vy(de,e,Z,n,le)}Fg(de,t)})}function Go(e,t,n){return{instance:e,listener:t,currentTarget:n}}function gl(e,t){for(var n=t+"Capture",o=[];e!==null;){var c=e,u=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||u===null||(c=lo(e,n),c!=null&&o.unshift(Go(e,c,u)),c=lo(e,t),c!=null&&o.push(Go(e,c,u))),e.tag===3)return o;e=e.return}return[]}function Pr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Pg(e,t,n,o,c){for(var u=t._reactName,x=[];n!==null&&n!==o;){var w=n,z=w.alternate,Z=w.stateNode;if(w=w.tag,z!==null&&z===o)break;w!==5&&w!==26&&w!==27||Z===null||(z=Z,c?(Z=lo(n,u),Z!=null&&x.unshift(Go(n,Z,z))):c||(Z=lo(n,u),Z!=null&&x.push(Go(n,Z,z)))),n=n.return}x.length!==0&&e.push({event:t,listeners:x})}var jy=/\r\n?/g,_y=/\u0000|\uFFFD/g;function Yg(e){return(typeof e=="string"?e:""+e).replace(jy,`
`).replace(_y,"")}function Xg(e,t){return t=Yg(t),Yg(e)===t}function pl(){}function dt(e,t,n,o,c,u){switch(n){case"children":typeof o=="string"?t==="body"||t==="textarea"&&o===""||yr(e,o):(typeof o=="number"||typeof o=="bigint")&&t!=="body"&&yr(e,""+o);break;case"className":Ct(e,"class",o);break;case"tabIndex":Ct(e,"tabindex",o);break;case"dir":case"role":case"viewBox":case"width":case"height":Ct(e,n,o);break;case"style":Vd(e,o,u);break;case"data":if(t!=="object"){Ct(e,"data",o);break}case"src":case"href":if(o===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(o==null||typeof o=="function"||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(n);break}o=ws(""+o),e.setAttribute(n,o);break;case"action":case"formAction":if(typeof o=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof u=="function"&&(n==="formAction"?(t!=="input"&&dt(e,t,"name",c.name,c,null),dt(e,t,"formEncType",c.formEncType,c,null),dt(e,t,"formMethod",c.formMethod,c,null),dt(e,t,"formTarget",c.formTarget,c,null)):(dt(e,t,"encType",c.encType,c,null),dt(e,t,"method",c.method,c,null),dt(e,t,"target",c.target,c,null)));if(o==null||typeof o=="symbol"||typeof o=="boolean"){e.removeAttribute(n);break}o=ws(""+o),e.setAttribute(n,o);break;case"onClick":o!=null&&(e.onclick=pl);break;case"onScroll":o!=null&&Xe("scroll",e);break;case"onScrollEnd":o!=null&&Xe("scrollend",e);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(n=o.__html,n!=null){if(c.children!=null)throw Error(i(60));e.innerHTML=n}}break;case"multiple":e.multiple=o&&typeof o!="function"&&typeof o!="symbol";break;case"muted":e.muted=o&&typeof o!="function"&&typeof o!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(o==null||typeof o=="function"||typeof o=="boolean"||typeof o=="symbol"){e.removeAttribute("xlink:href");break}n=ws(""+o),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(n,""+o):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":o&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":o===!0?e.setAttribute(n,""):o!==!1&&o!=null&&typeof o!="function"&&typeof o!="symbol"?e.setAttribute(n,o):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":o!=null&&typeof o!="function"&&typeof o!="symbol"&&!isNaN(o)&&1<=o?e.setAttribute(n,o):e.removeAttribute(n);break;case"rowSpan":case"start":o==null||typeof o=="function"||typeof o=="symbol"||isNaN(o)?e.removeAttribute(n):e.setAttribute(n,o);break;case"popover":Xe("beforetoggle",e),Xe("toggle",e),He(e,"popover",o);break;case"xlinkActuate":qt(e,"http://www.w3.org/1999/xlink","xlink:actuate",o);break;case"xlinkArcrole":qt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",o);break;case"xlinkRole":qt(e,"http://www.w3.org/1999/xlink","xlink:role",o);break;case"xlinkShow":qt(e,"http://www.w3.org/1999/xlink","xlink:show",o);break;case"xlinkTitle":qt(e,"http://www.w3.org/1999/xlink","xlink:title",o);break;case"xlinkType":qt(e,"http://www.w3.org/1999/xlink","xlink:type",o);break;case"xmlBase":qt(e,"http://www.w3.org/XML/1998/namespace","xml:base",o);break;case"xmlLang":qt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",o);break;case"xmlSpace":qt(e,"http://www.w3.org/XML/1998/namespace","xml:space",o);break;case"is":He(e,"is",o);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=tm.get(n)||n,He(e,n,o))}}function Lc(e,t,n,o,c,u){switch(n){case"style":Vd(e,o,u);break;case"dangerouslySetInnerHTML":if(o!=null){if(typeof o!="object"||!("__html"in o))throw Error(i(61));if(n=o.__html,n!=null){if(c.children!=null)throw Error(i(60));e.innerHTML=n}}break;case"children":typeof o=="string"?yr(e,o):(typeof o=="number"||typeof o=="bigint")&&yr(e,""+o);break;case"onScroll":o!=null&&Xe("scroll",e);break;case"onScrollEnd":o!=null&&Xe("scrollend",e);break;case"onClick":o!=null&&(e.onclick=pl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!qe.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(c=n.endsWith("Capture"),t=n.slice(2,c?n.length-7:void 0),u=e[Ne]||null,u=u!=null?u[n]:null,typeof u=="function"&&e.removeEventListener(t,u,c),typeof o=="function")){typeof u!="function"&&u!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,o,c);break e}n in e?e[n]=o:o===!0?e.setAttribute(n,""):He(e,n,o)}}}function Kt(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Xe("error",e),Xe("load",e);var o=!1,c=!1,u;for(u in n)if(n.hasOwnProperty(u)){var x=n[u];if(x!=null)switch(u){case"src":o=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:dt(e,t,u,x,n,null)}}c&&dt(e,t,"srcSet",n.srcSet,n,null),o&&dt(e,t,"src",n.src,n,null);return;case"input":Xe("invalid",e);var w=u=x=c=null,z=null,Z=null;for(o in n)if(n.hasOwnProperty(o)){var le=n[o];if(le!=null)switch(o){case"name":c=le;break;case"type":x=le;break;case"checked":z=le;break;case"defaultChecked":Z=le;break;case"value":u=le;break;case"defaultValue":w=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(i(137,t));break;default:dt(e,t,o,le,n,null)}}Gd(e,u,w,z,Z,x,c,!1),vs(e);return;case"select":Xe("invalid",e),o=x=u=null;for(c in n)if(n.hasOwnProperty(c)&&(w=n[c],w!=null))switch(c){case"value":u=w;break;case"defaultValue":x=w;break;case"multiple":o=w;default:dt(e,t,c,w,n,null)}t=u,n=x,e.multiple=!!o,t!=null?mr(e,!!o,t,!1):n!=null&&mr(e,!!o,n,!0);return;case"textarea":Xe("invalid",e),u=c=o=null;for(x in n)if(n.hasOwnProperty(x)&&(w=n[x],w!=null))switch(x){case"value":o=w;break;case"defaultValue":c=w;break;case"children":u=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(i(91));break;default:dt(e,t,x,w,n,null)}Yd(e,o,c,u),vs(e);return;case"option":for(z in n)if(n.hasOwnProperty(z)&&(o=n[z],o!=null))switch(z){case"selected":e.selected=o&&typeof o!="function"&&typeof o!="symbol";break;default:dt(e,t,z,o,n,null)}return;case"dialog":Xe("beforetoggle",e),Xe("toggle",e),Xe("cancel",e),Xe("close",e);break;case"iframe":case"object":Xe("load",e);break;case"video":case"audio":for(o=0;o<Fo.length;o++)Xe(Fo[o],e);break;case"image":Xe("error",e),Xe("load",e);break;case"details":Xe("toggle",e);break;case"embed":case"source":case"link":Xe("error",e),Xe("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Z in n)if(n.hasOwnProperty(Z)&&(o=n[Z],o!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:dt(e,t,Z,o,n,null)}return;default:if(Jl(t)){for(le in n)n.hasOwnProperty(le)&&(o=n[le],o!==void 0&&Lc(e,t,le,o,n,void 0));return}}for(w in n)n.hasOwnProperty(w)&&(o=n[w],o!=null&&dt(e,t,w,o,n,null))}function Ty(e,t,n,o){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,u=null,x=null,w=null,z=null,Z=null,le=null;for(ne in n){var de=n[ne];if(n.hasOwnProperty(ne)&&de!=null)switch(ne){case"checked":break;case"value":break;case"defaultValue":z=de;default:o.hasOwnProperty(ne)||dt(e,t,ne,null,o,de)}}for(var J in o){var ne=o[J];if(de=n[J],o.hasOwnProperty(J)&&(ne!=null||de!=null))switch(J){case"type":u=ne;break;case"name":c=ne;break;case"checked":Z=ne;break;case"defaultChecked":le=ne;break;case"value":x=ne;break;case"defaultValue":w=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(i(137,t));break;default:ne!==de&&dt(e,t,J,ne,o,de)}}Zl(e,x,w,z,Z,le,u,c);return;case"select":ne=x=w=J=null;for(u in n)if(z=n[u],n.hasOwnProperty(u)&&z!=null)switch(u){case"value":break;case"multiple":ne=z;default:o.hasOwnProperty(u)||dt(e,t,u,null,o,z)}for(c in o)if(u=o[c],z=n[c],o.hasOwnProperty(c)&&(u!=null||z!=null))switch(c){case"value":J=u;break;case"defaultValue":w=u;break;case"multiple":x=u;default:u!==z&&dt(e,t,c,u,o,z)}t=w,n=x,o=ne,J!=null?mr(e,!!n,J,!1):!!o!=!!n&&(t!=null?mr(e,!!n,t,!0):mr(e,!!n,n?[]:"",!1));return;case"textarea":ne=J=null;for(w in n)if(c=n[w],n.hasOwnProperty(w)&&c!=null&&!o.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:dt(e,t,w,null,o,c)}for(x in o)if(c=o[x],u=n[x],o.hasOwnProperty(x)&&(c!=null||u!=null))switch(x){case"value":J=c;break;case"defaultValue":ne=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(i(91));break;default:c!==u&&dt(e,t,x,c,o,u)}Pd(e,J,ne);return;case"option":for(var Le in n)if(J=n[Le],n.hasOwnProperty(Le)&&J!=null&&!o.hasOwnProperty(Le))switch(Le){case"selected":e.selected=!1;break;default:dt(e,t,Le,null,o,J)}for(z in o)if(J=o[z],ne=n[z],o.hasOwnProperty(z)&&J!==ne&&(J!=null||ne!=null))switch(z){case"selected":e.selected=J&&typeof J!="function"&&typeof J!="symbol";break;default:dt(e,t,z,J,o,ne)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Me in n)J=n[Me],n.hasOwnProperty(Me)&&J!=null&&!o.hasOwnProperty(Me)&&dt(e,t,Me,null,o,J);for(Z in o)if(J=o[Z],ne=n[Z],o.hasOwnProperty(Z)&&J!==ne&&(J!=null||ne!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(i(137,t));break;default:dt(e,t,Z,J,o,ne)}return;default:if(Jl(t)){for(var ut in n)J=n[ut],n.hasOwnProperty(ut)&&J!==void 0&&!o.hasOwnProperty(ut)&&Lc(e,t,ut,void 0,o,J);for(le in o)J=o[le],ne=n[le],!o.hasOwnProperty(le)||J===ne||J===void 0&&ne===void 0||Lc(e,t,le,J,o,ne);return}}for(var Y in n)J=n[Y],n.hasOwnProperty(Y)&&J!=null&&!o.hasOwnProperty(Y)&&dt(e,t,Y,null,o,J);for(de in o)J=o[de],ne=n[de],!o.hasOwnProperty(de)||J===ne||J==null&&ne==null||dt(e,t,de,J,o,ne)}var Uc=null,Bc=null;function hl(e){return e.nodeType===9?e:e.ownerDocument}function Vg(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Wg(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Ic(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Hc=null;function Ey(){var e=window.event;return e&&e.type==="popstate"?e===Hc?!1:(Hc=e,!0):(Hc=null,!1)}var Qg=typeof setTimeout=="function"?setTimeout:void 0,ky=typeof clearTimeout=="function"?clearTimeout:void 0,Zg=typeof Promise=="function"?Promise:void 0,Ay=typeof queueMicrotask=="function"?queueMicrotask:typeof Zg<"u"?function(e){return Zg.resolve(null).then(e).catch(Dy)}:Qg;function Dy(e){setTimeout(function(){throw e})}function $a(e){return e==="head"}function Kg(e,t){var n=t,o=0,c=0;do{var u=n.nextSibling;if(e.removeChild(n),u&&u.nodeType===8)if(n=u.data,n==="/$"){if(0<o&&8>o){n=o;var x=e.ownerDocument;if(n&1&&Po(x.documentElement),n&2&&Po(x.body),n&4)for(n=x.head,Po(n),x=n.firstChild;x;){var w=x.nextSibling,z=x.nodeName;x[ve]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&x.rel.toLowerCase()==="stylesheet"||n.removeChild(x),x=w}}if(c===0){e.removeChild(u),Jo(t);return}c--}else n==="$"||n==="$?"||n==="$!"?c++:o=n.charCodeAt(0)-48;else o=0;n=u}while(n);Jo(t)}function qc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":qc(n),$e(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function Ry(e,t,n,o){for(;e.nodeType===1;){var c=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!o&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(o){if(!e[ve])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(u=e.getAttribute("rel"),u==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(u!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(u=e.getAttribute("src"),(u!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&u&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var u=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===u)return e}else return e;if(e=In(e.nextSibling),e===null)break}return null}function Ny(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=In(e.nextSibling),e===null))return null;return e}function Fc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function Oy(e,t){var n=e.ownerDocument;if(e.data!=="$?"||n.readyState==="complete")t();else{var o=function(){t(),n.removeEventListener("DOMContentLoaded",o)};n.addEventListener("DOMContentLoaded",o),e._reactRetry=o}}function In(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var Gc=null;function Jg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}function ep(e,t,n){switch(t=hl(n),e){case"html":if(e=t.documentElement,!e)throw Error(i(452));return e;case"head":if(e=t.head,!e)throw Error(i(453));return e;case"body":if(e=t.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function Po(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);$e(e)}var Mn=new Map,tp=new Set;function ml(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ga=M.d;M.d={f:My,r:zy,D:$y,C:Ly,L:Uy,m:By,X:Hy,S:Iy,M:qy};function My(){var e=ga.f(),t=ll();return e||t}function zy(e){var t=pe(e);t!==null&&t.tag===5&&t.type==="form"?Sf(t):ga.r(e)}var Yr=typeof document>"u"?null:document;function np(e,t,n){var o=Yr;if(o&&typeof t=="string"&&t){var c=En(t);c='link[rel="'+e+'"][href="'+c+'"]',typeof n=="string"&&(c+='[crossorigin="'+n+'"]'),tp.has(c)||(tp.add(c),e={rel:e,crossOrigin:n,href:t},o.querySelector(c)===null&&(t=o.createElement("link"),Kt(t,"link",e),ye(t),o.head.appendChild(t)))}}function $y(e){ga.D(e),np("dns-prefetch",e,null)}function Ly(e,t){ga.C(e,t),np("preconnect",e,t)}function Uy(e,t,n){ga.L(e,t,n);var o=Yr;if(o&&e&&t){var c='link[rel="preload"][as="'+En(t)+'"]';t==="image"&&n&&n.imageSrcSet?(c+='[imagesrcset="'+En(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(c+='[imagesizes="'+En(n.imageSizes)+'"]')):c+='[href="'+En(e)+'"]';var u=c;switch(t){case"style":u=Xr(e);break;case"script":u=Vr(e)}Mn.has(u)||(e=y({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),Mn.set(u,e),o.querySelector(c)!==null||t==="style"&&o.querySelector(Yo(u))||t==="script"&&o.querySelector(Xo(u))||(t=o.createElement("link"),Kt(t,"link",e),ye(t),o.head.appendChild(t)))}}function By(e,t){ga.m(e,t);var n=Yr;if(n&&e){var o=t&&typeof t.as=="string"?t.as:"script",c='link[rel="modulepreload"][as="'+En(o)+'"][href="'+En(e)+'"]',u=c;switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":u=Vr(e)}if(!Mn.has(u)&&(e=y({rel:"modulepreload",href:e},t),Mn.set(u,e),n.querySelector(c)===null)){switch(o){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Xo(u)))return}o=n.createElement("link"),Kt(o,"link",e),ye(o),n.head.appendChild(o)}}}function Iy(e,t,n){ga.S(e,t,n);var o=Yr;if(o&&e){var c=Ee(o).hoistableStyles,u=Xr(e);t=t||"default";var x=c.get(u);if(!x){var w={loading:0,preload:null};if(x=o.querySelector(Yo(u)))w.loading=5;else{e=y({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Mn.get(u))&&Pc(e,n);var z=x=o.createElement("link");ye(z),Kt(z,"link",e),z._p=new Promise(function(Z,le){z.onload=Z,z.onerror=le}),z.addEventListener("load",function(){w.loading|=1}),z.addEventListener("error",function(){w.loading|=2}),w.loading|=4,yl(x,t,o)}x={type:"stylesheet",instance:x,count:1,state:w},c.set(u,x)}}}function Hy(e,t){ga.X(e,t);var n=Yr;if(n&&e){var o=Ee(n).hoistableScripts,c=Vr(e),u=o.get(c);u||(u=n.querySelector(Xo(c)),u||(e=y({src:e,async:!0},t),(t=Mn.get(c))&&Yc(e,t),u=n.createElement("script"),ye(u),Kt(u,"link",e),n.head.appendChild(u)),u={type:"script",instance:u,count:1,state:null},o.set(c,u))}}function qy(e,t){ga.M(e,t);var n=Yr;if(n&&e){var o=Ee(n).hoistableScripts,c=Vr(e),u=o.get(c);u||(u=n.querySelector(Xo(c)),u||(e=y({src:e,async:!0,type:"module"},t),(t=Mn.get(c))&&Yc(e,t),u=n.createElement("script"),ye(u),Kt(u,"link",e),n.head.appendChild(u)),u={type:"script",instance:u,count:1,state:null},o.set(c,u))}}function ap(e,t,n,o){var c=(c=ue.current)?ml(c):null;if(!c)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Xr(n.href),n=Ee(c).hoistableStyles,o=n.get(t),o||(o={type:"style",instance:null,count:0,state:null},n.set(t,o)),o):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Xr(n.href);var u=Ee(c).hoistableStyles,x=u.get(e);if(x||(c=c.ownerDocument||c,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,x),(u=c.querySelector(Yo(e)))&&!u._p&&(x.instance=u,x.state.loading=5),Mn.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Mn.set(e,n),u||Fy(c,e,n,x.state))),t&&o===null)throw Error(i(528,""));return x}if(t&&o!==null)throw Error(i(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Vr(n),n=Ee(c).hoistableScripts,o=n.get(t),o||(o={type:"script",instance:null,count:0,state:null},n.set(t,o)),o):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Xr(e){return'href="'+En(e)+'"'}function Yo(e){return'link[rel="stylesheet"]['+e+"]"}function rp(e){return y({},e,{"data-precedence":e.precedence,precedence:null})}function Fy(e,t,n,o){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?o.loading=1:(t=e.createElement("link"),o.preload=t,t.addEventListener("load",function(){return o.loading|=1}),t.addEventListener("error",function(){return o.loading|=2}),Kt(t,"link",n),ye(t),e.head.appendChild(t))}function Vr(e){return'[src="'+En(e)+'"]'}function Xo(e){return"script[async]"+e}function op(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var o=e.querySelector('style[data-href~="'+En(n.href)+'"]');if(o)return t.instance=o,ye(o),o;var c=y({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return o=(e.ownerDocument||e).createElement("style"),ye(o),Kt(o,"style",c),yl(o,n.precedence,e),t.instance=o;case"stylesheet":c=Xr(n.href);var u=e.querySelector(Yo(c));if(u)return t.state.loading|=4,t.instance=u,ye(u),u;o=rp(n),(c=Mn.get(c))&&Pc(o,c),u=(e.ownerDocument||e).createElement("link"),ye(u);var x=u;return x._p=new Promise(function(w,z){x.onload=w,x.onerror=z}),Kt(u,"link",o),t.state.loading|=4,yl(u,n.precedence,e),t.instance=u;case"script":return u=Vr(n.src),(c=e.querySelector(Xo(u)))?(t.instance=c,ye(c),c):(o=n,(c=Mn.get(u))&&(o=y({},n),Yc(o,c)),e=e.ownerDocument||e,c=e.createElement("script"),ye(c),Kt(c,"link",o),e.head.appendChild(c),t.instance=c);case"void":return null;default:throw Error(i(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(o=t.instance,t.state.loading|=4,yl(o,n.precedence,e));return t.instance}function yl(e,t,n){for(var o=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=o.length?o[o.length-1]:null,u=c,x=0;x<o.length;x++){var w=o[x];if(w.dataset.precedence===t)u=w;else if(u!==c)break}u?u.parentNode.insertBefore(e,u.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Pc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Yc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var xl=null;function sp(e,t,n){if(xl===null){var o=new Map,c=xl=new Map;c.set(n,o)}else c=xl,o=c.get(n),o||(o=new Map,c.set(n,o));if(o.has(e))return o;for(o.set(e,null),n=n.getElementsByTagName(e),c=0;c<n.length;c++){var u=n[c];if(!(u[ve]||u[Je]||e==="link"&&u.getAttribute("rel")==="stylesheet")&&u.namespaceURI!=="http://www.w3.org/2000/svg"){var x=u.getAttribute(t)||"";x=e+x;var w=o.get(x);w?w.push(u):o.set(x,[u])}}return o}function lp(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function Gy(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function ip(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var Vo=null;function Py(){}function Yy(e,t,n){if(Vo===null)throw Error(i(475));var o=Vo;if(t.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&(t.state.loading&4)===0){if(t.instance===null){var c=Xr(n.href),u=e.querySelector(Yo(c));if(u){e=u._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(o.count++,o=bl.bind(o),e.then(o,o)),t.state.loading|=4,t.instance=u,ye(u);return}u=e.ownerDocument||e,n=rp(n),(c=Mn.get(c))&&Pc(n,c),u=u.createElement("link"),ye(u);var x=u;x._p=new Promise(function(w,z){x.onload=w,x.onerror=z}),Kt(u,"link",n),t.instance=u}o.stylesheets===null&&(o.stylesheets=new Map),o.stylesheets.set(t,e),(e=t.state.preload)&&(t.state.loading&3)===0&&(o.count++,t=bl.bind(o),e.addEventListener("load",t),e.addEventListener("error",t))}}function Xy(){if(Vo===null)throw Error(i(475));var e=Vo;return e.stylesheets&&e.count===0&&Xc(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Xc(e,e.stylesheets),e.unsuspend){var o=e.unsuspend;e.unsuspend=null,o()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}function bl(){if(this.count--,this.count===0){if(this.stylesheets)Xc(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var vl=null;function Xc(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,vl=new Map,t.forEach(Vy,e),vl=null,bl.call(e))}function Vy(e,t){if(!(t.state.loading&4)){var n=vl.get(e);if(n)var o=n.get(null);else{n=new Map,vl.set(e,n);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),u=0;u<c.length;u++){var x=c[u];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(n.set(x.dataset.precedence,x),o=x)}o&&n.set(null,o)}c=t.instance,x=c.getAttribute("data-precedence"),u=n.get(x)||o,u===o&&n.set(null,c),n.set(x,c),this.count++,o=bl.bind(this),c.addEventListener("load",o),c.addEventListener("error",o),u?u.parentNode.insertBefore(c,u.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),t.state.loading|=4}}var Wo={$$typeof:D,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function Wy(e,t,n,o,c,u,x,w){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ln(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ln(0),this.hiddenUpdates=Ln(null),this.identifierPrefix=o,this.onUncaughtError=c,this.onCaughtError=u,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=w,this.incompleteTransitions=new Map}function cp(e,t,n,o,c,u,x,w,z,Z,le,de){return e=new Wy(e,t,n,x,w,z,Z,de),t=1,u===!0&&(t|=24),u=mn(3,null,null,t),e.current=u,u.stateNode=e,t=ki(),t.refCount++,e.pooledCache=t,t.refCount++,u.memoizedState={element:o,isDehydrated:n,cache:t},Ni(u),e}function dp(e){return e?(e=_r,e):_r}function up(e,t,n,o,c,u){c=dp(c),o.context===null?o.context=c:o.pendingContext=c,o=Ca(t),o.payload={element:n},u=u===void 0?null:u,u!==null&&(o.callback=u),n=ja(e,o,t),n!==null&&(Sn(n,e,t),_o(n,e,t))}function fp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Vc(e,t){fp(e,t),(e=e.alternate)&&fp(e,t)}function gp(e){if(e.tag===13){var t=jr(e,67108864);t!==null&&Sn(t,e,67108864),Vc(e,67108864)}}var Sl=!0;function Qy(e,t,n,o){var c=R.T;R.T=null;var u=M.p;try{M.p=2,Wc(e,t,n,o)}finally{M.p=u,R.T=c}}function Zy(e,t,n,o){var c=R.T;R.T=null;var u=M.p;try{M.p=8,Wc(e,t,n,o)}finally{M.p=u,R.T=c}}function Wc(e,t,n,o){if(Sl){var c=Qc(o);if(c===null)$c(e,t,o,wl,n),hp(e,o);else if(Jy(c,e,t,n,o))o.stopPropagation();else if(hp(e,o),t&4&&-1<Ky.indexOf(e)){for(;c!==null;){var u=pe(c);if(u!==null)switch(u.tag){case 3:if(u=u.stateNode,u.current.memoizedState.isDehydrated){var x=X(u.pendingLanes);if(x!==0){var w=u;for(w.pendingLanes|=2,w.entangledLanes|=2;x;){var z=1<<31-yt(x);w.entanglements[1]|=z,x&=~z}Vn(u),(st&6)===0&&(ol=Rt()+500,qo(0))}}break;case 13:w=jr(u,2),w!==null&&Sn(w,u,2),ll(),Vc(u,2)}if(u=Qc(o),u===null&&$c(e,t,o,wl,n),u===c)break;c=u}c!==null&&o.stopPropagation()}else $c(e,t,o,null,n)}}function Qc(e){return e=ti(e),Zc(e)}var wl=null;function Zc(e){if(wl=null,e=be(e),e!==null){var t=f(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=g(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return wl=e,null}function pp(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch($n()){case vt:return 2;case pt:return 8;case ht:case Nt:return 32;case sn:return 268435456;default:return 32}default:return 32}}var Kc=!1,La=null,Ua=null,Ba=null,Qo=new Map,Zo=new Map,Ia=[],Ky="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function hp(e,t){switch(e){case"focusin":case"focusout":La=null;break;case"dragenter":case"dragleave":Ua=null;break;case"mouseover":case"mouseout":Ba=null;break;case"pointerover":case"pointerout":Qo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zo.delete(t.pointerId)}}function Ko(e,t,n,o,c,u){return e===null||e.nativeEvent!==u?(e={blockedOn:t,domEventName:n,eventSystemFlags:o,nativeEvent:u,targetContainers:[c]},t!==null&&(t=pe(t),t!==null&&gp(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function Jy(e,t,n,o,c){switch(t){case"focusin":return La=Ko(La,e,t,n,o,c),!0;case"dragenter":return Ua=Ko(Ua,e,t,n,o,c),!0;case"mouseover":return Ba=Ko(Ba,e,t,n,o,c),!0;case"pointerover":var u=c.pointerId;return Qo.set(u,Ko(Qo.get(u)||null,e,t,n,o,c)),!0;case"gotpointercapture":return u=c.pointerId,Zo.set(u,Ko(Zo.get(u)||null,e,t,n,o,c)),!0}return!1}function mp(e){var t=be(e.target);if(t!==null){var n=f(t);if(n!==null){if(t=n.tag,t===13){if(t=g(n),t!==null){e.blockedOn=t,Wt(e.priority,function(){if(n.tag===13){var o=vn();o=wt(o);var c=jr(n,o);c!==null&&Sn(c,n,o),Vc(n,o)}});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Cl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qc(e.nativeEvent);if(n===null){n=e.nativeEvent;var o=new n.constructor(n.type,n);ei=o,n.target.dispatchEvent(o),ei=null}else return t=pe(n),t!==null&&gp(t),e.blockedOn=n,!1;t.shift()}return!0}function yp(e,t,n){Cl(e)&&n.delete(t)}function e0(){Kc=!1,La!==null&&Cl(La)&&(La=null),Ua!==null&&Cl(Ua)&&(Ua=null),Ba!==null&&Cl(Ba)&&(Ba=null),Qo.forEach(yp),Zo.forEach(yp)}function jl(e,t){e.blockedOn===t&&(e.blockedOn=null,Kc||(Kc=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,e0)))}var _l=null;function xp(e){_l!==e&&(_l=e,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){_l===e&&(_l=null);for(var t=0;t<e.length;t+=3){var n=e[t],o=e[t+1],c=e[t+2];if(typeof o!="function"){if(Zc(o||n)===null)continue;break}var u=pe(n);u!==null&&(e.splice(t,3),t-=3,Zi(u,{pending:!0,data:c,method:n.method,action:o},o,c))}}))}function Jo(e){function t(z){return jl(z,e)}La!==null&&jl(La,e),Ua!==null&&jl(Ua,e),Ba!==null&&jl(Ba,e),Qo.forEach(t),Zo.forEach(t);for(var n=0;n<Ia.length;n++){var o=Ia[n];o.blockedOn===e&&(o.blockedOn=null)}for(;0<Ia.length&&(n=Ia[0],n.blockedOn===null);)mp(n),n.blockedOn===null&&Ia.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(o=0;o<n.length;o+=3){var c=n[o],u=n[o+1],x=c[Ne]||null;if(typeof u=="function")x||xp(n);else if(x){var w=null;if(u&&u.hasAttribute("formAction")){if(c=u,x=u[Ne]||null)w=x.formAction;else if(Zc(c)!==null)continue}else w=x.action;typeof w=="function"?n[o+1]=w:(n.splice(o,3),o-=3),xp(n)}}}function Jc(e){this._internalRoot=e}Tl.prototype.render=Jc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(i(409));var n=t.current,o=vn();up(n,o,e,t,null,null)},Tl.prototype.unmount=Jc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;up(e.current,2,null,e,null,null),ll(),t[et]=null}};function Tl(e){this._internalRoot=e}Tl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Be();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ia.length&&t!==0&&t<Ia[n].priority;n++);Ia.splice(n,0,e),n===0&&mp(e)}};var bp=r.version;if(bp!=="19.1.0")throw Error(i(527,bp,"19.1.0"));M.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(i(188)):(e=Object.keys(e).join(","),Error(i(268,e)));return e=m(t),e=e!==null?h(e):null,e=e===null?null:e.stateNode,e};var t0={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:R,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var El=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!El.isDisabled&&El.supportsFiber)try{tn=El.inject(t0),it=El}catch{}}return ts.createRoot=function(e,t){if(!d(e))throw Error(i(299));var n=!1,o="",c=zf,u=$f,x=Lf,w=null;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onUncaughtError!==void 0&&(c=t.onUncaughtError),t.onCaughtError!==void 0&&(u=t.onCaughtError),t.onRecoverableError!==void 0&&(x=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(w=t.unstable_transitionCallbacks)),t=cp(e,1,!1,null,null,n,o,c,u,x,w,null),e[et]=t.current,zc(e),new Jc(t)},ts.hydrateRoot=function(e,t,n){if(!d(e))throw Error(i(299));var o=!1,c="",u=zf,x=$f,w=Lf,z=null,Z=null;return n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(u=n.onUncaughtError),n.onCaughtError!==void 0&&(x=n.onCaughtError),n.onRecoverableError!==void 0&&(w=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(z=n.unstable_transitionCallbacks),n.formState!==void 0&&(Z=n.formState)),t=cp(e,1,!0,t,n??null,o,c,u,x,w,z,Z),t.context=dp(null),n=t.current,o=vn(),o=wt(o),c=Ca(o),c.callback=null,ja(n,c,o),n=o,t.current.lanes=n,ot(t,n),Vn(t),e[et]=t.current,zc(e),new Tl(t)},ts.version="19.1.0",ts}var _p;function x0(){if(_p)return td.exports;_p=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(r){console.error(r)}}return a(),td.exports=y0(),td.exports}var b0=x0();const v0="modulepreload",S0=function(a){return"/"+a},Tp={},Qn=function(r,s,i){let d=Promise.resolve();if(s&&s.length>0){let g=function(h){return Promise.all(h.map(y=>Promise.resolve(y).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),m=(p==null?void 0:p.nonce)||(p==null?void 0:p.getAttribute("nonce"));d=g(s.map(h=>{if(h=S0(h),h in Tp)return;Tp[h]=!0;const y=h.endsWith(".css"),b=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${b}`))return;const S=document.createElement("link");if(S.rel=y?"stylesheet":v0,y||(S.as="script"),S.crossOrigin="",S.href=h,m&&S.setAttribute("nonce",m),document.head.appendChild(S),y)return new Promise((E,_)=>{S.addEventListener("load",E),S.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${h}`)))})}))}function f(g){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=g,window.dispatchEvent(p),!p.defaultPrevented)throw g}return d.then(g=>{for(const p of g||[])p.status==="rejected"&&f(p.reason);return r().catch(f)})};function w0(){const a=window.fetch;window.fetch=async function(r,s={}){const i=s.signal&&s.signal instanceof AbortSignal;if(i&&s.signal.aborted)throw new DOMException("The operation was aborted.","AbortError");const d={...s,credentials:s.credentials||"same-origin",headers:{"Content-Type":"application/json","Cache-Control":"no-cache",...s.headers}},f=i?1:3;let g;for(let p=1;p<=f;p++)try{if(console.log(`🌐 Fetch attempt ${p}/${f} to:`,r),i&&s.signal.aborted)throw new DOMException("The operation was aborted.","AbortError");const m=await a(r,d);if(console.log(`✅ Response ${m.status}:`,r),m.status===0)throw new Error("Network error (Status 0) - possible CORS or connectivity issue");return m}catch(m){if(console.error(`❌ Fetch attempt ${p} failed:`,m.message),g=m,m.name==="AbortError"||m.message.includes("aborted")||m.message.includes("401")||m.message.includes("403"))throw m;if(i&&s.signal.aborted)throw new DOMException("The operation was aborted.","AbortError");if(p<f){const h=Math.pow(2,p)*1e3;console.log(`⏳ Retrying in ${h}ms...`),await new Promise((y,b)=>{const S=setTimeout(y,h);if(i){const E=()=>{clearTimeout(S),b(new DOMException("The operation was aborted.","AbortError"))};if(s.signal.aborted)clearTimeout(S),b(new DOMException("The operation was aborted.","AbortError"));else{s.signal.addEventListener("abort",E,{once:!0});const _=y;y=j=>{s.signal.removeEventListener("abort",E),_(j)}}}})}}throw g}}function C0(){const a=localStorage.setItem,r=localStorage.getItem;localStorage.setItem=function(s,i){try{return a.call(this,s,i)}catch(d){console.warn("⚠️ localStorage.setItem failed (Brave privacy settings?):",d);try{sessionStorage.setItem(s,i)}catch(f){console.error("❌ Both localStorage and sessionStorage failed:",f)}}},localStorage.getItem=function(s){try{const i=r.call(this,s);return i!==null?i:sessionStorage.getItem(s)}catch(i){console.warn("⚠️ localStorage.getItem failed:",i);try{return sessionStorage.getItem(s)}catch(d){return console.error("❌ Both localStorage and sessionStorage getItem failed:",d),null}}}}function j0(){let a=navigator.onLine,r="unknown";function s(){if(navigator.connection){const i=navigator.connection;r=i.effectiveType||"unknown",console.log("📶 Connection info:",{effectiveType:i.effectiveType,downlink:i.downlink,rtt:i.rtt})}}return window.addEventListener("online",()=>{a=!0,console.log("🟢 Connection restored"),s()}),window.addEventListener("offline",()=>{a=!1,console.log("🔴 Connection lost")}),s(),{isOnline:()=>a,getQuality:()=>r,check:s}}function _0(){return{setToken:s=>{try{localStorage.setItem("token",s),sessionStorage.setItem("token_backup",s),console.log("✅ Token stored successfully")}catch(i){console.warn("⚠️ Token storage failed, using sessionStorage only:",i),sessionStorage.setItem("token",s),sessionStorage.setItem("token_backup",s)}},getToken:()=>{try{let s=localStorage.getItem("token");return s||(s=sessionStorage.getItem("token")||sessionStorage.getItem("token_backup"),s?(console.log("📝 Using token from sessionStorage fallback"),s):null)}catch(s){return console.error("❌ Token retrieval failed:",s),null}}}}function T0(){const a=new Date;console.log("⏰ Current timezone info:",{timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,offset:a.getTimezoneOffset(),locale:navigator.language})}function Ep(){console.log("🔧 Initializing browser compatibility fixes for Windows 11/Brave...");const a=navigator.platform.includes("Win"),r=navigator.userAgent.includes("Brave")||navigator.brave&&navigator.brave.isBrave;console.log("🖥️ Browser detection:",{platform:navigator.platform,userAgent:navigator.userAgent.substring(0,100)+"...",isWindows:a,isBrave:r,cookiesEnabled:navigator.cookieEnabled,language:navigator.language}),w0(),C0();const s=j0(),i=_0();T0(),window.browserCompatibility={connectivity:s,auth:i,isWindows:a,isBrave:r,checkConnection:()=>{console.log("🔍 Connection status:",{online:s.isOnline(),quality:s.getQuality(),cookiesEnabled:navigator.cookieEnabled})}},console.log("✅ Browser compatibility fixes applied"),console.log("🐛 Debug: Run window.browserCompatibility.checkConnection() to test connectivity")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Ep):Ep();const E0=a=>a?a.startsWith("https://cards.scryfall.io/")||a.startsWith("https://c1.scryfall.com/")?`http://localhost:3001/api/cards/image-proxy?url=${encodeURIComponent(a)}`:a:null;function k0(){const[a,r]=v.useState(""),[s,i]=v.useState([]),[d,f]=v.useState(!1),[g,p]=v.useState(""),[m,h]=v.useState(""),y=async b=>{b.preventDefault(),f(!0),p(""),h("");try{const _=await(await fetch(`/api/cards/typesense-search?q=${encodeURIComponent(a)}`)).json();Array.isArray(_)?(i(_),_.length===0?h("No cards found matching your search criteria."):h("")):_&&_.message?(i([]),h(_.message)):(i([]),h("No results found."))}catch{p("Error fetching cards."),i([]),h("")}f(!1)};return l.jsxs("div",{children:[l.jsx("h2",{children:"Card Search"}),l.jsxs("form",{onSubmit:y,style:{marginBottom:16},children:[l.jsx("input",{value:a,onChange:b=>r(b.target.value),placeholder:"Search for a card...",style:{padding:8,width:250}}),l.jsx("button",{type:"submit",style:{marginLeft:8,padding:8},children:"Search"})]}),d&&l.jsx("div",{children:"Loading..."}),g&&l.jsx("div",{style:{color:"red"},children:g}),m&&!d&&l.jsx("div",{style:{color:"gray"},children:m}),l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:16},children:s.map(b=>l.jsxs("div",{style:{border:"1px solid #ccc",padding:8,width:200},children:[l.jsx("div",{children:l.jsx("strong",{children:b.name})}),b.image_uris&&l.jsx("img",{src:E0(b.image_uris.small),alt:b.name,style:{width:"100%"}}),l.jsx("div",{style:{fontSize:12,color:"#555"},children:b.set_name})]},b.id||b._id))})]})}function dh(a){var r,s,i="";if(typeof a=="string"||typeof a=="number")i+=a;else if(typeof a=="object")if(Array.isArray(a)){var d=a.length;for(r=0;r<d;r++)a[r]&&(s=dh(a[r]))&&(i&&(i+=" "),i+=s)}else for(s in a)a[s]&&(i&&(i+=" "),i+=s);return i}function ur(){for(var a,r,s=0,i="",d=arguments.length;s<d;s++)(a=arguments[s])&&(r=dh(a))&&(i&&(i+=" "),i+=r);return i}function A0(a){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r.firstChild?r.insertBefore(s,r.firstChild):r.appendChild(s),s.styleSheet?s.styleSheet.cssText=a:s.appendChild(document.createTextNode(a))}A0(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var gs=a=>typeof a=="number"&&!isNaN(a),pr=a=>typeof a=="string",ha=a=>typeof a=="function",D0=a=>pr(a)||gs(a),yd=a=>pr(a)||ha(a)?a:null,R0=(a,r)=>a===!1||gs(a)&&a>0?a:r,xd=a=>v.isValidElement(a)||pr(a)||ha(a)||gs(a);function N0(a,r,s=300){let{scrollHeight:i,style:d}=a;requestAnimationFrame(()=>{d.minHeight="initial",d.height=i+"px",d.transition=`all ${s}ms`,requestAnimationFrame(()=>{d.height="0",d.padding="0",d.margin="0",setTimeout(r,s)})})}function O0({enter:a,exit:r,appendPosition:s=!1,collapse:i=!0,collapseDuration:d=300}){return function({children:f,position:g,preventExitTransition:p,done:m,nodeRef:h,isIn:y,playToast:b}){let S=s?`${a}--${g}`:a,E=s?`${r}--${g}`:r,_=v.useRef(0);return v.useLayoutEffect(()=>{let j=h.current,T=S.split(" "),N=O=>{O.target===h.current&&(b(),j.removeEventListener("animationend",N),j.removeEventListener("animationcancel",N),_.current===0&&O.type!=="animationcancel"&&j.classList.remove(...T))};j.classList.add(...T),j.addEventListener("animationend",N),j.addEventListener("animationcancel",N)},[]),v.useEffect(()=>{let j=h.current,T=()=>{j.removeEventListener("animationend",T),i?N0(j,m,d):m()};y||(p?T():(_.current=1,j.className+=` ${E}`,j.addEventListener("animationend",T)))},[y]),ke.createElement(ke.Fragment,null,f)}}function kp(a,r){return{content:uh(a.content,a.props),containerId:a.props.containerId,id:a.props.toastId,theme:a.props.theme,type:a.props.type,data:a.props.data||{},isLoading:a.props.isLoading,icon:a.props.icon,reason:a.removalReason,status:r}}function uh(a,r,s=!1){return v.isValidElement(a)&&!pr(a.type)?v.cloneElement(a,{closeToast:r.closeToast,toastProps:r,data:r.data,isPaused:s}):ha(a)?a({closeToast:r.closeToast,toastProps:r,data:r.data,isPaused:s}):a}function M0({closeToast:a,theme:r,ariaLabel:s="close"}){return ke.createElement("button",{className:`Toastify__close-button Toastify__close-button--${r}`,type:"button",onClick:i=>{i.stopPropagation(),a(!0)},"aria-label":s},ke.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},ke.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function z0({delay:a,isRunning:r,closeToast:s,type:i="default",hide:d,className:f,controlledProgress:g,progress:p,rtl:m,isIn:h,theme:y}){let b=d||g&&p===0,S={animationDuration:`${a}ms`,animationPlayState:r?"running":"paused"};g&&(S.transform=`scaleX(${p})`);let E=ur("Toastify__progress-bar",g?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${y}`,`Toastify__progress-bar--${i}`,{"Toastify__progress-bar--rtl":m}),_=ha(f)?f({rtl:m,type:i,defaultClassName:E}):ur(E,f),j={[g&&p>=1?"onTransitionEnd":"onAnimationEnd"]:g&&p<1?null:()=>{h&&s()}};return ke.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":b},ke.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${y} Toastify__progress-bar--${i}`}),ke.createElement("div",{role:"progressbar","aria-hidden":b?"true":"false","aria-label":"notification timer",className:_,style:S,...j}))}var $0=1,fh=()=>`${$0++}`;function L0(a,r,s){let i=1,d=0,f=[],g=[],p=r,m=new Map,h=new Set,y=O=>(h.add(O),()=>h.delete(O)),b=()=>{g=Array.from(m.values()),h.forEach(O=>O())},S=({containerId:O,toastId:D,updateId:L})=>{let $=O?O!==a:a!==1,V=m.has(D)&&L==null;return $||V},E=(O,D)=>{m.forEach(L=>{var $;(D==null||D===L.props.toastId)&&(($=L.toggle)==null||$.call(L,O))})},_=O=>{var D,L;(L=(D=O.props)==null?void 0:D.onClose)==null||L.call(D,O.removalReason),O.isActive=!1},j=O=>{if(O==null)m.forEach(_);else{let D=m.get(O);D&&_(D)}b()},T=()=>{d-=f.length,f=[]},N=O=>{var D,L;let{toastId:$,updateId:V}=O.props,H=V==null;O.staleId&&m.delete(O.staleId),O.isActive=!0,m.set($,O),b(),s(kp(O,H?"added":"updated")),H&&((L=(D=O.props).onOpen)==null||L.call(D))};return{id:a,props:p,observe:y,toggle:E,removeToast:j,toasts:m,clearQueue:T,buildToast:(O,D)=>{if(S(D))return;let{toastId:L,updateId:$,data:V,staleId:H,delay:C}=D,I=$==null;I&&d++;let U={...p,style:p.toastStyle,key:i++,...Object.fromEntries(Object.entries(D).filter(([ee,oe])=>oe!=null)),toastId:L,updateId:$,data:V,isIn:!1,className:yd(D.className||p.toastClassName),progressClassName:yd(D.progressClassName||p.progressClassName),autoClose:D.isLoading?!1:R0(D.autoClose,p.autoClose),closeToast(ee){m.get(L).removalReason=ee,j(L)},deleteToast(){let ee=m.get(L);if(ee!=null){if(s(kp(ee,"removed")),m.delete(L),d--,d<0&&(d=0),f.length>0){N(f.shift());return}b()}}};U.closeButton=p.closeButton,D.closeButton===!1||xd(D.closeButton)?U.closeButton=D.closeButton:D.closeButton===!0&&(U.closeButton=xd(p.closeButton)?p.closeButton:!0);let A={content:O,props:U,staleId:H};p.limit&&p.limit>0&&d>p.limit&&I?f.push(A):gs(C)?setTimeout(()=>{N(A)},C):N(A)},setProps(O){p=O},setToggle:(O,D)=>{let L=m.get(O);L&&(L.toggle=D)},isToastActive:O=>{var D;return(D=m.get(O))==null?void 0:D.isActive},getSnapshot:()=>g}}var on=new Map,is=[],bd=new Set,U0=a=>bd.forEach(r=>r(a)),gh=()=>on.size>0;function B0(){is.forEach(a=>hh(a.content,a.options)),is=[]}var I0=(a,{containerId:r})=>{var s;return(s=on.get(r||1))==null?void 0:s.toasts.get(a)};function ph(a,r){var s;if(r)return!!((s=on.get(r))!=null&&s.isToastActive(a));let i=!1;return on.forEach(d=>{d.isToastActive(a)&&(i=!0)}),i}function H0(a){if(!gh()){is=is.filter(r=>a!=null&&r.options.toastId!==a);return}if(a==null||D0(a))on.forEach(r=>{r.removeToast(a)});else if(a&&("containerId"in a||"id"in a)){let r=on.get(a.containerId);r?r.removeToast(a.id):on.forEach(s=>{s.removeToast(a.id)})}}var q0=(a={})=>{on.forEach(r=>{r.props.limit&&(!a.containerId||r.id===a.containerId)&&r.clearQueue()})};function hh(a,r){xd(a)&&(gh()||is.push({content:a,options:r}),on.forEach(s=>{s.buildToast(a,r)}))}function F0(a){var r;(r=on.get(a.containerId||1))==null||r.setToggle(a.id,a.fn)}function mh(a,r){on.forEach(s=>{(r==null||!(r!=null&&r.containerId)||(r==null?void 0:r.containerId)===s.id)&&s.toggle(a,r==null?void 0:r.id)})}function G0(a){let r=a.containerId||1;return{subscribe(s){let i=L0(r,a,U0);on.set(r,i);let d=i.observe(s);return B0(),()=>{d(),on.delete(r)}},setProps(s){var i;(i=on.get(r))==null||i.setProps(s)},getSnapshot(){var s;return(s=on.get(r))==null?void 0:s.getSnapshot()}}}function P0(a){return bd.add(a),()=>{bd.delete(a)}}function Y0(a){return a&&(pr(a.toastId)||gs(a.toastId))?a.toastId:fh()}function ps(a,r){return hh(a,r),r.toastId}function Hl(a,r){return{...r,type:r&&r.type||a,toastId:Y0(r)}}function ql(a){return(r,s)=>ps(r,Hl(a,s))}function ce(a,r){return ps(a,Hl("default",r))}ce.loading=(a,r)=>ps(a,Hl("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...r}));function X0(a,{pending:r,error:s,success:i},d){let f;r&&(f=pr(r)?ce.loading(r,d):ce.loading(r.render,{...d,...r}));let g={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},p=(h,y,b)=>{if(y==null){ce.dismiss(f);return}let S={type:h,...g,...d,data:b},E=pr(y)?{render:y}:y;return f?ce.update(f,{...S,...E}):ce(E.render,{...S,...E}),b},m=ha(a)?a():a;return m.then(h=>p("success",i,h)).catch(h=>p("error",s,h)),m}ce.promise=X0;ce.success=ql("success");ce.info=ql("info");ce.error=ql("error");ce.warning=ql("warning");ce.warn=ce.warning;ce.dark=(a,r)=>ps(a,Hl("default",{theme:"dark",...r}));function V0(a){H0(a)}ce.dismiss=V0;ce.clearWaitingQueue=q0;ce.isActive=ph;ce.update=(a,r={})=>{let s=I0(a,r);if(s){let{props:i,content:d}=s,f={delay:100,...i,...r,toastId:r.toastId||a,updateId:fh()};f.toastId!==a&&(f.staleId=a);let g=f.render||d;delete f.render,ps(g,f)}};ce.done=a=>{ce.update(a,{progress:1})};ce.onChange=P0;ce.play=a=>mh(!0,a);ce.pause=a=>mh(!1,a);function W0(a){var r;let{subscribe:s,getSnapshot:i,setProps:d}=v.useRef(G0(a)).current;d(a);let f=(r=v.useSyncExternalStore(s,i,i))==null?void 0:r.slice();function g(p){if(!f)return[];let m=new Map;return a.newestOnTop&&f.reverse(),f.forEach(h=>{let{position:y}=h.props;m.has(y)||m.set(y,[]),m.get(y).push(h)}),Array.from(m,h=>p(h[0],h[1]))}return{getToastToRender:g,isToastActive:ph,count:f==null?void 0:f.length}}function Q0(a){let[r,s]=v.useState(!1),[i,d]=v.useState(!1),f=v.useRef(null),g=v.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:p,pauseOnHover:m,closeToast:h,onClick:y,closeOnClick:b}=a;F0({id:a.toastId,containerId:a.containerId,fn:s}),v.useEffect(()=>{if(a.pauseOnFocusLoss)return S(),()=>{E()}},[a.pauseOnFocusLoss]);function S(){document.hasFocus()||N(),window.addEventListener("focus",T),window.addEventListener("blur",N)}function E(){window.removeEventListener("focus",T),window.removeEventListener("blur",N)}function _(H){if(a.draggable===!0||a.draggable===H.pointerType){O();let C=f.current;g.canCloseOnClick=!0,g.canDrag=!0,C.style.transition="none",a.draggableDirection==="x"?(g.start=H.clientX,g.removalDistance=C.offsetWidth*(a.draggablePercent/100)):(g.start=H.clientY,g.removalDistance=C.offsetHeight*(a.draggablePercent===80?a.draggablePercent*1.5:a.draggablePercent)/100)}}function j(H){let{top:C,bottom:I,left:U,right:A}=f.current.getBoundingClientRect();H.nativeEvent.type!=="touchend"&&a.pauseOnHover&&H.clientX>=U&&H.clientX<=A&&H.clientY>=C&&H.clientY<=I?N():T()}function T(){s(!0)}function N(){s(!1)}function O(){g.didMove=!1,document.addEventListener("pointermove",L),document.addEventListener("pointerup",$)}function D(){document.removeEventListener("pointermove",L),document.removeEventListener("pointerup",$)}function L(H){let C=f.current;if(g.canDrag&&C){g.didMove=!0,r&&N(),a.draggableDirection==="x"?g.delta=H.clientX-g.start:g.delta=H.clientY-g.start,g.start!==H.clientX&&(g.canCloseOnClick=!1);let I=a.draggableDirection==="x"?`${g.delta}px, var(--y)`:`0, calc(${g.delta}px + var(--y))`;C.style.transform=`translate3d(${I},0)`,C.style.opacity=`${1-Math.abs(g.delta/g.removalDistance)}`}}function $(){D();let H=f.current;if(g.canDrag&&g.didMove&&H){if(g.canDrag=!1,Math.abs(g.delta)>g.removalDistance){d(!0),a.closeToast(!0),a.collapseAll();return}H.style.transition="transform 0.2s, opacity 0.2s",H.style.removeProperty("transform"),H.style.removeProperty("opacity")}}let V={onPointerDown:_,onPointerUp:j};return p&&m&&(V.onMouseEnter=N,a.stacked||(V.onMouseLeave=T)),b&&(V.onClick=H=>{y&&y(H),g.canCloseOnClick&&h(!0)}),{playToast:T,pauseToast:N,isRunning:r,preventExitTransition:i,toastRef:f,eventHandlers:V}}var Z0=typeof window<"u"?v.useLayoutEffect:v.useEffect,Fl=({theme:a,type:r,isLoading:s,...i})=>ke.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:a==="colored"?"currentColor":`var(--toastify-icon-color-${r})`,...i});function K0(a){return ke.createElement(Fl,{...a},ke.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function J0(a){return ke.createElement(Fl,{...a},ke.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function ex(a){return ke.createElement(Fl,{...a},ke.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function tx(a){return ke.createElement(Fl,{...a},ke.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function nx(){return ke.createElement("div",{className:"Toastify__spinner"})}var vd={info:J0,warning:K0,success:ex,error:tx,spinner:nx},ax=a=>a in vd;function rx({theme:a,type:r,isLoading:s,icon:i}){let d=null,f={theme:a,type:r};return i===!1||(ha(i)?d=i({...f,isLoading:s}):v.isValidElement(i)?d=v.cloneElement(i,f):s?d=vd.spinner():ax(r)&&(d=vd[r](f))),d}var ox=a=>{let{isRunning:r,preventExitTransition:s,toastRef:i,eventHandlers:d,playToast:f}=Q0(a),{closeButton:g,children:p,autoClose:m,onClick:h,type:y,hideProgressBar:b,closeToast:S,transition:E,position:_,className:j,style:T,progressClassName:N,updateId:O,role:D,progress:L,rtl:$,toastId:V,deleteToast:H,isIn:C,isLoading:I,closeOnClick:U,theme:A,ariaLabel:ee}=a,oe=ur("Toastify__toast",`Toastify__toast-theme--${A}`,`Toastify__toast--${y}`,{"Toastify__toast--rtl":$},{"Toastify__toast--close-on-click":U}),G=ha(j)?j({rtl:$,position:_,type:y,defaultClassName:oe}):ur(oe,j),P=rx(a),R=!!L||!m,M={closeToast:S,type:y,theme:A},W=null;return g===!1||(ha(g)?W=g(M):v.isValidElement(g)?W=v.cloneElement(g,M):W=M0(M)),ke.createElement(E,{isIn:C,done:H,position:_,preventExitTransition:s,nodeRef:i,playToast:f},ke.createElement("div",{id:V,tabIndex:0,onClick:h,"data-in":C,className:G,...d,style:T,ref:i,...C&&{role:D,"aria-label":ee}},P!=null&&ke.createElement("div",{className:ur("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!I})},P),uh(p,a,!r),W,!a.customProgressBar&&ke.createElement(z0,{...O&&!R?{key:`p-${O}`}:{},rtl:$,theme:A,delay:m,isRunning:r,isIn:C,closeToast:S,hide:b,type:y,className:N,controlledProgress:R,progress:L||0})))},sx=(a,r=!1)=>({enter:`Toastify--animate Toastify__${a}-enter`,exit:`Toastify--animate Toastify__${a}-exit`,appendPosition:r}),lx=O0(sx("bounce",!0)),ix={position:"top-right",transition:lx,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:a=>a.altKey&&a.code==="KeyT"};function cx(a){let r={...ix,...a},s=a.stacked,[i,d]=v.useState(!0),f=v.useRef(null),{getToastToRender:g,isToastActive:p,count:m}=W0(r),{className:h,style:y,rtl:b,containerId:S,hotKeys:E}=r;function _(T){let N=ur("Toastify__toast-container",`Toastify__toast-container--${T}`,{"Toastify__toast-container--rtl":b});return ha(h)?h({position:T,rtl:b,defaultClassName:N}):ur(N,yd(h))}function j(){s&&(d(!0),ce.play())}return Z0(()=>{var T;if(s){let N=f.current.querySelectorAll('[data-in="true"]'),O=12,D=(T=r.position)==null?void 0:T.includes("top"),L=0,$=0;Array.from(N).reverse().forEach((V,H)=>{let C=V;C.classList.add("Toastify__toast--stacked"),H>0&&(C.dataset.collapsed=`${i}`),C.dataset.pos||(C.dataset.pos=D?"top":"bot");let I=L*(i?.2:1)+(i?0:O*H);C.style.setProperty("--y",`${D?I:I*-1}px`),C.style.setProperty("--g",`${O}`),C.style.setProperty("--s",`${1-(i?$:0)}`),L+=C.offsetHeight,$+=.025})}},[i,m,s]),v.useEffect(()=>{function T(N){var O;let D=f.current;E(N)&&((O=D.querySelector('[tabIndex="0"]'))==null||O.focus(),d(!1),ce.pause()),N.key==="Escape"&&(document.activeElement===D||D!=null&&D.contains(document.activeElement))&&(d(!0),ce.play())}return document.addEventListener("keydown",T),()=>{document.removeEventListener("keydown",T)}},[E]),ke.createElement("section",{ref:f,className:"Toastify",id:S,onMouseEnter:()=>{s&&(d(!1),ce.pause())},onMouseLeave:j,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":r["aria-label"]},g((T,N)=>{let O=N.length?{...y}:{...y,pointerEvents:"none"};return ke.createElement("div",{tabIndex:-1,className:_(T),"data-stacked":s,style:O,key:`c-${T}`},N.map(({content:D,props:L})=>ke.createElement(ox,{...L,stacked:s,collapseAll:j,isIn:p(L.toastId,L.containerId),key:`t-${L.key}`},D)))}))}function Ap({mode:a="login"}){const r=o0();v.useEffect(()=>()=>{E(""),j("")},[a]),v.useEffect(()=>{const K=new URLSearchParams(r.search).get("message");K&&E(decodeURIComponent(K))},[r]);const[s,i]=v.useState(""),[d,f]=v.useState(""),[g,p]=v.useState(""),[m,h]=v.useState(""),[y,b]=v.useState(!1),[S,E]=v.useState(""),[_,j]=v.useState(""),[T,N]=v.useState(""),[O,D]=v.useState(!1),[L,$]=v.useState(""),[V,H]=v.useState(!1),[C,I]=v.useState(""),[U,A]=v.useState(!1),[ee,oe]=v.useState(!1),G=ma(),P=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]).{8,}$/,R=te=>({length:te&&te.length>=8,lowercase:te&&/[a-z]/.test(te),uppercase:te&&/[A-Z]/.test(te),number:te&&/\d/.test(te),special:te&&/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(te)}),M=()=>!g||!m?null:g===m;function W(te){if(!te)return"";if(te.length<8)return"Too short";let K=0;return/[a-z]/.test(te)&&K++,/[A-Z]/.test(te)&&K++,/\d/.test(te)&&K++,/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]/.test(te)&&K++,K<=2?"Weak":K===3?"Medium":K===4?"Strong":""}ke.useEffect(()=>{N(W(g))},[g]);const se=async te=>{var K,ae;if(te.preventDefault(),E(""),j(""),a==="register"){if(!d.match(/^[^@]+@[^@]+\.[^@]+$/)){E("Please enter a valid email.");return}if(!P.test(g)){E("Password does not meet requirements.");return}if(g!==m){E("Passwords do not match.");return}}b(!0);try{const ue=await fetch(`/api/auth/${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a==="register"?{username:s,email:d,password:g}:{username:s,password:g})}),me=await ue.json();ue.ok&&me.token?(localStorage.setItem("token",me.token),j("Logged in!"),ce.success("Logged in!"),G("/")):ue.ok?(j("Registered! Please check your email to verify your account."),ce.success("Registered! Please check your email to verify your account."),G("/login")):E(me.error||me.message||((ae=(K=me.errors)==null?void 0:K[0])==null?void 0:ae.msg)||"An unknown error occurred. Please try again.")}catch{E("Network error")}b(!1)},he=async te=>{te.preventDefault(),A(!1),E("");try{const ae=await fetch("/api/auth/send-verification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:C})}),re=await ae.json();ae.ok?A(!0):E(re.error||"Error")}catch{E("Network error")}},fe=async te=>{te.preventDefault(),H(!1),E("");try{const re=await fetch("/api/auth/reset-password-request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:L})}),ue=await re.json();re.ok?H(!0):E(ue.error||"Error")}catch{E("Network error")}};return O?l.jsxs("form",{onSubmit:fe,className:"auth-form","aria-label":"Reset password form",children:[l.jsx("h2",{children:"Reset Password"}),l.jsx("div",{className:"form-group",children:l.jsx("input",{id:"resetEmail",type:"email",value:L,onChange:te=>$(te.target.value),placeholder:"Email",required:!0})}),V&&l.jsx("div",{className:"success-message",children:"If an account exists, a reset link has been sent."}),S&&l.jsx("div",{className:"error-message",children:S}),l.jsx("button",{type:"submit",className:"auth-button",children:"Send Reset Link"}),l.jsx("div",{className:"auth-link",children:l.jsx("a",{href:"#",onClick:te=>{te.preventDefault(),D(!1)},children:"Back to login"})})]}):ee?l.jsxs("form",{onSubmit:he,className:"auth-form","aria-label":"Resend verification form",children:[l.jsx("h2",{children:"Resend Verification Email"}),l.jsx("div",{className:"form-group",children:l.jsx("input",{type:"email",value:C,onChange:te=>I(te.target.value),placeholder:"Email",required:!0})}),l.jsx("button",{type:"submit",className:"auth-button",children:"Resend"}),U&&l.jsx("div",{className:"success-message",children:"Verification email sent."}),S&&l.jsx("div",{className:"error-message",children:S}),l.jsx("div",{className:"auth-link",children:l.jsx("a",{href:"#",onClick:te=>{te.preventDefault(),oe(!1)},children:"Back to login"})})]}):l.jsxs("form",{onSubmit:se,className:"auth-form","aria-label":a==="login"?"Login form":"Register form",children:[l.jsx("h2",{children:a==="login"?"Login":"Register"}),l.jsx("div",{className:"form-group",children:l.jsx("input",{id:"username",value:s,onChange:te=>i(te.target.value),placeholder:"Username",required:!0,minLength:3,"aria-required":"true",autoComplete:"username"})}),a==="register"&&l.jsx("div",{className:"form-group",children:l.jsx("input",{id:"email",type:"email",value:d,onChange:te=>f(te.target.value),placeholder:"Email",required:!0,"aria-required":"true",autoComplete:"email"})}),l.jsx("div",{className:"form-group",children:l.jsx("input",{id:"password",type:"password",value:g,onChange:te=>p(te.target.value),placeholder:"Password",required:!0,minLength:8,"aria-required":"true",autoComplete:a==="register"?"new-password":"current-password","aria-describedby":a==="register"?"password-req password-strength":void 0})}),a==="register"&&l.jsxs(l.Fragment,{children:[l.jsx("div",{id:"password-req",className:"password-requirements",children:(()=>{const te=R(g);return l.jsxs("div",{children:[l.jsxs("div",{className:`requirement ${te.length?"met":"unmet"}`,children:[l.jsx("span",{className:"checkmark",children:te.length?"✓":"○"}),"At least 8 characters"]}),l.jsxs("div",{className:`requirement ${te.lowercase?"met":"unmet"}`,children:[l.jsx("span",{className:"checkmark",children:te.lowercase?"✓":"○"}),"One lowercase letter"]}),l.jsxs("div",{className:`requirement ${te.uppercase?"met":"unmet"}`,children:[l.jsx("span",{className:"checkmark",children:te.uppercase?"✓":"○"}),"One uppercase letter"]}),l.jsxs("div",{className:`requirement ${te.number?"met":"unmet"}`,children:[l.jsx("span",{className:"checkmark",children:te.number?"✓":"○"}),"One number"]}),l.jsxs("div",{className:`requirement ${te.special?"met":"unmet"}`,children:[l.jsx("span",{className:"checkmark",children:te.special?"✓":"○"}),"One special character"]})]})})()}),l.jsxs("div",{id:"password-strength",className:`password-strength ${T.toLowerCase()}`,children:["Strength: ",T]})]}),a==="register"&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"form-group",children:l.jsx("input",{id:"confirmPassword",type:"password",value:m,onChange:te=>h(te.target.value),placeholder:"Confirm Password",required:!0,minLength:8,"aria-required":"true",autoComplete:"new-password"})}),m&&l.jsx("div",{className:"password-match",children:(()=>{const te=M();return l.jsxs("div",{className:`requirement ${te?"met":"unmet"}`,children:[l.jsx("span",{className:"checkmark",children:te?"✓":"✗"}),te?"Passwords match":"Passwords do not match"]})})()})]}),S&&l.jsx("div",{role:"alert",className:"error-message",children:S}),_&&l.jsx("div",{role:"status",className:"success-message",children:_}),l.jsx("button",{type:"submit",disabled:y,className:"auth-button",children:y?"Loading...":a==="login"?"Login":"Register"}),a==="login"&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"auth-link",children:l.jsx("a",{href:"#",onClick:te=>{te.preventDefault(),D(!0)},children:"Forgot password?"})}),l.jsx("div",{className:"auth-link",children:l.jsx("a",{href:"/register",children:"make an account"})}),l.jsx("div",{className:"auth-link",children:l.jsx("a",{href:"#",onClick:te=>{te.preventDefault(),oe(!0)},children:"Resend verification email"})})]}),a==="register"&&l.jsxs("div",{className:"auth-link",style:{fontSize:"13px"},children:["By creating an account, you agree to our ",l.jsx("a",{href:"/privacy",children:"Privacy Policy"})," and ",l.jsx("a",{href:"/terms",children:"Terms of Service"}),"."]})]})}async function dx(a){const s=await fetch("/api/otag-recommendations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cards:a})});if(!s.ok)throw new Error("Failed to fetch otag recommendations");return(await s.json()).topOtags}function yh(a){const r=a.split(/\r?\n/).map(f=>f.trim()).filter(Boolean),s=[],i=/^(\d+)\s+(.+?)\s+\(([^)]+)\)\s+(\S+)(?:\s+\*F\*)?$/i,d=/\*F\*/i;for(const f of r){const g=d.test(f),p=f.match(i);if(p){const[,m,h,y,b]=p;s.push({quantity:parseInt(m,10),name:h.trim(),set:y.trim(),collectorNumber:b.trim(),foil:g})}}return s}const Dp=["Alchemy","Alpha 40","Archon","Australian Highlander","Brawl","Canadian Highlander","Centurion","Commander / EDH","Conquest","Dandan","Duel Commander","European Highlander","Gladiator","Highlander Gauntlet","Historic","Legacy","Leviathan","Modern","Oathbreaker","Old School","Pauper","Pauper EDH","Pendragon","Penny Dreadful","Pioneer","PreDH","Premodern","Primordial","Russian Duel Commander","Standard","Standard Brawl","Timeless","Tiny Leaders","Value Vintage","Vintage","None"];function ux(){const[a,r]=v.useState(""),[s,i]=v.useState([]),[d,f]=v.useState(!1),[g,p]=v.useState([]),[m,h]=v.useState(""),[y,b]=v.useState(Dp[0]),S=(D,L,$)=>{const V=[...s];V[D]={...V[D],[L]:$},i(V)},E=()=>i([...s,{name:"",set:"",collectorNumber:"",count:1,foil:!1}]),_=D=>i(s.filter((L,$)=>$!==D)),j=()=>{const D=yh(m);if(D.length===0){ce.error("No valid cards found in decklist.");return}i(D),ce.success(`Imported ${D.length} cards!`)},T=async()=>{f(!0);try{const D=s.filter($=>$.name&&$.set&&$.collectorNumber).map($=>({name:$.name,set:$.set,collectorNumber:$.collectorNumber})),L=await dx(D);p(L)}catch{ce.error("Failed to fetch otag suggestions")}f(!1)},N=async(D,L)=>{try{if(window.digitalOnlyCards&&window.digitalOnlyCards[`${D}-${L}`]!==void 0)return window.digitalOnlyCards[`${D}-${L}`];const $=encodeURIComponent(D),V=encodeURIComponent(L),C=await(await fetch(`https://api.scryfall.com/cards/search?q=${$}+set:${V}`)).json();if(window.digitalOnlyCards||(window.digitalOnlyCards={}),C.data&&C.data.length>0){const I=C.data.some(U=>U.digital===!0||Array.isArray(U.games)&&!U.games.includes("paper"));return window.digitalOnlyCards[`${D}-${L}`]=I,I}return!1}catch($){return console.error("Error checking digital status:",$),!1}},O=async D=>{var L,$;D.preventDefault(),f(!0);try{let V=!1;const H=[];for(const ee of s)ee.name&&ee.set&&await N(ee.name,ee.set)&&(V=!0,H.push(ee.name));if(V&&!window.confirm(`Warning: This deck contains digital-only cards (${H.join(", ")}) which cannot be used in paper play.

Do you want to continue?`)){f(!1);return}const C=localStorage.getItem("token"),U=await fetch("/api/decks",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`},body:JSON.stringify({name:a,cards:s,format:y,hasDigitalOnlyCards:V})}),A=await U.json();U.ok?(ce.success("Deck saved!"),r(""),i([]),h("")):ce.error(A.error||(($=(L=A.errors)==null?void 0:L[0])==null?void 0:$.msg)||"Error")}catch(V){console.error("Error submitting deck:",V),ce.error("Network error")}f(!1)};return l.jsxs("div",{style:{display:"flex",maxWidth:900,margin:"2rem auto"},children:[l.jsxs("div",{style:{flex:"0 0 260px",marginRight:32},children:[l.jsx("div",{style:{width:240,height:340,background:"#eee",borderRadius:8,marginBottom:16,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",fontSize:18},children:"Card Preview"}),l.jsx("button",{type:"button",onClick:T,disabled:d||s.length===0,style:{width:"100%",marginBottom:8},children:d?"Loading Otag Suggestions...":"Suggest Otag Tags"}),g.length>0&&l.jsxs("div",{style:{margin:"1rem 0",padding:"0.5rem",background:"#f6f6f6",borderRadius:4},children:[l.jsx("strong",{children:"Recommended Otag Tags:"}),l.jsx("ul",{children:g.map(({tag:D,count:L})=>l.jsxs("li",{children:[D," (",L,")"]},D))})]})]}),l.jsxs("form",{onSubmit:O,style:{flex:1,maxWidth:400},children:[l.jsx("h2",{children:"Deck Builder"}),l.jsx("input",{value:a,onChange:D=>r(D.target.value),placeholder:"Deck Name",required:!0,style:{width:"100%",marginBottom:8,padding:8}}),l.jsxs("div",{style:{marginBottom:12},children:[l.jsx("label",{style:{display:"block",fontWeight:500,marginBottom:4},children:"Format"}),l.jsx("select",{value:y,onChange:D=>b(D.target.value),style:{width:"100%",marginBottom:8,padding:8,borderRadius:4,border:"1px solid #bbb"},children:Dp.map(D=>l.jsx("option",{value:D,children:D},D))})]}),l.jsxs("div",{style:{marginBottom:12},children:[l.jsx("textarea",{value:m,onChange:D=>h(D.target.value),placeholder:"Paste Moxfield/MTG decklist here",rows:6,style:{width:"100%",padding:8,fontFamily:"monospace"}}),l.jsx("button",{type:"button",onClick:j,style:{marginTop:4,marginBottom:8},children:"Import Decklist"})]}),s.length>0&&l.jsxs("div",{style:{marginBottom:8},children:[l.jsx("strong",{children:"Cards:"}),s.map((D,L)=>l.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:4,gap:4},children:[l.jsx("input",{value:D.name,onChange:$=>S(L,"name",$.target.value),placeholder:"Name",required:!0,style:{flex:2,padding:6}}),l.jsx("input",{value:D.set,onChange:$=>S(L,"set",$.target.value),placeholder:"Set",required:!0,style:{width:50,padding:6}}),l.jsx("input",{value:D.collectorNumber,onChange:$=>S(L,"collectorNumber",$.target.value),placeholder:"#",required:!0,style:{width:50,padding:6}}),l.jsx("input",{type:"number",min:1,value:D.count,onChange:$=>S(L,"count",parseInt($.target.value,10)||1),placeholder:"Count",style:{width:45,padding:6}}),l.jsxs("label",{style:{fontSize:12},children:[l.jsx("input",{type:"checkbox",checked:!!D.foil,onChange:$=>S(L,"foil",$.target.checked)}),"Foil"]}),l.jsx("button",{type:"button",onClick:()=>_(L),disabled:s.length===1,children:"-"})]},L)),l.jsx("button",{type:"button",onClick:E,style:{marginBottom:8},children:"Add Card"})]}),l.jsx("button",{type:"submit",disabled:d,style:{width:"100%",padding:8},children:d?"Saving...":"Save Deck"})]})]})}class Jr{static get(r){try{const i=this.getCache()[r];if(!i)return null;const f=Date.now()-i.timestamp,g=this.CACHE_EXPIRY_HOURS*60*60*1e3;return f>g?(this.remove(r),null):i.data}catch(s){return console.error("[PrintingCache] Error reading cache:",s),null}}static set(r,s,i){try{if(!r||!s)return;const d=this.getCache(),f=Object.keys(d);if(f.length>=this.MAX_CACHE_SIZE){const g=f.map(m=>({key:m,timestamp:d[m].timestamp})).sort((m,h)=>m.timestamp-h.timestamp),p=Math.floor(this.MAX_CACHE_SIZE*.2);for(let m=0;m<p;m++)delete d[g[m].key]}d[r]={data:{printings:s,selectedPrinting:i},timestamp:Date.now(),version:this.CACHE_VERSION},this.saveCache(d)}catch(d){console.error("[PrintingCache] Error writing cache:",d)}}static remove(r){try{const s=this.getCache();delete s[r],this.saveCache(s)}catch(s){console.error("[PrintingCache] Error removing from cache:",s)}}static has(r){return this.get(r)!==null}static seedFromExistingData(r,s){try{return!1}catch(i){return console.error(`[PrintingCache] Error seeding cache for ${r}:`,i),!1}}static seedFromDeckCards(r){if(!Array.isArray(r))return 0;let s=0;const i=new Map;r.forEach(d=>{var f,g,p,m;try{let h=null,y=null;(g=(f=d.cardObj)==null?void 0:f.card)!=null&&g.name?(h=d.cardObj.card.name,y=d.cardObj.card.scryfall_json||d.cardObj.scryfall_json):(p=d.cardObj)!=null&&p.name?(h=d.cardObj.name,y=d.cardObj.scryfall_json):d.name?(h=d.name,y=d.scryfall_json):(m=d.card)!=null&&m.name&&(h=d.card.name,y=d.card.scryfall_json),h&&y&&y.id&&!i.has(h)&&i.set(h,y)}catch(h){console.warn("[PrintingCache] Error processing deck card for seeding:",h)}});for(const[d,f]of i)this.seedFromExistingData(d,f)&&s++;return s}static getCache(){try{const r=localStorage.getItem(this.STORAGE_KEY);if(!r)return{};const s=JSON.parse(r);return s._version!==this.CACHE_VERSION?(localStorage.removeItem(this.STORAGE_KEY),{}):s}catch(r){return console.error("[PrintingCache] Error parsing cache, clearing:",r),localStorage.removeItem(this.STORAGE_KEY),{}}}static saveCache(r){try{r._version=this.CACHE_VERSION,r._lastUpdated=Date.now(),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(r))}catch(s){if(s.name==="QuotaExceededError"){this.clearOldEntries();try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(r))}catch(i){console.error("[PrintingCache] Still cannot save after clearing:",i)}}else console.error("[PrintingCache] Error saving cache:",s)}}static clearOldEntries(){try{const r=this.getCache(),s=Date.now(),i=this.CACHE_EXPIRY_HOURS*60*60*1e3;let d=0;for(const[f,g]of Object.entries(r))f.startsWith("_")||s-g.timestamp>i&&(delete r[f],d++);this.saveCache(r)}catch(r){console.error("[PrintingCache] Error clearing old entries:",r)}}static getStats(){try{const r=this.getCache(),s=Object.keys(r).filter(d=>!d.startsWith("_")),i=JSON.stringify(r).length;return{entries:s.length,totalSizeKB:Math.round(i/1024),maxEntries:this.MAX_CACHE_SIZE,cacheVersion:this.CACHE_VERSION}}catch(r){return console.error("[PrintingCache] Error getting stats:",r),{entries:0,totalSizeKB:0,maxEntries:this.MAX_CACHE_SIZE,cacheVersion:this.CACHE_VERSION}}}static clear(){try{localStorage.removeItem(this.STORAGE_KEY)}catch(r){console.error("[PrintingCache] Error clearing cache:",r)}}static async preloadCommonCards(){const r=["Forest","Island","Mountain","Plains","Swamp","Wastes","Snow-Covered Forest","Snow-Covered Island","Snow-Covered Mountain","Snow-Covered Plains","Snow-Covered Swamp","Snow-Covered Wastes","Sol Ring","Command Tower","Arcane Signet","Lightning Bolt","Counterspell","Swords to Plowshares","Path to Exile","Rampant Growth","Cultivate","Kodama's Reach","Atraxa, Praetors' Voice","Edgar Markov","Korvold, Fae-Cursed King","Mana Crypt","Mana Vault","Chrome Mox","Mystical Tutor"];try{await this.prefetchCards(r,(s,i)=>{s%5})}catch(s){console.warn("[PrintingCache] ⚠️ Some common cards failed to preload:",s)}}static warmUpCard(r){return this.has(r)?Promise.resolve():this.fetchAndCacheCard(r).catch(s=>{})}static async prefetchCards(r,s){const i=r.filter(p=>!this.has(p));if(i.length===0)return;const d=6,f=2,g=[];for(let p=0;p<i.length;p+=d)g.push(i.slice(p,p+d));for(let p=0;p<g.length;p+=f){const h=g.slice(p,p+f).map(async(y,b)=>{const S=p+b,E=y.map(async(_,j)=>{try{await this.fetchAndCacheCard(_);const T=S*d+j+1;s&&s(T,i.length)}catch{}});await Promise.all(E)});await Promise.all(h),p+f<g.length&&await new Promise(y=>setTimeout(y,50))}}static async fetchAndCacheCard(r){try{const i=`https://constant-lists-api.onrender.com/api/cards/printings?name=${encodeURIComponent(r)}`,d=await fetch(i);if(!d.ok)throw new Error(`API error: ${d.status}`);const f=await d.json();if(!Array.isArray(f.data)||f.data.length===0)throw new Error("No printings found");const g=f.data.slice(0,20),p=g[0];return this.set(r,g,p),{printings:g,selectedPrinting:p}}catch(s){throw console.error(`[PrintingCache] Error fetching ${r}:`,s),s}}}lr(Jr,"STORAGE_KEY","printingsCache"),lr(Jr,"CACHE_VERSION","1.0"),lr(Jr,"MAX_CACHE_SIZE",1e3),lr(Jr,"CACHE_EXPIRY_HOURS",24);function as({children:a}){console.log("RequireAuth rendered");const r=ma();return v.useEffect(()=>{localStorage.getItem("token")||r("/login")},[r]),a}function fx(){const[a,r]=v.useState(null),[s,i]=v.useState([]),[d,f]=v.useState(!0),[g,p]=v.useState([]),[m,h]=v.useState(!1),[y,b]=v.useState(""),[S,E]=v.useState(""),[_,j]=v.useState(""),[T,N]=v.useState("");if(v.useEffect(()=>{const H=localStorage.getItem("token");H&&Promise.all([fetch("/api/users/me",{headers:{Authorization:`Bearer ${H}`}}).then(I=>I.json()),fetch("/api/decks/mine",{headers:{Authorization:`Bearer ${H}`}}).then(I=>I.json()),fetch("/api/auth/sessions",{headers:{Authorization:`Bearer ${H}`}}).then(I=>I.json())]).then(([C,I,U])=>{r(C),i(I),p(U),f(!1)})},[]),d)return l.jsx("div",{className:"container",children:"Loading..."});if(!a)return l.jsx("div",{className:"container",children:"Not logged in."});const O=async()=>{if(!window.confirm("Are you sure you want to delete your account? This cannot be undone."))return;const H=localStorage.getItem("token");(await fetch("/api/auth/delete-account",{method:"DELETE",headers:{Authorization:`Bearer ${H}`}})).ok?(localStorage.removeItem("token"),window.location.href="/"):alert("Error deleting account")},D=async()=>{j(""),h(!0);const H=localStorage.getItem("token"),I=await(await fetch("/api/auth/2fa/setup",{method:"POST",headers:{Authorization:`Bearer ${H}`}})).json();I.qr?b(I.qr):j(I.error||"Error generating QR")},L=async H=>{H.preventDefault(),j("");const C=localStorage.getItem("token"),I=await fetch("/api/auth/2fa/verify",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`},body:JSON.stringify({token:S})}),U=await I.json();I.ok?(j("2FA enabled!"),h(!1),r({...a,twoFactorEnabled:!0})):j(U.error||"Error verifying 2FA")},$=async()=>{j("");const H=localStorage.getItem("token");(await fetch("/api/auth/2fa/disable",{method:"POST",headers:{Authorization:`Bearer ${H}`}})).ok?(r({...a,twoFactorEnabled:!1}),j("2FA disabled")):j("Error disabling 2FA")},V=async H=>{N("");const C=localStorage.getItem("token");(await fetch("/api/auth/sessions/revoke",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`},body:JSON.stringify({jwtId:H})})).ok?(p(g.map(U=>U.jwtId===H?{...U,revoked:!0}:U)),N("Session revoked")):N("Error revoking session")};return l.jsxs("div",{className:"container",children:[l.jsx("h2",{children:"Profile"}),l.jsxs("div",{children:[l.jsx("strong",{children:"Username:"})," ",a.username]}),l.jsx("h3",{children:"Your Decks"}),l.jsx("ul",{children:s.map(H=>l.jsxs("li",{children:[H.name," (",H.cards.length," cards)"]},H._id))}),l.jsx("button",{onClick:O,style:{background:"#c00",color:"#fff",marginTop:16},children:"Delete Account"}),l.jsx("hr",{style:{margin:"24px 0"}}),l.jsx("h3",{children:"Security"}),l.jsxs("div",{children:[l.jsx("strong",{children:"Two-Factor Authentication (2FA):"}),a.twoFactorEnabled?l.jsxs(l.Fragment,{children:[l.jsx("span",{style:{color:"green",marginLeft:8},children:"Enabled"}),l.jsx("button",{onClick:$,style:{marginLeft:16},children:"Disable 2FA"})]}):l.jsxs(l.Fragment,{children:[l.jsx("span",{style:{color:"red",marginLeft:8},children:"Disabled"}),l.jsx("button",{onClick:D,style:{marginLeft:16},children:"Enable 2FA"})]}),_&&l.jsx("div",{style:{marginTop:8,color:_.includes("enabled")?"green":"red"},children:_}),m&&y&&l.jsxs("form",{onSubmit:L,style:{marginTop:16},children:[l.jsx("div",{children:"Scan this QR code with your authenticator app:"}),l.jsx("img",{src:y,alt:"2FA QR",style:{margin:"12px 0",width:180,height:180}}),l.jsxs("div",{children:[l.jsx("input",{type:"text",value:S,onChange:H=>E(H.target.value),placeholder:"Enter 6-digit code",required:!0,style:{width:120,marginRight:8}}),l.jsx("button",{type:"submit",children:"Verify"})]})]})]}),l.jsxs("div",{style:{marginTop:32},children:[l.jsx("strong",{children:"Active Sessions:"}),T&&l.jsx("div",{style:{color:"green",marginBottom:8},children:T}),l.jsx("ul",{children:g.map(H=>l.jsxs("li",{style:{opacity:H.revoked?.5:1},children:[H.userAgent," — ",new Date(H.createdAt).toLocaleString()," ",H.revoked?l.jsx("span",{style:{color:"red"},children:"(revoked)"}):l.jsx("button",{onClick:()=>V(H.jwtId),style:{marginLeft:8},children:"Revoke"})]},H.jwtId))})]})]})}function gx(){const[a,r]=v.useState(null),[s,i]=v.useState([]),[d,f]=v.useState([]),[g,p]=v.useState(!0),[m,h]=v.useState(1),[y,b]=v.useState(1),[S,E]=v.useState(null),[_,j]=v.useState(!1),T="",N=localStorage.getItem("token"),O=async()=>{try{const C=await fetch(`${T}/api/admin/analytics`,{headers:{Authorization:`Bearer ${N}`}});if(!C.ok){if(C.status===403){ce.error("Admin access required");return}throw new Error("Failed to fetch analytics")}const I=await C.json();r(I)}catch(C){console.error("Analytics error:",C),ce.error("Failed to load analytics")}},D=async(C=1)=>{try{p(!0);const I=await fetch(`${T}/api/admin/users?page=${C}&limit=25`,{headers:{Authorization:`Bearer ${N}`}});if(!I.ok)throw new Error("Failed to fetch users");const U=await I.json();i(U.users),b(U.pagination.pages),h(C)}catch(I){console.error("Users error:",I),ce.error("Failed to load users")}finally{p(!1)}},L=async C=>{try{const I=await fetch(`${T}/api/admin/users/${C}`,{headers:{Authorization:`Bearer ${N}`}});if(!I.ok)throw new Error("Failed to fetch user details");const U=await I.json();E(U),j(!0)}catch(I){console.error("User details error:",I),ce.error("Failed to load user details")}},$=async(C,I)=>{if(confirm(`Are you sure you want to delete user "${I}" and all their data?`))try{const U=await fetch(`${T}/api/admin/users/${C}`,{method:"DELETE",headers:{Authorization:`Bearer ${N}`}});if(!U.ok)throw new Error("Failed to delete user");const A=await U.json();ce.success(`Deleted user ${I} and ${A.deletedDecks} decks`),D(m),O()}catch(U){console.error("Delete error:",U),ce.error("Failed to delete user")}},V=async C=>{if(d.length===0){ce.error("No users selected");return}if(!(C==="delete"&&!confirm(`Delete ${d.length} users and all their data?`)))try{const I=await fetch(`${T}/api/admin/bulk-operations`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`},body:JSON.stringify({operation:C,userIds:d})});if(!I.ok)throw new Error("Bulk operation failed");const U=await I.json();if(C==="delete")ce.success(`Deleted ${U.deletedUsers} users and ${U.deletedDecks} decks`),f([]),D(m),O();else if(C==="export"){const A=new Blob([JSON.stringify(U.users,null,2)],{type:"application/json"}),ee=URL.createObjectURL(A),oe=document.createElement("a");oe.href=ee,oe.download=`users-export-${new Date().toISOString().split("T")[0]}.json`,oe.click(),ce.success(`Exported ${U.count} users`)}}catch(I){console.error("Bulk operation error:",I),ce.error("Bulk operation failed")}},H=C=>{f(I=>I.includes(C)?I.filter(U=>U!==C):[...I,C])};return v.useEffect(()=>{O(),D()},[]),g&&!a?l.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:l.jsx("h2",{children:"Loading Admin Dashboard..."})}):l.jsxs("div",{style:{padding:"2rem",maxWidth:"1200px",margin:"0 auto"},children:[l.jsx("h1",{style:{marginBottom:"2rem",color:"#333"},children:"🛡️ Admin Dashboard"}),a&&l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[l.jsxs("div",{style:{background:"#f8f9fa",padding:"1.5rem",borderRadius:"8px",border:"1px solid #dee2e6"},children:[l.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"#2196f3"},children:"Total Users"}),l.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#333"},children:a.summary.totalUsers})]}),l.jsxs("div",{style:{background:"#f8f9fa",padding:"1.5rem",borderRadius:"8px",border:"1px solid #dee2e6"},children:[l.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"#4caf50"},children:"New This Week"}),l.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#333"},children:a.summary.recentUsers})]}),l.jsxs("div",{style:{background:"#f8f9fa",padding:"1.5rem",borderRadius:"8px",border:"1px solid #dee2e6"},children:[l.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"#ff9800"},children:"Total Decks"}),l.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#333"},children:a.summary.totalDecks})]}),l.jsxs("div",{style:{background:"#f8f9fa",padding:"1.5rem",borderRadius:"8px",border:"1px solid #dee2e6"},children:[l.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"#9c27b0"},children:"Public Decks"}),l.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#333"},children:a.summary.publicDecks})]})]}),l.jsxs("div",{style:{marginBottom:"1rem",display:"flex",gap:"1rem",alignItems:"center"},children:[l.jsxs("span",{style:{fontWeight:"500"},children:[d.length," users selected"]}),d.length>0&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>V("export"),style:{padding:"8px 16px",backgroundColor:"#2196f3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"📤 Export Selected"}),l.jsx("button",{onClick:()=>V("delete"),style:{padding:"8px 16px",backgroundColor:"#f44336",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"🗑️ Delete Selected"})]})]}),l.jsx("div",{style:{background:"white",borderRadius:"8px",border:"1px solid #dee2e6",overflow:"hidden"},children:l.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[l.jsx("thead",{style:{backgroundColor:"#f8f9fa"},children:l.jsxs("tr",{children:[l.jsx("th",{style:{padding:"1rem",textAlign:"left",borderBottom:"1px solid #dee2e6"},children:l.jsx("input",{type:"checkbox",checked:d.length===s.length&&s.length>0,onChange:C=>{C.target.checked?f(s.map(I=>I.id)):f([])}})}),l.jsx("th",{style:{padding:"1rem",textAlign:"left",borderBottom:"1px solid #dee2e6"},children:"Username"}),l.jsx("th",{style:{padding:"1rem",textAlign:"left",borderBottom:"1px solid #dee2e6"},children:"Email"}),l.jsx("th",{style:{padding:"1rem",textAlign:"left",borderBottom:"1px solid #dee2e6"},children:"Decks"}),l.jsx("th",{style:{padding:"1rem",textAlign:"left",borderBottom:"1px solid #dee2e6"},children:"Joined"}),l.jsx("th",{style:{padding:"1rem",textAlign:"left",borderBottom:"1px solid #dee2e6"},children:"Actions"})]})}),l.jsx("tbody",{children:s.map(C=>l.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[l.jsx("td",{style:{padding:"1rem"},children:l.jsx("input",{type:"checkbox",checked:d.includes(C.id),onChange:()=>H(C.id)})}),l.jsx("td",{style:{padding:"1rem",fontWeight:"500"},children:C.username}),l.jsx("td",{style:{padding:"1rem",color:"#666"},children:C.email}),l.jsx("td",{style:{padding:"1rem"},children:C.deckCount}),l.jsx("td",{style:{padding:"1rem",color:"#666"},children:new Date(C.createdAt).toLocaleDateString()}),l.jsx("td",{style:{padding:"1rem"},children:l.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[l.jsx("button",{onClick:()=>L(C.id),style:{padding:"4px 8px",backgroundColor:"#2196f3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"View"}),l.jsx("button",{onClick:()=>$(C.id,C.username),style:{padding:"4px 8px",backgroundColor:"#f44336",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Delete"})]})})]},C.id))})]})}),l.jsxs("div",{style:{marginTop:"1rem",textAlign:"center"},children:[l.jsx("button",{onClick:()=>D(m-1),disabled:m<=1,style:{padding:"8px 16px",margin:"0 4px",backgroundColor:m<=1?"#ccc":"#2196f3",color:"white",border:"none",borderRadius:"4px",cursor:m<=1?"not-allowed":"pointer"},children:"Previous"}),l.jsxs("span",{style:{margin:"0 1rem"},children:["Page ",m," of ",y]}),l.jsx("button",{onClick:()=>D(m+1),disabled:m>=y,style:{padding:"8px 16px",margin:"0 4px",backgroundColor:m>=y?"#ccc":"#2196f3",color:"white",border:"none",borderRadius:"4px",cursor:m>=y?"not-allowed":"pointer"},children:"Next"})]}),_&&S&&l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:l.jsxs("div",{style:{backgroundColor:"white",padding:"2rem",borderRadius:"8px",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflow:"auto"},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[l.jsxs("h2",{style:{margin:0},children:["User Details: ",S.user.username]}),l.jsx("button",{onClick:()=>j(!1),style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer"},children:"✕"})]}),l.jsxs("div",{style:{marginBottom:"1rem"},children:[l.jsx("strong",{children:"Email:"})," ",S.user.email,l.jsx("br",{}),l.jsx("strong",{children:"User ID:"})," ",S.user.id,l.jsx("br",{}),l.jsx("strong",{children:"Joined:"})," ",new Date(S.user.createdAt).toLocaleString(),l.jsx("br",{}),l.jsx("strong",{children:"Last Seen:"})," ",new Date(S.user.lastSeen).toLocaleString()]}),l.jsxs("h3",{children:["Decks (",S.decks.length,")"]}),S.decks.length>0?l.jsx("div",{style:{maxHeight:"300px",overflow:"auto"},children:S.decks.map(C=>l.jsxs("div",{style:{padding:"0.5rem",border:"1px solid #eee",borderRadius:"4px",marginBottom:"0.5rem"},children:[l.jsx("strong",{children:C.name})," (",C.format,")",l.jsx("br",{}),l.jsxs("small",{style:{color:"#666"},children:["Created: ",new Date(C.createdAt).toLocaleDateString(),C.updatedAt&&` • Updated: ${new Date(C.updatedAt).toLocaleDateString()}`]})]},C.id))}):l.jsx("p",{style:{color:"#666"},children:"No decks created yet"})]})})]})}class Rp extends ke.Component{constructor(r){super(r),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(r){return{hasError:!0}}componentDidCatch(r,s){console.error("[ERROR BOUNDARY] Caught error:"),console.error(r),console.error("[ERROR BOUNDARY] Error info:"),console.error(s),r&&r.message&&r.message.includes("forEach")&&(console.error("[ERROR BOUNDARY] forEach error detected!"),console.error("[ERROR BOUNDARY] Error stack:",r.stack)),this.setState({error:r,errorInfo:s||null})}render(){return this.state.hasError?l.jsxs("div",{style:{padding:"20px",backgroundColor:"#fee",border:"1px solid #faa"},children:[l.jsx("h2",{children:"Something went wrong."}),l.jsxs("details",{style:{whiteSpace:"pre-wrap"},children:[l.jsx("summary",{children:"Error details"}),this.state.error&&this.state.error.toString(),l.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]}),l.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null,errorInfo:null}),style:{marginTop:"10px",padding:"5px 10px"},children:"Try Again"})]}):this.props.children}}class Np extends ke.Component{constructor(s){super(s);lr(this,"handleRetry",()=>{this.setState({hasError:!1,errorCount:0,lastError:null})});this.state={hasError:!1,errorCount:0,lastError:null}}static getDerivedStateFromError(s){return{hasError:!0}}componentDidCatch(s,i){console.error("[SAFE WRAPPER] Caught DeckViewEdit error:",s),console.error("[SAFE WRAPPER] Error info:",i),this.setState(d=>({hasError:!0,errorCount:d.errorCount+1,lastError:s})),s.message&&s.message.includes("forEach")&&(console.log("[SAFE WRAPPER] forEach error detected, attempting recovery in 1 second..."),setTimeout(()=>{this.setState({hasError:!1})},1e3))}render(){return this.state.hasError?l.jsxs("div",{style:{padding:"20px",backgroundColor:"#fee",border:"1px solid #faa",borderRadius:"8px",margin:"20px"},children:[l.jsx("h2",{children:"🛠️ Deck Loading Issue"}),l.jsx("p",{children:"The deck editor encountered a technical issue. This is likely a temporary problem."}),l.jsxs("div",{style:{marginBottom:"15px"},children:[l.jsx("strong",{children:"Error Count:"})," ",this.state.errorCount]}),this.state.lastError&&l.jsxs("details",{style:{marginBottom:"15px"},children:[l.jsx("summary",{children:"Technical Details"}),l.jsxs("pre",{style:{background:"#f5f5f5",padding:"10px",fontSize:"12px",overflow:"auto"},children:[this.state.lastError.message,this.state.lastError.stack&&`

Stack:
`+this.state.lastError.stack]})]}),l.jsxs("div",{style:{display:"flex",gap:"10px"},children:[l.jsx("button",{onClick:this.handleRetry,style:{padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Try Again"}),l.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"8px 16px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Refresh Page"})]}),l.jsxs("div",{style:{marginTop:"15px",fontSize:"14px",color:"#666"},children:[l.jsxs("p",{children:["💡 ",l.jsx("strong",{children:"If this keeps happening:"})]}),l.jsxs("ul",{style:{margin:"5px 0",paddingLeft:"20px"},children:[l.jsx("li",{children:"Try refreshing the page"}),l.jsx("li",{children:"Check your internet connection"}),l.jsx("li",{children:"The issue may resolve automatically"})]})]})]}):this.props.children}}function px(){const a=ma(),r=!!localStorage.getItem("token"),[s,i]=v.useState(0),[d,f]=v.useState(0);v.useEffect(()=>{const p=()=>{try{const S=localStorage.getItem("shoppingCart");if(S){const _=JSON.parse(S).reduce((j,T)=>j+parseInt(T.quantity||1),0);i(_)}else i(0)}catch(S){console.error("Error reading cart from localStorage:",S),i(0)}},m=()=>{try{const S=localStorage.getItem("global-wishlist");if(S){const _=JSON.parse(S).reduce((j,T)=>j+parseInt(T.count||1),0);f(_)}else f(0)}catch(S){console.error("Error reading wishlist from localStorage:",S),f(0)}};p(),m();const h=S=>{S.key==="shoppingCart"?p():S.key==="global-wishlist"&&m()};window.addEventListener("storage",h);const y=()=>{p()},b=()=>{m()};return window.addEventListener("cartUpdated",y),window.addEventListener("wishlistUpdated",b),()=>{window.removeEventListener("storage",h),window.removeEventListener("cartUpdated",y),window.removeEventListener("wishlistUpdated",b)}},[]);const g=()=>{localStorage.removeItem("token"),a("/login")};return l.jsxs("nav",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",background:"#1976d2",color:"#fff",padding:"0.5rem 2rem",marginBottom:24,position:"relative",zIndex:1e3},children:[l.jsx("div",{style:{fontWeight:"bold",fontSize:22},children:l.jsx(Hn,{to:"/home",style:{color:"#fff",textDecoration:"none"},children:"Constant Lists"})}),l.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center"},children:[l.jsx(Hn,{to:"/research",style:{color:"#fff"},children:"Research"}),l.jsx(Hn,{to:"/build",style:{color:"#fff"},children:"Build"}),l.jsx(Hn,{to:"/collect",style:{color:"#fff"},children:"Collect"}),l.jsx(Hn,{to:"/trade",style:{color:"#fff"},children:"Trade"}),l.jsxs(Hn,{to:"/wishlist",style:{color:"#fff",display:"flex",alignItems:"center",position:"relative",textDecoration:"none"},title:"Wishlist",children:[l.jsx("img",{src:"/svgs/heart-outline.svg",alt:"Wishlist",style:{width:"12px",height:"12px",opacity:.8}}),d>0&&l.jsx("span",{style:{position:"absolute",top:"-8px",right:"-8px",background:"#ef4444",color:"white",borderRadius:"50%",width:"16px",height:"16px",fontSize:"10px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",minWidth:"16px"},children:d>99?"99+":d})]}),l.jsxs(Hn,{to:"/shopping-cart",style:{color:"#fff",display:"flex",alignItems:"center",position:"relative",textDecoration:"none"},title:"Shopping Cart",children:[l.jsx("img",{src:"/svgs/shopping-cart-outline.svg",alt:"Shopping Cart",style:{width:"12px",height:"12px",opacity:.8}}),s>0&&l.jsx("span",{style:{position:"absolute",top:"-8px",right:"-8px",background:"#ef4444",color:"white",borderRadius:"50%",width:"16px",height:"16px",fontSize:"10px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",minWidth:"16px"},children:s>99?"99+":s})]}),r&&l.jsx(Hn,{to:"/profile",style:{color:"#fff"},children:"Profile"}),!r&&l.jsx(Hn,{to:"/login",style:{color:"#fff"},children:"Login"}),r&&l.jsx("button",{onClick:g,style:{background:"none",border:"none",color:"#fff",cursor:"pointer"},children:"Logout"})]})]})}const hx=({card:a,onOracleTagSearch:r})=>{var O,D,L,$,V,H;const[s,i]=v.useState([]),[d,f]=v.useState(!0),[g,p]=v.useState(null),[m,h]=v.useState(new Map);v.useEffect(()=>{var ee,oe;const C=()=>window.productionOtagSystem&&window.productionOtagSystem.isReady?(console.log("[OracleTagsIntegration] Production OTAG System is ready"),f(!1),!0):!1,I=G=>{var P;console.log("[OracleTagsIntegration] OTAG database loaded with stats:",(P=G.detail)==null?void 0:P.stats),f(!1),a&&b(a)};if(window.addEventListener("otagDatabaseLoaded",I),C()){const G=(oe=(ee=window.productionOtagSystem)==null?void 0:ee.getStats)==null?void 0:oe.call(ee);return G&&G.totalCards>1e3&&(console.log("[OracleTagsIntegration] Database already loaded with",G.totalCards,"cards"),f(!1)),()=>{window.removeEventListener("otagDatabaseLoaded",I)}}const U=setInterval(()=>{C()&&clearInterval(U)},500),A=setTimeout(()=>{console.log("[OracleTagsIntegration] Timeout waiting for Production OTAG System"),clearInterval(U),f(!1)},3e4);return()=>{clearInterval(U),clearTimeout(A),window.removeEventListener("otagDatabaseLoaded",I)}},[a]);const y=v.useCallback(C=>{var I,U,A,ee,oe;return C!=null&&C.name?C.name:(I=C==null?void 0:C.cardObj)!=null&&I.name?C.cardObj.name:(A=(U=C==null?void 0:C.cardObj)==null?void 0:U.card)!=null&&A.name?C.cardObj.card.name:(ee=C==null?void 0:C.scryfall_json)!=null&&ee.name?C.scryfall_json.name:(oe=C==null?void 0:C.card)!=null&&oe.name?C.card.name:typeof C=="string"?C:null},[]),b=v.useCallback(C=>{var U,A,ee,oe,G;const I=y(C);if(I&&window.productionOtagSystem&&window.productionOtagSystem.isReady){console.log(`[OracleTagsIntegration] Getting tags for: ${I}`),console.log("[OracleTagsIntegration] OTAG System Stats:",{totalCards:(U=window.productionOtagSystem.stats)==null?void 0:U.totalCards,totalOtags:(A=window.productionOtagSystem.stats)==null?void 0:A.totalOtags,isReady:window.productionOtagSystem.isReady,hasDatabase:!!window.productionOtagSystem.otagDatabase,databaseSize:(ee=window.productionOtagSystem.otagDatabase)==null?void 0:ee.size});const P=window.productionOtagSystem.getTagsForCard(I);if(i(P||[]),console.log(`[OracleTagsIntegration] Found ${(P||[]).length} tags for ${I}`),!P||P.length===0){const R=I.toLowerCase().trim(),M=(oe=window.productionOtagSystem.otagDatabase)==null?void 0:oe.has(R);if(console.log(`[OracleTagsIntegration] Card "${I}" (key: "${R}") exists in database: ${M}`),((G=window.productionOtagSystem.otagDatabase)==null?void 0:G.size)>0){const W=Array.from(window.productionOtagSystem.otagDatabase.keys()).slice(0,5);console.log("[OracleTagsIntegration] Sample cards in database:",W)}}}else console.log(`[OracleTagsIntegration] OTAG system not ready for: ${I}`),i([])},[y]);v.useEffect(()=>{var C;if(a&&!d)b(a);else if(a){const I=y(a);console.log(`[OracleTagsIntegration] OTAG system not ready for: ${I}`,{hasSystem:!!window.productionOtagSystem,isReady:(C=window.productionOtagSystem)==null?void 0:C.isReady,loading:d}),i([])}},[a,d,b,y]);const S=v.useCallback(C=>{console.log(`[OracleTagsIntegration] 🔍 Oracle tag clicked: ${C}`),r?r(C):alert(`Searching for cards with oracle tag: "${C}"

This would normally trigger a search in your app.`)},[r]),E=v.useCallback((C,I)=>{C.preventDefault(),C.stopPropagation(),setTimeout(()=>{S(I)},0)},[S]),_=C=>{const I={"Mechanics & Effects":[],"Card Types & Attributes":[],"Colors & Identity":[],"Competitive & Formats":[],"Tribal & Themes":[],"Other Functions":[]};for(const U of C){const A=U.toLowerCase();A.includes("removal")||A.includes("counter")||A.includes("draw")||A.includes("ramp")||A.includes("acceleration")||A.includes("burn")||A.includes("control")||A.includes("damage")||A.includes("protection")||A.includes("tutor")||A.includes("graveyard")||A.includes("exile")||A.includes("bounce")||A.includes("flicker")||A.includes("sacrifice")||A.includes("token")||A.includes("buff")||A.includes("debuff")||A.includes("tap")||A.includes("untap")||A.includes("trigger")||A.includes("conditional")||A.includes("temporary")||A.includes("boost")||A.includes("generation")||A.includes("granter")||A.includes("targeted")||A.includes("utility")?I["Mechanics & Effects"].push(U):A.includes("creature")||A.includes("instant")||A.includes("sorcery")||A.includes("artifact")||A.includes("enchantment")||A.includes("planeswalker")||A.includes("legendary")||A.includes("historic")||A.includes("permanent")||A.includes("spell")||A.includes("nonland")||A.includes("mana-cost")||A.includes("cmc")||A.includes("power")||A.includes("toughness")||A.includes("evasion")||A.includes("flying")||A.includes("trample")||A.includes("lifelink")||A.includes("deathtouch")||A.includes("vigilance")||A.includes("haste")||A.includes("reach")||A.includes("first-strike")||A.includes("double-strike")||A.includes("menace")||A.includes("hexproof")||A.includes("indestructible")||A.includes("matters")||A.includes("effect")||A.includes("ability")||A.includes("combat")?I["Card Types & Attributes"].push(U):A.includes("white")||A.includes("blue")||A.includes("black")||A.includes("red")||A.includes("green")||A.includes("colorless")||A.includes("multicolor")||A.includes("mono")||A.includes("color")||A.includes("identity")||A.includes("hybrid")||A.includes("gold")||A.includes("artifact-creature")||A.includes("devoid")?I["Colors & Identity"].push(U):A.includes("legal")||A.includes("banned")||A.includes("restricted")||A.includes("standard")||A.includes("modern")||A.includes("legacy")||A.includes("vintage")||A.includes("commander")||A.includes("edh")||A.includes("pauper")||A.includes("pioneer")||A.includes("historic")||A.includes("competitive")||A.includes("casual")||A.includes("tournament")||A.includes("meta")||A.includes("staple")||A.includes("sideboard")||A.includes("mainboard")||A.includes("relevant")||A.includes("option")?I["Competitive & Formats"].push(U):A.includes("tribal")||A.includes("typal")||A.includes("kindred")||A.includes("synergy")||A.includes("archetype")||A.includes("deck")||A.includes("strategy")||A.includes("combo")||A.includes("engine")||A.includes("package")||A.includes("theme")||A.includes("build-around")||A.includes("win-condition")||A.includes("finisher")||A.includes("enabler")||A.includes("payoff")||A.includes("zombie")||A.includes("mutant")||A.includes("human")||A.includes("elf")||A.includes("dragon")||A.includes("angel")||A.includes("demon")||A.includes("beast")||A.includes("warrior")||A.includes("wizard")||A.includes("soldier")||A.includes("knight")||A.includes("cleric")||A.includes("rogue")||A.includes("shaman")||A.includes("fallout")||A.includes("radiation")||A.includes("death")?I["Tribal & Themes"].push(U):I["Other Functions"].push(U)}return Object.fromEntries(Object.entries(I).filter(([U,A])=>A.length>0))},j=C=>C.replace(/-/g," ").replace(/\b\w/g,I=>I.toUpperCase()),T=C=>{const I={"Mechanics & Effects":{bg:"#dbeafe",border:"#3b82f6",text:"#1e40af"},"Card Types & Attributes":{bg:"#fef3c7",border:"#f59e0b",text:"#92400e"},"Colors & Identity":{bg:"#d1fae5",border:"#10b981",text:"#065f46"},"Competitive & Formats":{bg:"#f3e8ff",border:"#8b5cf6",text:"#5b21b6"},"Tribal & Themes":{bg:"#fee2e2",border:"#ef4444",text:"#991b1b"},"Other Functions":{bg:"#f1f5f9",border:"#64748b",text:"#334155"}};return I[C]||I["Other Functions"]};if(d)return l.jsxs("div",{className:"oracle-tags-integration loading",children:[l.jsxs("div",{className:"oracle-tags-header",children:[l.jsx("span",{className:"oracle-tags-icon",children:"🏷️"}),l.jsx("span",{className:"oracle-tags-title",children:"Waiting for Oracle Tags System..."})]}),l.jsx("div",{className:"loading-spinner"}),l.jsx("div",{style:{fontSize:"11px",color:"#64748b",textAlign:"center",marginTop:"8px"},children:"Loading 34,425 cards and 4,288 categories..."})]});if(g)return l.jsxs("div",{className:"oracle-tags-integration error",children:[l.jsxs("div",{className:"oracle-tags-header",children:[l.jsx("span",{className:"oracle-tags-icon",children:"⚠️"}),l.jsx("span",{className:"oracle-tags-title",children:"Oracle Tags Error"})]}),l.jsx("div",{className:"error-message",children:g})]});if(!s||s.length===0)return l.jsxs("div",{className:"oracle-tags-integration no-tags",children:[l.jsxs("div",{className:"oracle-tags-header",children:[l.jsx("span",{className:"oracle-tags-icon",children:"🏷️"}),l.jsx("span",{className:"oracle-tags-title",children:"Oracle Tags"})]}),l.jsx("div",{className:"no-tags-message",children:((D=(O=window.productionOtagSystem)==null?void 0:O.stats)==null?void 0:D.totalCards)>100?"No functional tags found for this card":"Loading Oracle Tags database..."}),l.jsxs("div",{style:{fontSize:"10px",color:"#64748b",textAlign:"center",marginTop:"4px"},children:["Database: ",(($=(L=window.productionOtagSystem)==null?void 0:L.stats)==null?void 0:$.totalCards)||0," cards loaded",((H=(V=window.productionOtagSystem)==null?void 0:V.stats)==null?void 0:H.totalCards)<=100&&l.jsx("div",{children:"⚠️ Database incomplete - expected 34,000+ cards"})]})]});const N=_(s);return l.jsxs("div",{className:"oracle-tags-integration",children:[l.jsxs("div",{className:"oracle-tags-header",children:[l.jsx("span",{className:"oracle-tags-icon",children:"🏷️"}),l.jsxs("span",{className:"oracle-tags-title",children:["Functional Oracle Tags (",s.length,")"]})]}),l.jsx("div",{className:"oracle-tags-content",children:(()=>{const C=Object.entries(N),I=[],U=[];let A=0,ee=0;return C.forEach(([oe,G])=>{A<=ee?(I.push([oe,G]),A+=G.length):(U.push([oe,G]),ee+=G.length)}),l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"oracle-tags-column",children:I.map(([oe,G])=>l.jsxs("div",{className:"oracle-tags-category",children:[l.jsxs("div",{className:"category-header",children:[l.jsx("span",{className:"category-name",children:oe}),l.jsxs("span",{className:"category-count",children:["(",G.length,")"]})]}),l.jsx("div",{className:"oracle-tags-list",children:G.map(P=>{const R=T(oe);return l.jsx("button",{className:"oracle-tag",style:{"--tag-bg":R.bg,"--tag-border":R.border,"--tag-text":R.text},onClick:M=>{M.preventDefault(),M.stopPropagation()},onMouseDown:M=>E(M,P),title:`Search for cards with "${P}" functionality`,children:j(P)},P)})})]},oe))}),l.jsx("div",{className:"oracle-tags-column",children:U.map(([oe,G])=>l.jsxs("div",{className:"oracle-tags-category",children:[l.jsxs("div",{className:"category-header",children:[l.jsx("span",{className:"category-name",children:oe}),l.jsxs("span",{className:"category-count",children:["(",G.length,")"]})]}),l.jsx("div",{className:"oracle-tags-list",children:G.map(P=>{const R=T(oe);return l.jsx("button",{className:"oracle-tag",style:{"--tag-bg":R.bg,"--tag-border":R.border,"--tag-text":R.text},onClick:M=>{M.preventDefault(),M.stopPropagation()},onMouseDown:M=>E(M,P),title:`Search for cards with "${P}" functionality`,children:j(P)},P)})})]},oe))})]})})()}),l.jsx("div",{className:"oracle-tags-footer",children:l.jsx("span",{className:"search-hint",children:"💡 Click any tag to search for similar cards"})})]})},mx=({card:a,isOpen:r,onClose:s,userDecks:i,onOracleTagSearch:d})=>{var H;const[f,g]=v.useState(""),[p,m]=v.useState(!1),[h,y]=v.useState(null),[b,S]=v.useState([]),[E,_]=v.useState(!1);v.useEffect(()=>{r&&a?((i==null?void 0:i.length)>0&&g(i[0]._id),y(a),j(a.name)):(g(""),y(null),S([]))},[r,a,i]),v.useEffect(()=>{if(r){const C=window.scrollY;return document.body.style.position="fixed",document.body.style.top=`-${C}px`,document.body.style.width="100%",()=>{document.body.style.position="",document.body.style.top="",document.body.style.width="",window.scrollTo(0,C)}}},[r]),v.useEffect(()=>{const C=I=>{I.key==="Escape"&&r&&s()};return r&&document.addEventListener("keydown",C),()=>{document.removeEventListener("keydown",C)}},[r,s]);const j=async C=>{if(C){_(!0);try{console.log(`[SimpleCardModal] Loading printings for: "${C}"`);const U=`https://constant-lists-api.onrender.com/api/cards/printings?name=${encodeURIComponent(C)}`,A=await fetch(U);let ee=[];if(A.ok){const P=await A.json();ee=P.data||[];let R=P.next_page;for(;R&&ee.length<20;){const M=await fetch(R);if(M.ok){const W=await M.json();ee=[...ee,...W.data||[]],R=W.next_page}else break}}else a&&(ee=[a]);!ee.some(P=>P.id===a.id)&&a&&ee.unshift(a);const G=O(ee,a);S(G),console.log(`[SimpleCardModal] Loaded ${ee.length} printings`)}catch(I){console.error("Error loading printings:",I),a&&S([a])}finally{_(!1)}}},T=async()=>{if(!(!f||!h)){m(!0);try{const C=localStorage.getItem("token");if(!C){alert("Please log in to add cards to decks");return}const U=await fetch(`${""||""}/api/decks/${f}/cards`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`},body:JSON.stringify({scryfall_id:h.id,quantity:1,section:"mainboard"})});if(U.ok)alert(`Added ${h.name} to deck!`),s();else{const A=await U.json();alert(`Error adding card: ${A.message||"Unknown error"}`)}}catch(C){console.error("Error adding card to deck:",C),alert("Error adding card to deck")}finally{m(!1)}}},N=C=>{if(!C)return"N/A";const I=C.usd||C.usd_foil;return I?`$${Number(I).toFixed(2)}`:"N/A"},O=(C,I)=>{if(!I)return C;const U=I.id,A=C.find(oe=>oe.id===U),ee=C.filter(oe=>oe.id!==U);return A?[A,...ee]:C},D=C=>{y(C);const I=O(b,C);S(I)},L=async()=>{h&&alert(`Added ${h.name} to wishlist! (Feature coming soon)`)},$=async()=>{h&&alert(`Added ${h.name} to collection! (Feature coming soon)`)},V=C=>C&&C.split(/(\{[^}]+\})/).map((I,U)=>{const A=I.match(/^\{([^}]+)\}$/);if(A){let ee=A[1].toLowerCase();return ee==="t"&&(ee="tap"),ee==="q"&&(ee="untap"),l.jsx("img",{src:`/svgs/${ee}.svg`,alt:I,className:"mana-symbol",style:{width:"10px",height:"10px",display:"inline-block",verticalAlign:"middle",margin:"0 0.5px"},onError:oe=>{oe.target.outerHTML=I},"data-no-qr-scan":"true",loading:"lazy"},U)}return I});return!r||!h?null:l.jsx("div",{className:"modal-backdrop card-actions-modal",onClick:s,children:l.jsxs("div",{className:"modal-content",onClick:C=>C.stopPropagation(),children:[l.jsx("div",{className:"modal-header",children:l.jsx("button",{onClick:s,className:"close-button",children:"×"})}),l.jsxs("div",{className:"modal-body",children:[l.jsxs("div",{className:"card-actions",children:[l.jsxs("div",{className:"action-row",children:[l.jsx("label",{className:"control-label",children:"Add to Deck:"}),l.jsx("div",{className:"deck-selection-controls",children:(i==null?void 0:i.length)>0?l.jsxs(l.Fragment,{children:[l.jsx("select",{value:f,onChange:C=>g(C.target.value),className:"deck-select",style:{width:"100%",marginBottom:"8px"},children:i.map(C=>l.jsx("option",{value:C._id,children:C.name},C._id))}),l.jsx("button",{onClick:T,disabled:p||!f,className:`action-button ${p?"loading":""}`,style:{width:"100%"},children:p?"Adding...":"Add to Deck"})]}):l.jsx("div",{className:"no-decks-message",style:{fontSize:"12px",color:"#666"},children:"Please log in and create a deck to add cards."})})]}),l.jsxs("div",{className:"action-row",children:[l.jsx("button",{onClick:L,className:"action-button wishlist-button",style:{width:"100%",backgroundColor:"#ff9800",marginBottom:"8px"},children:"Add to Wishlist"}),l.jsx("button",{onClick:$,className:"action-button collection-button",style:{width:"100%",backgroundColor:"#4caf50"},children:"Add to Collection"})]}),l.jsxs("div",{className:"printings-section",children:[l.jsx("h3",{children:"Select Printing"}),l.jsx("div",{className:"printings-list",children:E?l.jsxs("div",{className:"loading-printings",children:[l.jsx("p",{children:"Loading printings..."}),l.jsx("div",{className:"spinner"})]}):b.length===0?l.jsx("p",{children:"No printings found for this card."}):l.jsxs("div",{children:[l.jsxs("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",textAlign:"center"},children:["Found ",b.length," printings"]}),l.jsx("div",{className:"printings-grid",children:b.map(C=>{var ee,oe,G;const I=h.id===C.id,U=N(C.prices),A=C.set?`/svgs/${C.set}.svg`:null;return l.jsxs("div",{className:`printing-item ${I?"selected":""}`,onClick:()=>D(C),title:`${C.set_name} - ${(ee=C.set)==null?void 0:ee.toUpperCase()} ${C.collector_number?`(#${C.collector_number})`:""} - ${U}`,children:[I&&l.jsx("div",{className:"current-label",children:"CURRENT"}),(()=>{var R,M,W,se,he;let P=null;if((R=C.image_uris)!=null&&R.border_crop||(M=C.image_uris)!=null&&M.small||(W=C.image_uris)!=null&&W.normal)P=C.image_uris.border_crop||C.image_uris.small||C.image_uris.normal;else if((he=(se=C.card_faces)==null?void 0:se[0])!=null&&he.image_uris){const fe=C.card_faces[0].image_uris;P=fe.border_crop||fe.small||fe.normal}return P&&l.jsx("div",{className:"printing-image-preview",children:l.jsx("img",{src:P,alt:C.name,className:"printing-preview-img",loading:"lazy",style:{backgroundColor:"#f5f5f5",minHeight:"88px"},onError:fe=>{var te,K,ae,re,ue,me,Ce,Te;fe.target.src!==(((te=C.image_uris)==null?void 0:te.normal)||((re=(ae=(K=C.card_faces)==null?void 0:K[0])==null?void 0:ae.image_uris)==null?void 0:re.normal))&&(fe.target.src=((ue=C.image_uris)==null?void 0:ue.normal)||((Te=(Ce=(me=C.card_faces)==null?void 0:me[0])==null?void 0:Ce.image_uris)==null?void 0:Te.normal))}})})})(),l.jsx("div",{className:"printing-label",children:l.jsxs("div",{className:"set-info",children:[l.jsxs("div",{className:"set-details-row",children:[A&&l.jsx("img",{src:A,alt:(oe=C.set)==null?void 0:oe.toUpperCase(),className:"set-symbol",loading:"lazy",onError:P=>P.target.style.display="none"}),l.jsxs("span",{children:[(G=C.set)==null?void 0:G.toUpperCase()," #",C.collector_number||"?"]})]}),l.jsxs("div",{className:"price-row",children:[l.jsx("span",{children:U}),l.jsx("div",{className:"collection-dot not-owned",title:"Not in Collection"})]})]})})]},C.id)})})]})})]})]}),l.jsx("div",{className:"printings-container",children:l.jsx("div",{className:"current-printing-container",children:l.jsxs("div",{className:"current-printing-info",children:[l.jsx("h2",{className:"card-name-title",children:h.name}),l.jsxs("div",{className:"card-details-columns",children:[l.jsxs("div",{className:"detail-column",children:[l.jsxs("div",{className:"detail-row",children:[l.jsx("span",{className:"detail-label",children:"Type:"}),l.jsx("span",{className:"detail-value",children:h.type_line})]}),h.mana_cost&&l.jsxs("div",{className:"detail-row",children:[l.jsx("span",{className:"detail-label",children:"Mana Cost:"}),l.jsx("span",{className:"detail-value",children:V(h.mana_cost)})]}),l.jsxs("div",{className:"detail-row",children:[l.jsx("span",{className:"detail-label",children:"Price:"}),l.jsx("span",{className:"detail-value price-highlight",children:N(h.prices)})]})]}),l.jsxs("div",{className:"detail-column",children:[l.jsxs("div",{className:"detail-row",children:[l.jsx("span",{className:"detail-label",children:"Set:"}),l.jsxs("span",{className:"detail-value",children:[h.set_name," (",(H=h.set)==null?void 0:H.toUpperCase(),")"]})]}),h.released_at&&l.jsxs("div",{className:"detail-row",children:[l.jsx("span",{className:"detail-label",children:"Released:"}),l.jsx("span",{className:"detail-value",children:new Date(h.released_at).toLocaleDateString()})]})]})]}),h.oracle_text&&l.jsx("div",{className:"oracle-text-content-compact",children:V(h.oracle_text)}),l.jsx(hx,{card:h,onOracleTagSearch:C=>{console.log(`[SimpleCardModal] Oracle tag search requested: ${C}`),d?d(C):alert(`Search for oracle tag: "${C}"

This feature can be enhanced to integrate with your search system.`)}})]})})})]})]})})},yx=a=>{if(!a||typeof a!="string")return null;const r=a.toLowerCase();return r.includes("creature")?"creature":r.includes("planeswalker")?"planeswalker":r.includes("instant")?"instant":r.includes("sorcery")?"sorcery":r.includes("artifact")?"artifact":r.includes("enchantment")?"enchantment":r.includes("land")?"land":null},Sd=ke.memo(({typeLine:a,size:r=16,className:s="",style:i={}})=>{const d=yx(a);return d?l.jsx("img",{src:`/svgs/${d}.svg`,alt:d,title:a,className:`type-icon ${s}`,style:{width:r,height:r,display:"inline-block",verticalAlign:"middle",...i},onError:f=>{f.target.style.display="none"}}):null});Sd.displayName="TypeIcon";const Op=({size:a=12,color:r="#1976d2"})=>l.jsx("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:a,height:a*(32/23),viewBox:"0 0 23 32",style:{display:"inline-block",verticalAlign:"middle"},children:l.jsx("path",{fill:r,d:"M18.486 28.106c0 1.581-1.282 2.863-2.863 2.863h-12.762c-1.581 0-2.863-1.282-2.863-2.863v-20.157c0-1.581 1.282-2.863 2.863-2.863h2.028v-1.193c0-1.581 1.282-2.863 2.863-2.863h12.762c1.581 0 2.863 1.282 2.863 2.863v20.157c0 1.581-1.282 2.863-2.863 2.863h-2.028v1.193zM15.623 6.995h-12.762c-0.527 0-0.954 0.427-0.954 0.954v20.157c0 0.527 0.427 0.954 0.954 0.954h12.762c0.527 0 0.954-0.427 0.954-0.954v-20.157c0-0.527-0.427-0.954-0.954-0.954zM18.486 25.005h2.028c0.527 0 0.954-0.427 0.954-0.954v-20.157c0-0.527-0.427-0.954-0.954-0.954h-12.762c-0.527 0-0.954 0.427-0.954 0.954v1.193h8.826c1.581 0 2.863 1.282 2.863 2.863v17.056z"})}),Nl=a=>{if(!a||typeof a!="object")return{price:null,source:"invalid_card_object",cardType:"unknown"};const r=a.prices||{};let s=null,i="no_price",d="normal";return r.usd&&r.usd!=="0.00"?(s=r.usd,i="regular_usd"):r.usd_foil&&r.usd_foil!=="0.00"?(s=r.usd_foil,i="foil_usd"):r.eur&&r.eur!=="0.00"?(s=r.eur,i="eur"):r.tix&&r.tix!=="0.00"&&(s=r.tix,i="tix"),{price:s,source:i,isFoil:i==="foil_usd",cardType:d}};function xx({card:a,nameStyle:r,isDoubleFacedCard:s}){const[i,d]=v.useState(!1),f=s?s(a):!1,g=()=>{var y,b,S,E;return f&&((S=(b=(y=a.card_faces)==null?void 0:y[0])==null?void 0:b.image_uris)!=null&&S.normal)?a.card_faces[0].image_uris.normal:(E=a.image_uris)==null?void 0:E.normal},p=()=>{var y,b,S;return f&&((S=(b=(y=a.card_faces)==null?void 0:y[1])==null?void 0:b.image_uris)!=null&&S.normal)?a.card_faces[1].image_uris.normal:null},m=g(),h=p();return l.jsxs("span",{style:{position:"relative"},onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),children:[l.jsx("span",{style:r||{textDecoration:"underline",cursor:"pointer"},children:a.name}),i&&m&&l.jsxs("div",{style:{position:"absolute",top:24,left:0,zIndex:10,display:"flex",gap:"8px",background:"#fff",padding:"8px",borderRadius:8,boxShadow:"0 4px 16px rgba(0,0,0,0.25)"},children:[l.jsx("img",{src:m,alt:`${a.name} - Front`,style:{width:200,height:"auto",borderRadius:4}}),f&&h&&l.jsx("img",{src:h,alt:`${a.name} - Back`,style:{width:200,height:"auto",borderRadius:4}})]})]})}function rd(a){var r,s;try{const i=localStorage.getItem("shoppingCart");let d=i?JSON.parse(i):[];const f=d.findIndex(g=>g.id===a.id);if(f!==-1)d[f].quantity=(d[f].quantity||1)+1,ce.success(`Increased ${a.name} quantity to ${d[f].quantity} in shopping cart`);else{const g={id:a.id,name:a.name,set_name:a.set_name,type_line:a.type_line,image_url:(r=a.image_uris)==null?void 0:r.normal,price:((s=a.prices)==null?void 0:s.usd)||"0.00",quantity:1,scryfall_id:a.id};d.push(g),ce.success(`Added ${a.name} to shopping cart`)}localStorage.setItem("shoppingCart",JSON.stringify(d)),window.dispatchEvent(new CustomEvent("cartUpdated"))}catch(i){console.error("Error adding to shopping cart:",i),ce.error("Failed to add card to shopping cart")}}function bx({onSearch:a,loading:r,query:s,setQuery:i}){const d=f=>{f.preventDefault(),s.trim()&&a(s)};return l.jsxs("form",{onSubmit:d,style:{marginBottom:16,display:"flex",gap:8,flexWrap:"wrap"},children:[l.jsx("input",{type:"text",placeholder:"Search cards (Scryfall syntax supported)",value:s,onChange:f=>i(f.target.value),style:{flex:1,minWidth:180,padding:8,fontSize:16,backgroundColor:"white",border:"1px solid #ccc",borderRadius:4},"aria-label":"Card search query","data-research-page-search":"true"}),l.jsx("button",{type:"submit",disabled:r,style:{minWidth:100},children:r?"Searching...":"Search"})]})}function vx(a){if(!a)return null;const r=a.split(/(\{[^}]+\})/);return l.jsx("span",{children:r.map((s,i)=>{if(s.match(/\{[^}]+\}/)){let d=s.replace(/[{}]/g,"");return d=d.replace(/\//g,""),d=d.toUpperCase(),l.jsx("img",{src:`/svgs/${d.toLowerCase()}.svg`,alt:s,onError:f=>{f.target.outerHTML=s},"data-no-qr-scan":"true",loading:"lazy",style:{width:12,height:12,verticalAlign:"middle",margin:"0 1px",display:"inline"}},i)}else return l.jsx("span",{children:s},i)})})}function Sx({sort:a,setSort:r,sortDir:s,setSortDir:i,view:d,setView:f}){return l.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:16,flexWrap:"wrap"},children:[l.jsxs("label",{children:["Sort by:",l.jsxs("select",{value:a,onChange:g=>r(g.target.value),style:{marginLeft:8,backgroundColor:"white",border:"1px solid #ccc",borderRadius:4,padding:"4px 8px"},children:[l.jsx("option",{value:"name",children:"Name"}),l.jsx("option",{value:"type",children:"Type"}),l.jsx("option",{value:"mana",children:"Mana Value"}),l.jsx("option",{value:"price",children:"Price"})]})]}),l.jsxs("div",{style:{display:"flex",gap:4},children:[l.jsx("button",{type:"button",onClick:()=>i("asc"),style:{background:s==="asc"?"#1976d2":"#eee",color:s==="asc"?"#fff":"#222",border:"1px solid #ccc",borderRadius:4,padding:"4px 16px",fontWeight:600,cursor:"pointer"},children:"A-Z"}),l.jsx("button",{type:"button",onClick:()=>i("desc"),style:{background:s==="desc"?"#1976d2":"#eee",color:s==="desc"?"#fff":"#222",border:"1px solid #ccc",borderRadius:4,padding:"4px 16px",fontWeight:600,cursor:"pointer"},children:"Z-A"})]}),l.jsxs("div",{style:{display:"flex",gap:8},children:[l.jsx("button",{type:"button",onClick:()=>f("grid"),style:{background:d==="grid"?"#1976d2":"#eee",color:d==="grid"?"#fff":"#222",border:"1px solid #ccc",borderRadius:4,padding:"4px 12px"},children:"Grid"}),l.jsx("button",{type:"button",onClick:()=>f("hybrid"),style:{background:d==="hybrid"?"#1976d2":"#eee",color:d==="hybrid"?"#fff":"#222",border:"1px solid #ccc",borderRadius:4,padding:"4px 12px"},children:"Hybrid"}),l.jsx("button",{type:"button",onClick:()=>f("text"),style:{background:d==="text"?"#1976d2":"#eee",color:d==="text"?"#fff":"#222",border:"1px solid #ccc",borderRadius:4,padding:"4px 12px"},children:"Text"})]})]})}function wx({results:a,error:r,view:s,sort:i,sortDir:d,setSort:f,setSortDir:g,handleSearch:p,onCardClick:m,flipStates:h,isDoubleFacedCard:y,getCardName:b,handleFlipCard:S,getCardImageUrl:E}){if(r)return l.jsx("div",{style:{color:"red",marginTop:16},children:r});if(!a)return null;if(a.length===0)return l.jsx("div",{style:{color:"#888",marginTop:16},children:"No results found."});if(s==="text"){const _=j=>{i===j?g(d==="asc"?"desc":"asc"):(f(j),g("asc"))};return l.jsxs("div",{style:{marginTop:24,flex:1,display:"flex",flexDirection:"column"},children:[l.jsx("h3",{style:{marginBottom:16},children:"Results"}),l.jsx("div",{style:{flex:1,overflowX:"auto",overflowY:"auto",padding:"0 16px"},children:l.jsxs("table",{style:{width:"100%",minWidth:600,borderCollapse:"collapse",fontSize:16,borderSpacing:0},children:[l.jsx("thead",{children:l.jsxs("tr",{style:{background:"#f2f2f2",height:20,maxHeight:20,lineHeight:1,overflow:"hidden"},children:[l.jsxs("th",{style:{textAlign:"left",padding:"0 0 0 10px",borderBottom:"1px solid #ccc",borderRight:"1px solid #ccc",minWidth:120,cursor:"pointer",userSelect:"none",height:20,maxHeight:20,verticalAlign:"middle",fontWeight:700,fontSize:16,letterSpacing:.2,lineHeight:1,overflow:"hidden"},onClick:()=>_("name"),children:["Name ",i==="name"&&(d==="asc"?"▲":"▼")]}),l.jsxs("th",{style:{textAlign:"left",padding:"0 0 0 10px",borderBottom:"1px solid #ccc",borderRight:"1px solid #ccc",minWidth:100,cursor:"pointer",userSelect:"none",height:20,maxHeight:20,verticalAlign:"middle",fontWeight:700,fontSize:16,letterSpacing:.2,lineHeight:1,overflow:"hidden"},onClick:()=>_("type"),children:["Type ",i==="type"&&(d==="asc"?"▲":"▼")]}),l.jsxs("th",{style:{textAlign:"left",padding:"0 0 0 10px",borderBottom:"1px solid #ccc",borderRight:"1px solid #ccc",minWidth:80,cursor:"pointer",userSelect:"none",height:20,maxHeight:20,verticalAlign:"middle",fontWeight:700,fontSize:16,letterSpacing:.2,lineHeight:1,overflow:"hidden"},onClick:()=>_("mana"),children:["Mana Value ",i==="mana"&&(d==="asc"?"▲":"▼")]}),l.jsxs("th",{style:{textAlign:"left",padding:"0 0 0 10px",borderBottom:"1px solid #ccc",borderRight:"1px solid #ccc",minWidth:70,cursor:"pointer",userSelect:"none",height:20,maxHeight:20,verticalAlign:"middle",fontWeight:700,fontSize:16,letterSpacing:.2,lineHeight:1,overflow:"hidden"},onClick:()=>_("price"),children:["Price ",i==="price"&&(d==="asc"?"▲":"▼")]}),l.jsx("th",{style:{textAlign:"center",padding:0,borderBottom:"1px solid #ccc",minWidth:32,height:20,maxHeight:20,verticalAlign:"middle",fontWeight:700,fontSize:16,letterSpacing:.2,lineHeight:1,overflow:"hidden"},children:"Actions"})]})}),l.jsx("tbody",{children:(a||[]).map(j=>{var U,A,ee,oe;const T=y(j);let N,O;if(T&&j.card_faces){N=((U=j.card_faces[0])==null?void 0:U.mana_cost)||"",O=((A=j.card_faces[1])==null?void 0:A.mana_cost)||"";const G=N.match(/\{.*?\}/g)||[],P=O.match(/\{.*?\}/g)||[];[...G,...P]}else N=j.mana_cost||"",N.match(/\{.*?\}/g);const D=N.match(/\{.*?\}/g)||[];let L=0;D.forEach(G=>{const P=G.replace(/[{}]/g,"");isNaN(Number(P))?P.match(/^[WUBRGCSXYZQ]$/i)?L+=1:P.match(/^2[WUBRG]$/i)?L+=2:P.match(/\//)&&(L+=1):L+=Number(P)}),L||(T&&((ee=j.card_faces)!=null&&ee[0])?L=j.card_faces[0].cmc||j.card_faces[0].mana_value||j.cmc||j.mana_value||0:L=j.cmc||j.mana_value||0),D.forEach(G=>{let P=G.replace(/[{}]/g,"");P=P.replace(/\//g,""),P=P.toUpperCase()});let $="",V;if(T&&((oe=j.card_faces)!=null&&oe[0])?V=j.card_faces[0].type_line||j.type_line:V=j.type_line,V){const G=V.split("—").map(P=>P.trim());G.length===2?$=`${G[0]} - ${G[1]}`:$=G[0]}const{price:H,source:C}=Nl(j);let I="N/A";return H&&(C==="eur"?I=`€${Number(H).toFixed(2)}`:C==="tix"?I=`${Number(H).toFixed(2)} tix`:C==="foil_usd"?I=`$${Number(H).toFixed(2)} (F)`:I=`$${Number(H).toFixed(2)}`),l.jsxs("tr",{style:{height:20,maxHeight:20,lineHeight:1,minHeight:0,overflow:"hidden"},children:[l.jsx("td",{style:{padding:"0 0 0 10px",borderBottom:"1px solid #eee",borderRight:"1px solid #eee",fontSize:16,height:20,maxHeight:20,verticalAlign:"middle",minHeight:0,textAlign:"left",lineHeight:1},children:l.jsx(xx,{card:j,nameStyle:{fontWeight:700,color:"#4e8c6c",fontSize:16,textDecoration:"none",lineHeight:1,margin:0,padding:0,cursor:"pointer"},isDoubleFacedCard:y})}),l.jsx("td",{style:{padding:"0 0 0 10px",borderBottom:"1px solid #eee",borderRight:"1px solid #eee",fontSize:15,height:20,maxHeight:20,verticalAlign:"middle",minHeight:0,textAlign:"left",lineHeight:1,overflow:"hidden"},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[l.jsx(Sd,{typeLine:$,size:14}),l.jsx("span",{children:$})]})}),l.jsx("td",{style:{padding:"0 0 0 10px",borderBottom:"1px solid #eee",borderRight:"1px solid #eee",height:20,maxHeight:20,verticalAlign:"middle",minHeight:0,textAlign:"left",lineHeight:1,overflow:"hidden"},children:l.jsx("span",{style:{display:"inline-flex",gap:0,lineHeight:1,alignItems:"center",margin:0,padding:0,height:20,maxHeight:20,overflow:"hidden"},children:T&&j.card_faces?l.jsxs(l.Fragment,{children:[(N.match(/\{.*?\}/g)||[]).map((G,P)=>{let R=G.replace(/[{}]/g,"");return R=R.replace(/\//g,""),R=R.toUpperCase(),l.jsx("img",{src:`/svgs/${R.toLowerCase()}.svg`,alt:R,style:{width:12,height:12,verticalAlign:"middle",margin:0,padding:0,display:"block",maxHeight:12,overflow:"hidden"}},`front-${P}`)}),N&&O&&l.jsx("span",{style:{margin:"0 2px",fontSize:"12px",color:"#666",lineHeight:1},children:"//"}),(O.match(/\{.*?\}/g)||[]).map((G,P)=>{let R=G.replace(/[{}]/g,"");return R=R.replace(/\//g,""),R=R.toUpperCase(),l.jsx("img",{src:`/svgs/${R.toLowerCase()}.svg`,alt:R,style:{width:12,height:12,verticalAlign:"middle",margin:0,padding:0,display:"block",maxHeight:12,overflow:"hidden"}},`back-${P}`)})]}):D.map((G,P)=>{let R=G.replace(/[{}]/g,"");return R=R.replace(/\//g,""),R=R.toUpperCase(),l.jsx("img",{src:`/svgs/${R.toLowerCase()}.svg`,alt:R,style:{width:15,height:15,verticalAlign:"middle",margin:0,padding:0,display:"block",maxHeight:15,overflow:"hidden"}},P)})})}),l.jsx("td",{style:{padding:"0 0 0 10px",borderBottom:"1px solid #eee",borderRight:"1px solid #eee",fontSize:16,height:20,maxHeight:20,verticalAlign:"middle",minHeight:0,textAlign:"left",lineHeight:1},children:I}),l.jsx("td",{style:{padding:"0 0 0 10px",borderBottom:"1px solid #eee",fontSize:16,height:20,maxHeight:20,verticalAlign:"middle",minHeight:0,textAlign:"center",lineHeight:1},children:l.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center",justifyContent:"center",height:20,maxHeight:20,overflow:"hidden"},children:[l.jsx("button",{onClick:()=>rd(j),style:{backgroundColor:"#059669",color:"white",border:"none",padding:"2px 6px",borderRadius:"3px",fontSize:"10px",cursor:"pointer",height:16,lineHeight:1},title:"Add to Shopping Cart",children:"🛒"}),l.jsx("button",{onClick:()=>m(j),style:{backgroundColor:"#3b82f6",color:"white",border:"none",padding:"2px 6px",borderRadius:"3px",fontSize:"10px",cursor:"pointer",height:16,lineHeight:1},title:"Add to Deck",children:"📚"})]})})]},j.id)})})]})})]})}if(s==="grid")return l.jsxs("div",{style:{marginTop:24,flex:1,display:"flex",flexDirection:"column"},children:[l.jsx("h3",{style:{marginBottom:16},children:"Results"}),l.jsx("div",{style:{flex:1,overflowY:"auto",padding:"0 16px"},children:l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:16},children:(a||[]).map(_=>{const{price:j,source:T}=Nl(_);let N="N/A";j&&(T==="eur"?N=`€${Number(j).toFixed(2)}`:T==="tix"?N=`${Number(j).toFixed(2)} tix`:T==="foil_usd"?N=`$${Number(j).toFixed(2)} (F)`:N=`$${Number(j).toFixed(2)}`);const O=_.scryfall_id||_.id,D=h.get(O)||!1,L=y(_),$=E(_,O,D),V=b(_,O,D);return l.jsxs("div",{style:{padding:8,width:200,borderRadius:6,background:"#fafbfc",display:"flex",flexDirection:"column",alignItems:"center",position:"relative"},children:[l.jsxs("div",{style:{position:"relative",width:"100%"},children:[$&&l.jsx("img",{src:$,alt:V,style:{width:"100%",maxWidth:184,height:"auto",aspectRatio:"63/88",objectFit:"cover",borderRadius:4,cursor:"pointer"},onClick:()=>m(_)}),l.jsxs("div",{style:{position:"absolute",bottom:"4px",left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"center",gap:"6px",backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",padding:"2px 6px",borderRadius:"4px",backdropFilter:"blur(4px)"},children:[l.jsx("span",{style:{fontSize:"12px",fontWeight:"600"},children:N}),L&&l.jsx("button",{onClick:H=>{H.stopPropagation(),S(O)},style:{backgroundColor:"transparent",color:"white",border:"none",padding:"1px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"2px"},title:`Flip to ${D?"front":"back"} face`,children:l.jsx(Op,{size:10,color:"white"})})]})]}),l.jsxs("div",{style:{marginTop:8,display:"flex",gap:4,width:"100%"},children:[l.jsx("button",{onClick:()=>rd(_),style:{flex:1,backgroundColor:"#059669",color:"white",border:"none",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",cursor:"pointer"},title:"Add to Shopping Cart",children:"🛒"}),l.jsx("button",{onClick:()=>m(_),style:{flex:1,backgroundColor:"#3b82f6",color:"white",border:"none",padding:"6px 8px",borderRadius:"4px",fontSize:"12px",cursor:"pointer"},title:"Add to Deck",children:"📚"})]})]},_.id)})})})]});if(s==="hybrid")return l.jsxs("div",{style:{marginTop:24,flex:1,display:"flex",flexDirection:"column"},children:[l.jsx("h3",{style:{marginBottom:16},children:"Results"}),l.jsx("div",{style:{flex:1,overflowY:"auto",padding:"0 16px"},children:l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:(a||[]).map(_=>{var A,ee,oe,G;const{price:j,source:T}=Nl(_);let N="N/A";j&&(T==="eur"?N=`€${Number(j).toFixed(2)}`:T==="tix"?N=`${Number(j).toFixed(2)} tix`:N=`$${Number(j).toFixed(2)}`);const O=_.scryfall_id||_.id,D=h.get(O)||!1,L=y(_);E(_,O,D);const $=b(_,O,D);let V,H;L&&_.card_faces?(V=((A=_.card_faces[0])==null?void 0:A.mana_cost)||"",H=((ee=_.card_faces[1])==null?void 0:ee.mana_cost)||""):V=_.mana_cost||"";let C="",I;if(L&&((oe=_.card_faces)!=null&&oe[0])?I=_.card_faces[0].type_line||_.type_line:I=_.type_line,I){const P=I.split("—").map(R=>R.trim());P.length===2?C=`${P[0]} - ${P[1]}`:C=P[0]}let U="";if(L&&_.card_faces){const P=D?1:0;U=((G=_.card_faces[P])==null?void 0:G.oracle_text)||""}else U=_.oracle_text||"";return l.jsxs("div",{style:{display:"flex",gap:16,padding:12,background:"#fafbfc",border:"1px solid #e2e8f0",borderRadius:8,alignItems:"center"},children:[l.jsx("div",{style:{flexShrink:0,position:"relative",display:"flex",justifyContent:"center",alignItems:"center",alignSelf:"center"},children:(()=>{var R,M;let P=null;if(L&&_.card_faces){const W=D?1:0,se=_.card_faces[W];P=(R=se==null?void 0:se.image_uris)==null?void 0:R.art_crop}else P=(M=_.image_uris)==null?void 0:M.art_crop;return P&&l.jsxs(l.Fragment,{children:[l.jsx("img",{src:P,alt:$,style:{width:150,height:112,objectFit:"cover",borderRadius:6,cursor:"pointer"},onClick:()=>m(_)}),L&&l.jsxs("button",{onClick:W=>{W.stopPropagation(),S(O)},style:{position:"absolute",bottom:"4px",left:"50%",transform:"translateX(-50%)",backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",border:"none",padding:"2px 4px",cursor:"pointer",borderRadius:"3px",fontSize:"10px",fontWeight:"500",display:"flex",alignItems:"center",gap:2,minWidth:"fit-content",backdropFilter:"blur(2px)"},title:`Flip to ${D?"front":"back"} face`,children:[l.jsx(Op,{size:10,color:"white"}),"Flip"]})]})})()}),l.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:8,minWidth:0},children:[l.jsx("div",{style:{marginBottom:8},children:l.jsx("h4",{style:{margin:0,fontSize:18,fontWeight:700,color:"#1976d2",cursor:"pointer",textDecoration:"underline"},onClick:()=>m(_),children:$})}),l.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",flexWrap:"wrap"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[l.jsx("span",{style:{fontSize:14,color:"#64748b",fontWeight:500},children:"Mana:"}),l.jsxs("div",{style:{display:"flex",gap:1},children:[L&&_.card_faces?l.jsxs(l.Fragment,{children:[(V.match(/\{.*?\}/g)||[]).map((P,R)=>{let M=P.replace(/[{}]/g,"").replace(/\//g,"").toUpperCase();return l.jsx("img",{src:`/svgs/${M.toLowerCase()}.svg`,alt:M,style:{width:16,height:16}},`front-${R}`)}),V&&H&&l.jsx("span",{style:{margin:"0 4px",fontSize:"12px",color:"#666"},children:"//"}),(H.match(/\{.*?\}/g)||[]).map((P,R)=>{let M=P.replace(/[{}]/g,"").replace(/\//g,"").toUpperCase();return l.jsx("img",{src:`/svgs/${M.toLowerCase()}.svg`,alt:M,style:{width:16,height:16}},`back-${R}`)})]}):(V.match(/\{.*?\}/g)||[]).map((P,R)=>{let M=P.replace(/[{}]/g,"").replace(/\//g,"").toUpperCase();return l.jsx("img",{src:`/svgs/${M.toLowerCase()}.svg`,alt:M,style:{width:16,height:16}},R)}),!V&&l.jsx("span",{style:{fontSize:14,color:"#94a3b8"},children:"—"})]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[l.jsx("span",{style:{fontSize:14,color:"#64748b",fontWeight:500},children:"Type:"}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[l.jsx(Sd,{typeLine:C,size:14}),l.jsx("span",{style:{fontSize:14,color:"#334155"},children:C||"—"})]})]})]}),U&&l.jsx("div",{style:{marginTop:4},children:l.jsx("div",{style:{fontSize:13,color:"#475569",lineHeight:1.4,wordWrap:"break-word",whiteSpace:"pre-wrap"},children:vx(U)})}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:"auto",flexWrap:"wrap"},children:[l.jsx("button",{onClick:()=>rd(_),style:{backgroundColor:"#059669",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",cursor:"pointer",textAlign:"center",maxWidth:"100px",minWidth:"60px",width:"fit-content",whiteSpace:"nowrap"},title:"Add to Shopping Cart",children:"Cart"}),l.jsx("button",{onClick:()=>{ce.success(`Added ${_.name} to wishlist!`)},style:{backgroundColor:"#f59e0b",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",cursor:"pointer",textAlign:"center",maxWidth:"100px",minWidth:"60px",width:"fit-content",whiteSpace:"nowrap"},title:"Add to Wishlist",children:"Wishlist"}),l.jsx("button",{onClick:()=>m(_),style:{backgroundColor:"#3b82f6",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",cursor:"pointer",textAlign:"center",maxWidth:"100px",minWidth:"60px",width:"fit-content",whiteSpace:"nowrap"},title:"Add to Deck",children:"Deck"}),l.jsx("span",{style:{fontSize:16,fontWeight:600,color:"#059669",minWidth:"fit-content",paddingLeft:"8px"},children:N})]})]})]},_.id)})})})]})}function Cx(){const[a,r]=v.useState(null),[s,i]=v.useState(!1),[d,f]=v.useState(""),[g,p]=v.useState("name"),[m,h]=v.useState("asc"),[y,b]=v.useState("hybrid"),[S,E]=v.useState(""),[_,j]=v.useState(null),[T,N]=v.useState(!1),[O,D]=v.useState(null),[L,$]=v.useState(new Map),V=G=>{const P=G.card_faces,R=G.layout,M=R==="transform"||R==="modal_dfc"||R==="reversible_card";return P&&Array.isArray(P)&&P.length>=2||M},H=(G,P,R=!1)=>{var M,W,se,he,fe,te,K;if(V(G)){const ae=R?1:0,re=(M=G.card_faces)==null?void 0:M[ae];let ue=((W=re==null?void 0:re.image_uris)==null?void 0:W.normal)||((se=re==null?void 0:re.image_uris)==null?void 0:se.small);return ue||(ue=((he=G.image_uris)==null?void 0:he.normal)||((fe=G.image_uris)==null?void 0:fe.small)),ue}else return((te=G.image_uris)==null?void 0:te.normal)||((K=G.image_uris)==null?void 0:K.small)},C=(G,P,R=!1)=>{var M;if(V(G)){const W=R?1:0,se=(M=G.card_faces)==null?void 0:M[W];return(se==null?void 0:se.name)||G.name}else return G.name},I=G=>{$(P=>{const R=new Map(P);return R.set(G,!P.get(G)),R})};v.useEffect(()=>{(async()=>{try{const P=localStorage.getItem("token");if(!P){D(null);return}const M=await fetch(`${""||""}/api/decks/mine`,{headers:{Authorization:`Bearer ${P}`}});if(M.ok){const W=await M.json();D(W)}else D(null)}catch(P){console.error("Error loading user decks:",P),D(null)}})()},[]);const U=G=>{j(G),N(!0)},A=()=>{N(!1),j(null)},ee=async G=>{i(!0),f(""),r(null),E(G);try{const P="",M=`/api/cards/search?q=${encodeURIComponent(G)}`,W=`${P}${M}`,se=await fetch(W);if(!se.ok)throw new Error(`HTTP error! status: ${se.status}`);const he=await se.json();he.data?r(he.data):Array.isArray(he)?r(he):r([]),he.data&&he.data.length===0&&f("No cards found matching your search criteria.")}catch(P){console.error("Search error:",P),f("Error fetching cards. Please try again."),r([])}i(!1)},oe=a?[...a].sort((G,P)=>{let R=0;if(g==="name")R=G.name.localeCompare(P.name);else if(g==="type")R=(G.type_line||"").localeCompare(P.type_line||"");else if(g==="mana"){const M=W=>{const he=(W.mana_cost||"").match(/\{.*?\}/g)||[];let fe=0;return he.forEach(te=>{const K=te.replace(/[{}]/g,"");isNaN(Number(K))?K.match(/^[WUBRGCSXYZQ]$/i)?fe+=1:K.match(/^2[WUBRG]$/i)?fe+=2:K.match(/\//)&&(fe+=1):fe+=Number(K)}),!fe&&(W.cmc||W.mana_value)&&(fe=W.cmc||W.mana_value),fe};R=M(G)-M(P)}else if(g==="price"){const M=he=>{const{price:fe}=Nl(he);return fe?Number(fe):0},W=M(G),se=M(P);R=W-se}return m==="desc"&&(R*=-1),R}):null;return l.jsxs("div",{className:"container",style:{maxWidth:"100%",width:"100%",padding:"1rem",boxSizing:"border-box",minHeight:"calc(100vh - 120px)",display:"flex",flexDirection:"column"},children:[l.jsx("h1",{style:{marginBottom:"1rem",flexShrink:0},children:"Research"}),l.jsxs("div",{style:{flexShrink:0,marginBottom:"1rem"},children:[l.jsx(bx,{onSearch:ee,loading:s,query:S,setQuery:E}),l.jsx(Sx,{sort:g,setSort:p,sortDir:m,setSortDir:h,view:y,setView:b})]}),l.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0},children:l.jsx(wx,{results:oe,error:d,view:y,handleSearch:G=>{E(G),ee(G)},sort:g,sortDir:m,setSort:p,setSortDir:h,onCardClick:U,flipStates:L,isDoubleFacedCard:V,getCardName:C,handleFlipCard:I,getCardImageUrl:H})}),l.jsx(mx,{card:_,isOpen:T,onClose:A,userDecks:O,onOracleTagSearch:G=>{console.log(`[ResearchPage] Oracle tag search triggered: ${G}`),A();const P=`otag:${G}`;E(P),ee(P)}})]})}const xh=ke.memo(({colorIdentity:a,size:r=12})=>!a||!Array.isArray(a)||a.length===0?l.jsx("img",{src:"/svgs/c.svg",alt:"Colorless",style:{width:r,height:r,marginRight:2,verticalAlign:"middle"},onError:s=>{s.target.outerHTML="C"},"data-no-qr-scan":"true",loading:"lazy"}):l.jsx("span",{className:"color-identity",children:a.map((s,i)=>l.jsx("img",{src:`/svgs/${s.toLowerCase()}.svg`,alt:s,style:{width:r,height:r,marginRight:2,verticalAlign:"middle"},onError:d=>{d.target.outerHTML=s},"data-no-qr-scan":"true",loading:"lazy"},i))}));xh.displayName="ColorIdentity";function jx(a,r){const[s,i]=v.useState(a);return v.useEffect(()=>{const d=setTimeout(()=>i(a),r);return()=>clearTimeout(d)},[a,r]),s}function Ol({value:a,onChange:r,onSelect:s,exclude:i=[],filter:d=""}){var oe,G,P,R;const[f,g]=v.useState((a==null?void 0:a.name)||a||""),p=jx(f,400),[m,h]=v.useState([]),[y,b]=v.useState(!1),[S,E]=v.useState(!1),[_,j]=v.useState(a||null),[T,N]=v.useState(null),[O,D]=v.useState(null),[L,$]=v.useState(null),[V,H]=v.useState(""),C=v.useRef();v.useEffect(()=>{g((a==null?void 0:a.name)||a||""),j(a||null)},[a]);function I(M,W={}){let se=M.trim();return se.startsWith("!")||/^[a-zA-Z0-9'\-,. ]+$/.test(se)&&se.length>2&&!se.endsWith(" ")&&(se=`name:${se}`),W.type==="background"?/t:background/.test(se)||(se+=" t:background"):W.type==="partner"||W.type==="friends forever"?/is:commander/.test(se)||(se+=" is:commander"):/is:commander/.test(se)||(se+=" is:commander"),se}const U=v.useRef({q:"",filter:"",exclude:""});v.useEffect(()=>{const M=JSON.stringify(i||[]);if(U.current.q===p&&U.current.filter===d&&U.current.exclude===M)return;if(U.current={q:p,filter:d,exclude:M},!p){h([]),H("");return}b(!0),H("");const W=I(p,{type:d});fetch(`/api/cards/search?q=${encodeURIComponent(W)}`).then(async he=>{if(he.status===429)throw new Error("Too many searches, please wait a moment.");const fe=await he.json();if(fe.error&&fe.error.includes("not found"))throw new Error("Local API failed");return fe}).catch(async he=>{console.log("Local API failed, trying Scryfall direct:",he.message);const fe=W.includes("game:")?W:`${W} game:paper`,te=await fetch(`https://api.scryfall.com/cards/search?q=${encodeURIComponent(fe)}`);if(te.status===429)throw new Error("Too many searches, please wait a moment.");return te.json()}).then(he=>{let fe=he.data||[];i&&i.length>0&&(fe=fe.filter(re=>!i.includes(re.name))),d==="partner"?fe=fe.filter(re=>/partner(?! with)/i.test(re.oracle_text||"")):d==="friends forever"?fe=fe.filter(re=>/friends forever/i.test(re.oracle_text||"")):d==="background"&&(fe=fe.filter(re=>/background/i.test(re.type_line||"")));const te=p.trim().toLowerCase(),K=fe.filter(re=>typeof re.name=="string"&&re.name.toLowerCase().startsWith(te)),ae=fe.filter(re=>typeof re.name=="string"&&!re.name.toLowerCase().startsWith(te)&&re.name.toLowerCase().includes(te));fe=[...K,...ae],h(fe),b(!1)}).catch(he=>{H(he.message),b(!1)})},[p,d,JSON.stringify(i)]);function A(M){if(!M)return null;const W=M.oracle_text||"";return/partner with ([^\n]+)/i.test(W)?{type:"partner with",partner:W.match(/partner with ([^\n]+)/i)[1].trim()}:/choose a background/i.test(W)?{type:"background"}:/friends forever/i.test(W)?{type:"friends forever"}:/partner(?! with)/i.test(W)?{type:"partner"}:null}function ee(M){g(M.name),j(M),E(!1),b(!1),s&&s(M),N(null),D(null),$(null);const W=A(M);(W==null?void 0:W.type)==="partner with"&&N({name:W.partner})}return v.useEffect(()=>{if(_&&T&&T.name&&!T.id){b(!0);const M=I(T.name,{type:"partner"});fetch(`/api/cards/search?q=${encodeURIComponent(M)}`).then(se=>se.json()).then(se=>{se.data&&se.data.length>0&&N(se.data[0]),b(!1)}).catch(se=>{console.error("Partner fetch error:",se),b(!1)})}},[_,T]),l.jsxs("div",{style:{position:"relative",marginBottom:12},children:[l.jsx("input",{ref:C,value:f,onChange:M=>{g(M.target.value),r&&r(M.target.value),E(!0)},onFocus:()=>E(!0),onBlur:()=>setTimeout(()=>E(!1),120),placeholder:d==="background"?"Choose a background":d==="partner"?"Who is their partner?":d==="friends forever"?"Who is their friend forever?":"Who is your Commander?",style:{width:"100%",padding:10,borderRadius:4,border:"1px solid #ddd",backgroundColor:"white",fontSize:"14px",color:"#333"}}),S&&m.length>0&&l.jsx("div",{style:{position:"absolute",top:42,left:0,right:0,background:"#fff",border:"1px solid #ddd",borderRadius:4,zIndex:10,maxHeight:220,overflowY:"auto",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:m.map(M=>l.jsxs("div",{onMouseDown:()=>ee(M),style:{padding:12,cursor:"pointer",borderBottom:"1px solid #eee",fontSize:"14px",color:"#333",backgroundColor:"white",display:"flex",alignItems:"center",justifyContent:"space-between"},onMouseEnter:W=>W.currentTarget.style.backgroundColor="#f5f5f5",onMouseLeave:W=>W.currentTarget.style.backgroundColor="white",children:[l.jsx("span",{style:{flex:1},children:M.name}),l.jsx(xh,{colorIdentity:M.color_identity,size:16})]},M.id))}),y&&l.jsx("div",{style:{position:"absolute",top:42,left:0,background:"#fff",padding:12,border:"1px solid #ddd",borderRadius:4,zIndex:10,fontSize:"14px",color:"#666",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:"Loading..."}),_&&((oe=A(_))==null?void 0:oe.type)==="partner"&&l.jsx("div",{style:{marginTop:10},children:l.jsx(Ol,{value:T,onChange:N,onSelect:N,exclude:[_.name],filter:"partner"})}),_&&((G=A(_))==null?void 0:G.type)==="partner with"&&T&&l.jsx("div",{style:{marginTop:10},children:T.id&&l.jsx("span",{style:{marginLeft:8,color:"#1976d2",cursor:"pointer"},onClick:()=>N(null),children:"[remove]"})}),_&&((P=A(_))==null?void 0:P.type)==="background"&&l.jsx("div",{style:{marginTop:10},children:l.jsx(Ol,{value:O,onChange:D,onSelect:D,filter:"background"})}),_&&((R=A(_))==null?void 0:R.type)==="friends forever"&&l.jsx("div",{style:{marginTop:10},children:l.jsx(Ol,{value:L,onChange:$,onSelect:$,exclude:[_.name],filter:"friends forever"})})]})}function _x(a){const r=a.split(/\r?\n/).map(i=>i.trim()).filter(Boolean),s=[];for(const i of r){if(i.includes("MAIN DECK:")||i.includes("TECH IDEAS:")||i.includes("SIDEBOARD:")||i.includes("===")||i.includes("Generated on")||i.includes("Format:")||i.includes("Total:")||i==="")continue;const d=i.match(/^(\d+)\s+(.+?)(?:\s+\[([^\]]+)\]\s+(\S+))?$/);if(d){const[,f,g,p,m]=d;s.push({quantity:parseInt(f,10),name:g.trim(),set:p==null?void 0:p.trim(),collectorNumber:m==null?void 0:m.trim(),foil:!1})}}return s}const od=["Alchemy","Alpha 40","Archon","Australian Highlander","Brawl","Canadian Highlander","Centurion","Commander / EDH","Conquest","Dandan","Duel Commander","European Highlander","Gladiator","Highlander Gauntlet","Historic","Legacy","Leviathan","Modern","Oathbreaker","Old School","Pauper","Pauper EDH","Pendragon","Penny Dreadful","Pioneer","PreDH","Premodern","Primordial","Russian Duel Commander","Standard","Standard Brawl","Timeless","Tiny Leaders","Value Vintage","Vintage","None"],Tx=["Paste List","Import File","Import from Website"],Al=["Commander / EDH","Brawl","Oathbreaker","Duel Commander","Tiny Leaders","Pauper EDH","Centurion","PreDH","Archon","Conquest"];function Ex({onCreate:a}){return l.jsx("div",{style:{marginBottom:24},children:l.jsx("button",{style:{marginTop:8},onClick:()=>{console.log("Create New Deck clicked"),a()},children:"Create New Deck"})})}const Mp=`4 Accumulated Knowledge
2 Brainstorm
10 Dandân
2 Diminishing Returns
1 Foil
2 Halimar Depths
22 Island
2 Izzet Boilerworks
2 Lonely Sandbar
4 Magical Hack
8 Memory Lapse
2 Mental Note
1 Mind Bend
1 Miscalculation
2 Mystic Retrieval
2 Portent
2 Ray of Command
2 Remote Isle
1 Supplant Form
4 Telling Time
2 Temple of Epiphany
2 Vision Charm`,kx=ke.memo(function({open:r,onClose:s}){const[i,d]=v.useState(""),[f,g]=v.useState(od[0]),[p,m]=v.useState(""),[h,y]=v.useState(""),[b,S]=v.useState(""),[E,_]=v.useState(null),[j,T]=v.useState(!1),[N,O]=v.useState(""),[D,L]=v.useState(null),[$,V]=v.useState(""),H=ke.useRef(),C=ke.useRef(),I=ke.useRef(),U=ke.useRef(),A=ma();ke.useEffect(()=>{r&&(d(""),g(od[0]),m(""),y(""),S(""),_(null),O(""),L(null),V(""),setTimeout(()=>{H.current&&H.current.focus()},100))},[r]),ke.useEffect(()=>{p==="Paste List"&&C.current&&C.current.focus(),p==="Import from Website"&&I.current&&I.current.focus(),p==="Import File"&&U.current&&(U.current.value="")},[p]),ke.useEffect(()=>{if(!r)return;const oe=G=>{G.key==="Escape"&&s()};return window.addEventListener("keydown",oe),()=>window.removeEventListener("keydown",oe)},[r,s]),ke.useEffect(()=>{f==="Dandan"&&(m("Paste List"),y(Mp))},[f]);const ee=async()=>{var oe,G,P;if(console.log("🚀 handleCreate called!",{name:i,format:f,importType:p,pastedList:h==null?void 0:h.substring(0,100)}),O(""),L(null),!i.trim()){O("Deck name is required"),console.log("❌ Error: Deck name is required");return}console.log("✅ Starting deck creation process..."),T(!0);try{let R,M;const W=localStorage.getItem("token");if(console.log("🔑 Token available:",!!W),!p){let se={name:i,format:f,cards:[]};if($&&Al.includes(f)&&(se.commander=typeof $=="string"?$:$.name,console.log("🎯 Commander being added to deck:",{commanderType:typeof $,commanderName:$.name||$,hasImageUris:!!$.image_uris,hasArtCrop:!!((oe=$.image_uris)!=null&&oe.art_crop),artCropUrl:(G=$.image_uris)==null?void 0:G.art_crop,fullCommander:$}),typeof $=="object"&&$.name&&(se.cards.push({quantity:1,scryfallCard:$,printing:$.set||"unknown"}),console.log("✅ Commander added to cards array:",{quantity:1,scryfallCard:!!$,printing:$.set||"unknown",hasArtCrop:!!((P=$.image_uris)!=null&&P.art_crop)}))),console.log("[DEBUG] Creating deck with body:",se),R=await fetch("/api/decks",{method:"POST",headers:{"Content-Type":"application/json",...W?{Authorization:`Bearer ${W}`}:{}},body:JSON.stringify(se),credentials:"include"}),M=await R.json(),console.log("[DEBUG] Server response after deck creation:",M),console.log("[DEBUG] Server response commander properties:",{commander:M.commander,commanderNames:M.commanderNames,hasCommander:"commander"in M,hasCommanderNames:"commanderNames"in M,allKeys:Object.keys(M)}),se.commander&&!M.commander&&(console.log("[COMMANDER FIX] Server lost commander data during creation, restoring:",{originalCommander:se.commander,originalCommanderNames:se.commanderNames,serverResponse:M.commander}),M.commander=se.commander,se.commanderNames&&(M.commanderNames=se.commanderNames)),!R.ok)throw new Error(M.error||"Failed to create deck");T(!1),s(),M._id&&A(`/decks/${M._id}`);return}if(p==="Import File"){if(!E){O("Please select a file to import"),T(!1);return}const se=new FormData;se.append("file",E),se.append("name",i),se.append("format",f),$&&Al.includes(f)&&se.append("commander",$),R=await fetch("/api/decks",{method:"POST",body:se,credentials:"include",headers:W?{Authorization:`Bearer ${W}`}:{}})}else{let se={name:i,format:f};if(p==="Paste List"){let fe=yh(h);if((!fe||fe.length===0)&&(fe=_x(h)),fe&&fe.length>0){se.cards=[];for(const te of fe)for(let K=0;K<te.quantity;K++)se.cards.push({name:te.name,set:te.set,collectorNumber:te.collectorNumber,foil:te.foil||!1})}else se.pastedList=h}p==="Import from Website"&&(se.websiteUrl=b),$&&Al.includes(f)&&(se.commander=typeof $=="string"?$:$.name);const he="";console.log("🌐 Making request to:",`${he}/api/decks`),console.log("📦 Request body:",JSON.stringify(se,null,2)),R=await fetch(`${he}/api/decks`,{method:"POST",headers:{"Content-Type":"application/json",...W?{Authorization:`Bearer ${W}`}:{}},body:JSON.stringify(se),credentials:"include"}),console.log("📡 Response status:",R.status,R.statusText)}if(M=await R.json(),console.log("📋 Response data:",M),console.log("🆔 Response has ID:",!!M._id,"ID value:",M._id),!R.ok)throw new Error(M.error||"Import failed");if(console.log("🎯 Setting deck preview:",M.deck),L(M.deck),M.deck&&M.deck._id){console.log("✅ Deck created successfully, navigating to:",`/decks/${M.deck._id}`),T(!1),s(),A(`/decks/${M.deck._id}`);return}else if(M._id){console.log("✅ Deck created (direct ID), navigating to:",`/decks/${M._id}`),T(!1),s(),A(`/decks/${M._id}`);return}else console.log("❌ No deck ID found in response")}catch(R){p==="Import from Website"&&b&&/moxfield\.com/.test(b)&&/moxfield/i.test(R.message)?(O("Automatic import from Moxfield is currently not supported due to site restrictions. Please export your deck as text from Moxfield and upload or paste it here."),m("Paste List"),setTimeout(()=>{C.current&&C.current.focus()},100)):O(R.message)}finally{T(!1)}};return r?l.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.35)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsxs("div",{style:{background:"#fff",borderRadius:8,boxShadow:"0 2px 16px rgba(0,0,0,0.18)",padding:28,minWidth:340,maxWidth:420,width:"100%",position:"relative"},children:[l.jsx("button",{onClick:s,style:{position:"absolute",top:12,right:12,background:"none",border:"none",fontSize:22,cursor:"pointer",color:"#888"},"aria-label":"Close",children:"×"}),l.jsx("h2",{style:{marginTop:0,marginBottom:18},children:"Create New Deck"}),l.jsxs("div",{style:{marginBottom:18},children:[l.jsx("label",{style:{display:"block",fontWeight:500,marginBottom:4},children:"Name"}),l.jsx("input",{ref:H,value:i,onChange:oe=>d(oe.target.value),placeholder:"Deck Name",required:!0,style:{width:"100%",marginBottom:10,padding:10,borderRadius:4,border:"1px solid #ddd",backgroundColor:"white",fontSize:"14px",color:"#333"},maxLength:100,title:"Deck name can include letters, numbers, spaces, and basic punctuation."}),l.jsx("label",{style:{display:"block",fontWeight:500,marginBottom:4},children:"Format"}),l.jsx("select",{value:f,onChange:oe=>g(oe.target.value),style:{width:"100%",marginBottom:10,padding:10,borderRadius:4,border:"1px solid #ddd",backgroundColor:"white",fontSize:"14px",color:"#333"},children:od.map(oe=>l.jsx("option",{value:oe,children:oe},oe))})]}),Al.includes(f)&&l.jsx("div",{style:{marginBottom:18},children:l.jsx(Ol,{value:$,onChange:V,onSelect:V})}),l.jsxs("div",{style:{marginBottom:18},children:[l.jsx("label",{style:{display:"block",fontWeight:500,marginBottom:4},children:"Deck Import (optional)"}),l.jsxs("select",{value:p,onChange:oe=>m(oe.target.value),style:{width:"100%",marginBottom:10,padding:10,borderRadius:4,border:"1px solid #ddd",backgroundColor:"white",fontSize:"14px",color:"#333"},disabled:f==="Dandan",children:[l.jsx("option",{value:"",children:"Choose import method here..."}),Tx.map(oe=>l.jsx("option",{value:oe,children:oe},oe))]}),p==="Paste List"&&(f==="Dandan"?l.jsx("textarea",{value:Mp,readOnly:!0,style:{width:"100%",minHeight:180,marginBottom:8,padding:10,borderRadius:4,border:"1px solid #ddd",background:"#f8f8f8",color:"#333",fontSize:"14px",fontWeight:500}}):l.jsx("textarea",{ref:C,value:h,onChange:oe=>y(oe.target.value),placeholder:"Paste your deck list here...",style:{width:"100%",minHeight:80,marginBottom:8,padding:10,borderRadius:4,border:"1px solid #ddd",backgroundColor:"white",fontSize:"14px",color:"#333"}})),p==="Import File"&&l.jsxs("div",{style:{marginBottom:8},children:[l.jsxs("label",{style:{display:"inline-block",padding:"8px 16px",background:"#eee",borderRadius:4,border:"1px solid #bbb",color:"#333",cursor:"pointer",marginBottom:8,fontWeight:500},children:["Choose file...",l.jsx("input",{ref:U,type:"file",accept:".txt,.dek,.csv,.mwDeck,.cod,.json",onChange:oe=>_(oe.target.files[0]),style:{display:"none"}})]}),E&&l.jsx("span",{style:{marginLeft:10},children:E.name}),l.jsx("button",{style:{width:"100%",padding:8,borderRadius:4,background:"#1976d2",color:"#fff",border:"none",fontWeight:500,marginTop:8},onClick:ee,disabled:j||!E,children:j?"Importing...":"Import from file..."})]}),p==="Import from Website"&&l.jsxs("div",{style:{marginBottom:8},children:[l.jsx("input",{ref:I,type:"text",value:b,onChange:oe=>S(oe.target.value),placeholder:"Paste website link here",style:{width:"100%",padding:8,borderRadius:4,border:"1px solid #bbb",marginBottom:4}}),l.jsx("div",{style:{color:"#888",fontSize:13},children:"Paste website link here"})]})]}),N&&l.jsx("div",{style:{color:"#c00",background:"#ffeaea",borderRadius:4,padding:"6px 10px",marginBottom:10},children:N}),D&&l.jsxs("div",{style:{background:"#f5f5f5",padding:12,borderRadius:4,marginBottom:10,maxHeight:180,overflow:"auto"},children:[l.jsx("b",{children:"Deck Preview:"}),l.jsx("pre",{style:{fontSize:13,whiteSpace:"pre-wrap",margin:0},children:JSON.stringify(D,null,2)})]}),l.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:p!=="Import File"&&l.jsx("button",{onClick:ee,style:{padding:"8px 16px",background:"#1976d2",color:"#fff",border:"none",borderRadius:4,fontWeight:500},disabled:j,children:j?"Importing...":"Create"})})]})}):null}),Ax=ke.memo(function({decks:r,onSelect:s}){if(!r||r.length===0)return null;const d=[...r].sort((m,h)=>new Date(h.updatedAt||h.createdAt)-new Date(m.updatedAt||m.createdAt)).slice(0,5),f=m=>!m.cards||m.cards.length===0?0:m.cards.reduce((h,y)=>h+(y.quantity||1),0),g=m=>!m||m.length<36?null:`https://cards.scryfall.io/art_crop/front/${m.substring(0,1)}/${m.substring(1,2)}/${m}.jpg`,p=m=>{var S,E,_,j,T,N,O,D,L,$,V,H,C,I,U,A,ee,oe,G,P,R,M,W,se,he,fe,te,K,ae,re;if(!m.cards||m.cards.length===0)return null;if(m.customPreviewImage)return console.log("🖼️ Using custom preview image for deck:",m.name,m.customPreviewImage),m.customPreviewImage;const h=m.cards.find(ue=>{var Ce,Te,_e,Pe,rt;const me=((Ce=ue.scryfallCard)==null?void 0:Ce.type_line)||((_e=(Te=ue.card)==null?void 0:Te.scryfall_json)==null?void 0:_e.type_line)||((Pe=ue.scryfall_json)==null?void 0:Pe.type_line)||ue.type_line||((rt=ue.card)==null?void 0:rt.type_line);return me&&me.toLowerCase().includes("legendary")&&me.toLowerCase().includes("creature")});if(h){const ue=((E=(S=h==null?void 0:h.scryfallCard)==null?void 0:S.image_uris)==null?void 0:E.art_crop)||((T=(j=(_=h==null?void 0:h.card)==null?void 0:_.scryfall_json)==null?void 0:j.image_uris)==null?void 0:T.art_crop)||((O=(N=h==null?void 0:h.scryfall_json)==null?void 0:N.image_uris)==null?void 0:O.art_crop)||((D=h==null?void 0:h.image_uris)==null?void 0:D.art_crop)||(($=(L=h==null?void 0:h.card)==null?void 0:L.image_uris)==null?void 0:$.art_crop);if(ue)return ue;const me=((V=h==null?void 0:h.scryfallCard)==null?void 0:V.id)||((C=(H=h==null?void 0:h.card)==null?void 0:H.scryfall_json)==null?void 0:C.id)||((I=h==null?void 0:h.scryfall_json)==null?void 0:I.id)||(h==null?void 0:h.id)||((U=h==null?void 0:h.card)==null?void 0:U.id);if(me)return g(me)}const y=m.cards.find(ue=>{var Ce,Te,_e,Pe,rt,nt,_t,en,It,Rt;return!!(((Te=(Ce=ue.scryfallCard)==null?void 0:Ce.image_uris)==null?void 0:Te.art_crop)||((rt=(Pe=(_e=ue.card)==null?void 0:_e.scryfall_json)==null?void 0:Pe.image_uris)==null?void 0:rt.art_crop)||((_t=(nt=ue.scryfall_json)==null?void 0:nt.image_uris)==null?void 0:_t.art_crop)||((en=ue.image_uris)==null?void 0:en.art_crop)||((Rt=(It=ue.card)==null?void 0:It.image_uris)==null?void 0:Rt.art_crop))});if(y){const ue=((ee=(A=y==null?void 0:y.scryfallCard)==null?void 0:A.image_uris)==null?void 0:ee.art_crop)||((P=(G=(oe=y==null?void 0:y.card)==null?void 0:oe.scryfall_json)==null?void 0:G.image_uris)==null?void 0:P.art_crop)||((M=(R=y==null?void 0:y.scryfall_json)==null?void 0:R.image_uris)==null?void 0:M.art_crop)||((W=y==null?void 0:y.image_uris)==null?void 0:W.art_crop)||((he=(se=y==null?void 0:y.card)==null?void 0:se.image_uris)==null?void 0:he.art_crop);return console.log("🖼️ Found card art crop from data:",m.name,ue),ue}const b=m.cards.find(ue=>{var Ce,Te,_e,Pe,rt;const me=((Ce=ue.scryfallCard)==null?void 0:Ce.id)||((_e=(Te=ue.card)==null?void 0:Te.scryfall_json)==null?void 0:_e.id)||((Pe=ue.scryfall_json)==null?void 0:Pe.id)||ue.id||((rt=ue.card)==null?void 0:rt.id);return me&&me.length>=36});if(b){const ue=((fe=b.scryfallCard)==null?void 0:fe.id)||((K=(te=b.card)==null?void 0:te.scryfall_json)==null?void 0:K.id)||((ae=b.scryfall_json)==null?void 0:ae.id)||b.id||((re=b.card)==null?void 0:re.id),me=g(ue);return console.log("🖼️ Generated art crop from any card ID for:",m.name,me),me}return null};return l.jsxs("div",{style:{marginTop:24},children:[l.jsx("h3",{style:{textAlign:"center",marginBottom:"1.5rem",color:"#333"},children:"Recent Decks"}),l.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:32,flexWrap:"nowrap",overflowX:"auto",paddingBottom:20,maxWidth:"100vw",padding:"16px 2rem 24px 2rem"},children:d.map(m=>{const h=p(m);return l.jsx("div",{style:{width:180,height:130,minWidth:180,position:"relative",transition:"all 0.3s ease",transformOrigin:"center"},onMouseEnter:y=>{y.currentTarget.style.transform="translateY(-4px) scale(1.08)",y.currentTarget.style.zIndex="10";const b=y.currentTarget.querySelector("button");b&&(b.style.boxShadow="0 8px 32px rgba(0,0,0,0.25)",b.style.border="3px solid #4CAF50")},onMouseLeave:y=>{y.currentTarget.style.transform="translateY(0) scale(1)",y.currentTarget.style.zIndex="1";const b=y.currentTarget.querySelector("button");b&&(b.style.boxShadow="0 4px 16px rgba(0,0,0,0.15)",b.style.border="2px solid #ddd")},children:l.jsxs("button",{onClick:()=>s(m._id),style:{width:"100%",height:"100%",borderRadius:16,border:"2px solid #ddd",background:h?"transparent":"#f5f5f5",cursor:"pointer",fontSize:14,fontWeight:600,boxSizing:"border-box",textAlign:"center",position:"relative",boxShadow:"0 4px 16px rgba(0,0,0,0.15)",overflow:"hidden",padding:0,display:"flex",alignItems:"flex-end",justifyContent:"center",flexDirection:"column",transition:"all 0.3s ease"},children:[h&&l.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundImage:`url(${h})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",borderRadius:"14px"}}),l.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"40%",background:"linear-gradient(to top, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.4) 50%, transparent 100%)",borderBottomLeftRadius:14,borderBottomRightRadius:14}}),l.jsxs("div",{style:{position:"absolute",bottom:0,left:0,right:0,padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",zIndex:2},children:[l.jsx("span",{style:{color:"#fff",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",fontSize:"14px",fontWeight:"700",textShadow:"0 2px 4px rgba(0,0,0,0.8)",marginBottom:"2px"},children:m.name}),l.jsxs("span",{style:{color:"rgba(255,255,255,0.9)",fontSize:"11px",fontWeight:"500",textShadow:"0 1px 2px rgba(0,0,0,0.6)"},children:[f(m)," cards"]})]}),!h&&l.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",color:"#666",fontSize:"14px",fontWeight:"600"},children:[l.jsx("div",{style:{marginBottom:"8px",fontSize:"16px"},children:"📋"}),l.jsx("div",{style:{color:"#333",marginBottom:"4px"},children:m.name}),l.jsxs("div",{style:{color:"#666",fontSize:"11px"},children:[f(m)," cards"]})]})]})},m._id)})})]})}),Dx=ke.memo(function({decks:r,onSelect:s,refreshDecks:i}){var E;if(!r||r.length===0)return null;const[d,f]=v.useState(null),[g,p]=v.useState({open:!1,x:0,y:0,deck:null}),m=_=>!_.cards||_.cards.length===0?0:_.cards.reduce((j,T)=>j+(T.quantity||1),0),h=({x:_,y:j,onClose:T,onCopyLink:N,onDelete:O,onDuplicate:D})=>(console.log("DeckContextMenu rendering at",{x:_,y:j}),l.jsxs("div",{style:{position:"fixed",top:Math.min(j,window.innerHeight-200),left:Math.min(_,window.innerWidth-200),background:"white",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:10001,minWidth:"150px"},onContextMenu:L=>L.preventDefault(),onClick:L=>L.stopPropagation(),children:[l.jsx("button",{onClick:()=>{console.log("Copy link clicked"),N(),T()},style:{display:"block",width:"100%",padding:"8px 12px",border:"none",background:"none",textAlign:"left",cursor:"pointer",fontSize:"14px",color:"#333"},onMouseEnter:L=>L.target.style.backgroundColor="#f5f5f5",onMouseLeave:L=>L.target.style.backgroundColor="transparent",children:"Copy Deck Link"}),l.jsx("button",{onClick:()=>{console.log("Duplicate clicked"),D(),T()},style:{display:"block",width:"100%",padding:"8px 12px",border:"none",background:"none",textAlign:"left",cursor:"pointer",fontSize:"14px",color:"#333"},onMouseEnter:L=>L.target.style.backgroundColor="#f5f5f5",onMouseLeave:L=>L.target.style.backgroundColor="transparent",children:"Duplicate Deck"}),l.jsx("hr",{style:{margin:"4px 0",border:"0",borderTop:"1px solid #eee"}}),l.jsx("button",{onClick:()=>{console.log("Delete clicked"),O(),T()},style:{display:"block",width:"100%",padding:"8px 12px",border:"none",background:"none",textAlign:"left",cursor:"pointer",fontSize:"14px",color:"#dc3545"},onMouseEnter:L=>L.target.style.backgroundColor="#fff5f5",onMouseLeave:L=>L.target.style.backgroundColor="transparent",children:"Delete Deck"})]}));v.useEffect(()=>{if(!g.open)return;console.log("Context menu useEffect triggered, open:",g.open);const _=j=>{console.log("Close event triggered:",j.type),p({open:!1,x:0,y:0,deck:null})};return window.addEventListener("click",_),window.addEventListener("contextmenu",_),()=>{window.removeEventListener("click",_),window.removeEventListener("contextmenu",_)}},[g.open]);const y=async _=>{try{const j=localStorage.getItem("token");(await fetch(`/api/decks/${_}`,{method:"DELETE",headers:j?{Authorization:`Bearer ${j}`}:{},credentials:"include"})).ok?(console.log("✅ Deck deleted successfully, calling refreshDecks()"),i(),console.log("🔄 refreshDecks() called")):(console.error("Failed to delete deck"),alert("Failed to delete deck. Please try again."))}catch(j){console.error("Error deleting deck:",j),alert("Error deleting deck. Please try again.")}f(null)},b=async _=>{try{const j=window.location.origin+`/decks/${_._id}`;await navigator.clipboard.writeText(j),console.log("Deck link copied:",j)}catch(j){console.error("Failed to copy deck link:",j)}},S=async _=>{try{const j=localStorage.getItem("token"),N=await fetch(`/api/decks/${_._id}/duplicate`,{method:"POST",headers:{"Content-Type":"application/json",...j?{Authorization:`Bearer ${j}`}:{}},credentials:"include"});if(N.ok){const O=await N.json();window.location.reload()}else console.error("Failed to duplicate deck"),alert("Failed to duplicate deck. Please try again.")}catch(j){console.error("Error duplicating deck:",j),alert("Error duplicating deck. Please try again.")}};return l.jsxs("div",{style:{marginTop:32},children:[l.jsx("h3",{style:{marginBottom:"1rem",color:"#333"},children:"All Decks"}),l.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",background:"#fafbfc",borderRadius:8,overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[l.jsx("thead",{children:l.jsxs("tr",{style:{background:"#f0f0f0"},children:[l.jsx("th",{style:{textAlign:"left",padding:"12px"},children:"Name"}),l.jsx("th",{style:{textAlign:"left",padding:"12px"},children:"Format"}),l.jsx("th",{style:{textAlign:"left",padding:"12px"},children:"Cards"}),l.jsx("th",{style:{textAlign:"left",padding:"12px"},children:"Last Modified"}),l.jsx("th",{style:{padding:"12px",width:"50px"}})]})}),l.jsx("tbody",{children:r.map(_=>l.jsxs("tr",{style:{borderBottom:"1px solid #eee",transition:"background-color 0.2s ease",cursor:"pointer"},onClick:j=>{j.target.closest(".delete-button")||s(_._id)},onContextMenu:j=>{j.preventDefault(),j.stopPropagation(),p({open:!0,x:j.clientX,y:j.clientY,deck:_})},onMouseEnter:j=>{j.currentTarget.style.backgroundColor="#f5f5f5"},onMouseLeave:j=>{j.currentTarget.style.backgroundColor="transparent"},children:[l.jsx("td",{style:{padding:"8px 12px",fontWeight:500},children:_.name}),l.jsx("td",{style:{padding:"8px 12px",color:"#666"},children:_.format||"-"}),l.jsx("td",{style:{padding:"8px 12px",color:"#666"},children:m(_)}),l.jsx("td",{style:{padding:"8px 12px",color:"#666",fontSize:"13px"},children:_.updatedAt?new Date(_.updatedAt).toLocaleDateString():_.createdAt?new Date(_.createdAt).toLocaleDateString():""}),l.jsx("td",{style:{padding:"8px 12px"},children:l.jsx("button",{className:"delete-button",onClick:j=>{j.stopPropagation(),f(_._id)},style:{padding:"6px 8px",borderRadius:4,border:"none",background:"transparent",color:"#dc3545",cursor:"pointer",fontSize:"16px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:j=>{j.target.style.background="#fff5f5",j.target.style.color="#b02a37"},onMouseLeave:j=>{j.target.style.background="transparent",j.target.style.color="#dc3545"},title:"Delete deck",children:"🗑️"})})]},_._id))})]}),d&&l.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e4,display:"flex",justifyContent:"center",alignItems:"center"},children:l.jsxs("div",{style:{backgroundColor:"white",borderRadius:8,padding:"24px",maxWidth:"400px",width:"90%",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.2)"},children:[l.jsx("h3",{style:{margin:"0 0 16px 0",color:"#333"},children:"Delete Deck"}),l.jsxs("p",{style:{margin:"0 0 20px 0",color:"#666"},children:['Are you sure you want to delete "',(E=r.find(_=>_._id===d))==null?void 0:E.name,'"? This action cannot be undone.']}),l.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[l.jsx("button",{onClick:()=>f(null),style:{padding:"8px 16px",borderRadius:4,border:"1px solid #ccc",background:"white",color:"#333",cursor:"pointer",fontSize:"14px"},children:"Cancel"}),l.jsx("button",{onClick:()=>y(d),style:{padding:"8px 16px",borderRadius:4,border:"none",background:"#dc3545",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Delete"})]})]})}),g.open&&l.jsxs(l.Fragment,{children:[console.log("Rendering context menu:",g),l.jsx(h,{x:g.x,y:g.y,onClose:()=>p({open:!1,x:0,y:0,deck:null}),onCopyLink:()=>b(g.deck),onDelete:()=>f(g.deck._id),onDuplicate:()=>S(g.deck)})]})]})});function Rx(){const[a,r]=v.useState(!1),[s,i]=v.useState([]),[d,f]=v.useState(0),[g,p]=v.useState(!1),m=ma(),h=v.useRef(),y=v.useCallback(()=>{f(b=>b+1)},[]);return v.useEffect(()=>{const b=localStorage.getItem("deck-updated-timestamp");if(b){const S=parseInt(b);Date.now()-S<2*60*1e3&&y()}},[]),v.useEffect(()=>{const b=()=>{const j=localStorage.getItem("deck-updated-timestamp");if(j){const T=parseInt(j);Date.now()-T<3e5&&y()}},S=()=>{document.hidden||b()},E=()=>{y()},_=j=>{j.key==="deck-updated-timestamp"&&(console.log("Detected deck update from another tab, refreshing..."),y())};return window.addEventListener("focus",b),window.addEventListener("deck-updated",E),window.addEventListener("storage",_),document.addEventListener("visibilitychange",S),()=>{window.removeEventListener("focus",b),window.removeEventListener("deck-updated",E),window.removeEventListener("storage",_),document.removeEventListener("visibilitychange",S)}},[y]),v.useEffect(()=>{if(!(s.length>0&&d===0||g))return h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{const b=localStorage.getItem("token");if(!b){i([]);return}p(!0),fetch("/api/decks/mine",{headers:b?{Authorization:`Bearer ${b}`}:{},credentials:"include"}).then(async E=>{if(E.status===429){i([]);return}try{return await E.json()}catch(_){return console.error("JSON parse error:",_),[]}}).catch(E=>(console.error("Fetch failed:",E),i([]),p(!1),[])).then(E=>{Array.isArray(E)?i(E):E&&Array.isArray(E.decks)?i(E.decks):i([])}).finally(()=>{p(!1)})},100),()=>clearTimeout(h.current)},[d,s.length,g]),l.jsxs("div",{style:{maxWidth:"1400px",margin:"2rem auto",padding:"0 2rem",width:"100%",boxSizing:"border-box"},children:[l.jsx("h1",{style:{textAlign:"center",fontSize:"2.5rem",fontWeight:700,marginBottom:"2rem",color:"#333"},children:"Build"}),l.jsx(Ex,{onCreate:()=>r(!0)}),l.jsx(Ax,{decks:s,onSelect:b=>m(`/decks/${b}`)}),l.jsx(Dx,{decks:s,onSelect:b=>m(`/decks/${b}`),refreshDecks:y}),l.jsx(kx,{open:a,onClose:()=>r(!1)})]})}const Nx=a=>l.jsx(as,{children:l.jsx(Rx,{...a})}),dr=new Map,ir={maxRequestsPerSecond:9.5,maxConcurrent:5,retryAttempts:2,baseDelay:105,retryDelay:800,backoffMultiplier:1.8};let sd=0,zp=0,Ml=[];const rs=new Map;let cr=0;async function Ox(a){if(!a||!a.name||zx(a))return a;const r=`${a.name}|${a.set}|${a.collector_number}`,s=rs.get(r);if(s)return cr++,{...s,quantity:a.quantity};try{const i=await $x(a);if(i){const d=Ux(a,i),f={...d};return delete f.quantity,rs.set(r,f),d}}catch(i){return i.message.includes("Card not found")?(console.log(`📝 ${a.name} (${a.set}/${a.collector_number}) not found in Scryfall, using basic data`),{...a,enrichment_status:"not_found",enrichment_note:"Card printing not found in Scryfall database"}):(console.warn(`⚠️ Failed to enrich ${a.name}:`,i.message),{...a,enrichment_status:"failed",enrichment_note:`API error: ${i.message}`})}return{...a,enrichment_status:"no_data",enrichment_note:"No additional data available"}}async function Mx(a,r={}){return new Promise((s,i)=>{Ml.push({apiCall:a,context:r,resolve:s,reject:i,attempts:0}),wd()})}async function wd(){if(sd>=ir.maxConcurrent||Ml.length===0)return;const{apiCall:a,context:r,resolve:s,reject:i,attempts:d}=Ml.shift();sd++;try{const g=Date.now()-zp,p=1e3/ir.maxRequestsPerSecond;g<p&&await new Promise(h=>setTimeout(h,p-g)),zp=Date.now(),r&&r.progressCallback&&r.progressCallback({phase:"api",current:r.processed||0,total:r.total||0,message:"Enriching card data..."});const m=await a();s(m)}catch(f){if(f.message.includes("404")||f.response&&f.response.status===404){console.log(`ℹ️ Card not found in Scryfall: ${r.cardName||"unknown"} - this is normal for some promotional/limited cards`),i(new Error(`Card not found: ${r.cardName||"unknown"}`));return}if(d<ir.retryAttempts&&(f.message.includes("Failed to fetch")||f.message.includes("CORS")||f.message.includes("429"))){const g=ir.retryDelay*Math.pow(ir.backoffMultiplier,d);console.log(`⏳ Retrying ${r.cardName||"API call"} after ${g}ms (attempt ${d+1})`),setTimeout(()=>{Ml.unshift({apiCall:a,context:r,resolve:s,reject:i,attempts:d+1}),wd()},g)}else console.warn(`❌ API call failed permanently: ${f.message}`),i(f)}finally{sd--,setTimeout(wd,ir.baseDelay)}}async function bh(a,r,s={}){var j,T,N,O,D,L;const{maxConcurrent:i=5,enableRetries:d=!0,isLargeImport:f=!1}=s,g=f?40:25,p=f?200:50,m=[],h=[];let y=0;const b=Bx(a);console.log(`📊 Processing ${b.length} unique cards (${a.length} total)`);let S=g,E=p;if(f&&a.length>5e3){console.log("� Optimizing for large import (>5000 cards) - using aggressive performance settings"),S=50,E=Math.max(p,250);const $=Math.ceil(b.length/(ir.maxRequestsPerSecond*60));console.log(`📊 Estimated processing time: ~${$} minutes for ${b.length} unique cards`)}for(let $=0;$<b.length;$+=S){const V=b.slice($,$+S);try{const H=await Promise.allSettled(V.map((C,I)=>Mx(()=>Ox(C),{cardName:C.name,processed:y+I,total:b.length,progressCallback:r})));for(let C=0;C<H.length;C++){const I=H[C],U=V[C];if(I.status==="fulfilled"){const A=I.value;m.push(A),A.enrichment_status==="not_found"?h.push({card:U.name,type:"404_not_found",error:"Card printing not in Scryfall database (normal for some promotional cards)"}):A.enrichment_status==="failed"&&h.push({card:U.name,type:"api_error",error:A.enrichment_note})}else{const A=((T=(j=I.reason)==null?void 0:j.message)==null?void 0:T.includes("Card not found"))||((O=(N=I.reason)==null?void 0:N.message)==null?void 0:O.includes("404"));m.push({...U,enrichment_status:A?"not_found":"failed",enrichment_note:((D=I.reason)==null?void 0:D.message)||"Unknown enrichment error"}),h.push({card:U.name,type:A?"404_not_found":"api_error",error:((L=I.reason)==null?void 0:L.message)||"Unknown error"})}y++,(y%E===0||y===b.length)&&r&&r(y,b.length,{enriched:y-h.length,errors:h.length,cacheHits:cr,cacheSize:rs.size})}if($+S<b.length){const C=f?50:200;await new Promise(I=>setTimeout(I,C))}}catch(H){console.error(`❌ Batch error processing cards ${$}-${$+S}:`,H);for(const C of V)m.push(C),h.push({card:C.name,type:"batch_error",error:H.message})}}const _=Ix(a,m);if(h.length>0){const $=h.reduce((I,U)=>(I[U.type]=(I[U.type]||0)+1,I),{});console.log(`📊 Import Summary for ${a.length} cards:`),console.log(`   ✅ Successfully processed: ${_.length-h.length}`),console.log(`   🚀 Cache hits: ${cr} (saved ${cr} API calls)`),console.log(`   💾 Session cache size: ${rs.size} unique cards`),$["404_not_found"]&&console.log(`   📝 Cards not found in Scryfall: ${$["404_not_found"]} (normal for promotional/limited cards)`),$.api_error&&console.log(`   ❌ API errors: ${$.api_error}`);const V=h.filter(I=>I.type==="404_not_found").slice(0,3);V.length>0&&console.log(`   📋 Example cards not found: ${V.map(I=>I.card).join(", ")}`);const H=b.length-cr,C=cr*.11;console.log(`   ⚡ Performance: ${H} API calls made, saved ~${C.toFixed(1)}s with caching`)}else console.log(`✅ All ${a.length} cards processed successfully!`),console.log(`🚀 Cache performance: ${cr} hits, ${rs.size} entries`);return _}function zx(a){return!!(a.type_line&&a.color_identity!==void 0&&a.set_name&&a.mana_cost!==void 0&&a.cmc!==void 0)}function $p(a){return!a||typeof a!="string"?a:a.replace(/^0+([0-9])/,"$1")}async function $x(a){const r=$l(a);if(dr.has(r))return dr.get(r);let s="";if(a.set&&a.collector_number){const i=$p(a.collector_number);i!==a.collector_number&&console.log(`🔧 Normalizing collector number for ${a.name}: "${a.collector_number}" -> "${i}"`),s=`https://api.scryfall.com/cards/${a.set.toLowerCase()}/${i}`}else a.name&&(s=`https://api.scryfall.com/cards/named?exact=${encodeURIComponent(a.name)}`);if(!s)return null;try{const i=await fetch(s,{headers:{Accept:"application/json","User-Agent":"ConstantLists/1.0"}});if(i.status===429){const f=i.headers.get("Retry-After")||"2";throw new Error(`Rate limited, retry after ${f}s`)}if(!i.ok){if(a.set&&a.collector_number&&i.status===404){const f=a.collector_number,g=$p(f);if(console.log(`🔍 Card not found: ${a.name} (${a.set}/${f})`),f!==g){console.log(`   🔄 Trying original collector number: ${f}`);const p=`https://api.scryfall.com/cards/${a.set.toLowerCase()}/${f}`;try{const m=await fetch(p);if(m.ok){const h=await m.json();return console.log("   ✅ Found with original collector number!"),dr.set(r,h),h}}catch{console.log("   ❌ Original collector number also failed")}}return console.log(`   🔄 Trying name-only search for: ${a.name}`),await Lx(a.name)}if(i.status>=500)throw new Error(`Server error: ${i.status}`);return null}const d=await i.json();return dr.set(r,d),d}catch(i){throw i.message.includes("Failed to fetch")||console.warn(`Scryfall API error for ${a.name}:`,i.message),i}}async function Lx(a){const r=`name:${a}`;if(dr.has(r))return dr.get(r);try{const s=await fetch(`https://api.scryfall.com/cards/named?exact=${encodeURIComponent(a)}`,{headers:{Accept:"application/json","User-Agent":"ConstantLists/1.0"}});if(s.status===429){const d=s.headers.get("Retry-After")||"2";throw new Error(`Rate limited, retry after ${d}s`)}if(!s.ok)return null;const i=await s.json();return dr.set(r,i),i}catch(s){throw s.message.includes("Failed to fetch")||console.warn(`Name search error for ${a}:`,s.message),s}}function Ux(a,r){return{...a,type_line:a.type_line||r.type_line,color_identity:a.color_identity||r.color_identity||[],colors:a.colors||r.colors||[],set_name:a.set_name||r.set_name,mana_cost:a.mana_cost||r.mana_cost||"",cmc:a.cmc!==void 0?a.cmc:r.cmc||0,rarity:a.rarity||r.rarity,oracle_text:a.oracle_text||r.oracle_text,power:a.power||r.power,toughness:a.toughness||r.toughness,loyalty:a.loyalty||r.loyalty,scryfall_json:r,enriched:!0,enrichedAt:new Date().toISOString()}}function $l(a){return a.set&&a.collector_number?`${a.set.toLowerCase()}:${a.collector_number}`:`name:${a.name}`}async function fr(a,r={}){const{showProgress:s=!0,batchSize:i=50,skipEnrichment:d=!1}=r;if(!Array.isArray(a)||a.length===0)return a;if(console.log(`🔧 Processing ${a.length} imported cards...`),d)return a.map(g=>({...g,dateAdded:g.dateAdded||new Date().toISOString(),source:g.source||"import"}));let f;s&&(f=ce.info("Enriching card data...",{autoClose:!1}));try{const g=await bh(a,(p,m)=>{s&&ce.update(f,{render:`Enriching card data... ${p}/${m}`,type:"info"})});return s&&ce.update(f,{render:`✅ Enriched ${g.length} cards with complete data!`,type:"success",autoClose:3e3}),console.log(`✅ Card processing complete: ${g.length} cards enriched`),g}catch(g){return console.error("Error processing imported cards:",g),s&&ce.update(f,{render:"Error enriching card data",type:"error",autoClose:3e3}),a}}function Bx(a){const r=new Map;for(const s of a){const i=$l(s);if(r.has(i)){const d=r.get(i);d.quantity=(d.quantity||1)+(s.quantity||1),d._duplicates=(d._duplicates||1)+1}else r.set(i,{...s,_duplicates:1})}return Array.from(r.values())}function Ix(a,r){const s=new Map;for(const i of r){const d=$l(i);s.set(d,i)}return a.map(i=>{const d=$l(i),f=s.get(d);return f?{...f,quantity:i.quantity,id:i.id,dateAdded:i.dateAdded||new Date().toISOString()}:i})}async function vh(a,r={}){if(!a||!a.trim())throw new Error("CSV data is empty");const s=a.trim().split(`
`);if(s.length<2)throw new Error("CSV must have at least a header row and one data row");const i=s.map(y=>Hx(y)),d=i[0].map(y=>y.toLowerCase().trim()),f=i.slice(1),g=qx(d);console.log("Detected column mappings:",g),console.log("CSV headers:",d);const p=[];for(const y of f)try{const b=Px(y,d,g);b&&b.name&&p.push(b)}catch(b){console.warn("Skipping invalid row:",y,b.message)}if(p.length===0)throw new Error("No valid cards found in CSV");const{enrichData:m=!1,showProgress:h=!0}=r;return m?await fr(p,h):p}function Hx(a){const r=[];let s="",i=!1,d=0;for(;d<a.length;){const f=a[d];f==='"'?i&&a[d+1]==='"'?(s+='"',d+=2):(i=!i,d++):f===","&&!i?(r.push(s),s="",d++):(s+=f,d++)}return r.push(s),r}function qx(a){const r={},s=["quantity","qty","count","amount","copies"];r.quantity=Ve(a,s);const i=["name","card name","cardname","card_name","title"];r.name=Ve(a,i);const d=["set","set name","setname","set_name","edition","edition name","edition_name","expansion","exp","set code","setcode"];r.set=Ve(a,d);const f=["set code","setcode","set_code","edition code","edition_code","exp","expansion code","code","set_abbr","abbr"];r.setCode=Ve(a,f);const g=["foil","finish","treatment","printing"];r.foil=Ve(a,g);const p=["condition","cond","grade","state"];r.condition=Ve(a,p);const m=["language","lang","locale"];r.language=Ve(a,m);const h=["collector number","collector_number","number","card number","card_number","#"];r.collectorNumber=Ve(a,h);const y=["mana cost","mana_cost","manacost","cost","cmc","mana value","mana_value"];r.manaCost=Ve(a,y);const b=["rarity","rare"];r.rarity=Ve(a,b);const S=["price","value","cost","purchase price","purchase_price","market_price","tcg_price"];r.price=Ve(a,S);const E=["type","card_type","types","type_line"];r.cardType=Ve(a,E);const _=["color","colors","color_identity"];r.colors=Ve(a,_);const j=["cmc","converted_mana_cost","mana_value"];r.cmc=Ve(a,j);const T=["signed","artist_signed"];r.signed=Ve(a,T);const N=["artist proof","artist_proof"];r.artistProof=Ve(a,N);const O=["altered art","altered_art","altered","alter"];r.altered=Ve(a,O);const D=["misprint","error"];r.misprint=Ve(a,D);const L=["promo","promotional"];r.promo=Ve(a,L);const $=["textless","no_text"];r.textless=Ve(a,$);const V=["my price","my_price","personal_price","purchase_price"];r.myPrice=Ve(a,V);const H=["card number","card_number","#","number","num"];r.cardNumber=Ve(a,H);const C=["edition","expansion","set name","set_name"];r.edition=Ve(a,C);const I=["market price","market_price","current_price"];r.marketPrice=Ve(a,I);const U=["low price","low_price","tcg_low"];r.lowPrice=Ve(a,U);const A=["mid price","mid_price","tcg_mid"];r.midPrice=Ve(a,A);const ee=["high price","high_price","tcg_high"];r.highPrice=Ve(a,ee);const oe=["tradelist","tradelist count","tradelist_count","for_trade"];r.tradelist=Ve(a,oe);const G=["wishlist","wishlist count","wishlist_count","wanted"];r.wishlist=Ve(a,G);const P=["notes","comment","comments","description"];r.notes=Ve(a,P);const R=["tags","tag","categories"];r.tags=Ve(a,R);const M=["date added","date_added","added_date","created_date","last modified","last_modified"];r.dateAdded=Ve(a,M);const W=["power","pow"];r.power=Ve(a,W);const se=["toughness","tou"];r.toughness=Ve(a,se);const he=["loyalty","starting_loyalty"];return r.loyalty=Ve(a,he),r}function Ve(a,r){for(const s of r){const i=a.findIndex(d=>d.includes(s));if(i!==-1)return i}return-1}function Fx(a){return a&&{mint:"NM","near mint":"NM",nm:"NM","mint/near mint":"NM","m/nm":"NM","light play":"LP","lightly played":"LP",lp:"LP","slightly played":"LP",sp:"LP","moderate play":"MP","moderately played":"MP",mp:"MP",played:"MP",pl:"MP","heavy play":"HP","heavily played":"HP",hp:"HP",worn:"HP",damaged:"DMG",dmg:"DMG",poor:"DMG",p:"DMG",excellent:"NM",ex:"NM","very fine":"LP",vf:"LP",fine:"MP",f:"MP",good:"HP",g:"HP",fair:"DMG",fr:"DMG"}[a.toLowerCase()]||"NM"}function Gx(a){return a&&{english:"EN",en:"EN",eng:"EN",us:"EN",usa:"EN",spanish:"ES",es:"ES",esp:"ES",castellano:"ES",french:"FR",fr:"FR",français:"FR",francais:"FR",german:"DE",de:"DE",deutsch:"DE",ger:"DE",italian:"IT",it:"IT",italiano:"IT",ita:"IT",portuguese:"PT",pt:"PT",português:"PT",portugues:"PT",brazilian:"PT",br:"PT",japanese:"JA",ja:"JA",jp:"JA",jpn:"JA",日本語:"JA",korean:"KO",ko:"KO",kor:"KO",한국어:"KO",chinese:"ZH",zh:"ZH",chi:"ZH","chinese simplified":"ZHS","simplified chinese":"ZHS",zhs:"ZHS","chinese traditional":"ZHT","traditional chinese":"ZHT",zht:"ZHT",中文:"ZH",russian:"RU",ru:"RU",rus:"RU",русский:"RU",dutch:"NL",nl:"NL",nederlands:"NL",swedish:"SV",sv:"SV",svenska:"SV",norwegian:"NO",no:"NO",norsk:"NO",danish:"DA",da:"DA",dansk:"DA",finnish:"FI",fi:"FI",suomi:"FI",phyrexian:"PH",ph:"PH","phyrexian (hybrid)":"PH","hybrid phyrexian":"PH"}[a.toLowerCase()]||"EN"}function Px(a,r,s){const i=Yx(We(a,s.quantity)),d=We(a,s.name);if(!d||i<=0)throw new Error("Invalid card: missing name or quantity");const f=We(a,s.set),g=We(a,s.setCode),p=We(a,s.foil),m=Fx(We(a,s.condition))||"NM",h=Gx(We(a,s.language))||"EN",y=We(a,s.collectorNumber),b=We(a,s.manaCost),S=We(a,s.rarity),E=parseFloat(We(a,s.price))||0,_=We(a,s.cardType),j=We(a,s.colors),T=parseInt(We(a,s.cmc))||0,N=Wr(We(a,s.signed)),O=Wr(We(a,s.artistProof)),D=Wr(We(a,s.altered)),L=Wr(We(a,s.misprint)),$=Wr(We(a,s.promo)),V=Wr(We(a,s.textless)),H=parseFloat(We(a,s.myPrice))||0,C=parseFloat(We(a,s.marketPrice))||0,I=parseFloat(We(a,s.lowPrice))||0,U=parseFloat(We(a,s.midPrice))||0,A=parseFloat(We(a,s.highPrice))||0,ee=parseInt(We(a,s.tradelist))||0,oe=parseInt(We(a,s.wishlist))||0,G=We(a,s.notes),P=We(a,s.tags),R=We(a,s.dateAdded),M=We(a,s.power),W=We(a,s.toughness),se=We(a,s.loyalty),he=y||We(a,s.cardNumber),fe=f||We(a,s.edition),te=Xx(p);return{id:Zx(d,g||f,te,y),name:Vx(d),quantity:i,set:g||Wx(f),set_name:f||g,foil:te,condition:m,language:h,collector_number:y,mana_cost:b,rarity:S,price:E,card_type:_,colors:j,cmc:T,power:M,toughness:W,loyalty:se,signed:N,artist_proof:O,altered:D,misprint:L,promo:$,textless:V,my_price:H,market_price:C,low_price:I,mid_price:U,high_price:A,tradelist_count:ee,wishlist_count:oe,notes:G,tags:P,card_number:he,edition:fe,dateAdded:Qx(R)||new Date().toISOString(),source:"csv_import"}}function We(a,r){var s;return r===-1||r>=a.length?"":((s=a[r])==null?void 0:s.trim())||""}function Yx(a){if(!a)return 0;const r=a.match(/(\d+(?:\.\d+)?)/);if(r){const s=parseFloat(r[1]);return Math.max(1,Math.floor(s))}return 0}function Xx(a){if(!a)return!1;const r=a.toLowerCase(),s=["foil","etched","showcase","borderless","extended","alternate","promo","prerelease","gilded","textured","premium","special","holographic","holo"];return r==="true"||r==="1"||r==="yes"?!0:r==="false"||r==="0"||r==="no"||r==="normal"?!1:s.some(i=>r.includes(i))}function Vx(a){return a?a.replace(/^\d+x?\s+/,"").replace(/\s+\([^)]*\)$/,"").replace(/\s+\[[^\]]*\]$/,"").replace(/\s*-\s*foil$/i,"").replace(/\s*\*f\*$/i,"").trim():""}function Wx(a){if(!a)return"";const r={alpha:"lea",beta:"leb",unlimited:"ced",revised:"3ed","fourth edition":"4ed","ice age":"ice",tempest:"tmp","urza's saga":"usg","mercadian masques":"mmq",invasion:"inv",odyssey:"ody",onslaught:"ons",mirrodin:"mrd",kamigawa:"chk",ravnica:"rav","time spiral":"tsp",lorwyn:"lrw",shadowmoor:"shm",alara:"ala",zendikar:"zen","scars of mirrodin":"som",innistrad:"isd","return to ravnica":"rtr",theros:"ths","khans of tarkir":"ktk","battle for zendikar":"bfz","shadows over innistrad":"soi",kaladesh:"kld",amonkhet:"akh",ixalan:"xln",dominaria:"dom","guilds of ravnica":"grn","ravnica allegiance":"rna","war of the spark":"war","throne of eldraine":"eld","theros beyond death":"thb",ikoria:"iko","zendikar rising":"znr",kaldheim:"khm",strixhaven:"stx","modern horizons":"mh1","modern horizons 2":"mh2"},s=a.toLowerCase();if(r[s])return r[s];for(const[d,f]of Object.entries(r))if(s.includes(d)||d.includes(s))return f;const i=a.match(/\(([^)]+)\)|\[([^\]]+)\]/);if(i){const d=(i[1]||i[2]).toLowerCase();if(d.length===3)return d}return a.substring(0,3).toLowerCase()}function Wr(a){if(!a)return!1;const r=a.toLowerCase().trim();return r==="true"||r==="yes"||r==="1"||r==="x"||r==="y"}function Qx(a){if(!a)return null;try{const r=new Date(a);return isNaN(r.getTime())?null:r.toISOString()}catch{return null}}function Zx(a,r,s,i){return[a.replace(/[^a-zA-Z0-9]/g,"").toLowerCase(),r||"unknown",s?"foil":"normal",i||""].join("-")+"-"+Date.now()+"-"+Math.random().toString(36).substring(7)}const Kx=Object.freeze(Object.defineProperty({__proto__:null,parseCSV:vh},Symbol.toStringTag,{value:"Module"}));async function Cd(a,r={}){if(!a||!a.trim())throw new Error("Text input is empty");const{enrichData:s=!0,showProgress:i=!0}=r,d=a.split(/\r?\n/).map(g=>g.trim()).filter(g=>g.length>0),f=[];for(const g of d)try{const p=Jx(g);f.push(...p)}catch(p){console.warn("Skipping invalid line:",g,p.message)}if(f.length===0)throw new Error("No valid cards found in text");return s?await fr(f,{showProgress:i}):f}function Jx(a){if(!a||a.trim().length===0)return[];if(a.startsWith("//")||a.startsWith("#")||a.startsWith("--"))return[];const r=[eb,tb,nb,ab,rb,ob,sb,lb];for(const i of r)try{const d=i(a);if(d&&d.length>0)return d}catch{continue}const s=Sh(a);return s?[{id:no(s),name:s,quantity:1,set:"",set_name:"",foil:!1,condition:"NM",language:"EN",dateAdded:new Date().toISOString(),source:"text_import"}]:[]}function eb(a){const r=a.match(/^(\d+)\s+(.+?)\s*\(([A-Z0-9]{2,4})\)\s*(\d+)?\s*(\*[fF]\*)?(.*)$/);if(!r)return null;const s=parseInt(r[1],10),i=r[2].trim(),d=r[3],f=r[4]||"",g=r[5],p=r[6].trim(),m=!!g;let h="NM";p&&(Dd(p),Rd(p)&&(h=Pl(p)));const y=Ch(p);return[{id:no(i,d,m),name:i,quantity:s,set:d.toLowerCase(),set_name:d,collector_number:f,foil:m,condition:h,language:y,dateAdded:new Date().toISOString(),source:"text_import"}]}function tb(a){const r=a.match(/^(\d+)\s*[xX]\s*(.+)$/);if(!r)return null;const s=parseInt(r[1],10),i=r[2].trim();return Gl(i,s)}function nb(a){const r=a.match(/^(\d+)\s+(.+)$/);if(!r)return null;const s=parseInt(r[1],10),i=r[2].trim();return/^\d/.test(i)?null:Gl(i,s)}function ab(a){const r=a.match(/^(.+?)\s*\((\d+)\)\s*(.*)$/);if(!r)return null;const s=r[1].trim(),i=parseInt(r[2],10),d=r[3].trim(),f=d?`${s} ${d}`:s;return Gl(f,i)}function rb(a){const r=a.match(/^(.+?)\s*\[(\d+)\]\s*(.*)$/);if(!r)return null;const s=r[1].trim(),i=parseInt(r[2],10),d=r[3].trim(),f=d?`${s} ${d}`:s;return Gl(f,i)}function ob(a){const r=a.split("-").map(h=>h.trim());if(r.length<2)return null;const s=r[0];if(!s.match(/^\d+$/))return null;const d=parseInt(s,10),f=r[1];if(!f)return null;let g="",p=!1,m="NM";for(let h=2;h<r.length;h++){const y=r[h].toLowerCase();Dd(y)?p=!0:Rd(y)?m=Pl(y):wh(y)&&(g=r[h])}return[{id:no(f,g,p),name:f,quantity:d,set:Nd(g),set_name:g,foil:p,condition:m,language:"EN",dateAdded:new Date().toISOString(),source:"text_import"}]}function sb(a){const r=a.split("-").map(g=>g.trim());if(r.length<2)return null;const s=r[0];let i="",d=!1,f="NM";for(let g=1;g<r.length;g++){const p=r[g].toLowerCase();Dd(p)?d=!0:Rd(p)?f=Pl(p):wh(p)&&(i=r[g])}return[{id:no(s,i,d),name:s,quantity:1,set:Nd(i),set_name:i,foil:d,condition:f,language:"EN",dateAdded:new Date().toISOString(),source:"text_import"}]}function lb(a){const r=Sh(a);return r?[{id:no(r),name:r,quantity:1,set:"",set_name:"",foil:!1,condition:"NM",language:"EN",dateAdded:new Date().toISOString(),source:"text_import"}]:null}function Gl(a,r=1){const{name:s,set:i,foil:d,condition:f,language:g}=ib(a);return s?[{id:no(s,i,d),name:s,quantity:r,set:Nd(i),set_name:i,foil:d,condition:f,language:g,dateAdded:new Date().toISOString(),source:"text_import"}]:null}function ib(a){let r=a,s="",i=!1,d="NM",f="EN";const g=a.match(/^(.+?)\s*\(([^)]+)\)(.*)$/);if(g){r=g[1].trim(),s=g[2].trim();const y=g[3].trim();y&&(a=`${r} ${y}`)}const p=a.match(/^(.+?)\s*\[([^\]]+)\](.*)$/);if(p){r=p[1].trim(),s=p[2].trim();const y=p[3].trim();y&&(a=`${r} ${y}`)}const m=["foil","etched","showcase","borderless","extended","alternate","promo","prerelease","*f*","*F*","(f)","[f]"];for(const y of m)if(a.toLowerCase().includes(y.toLowerCase())){i=!0,r=r.replace(new RegExp(y.replace(/\*/g,"\\*"),"gi"),"").trim();break}const h=["mint","nm","near mint","lp","light play","lightly played","mp","moderate play","moderately played","hp","heavy play","heavily played","damaged","dmg","poor","played","excellent","ex","very fine","vf","fine","f","good","g","fair","fr","slightly played","sp","worn"];for(const y of h)if(a.toLowerCase().includes(y.toLowerCase())){d=Pl(y),a=a.replace(new RegExp(y,"gi"),"").trim();break}return f=Ch(a),{name:cb(r),set:s,foil:i,condition:d,language:f}}function Sh(a){if(!a)return"";let r=a.replace(/^\d+\s*[xX]?\s*/,"").replace(/\s*\([^)]*\)\s*$/,"").replace(/\s*\[[^\]]*\]\s*$/,"").replace(/\s*-\s*(foil|etched|showcase).*$/i,"").replace(/\s*\*[fF]\*\s*$/,"").trim();return/[a-zA-Z]/.test(r)?r:""}function cb(a){return a.replace(/\s+/g," ").replace(/[""]/g,'"').replace(/['']/g,"'").trim()}function Dd(a){return["foil","etched","showcase","borderless","extended","alternate","promo","prerelease","gilded","textured","*f*","*F*"].some(s=>a.toLowerCase().includes(s.toLowerCase()))}function Rd(a){return["mint","nm","near mint","lp","light play","lightly played","mp","moderate play","moderately played","hp","heavy play","heavily played","damaged","dmg","poor","played","excellent","ex","very fine","vf","fine","f","good","g","fair","fr","slightly played","sp","worn","pl"].some(s=>a.toLowerCase().includes(s.toLowerCase()))}function wh(a){return a.length>=2&&(a.length===3||a.match(/^[A-Z0-9]{2,4}$/i)||a.match(/\b(edition|masters|horizons|remastered|chronicles)\b/i))}function Pl(a){return{mint:"NM","near mint":"NM",nm:"NM","mint/near mint":"NM","m/nm":"NM","light play":"LP","lightly played":"LP",lp:"LP","slightly played":"LP",sp:"LP","moderate play":"MP","moderately played":"MP",mp:"MP",played:"MP",pl:"MP","heavy play":"HP","heavily played":"HP",hp:"HP",worn:"HP",damaged:"DMG",dmg:"DMG",poor:"DMG",p:"DMG",excellent:"NM",ex:"NM","very fine":"LP",vf:"LP",fine:"MP",f:"MP",good:"HP",g:"HP",fair:"DMG",fr:"DMG"}[a.toLowerCase()]||"NM"}function Nd(a){if(!a)return"";if(a.length<=4&&/^[A-Z0-9]+$/i.test(a))return a.toLowerCase();const r={alpha:"lea",beta:"leb",unlimited:"ced",revised:"3ed","fourth edition":"4ed","ice age":"ice",tempest:"tmp","urza's saga":"usg","mercadian masques":"mmq",invasion:"inv",odyssey:"ody",onslaught:"ons",mirrodin:"mrd",kamigawa:"chk",ravnica:"rav","time spiral":"tsp",lorwyn:"lrw",shadowmoor:"shm",alara:"ala",zendikar:"zen","scars of mirrodin":"som",innistrad:"isd","return to ravnica":"rtr",theros:"ths","khans of tarkir":"ktk","battle for zendikar":"bfz","shadows over innistrad":"soi",kaladesh:"kld",amonkhet:"akh",ixalan:"xln",dominaria:"dom","guilds of ravnica":"grn","ravnica allegiance":"rna","war of the spark":"war","throne of eldraine":"eld","theros beyond death":"thb",ikoria:"iko","zendikar rising":"znr",kaldheim:"khm",strixhaven:"stx","modern horizons":"mh1","modern horizons 2":"mh2"},s=a.toLowerCase();return r[s]||a.substring(0,3).toLowerCase()}function db(a){return{english:"EN",en:"EN",eng:"EN",us:"EN",usa:"EN",spanish:"ES",es:"ES",esp:"ES",castellano:"ES",french:"FR",fr:"FR",français:"FR",francais:"FR",german:"DE",de:"DE",deutsch:"DE",ger:"DE",italian:"IT",it:"IT",italiano:"IT",ita:"IT",portuguese:"PT",pt:"PT",português:"PT",portugues:"PT",brazilian:"PT",br:"PT",japanese:"JA",ja:"JA",jp:"JA",jpn:"JA",日本語:"JA",korean:"KO",ko:"KO",kor:"KO",한국어:"KO",chinese:"ZH",zh:"ZH",chi:"ZH","chinese simplified":"ZHS","simplified chinese":"ZHS",zhs:"ZHS","chinese traditional":"ZHT","traditional chinese":"ZHT",zht:"ZHT",中文:"ZH",russian:"RU",ru:"RU",rus:"RU",русский:"RU",dutch:"NL",nl:"NL",nederlands:"NL",swedish:"SV",sv:"SV",svenska:"SV",norwegian:"NO",no:"NO",norsk:"NO",danish:"DA",da:"DA",dansk:"DA",finnish:"FI",fi:"FI",suomi:"FI",phyrexian:"PH",ph:"PH","phyrexian (hybrid)":"PH","hybrid phyrexian":"PH"}[a.toLowerCase()]||"EN"}function Ch(a){const r=["english","en","spanish","es","french","fr","german","de","italian","it","portuguese","pt","japanese","ja","korean","ko","chinese","zh","russian","ru","phyrexian","ph"],s=a.toLowerCase();for(const i of r)if(s.includes(i))return db(i);return"EN"}function no(a,r="",s=!1){return[a.replace(/[^a-zA-Z0-9]/g,"").toLowerCase(),r||"unknown",s?"foil":"normal"].join("-")+"-"+Date.now()+"-"+Math.random().toString(36).substring(7)}const Lp=Object.freeze(Object.defineProperty({__proto__:null,parseText:Cd},Symbol.toStringTag,{value:"Module"}));let ld;async function ub(){if(!ld)try{const a=await Qn(()=>import("./index-Bfk2rq25.js").then(r=>r.i),__vite__mapDeps([0,1]));ld=a.default||a}catch{return console.warn("Tesseract.js not available, falling back to simple text extraction"),null}return ld}async function fb(a){if(!a)throw new Error("No image provided");try{const r=await ub();if(r)return await gb(a,r);throw new Error("OCR library not available. Please install tesseract.js or use manual text input.")}catch(r){throw console.error("OCR processing failed:",r),new Error(`Camera text extraction failed: ${r.message}`)}}async function gb(a,r){try{const{data:{text:s}}=await r.recognize(a,"eng",{logger:i=>{i.status==="recognizing text"&&console.log(`OCR Progress: ${Math.round(i.progress*100)}%`)}});if(!s||s.trim().length===0)throw new Error("No text detected in image");return pb(s)}catch(s){throw console.error("Tesseract OCR error:",s),new Error(`OCR processing failed: ${s.message}`)}}function pb(a){return a?a.replace(/[|1Il]/g,"1").replace(/[0oO]/g,"o").replace(/rn/g,"m").replace(/[`']/g,"'").replace(/["]/g,'"').replace(/\s+/g," ").replace(/\n\s*\n/g,`
`).trim().split(`
`).map(i=>i.trim().replace(/^[^\w\d]*/,"").replace(/[^\w\d\s\(\)\[\]\-\.,'"]*$/,"").trim()).filter(i=>i.length>0&&i.length<200&&/[a-zA-Z]/.test(i)&&!/^[^\w\s]+$/.test(i)).join(`
`):""}async function jh(a,r={}){if(!a||!a.trim())throw new Error("JSON input is empty");let s;try{s=JSON.parse(a)}catch(g){throw new Error(`Invalid JSON format: ${g.message}`)}const i=[];if(s.object==="deck"&&s.entries)return vb(s);if(s.object==="card"){const g=gr(s);g&&i.push(g)}else if(s.object==="list"&&s.data){for(const g of s.data)if(g.object==="card"){const p=gr(g);p&&i.push(p)}}else if(Array.isArray(s)){for(const g of s)if(g.object==="card"){const p=gr(g);p&&i.push(p)}}else throw new Error("Unrecognized JSON format. Expected Scryfall card data.");if(i.length===0)throw new Error("No valid cards found in JSON data");const{enrichData:d=!1,showProgress:f=!1}=r;return d?await fr(i,{showProgress:f,skipEnrichment:!0}):i}function gr(a,r=1){if(!a||!a.name)throw new Error("Invalid card data: missing name");const s=hb(a),i=a.set||"",d=a.set_name||"",f=a.collector_number||"",g=a.rarity||"",p=a.mana_cost||"",m=a.cmc||0,h=a.type_line||"",y=a.oracle_text||"",b=a.power||"",S=a.toughness||"",E=a.loyalty||"",_=Array.isArray(a.colors)?a.colors.join(""):"",j=Array.isArray(a.color_identity)?a.color_identity.join(""):"",T=mb(a),N=yb(a.prices),O=a.lang||"en",D=a.legalities||{},L=a.image_uris||{};return{id:xb(s,i,T,f),name:s,quantity:r,set:i.toLowerCase(),set_name:d,foil:T,condition:"NM",language:O.toUpperCase(),collector_number:f,mana_cost:p,cmc:m,rarity:g.toLowerCase(),type_line:h,oracle_text:y,power:b,toughness:S,loyalty:E,colors:_,color_identity:j,legalities:D,prices:N,image_uris:L,scryfall_id:a.id,oracle_id:a.oracle_id,multiverse_ids:a.multiverse_ids||[],mtgo_id:a.mtgo_id,arena_id:a.arena_id,tcgplayer_id:a.tcgplayer_id,dateAdded:new Date().toISOString(),source:"scryfall_import"}}function hb(a){return a.card_faces&&a.card_faces.length>0?a.card_faces.map(s=>s.name).join(" // "):a.name}function mb(a){const r=a.finishes||[];return r.includes("foil")||r.includes("etched")||r.includes("glossy"),!1}function yb(a){return a?{usd:parseFloat(a.usd)||0,usd_foil:parseFloat(a.usd_foil)||0,usd_etched:parseFloat(a.usd_etched)||0,eur:parseFloat(a.eur)||0,eur_foil:parseFloat(a.eur_foil)||0,tix:parseFloat(a.tix)||0}:{}}function xb(a,r,s,i){return[a.replace(/[^a-zA-Z0-9]/g,"").toLowerCase(),r||"unknown","normal",i||""].join("-")+"-"+Date.now()+"-"+Math.random().toString(36).substring(7)}async function bb(a,r={}){if(!a||!a.trim())throw new Error("JSON input is empty");let s;try{s=JSON.parse(a)}catch(d){throw new Error(`Invalid JSON format: ${d.message}`)}const i=[];if(Array.isArray(s)){for(const d of s)if(d.card&&d.quantity){const f=gr(d.card,parseInt(d.quantity)||1);f&&i.push(f)}else if(d.object==="card"){const f=gr(d);f&&i.push(f)}}else if(s.collection&&Array.isArray(s.collection)){for(const d of s.collection)if(d.card&&d.quantity){const f=gr(d.card,parseInt(d.quantity)||1);f&&i.push(f)}}else return jh(a,r);if(i.length===0)throw new Error("No valid cards found in collection data");return r.enrichData?await fr(i):i}function vb(a){const r=[];if(!a.entries)throw new Error("No entries found in deck data");return Object.keys(a.entries).forEach(s=>{const i=a.entries[s];Array.isArray(i)&&i.forEach(d=>{if(d.card_digest&&d.count){const f=Sb(d,s);f&&r.push(f)}})}),r}function Sb(a,r){const s=a.card_digest;if(!s||!s.name)return null;const i=parseInt(a.count)||1,d=r==="sideboard"||r==="maybeboard",f={id:s.id,oracle_id:s.oracle_id,name:s.name,set:s.set,collector_number:s.collector_number,mana_cost:s.mana_cost,type_line:s.type_line,image_uris:s.image_uris||{}},g=gr(f,i);return g.sideboard=d,g.deck_section=r,g}async function _h(a){if(!a||!a.trim())throw new Error("Text content is empty");const r=a.split(/\r?\n/).map(d=>d.trim()).filter(d=>d.length>0),s=[];let i="mainboard";for(const d of r)try{if(jb(d)){i=_b(d);continue}if(!d||d.startsWith("//")||d.startsWith("#"))continue;const f=wb(d,i);f&&s.push(f)}catch(f){console.warn("Skipping invalid line:",d,f.message)}if(s.length===0)throw new Error("No valid cards found in text");return s}function wb(a,r="mainboard"){if(!a||a.trim().length===0)return null;const s=a.match(/^(\d+)\s+(.+)$/);if(!s){const g=Bp(a);return g?Up(g,1,r):null}const i=parseInt(s[1],10),d=s[2].trim();if(!d||i<=0)return null;const f=Bp(d);return f?Up(f,i,r):null}function Up(a,r,s){const i=s==="sideboard"||s==="maybeboard";return{id:Tb(a,s),name:a,quantity:r,sideboard:i,section:s,set:"",set_name:"",foil:!1,condition:"NM",language:"EN",dateAdded:new Date().toISOString(),source:"txt_import"}}function Bp(a){if(!a)return"";let r=a.replace(/^\d+\s*[xX]?\s*/,"").replace(/\s*\([^)]*\)\s*$/,"").replace(/\s*\[[^\]]*\]\s*$/,"").replace(/\s*\*[fF]\*\s*$/,"").trim();return/[a-zA-Z]/.test(r)?Cb(r):""}function Cb(a){return a.replace(/\s+/g," ").replace(/[""]/g,'"').replace(/['']/g,"'").trim()}function jb(a){const r=["sideboard","side board","sb","maybeboard","maybe board","mb","mainboard","main board","main","deck","commander","command zone"],s=a.toLowerCase();return s.startsWith("//")&&r.some(i=>s.includes(i))?!0:r.some(i=>s===i||s===`${i}:`||s===`// ${i}`||s===`# ${i}`)}function _b(a){const r=a.toLowerCase();return r.includes("sideboard")||r.includes("side board")||r.includes("sb")?"sideboard":r.includes("maybeboard")||r.includes("maybe board")||r.includes("mb")?"maybeboard":r.includes("commander")||r.includes("command zone")?"commander":"mainboard"}function Tb(a,r="mainboard"){return[a.replace(/[^a-zA-Z0-9]/g,"").toLowerCase(),r,"txt"].join("-")+"-"+Date.now()+"-"+Math.random().toString(36).substring(7)}function Th(a){if(!Array.isArray(a))throw new Error("Invalid cards array");return a.map(r=>({id:r.id,name:r.name,quantity:r.quantity,set:r.set||"",set_name:r.set_name||"",foil:r.foil||!1,condition:r.condition||"NM",language:r.language||"EN",sideboard:r.sideboard||!1,section:r.section||"mainboard",dateAdded:r.dateAdded,source:"txt_import"}))}const Ip=Object.freeze(Object.defineProperty({__proto__:null,convertSimpleTextToCollection:Th,parseSimpleText:_h},Symbol.toStringTag,{value:"Module"}));class hs{constructor(){this.supportedFormats=["docx","doc","odt","pages","txt","rtf","md","pdf","html","htm","xml","tex","xlsx","xlsm","xlsb","xls","csv","ods","numbers"]}async parseDocument(r,s={}){if(!r)throw new Error("No file provided");const i=this.getFileExtension(r.name),d=r.type;console.log(`Parsing document: ${r.name} (${i}) - ${d}`);try{switch(i.toLowerCase()){case"docx":return await this.parseWordDocx(r,s);case"doc":return await this.parseWordDoc(r,s);case"odt":return await this.parseOpenDocument(r,s);case"pages":return await this.parseApplePages(r,s);case"rtf":return await this.parseRTF(r,s);case"md":return await this.parseMarkdown(r,s);case"pdf":return await this.parsePDF(r,s);case"html":case"htm":return await this.parseHTML(r,s);case"xml":return await this.parseXML(r,s);case"tex":return await this.parseLaTeX(r,s);case"xlsx":case"xlsm":case"xlsb":return await this.parseExcel(r,s);case"xls":return await this.parseExcelLegacy(r,s);case"ods":return await this.parseOpenSpreadsheet(r,s);case"numbers":return await this.parseAppleNumbers(r,s);case"csv":return await this.parseCSVFile(r,s);case"txt":return await this.parsePlainText(r,s);default:return await this.parseFallback(r,s)}}catch(f){throw console.error(`Error parsing ${i} file:`,f),new Error(`Failed to parse ${i.toUpperCase()} file: ${f.message}`)}}getFileExtension(r){return r.split(".").pop().toLowerCase()}async parseWordDocx(r,s={}){try{const i=await this.extractTextFromBinary(r);return await this.parseExtractedText(i,"docx",s)}catch(i){throw new Error(`DOCX parsing failed: ${i.message}`)}}async parseWordDoc(r){try{const s=await this.extractTextFromBinary(r);return await this.parseExtractedText(s,"doc")}catch(s){throw new Error(`DOC parsing failed: ${s.message}`)}}async parseOpenDocument(r){try{const s=await this.extractTextFromZip(r);return await this.parseExtractedText(s,"odt")}catch(s){throw new Error(`ODT parsing failed: ${s.message}`)}}async parseApplePages(r){try{const s=await this.extractTextFromBinary(r);return await this.parseExtractedText(s,"pages")}catch(s){throw new Error(`Pages parsing failed: ${s.message}`)}}async parseRTF(r){try{const s=await this.readAsText(r),i=this.stripRTFFormatting(s);return await this.parseExtractedText(i,"rtf")}catch(s){throw new Error(`RTF parsing failed: ${s.message}`)}}async parseMarkdown(r){try{const s=await this.readAsText(r),i=this.stripMarkdownFormatting(s);return await this.parseExtractedText(i,"md")}catch(s){throw new Error(`Markdown parsing failed: ${s.message}`)}}async parsePDF(r){try{throw new Error("PDF parsing requires additional libraries. Please copy text from PDF and use Text Import instead.")}catch(s){throw new Error(`PDF parsing failed: ${s.message}`)}}async parseHTML(r){try{const s=await this.readAsText(r),i=this.stripHTMLTags(s);return await this.parseExtractedText(i,"html")}catch(s){throw new Error(`HTML parsing failed: ${s.message}`)}}async parseXML(r){try{const s=await this.readAsText(r);if(s.includes("<Deck")&&s.includes("<Cards")){const{parseDek:d}=await Qn(async()=>{const{parseDek:g}=await import("./dekParser-BD3dx_UN.js");return{parseDek:g}},[]),f=await d(s);return await this.convertDekToCards(f)}const i=this.stripXMLTags(s);return await this.parseExtractedText(i,"xml")}catch(s){throw new Error(`XML parsing failed: ${s.message}`)}}async parseLaTeX(r){try{const s=await this.readAsText(r),i=this.stripLaTeXCommands(s);return await this.parseExtractedText(i,"tex")}catch(s){throw new Error(`LaTeX parsing failed: ${s.message}`)}}async parseExcel(r){try{const s=await this.extractTextFromBinary(r);return await this.parseExtractedText(s,"xlsx")}catch(s){throw new Error(`Excel parsing failed: ${s.message}. Please export as CSV instead.`)}}async parseExcelLegacy(r){try{const s=await this.extractTextFromBinary(r);return await this.parseExtractedText(s,"xls")}catch(s){throw new Error(`Legacy Excel parsing failed: ${s.message}. Please export as CSV instead.`)}}async parseOpenSpreadsheet(r){try{const s=await this.extractTextFromZip(r);return await this.parseExtractedText(s,"ods")}catch(s){throw new Error(`ODS parsing failed: ${s.message}. Please export as CSV instead.`)}}async parseAppleNumbers(r){try{const s=await this.extractTextFromBinary(r);return await this.parseExtractedText(s,"numbers")}catch(s){throw new Error(`Numbers parsing failed: ${s.message}. Please export as CSV instead.`)}}async parseCSVFile(r,s={}){try{const i=await this.readAsText(r),{parseCSV:d}=await Qn(async()=>{const{parseCSV:f}=await Promise.resolve().then(()=>Kx);return{parseCSV:f}},void 0);return await d(i,s)}catch(i){throw new Error(`CSV parsing failed: ${i.message}`)}}async parsePlainText(r,s={}){try{const i=await r.text(),{parseText:d}=await Qn(async()=>{const{parseText:g}=await Promise.resolve().then(()=>Lp);return{parseText:g}},void 0),f=await d(i,s);if(!f||f.length===0){const{parseSimpleText:g}=await Qn(async()=>{const{parseSimpleText:b}=await Promise.resolve().then(()=>Ip);return{parseSimpleText:b}},void 0),p=await g(i),m=this.convertSimpleTextToCards(p),{enrichData:h=!1,showProgress:y=!0}=s;return h?await fr(m,y):m}return f}catch(i){throw new Error(`TXT parsing failed: ${i.message}`)}}async parseFallback(r){try{const s=await this.readAsText(r);return await this.parseExtractedText(s,"unknown")}catch{throw new Error("Unsupported file format. Please convert to CSV, TXT, or JSON format.")}}async readAsText(r){return new Promise((s,i)=>{const d=new FileReader;d.onload=f=>s(f.target.result),d.onerror=()=>i(new Error("Failed to read file as text")),d.readAsText(r)})}async extractTextFromBinary(r){return new Promise((s,i)=>{const d=new FileReader;d.onload=f=>{const g=f.target.result,p=this.extractReadableText(g);s(p)},d.onerror=()=>i(new Error("Failed to read binary file")),d.readAsArrayBuffer(r)})}async extractTextFromZip(r){return await this.extractTextFromBinary(r)}extractReadableText(r){const s=new Uint8Array(r);let i="";for(let d=0;d<s.length;d++){const f=s[d];(f>=32&&f<=126||f===10||f===13)&&(i+=String.fromCharCode(f))}return i}stripRTFFormatting(r){return r.replace(/\\[a-zA-Z]+\d*\s?/g,"").replace(/[{}]/g,"").replace(/\s+/g," ").trim()}stripMarkdownFormatting(r){return r.replace(/^#{1,6}\s+/gm,"").replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/`(.*?)`/g,"$1").replace(/\[([^\]]+)\]\([^)]+\)/g,"$1").replace(/^[-*+]\s+/gm,"").trim()}stripHTMLTags(r){return r.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi,"").replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/\s+/g," ").trim()}stripXMLTags(r){return r.replace(/<[^>]*>/g,"").replace(/\s+/g," ").trim()}stripLaTeXCommands(r){return r.replace(/\\[a-zA-Z]+(\[[^\]]*\])?(\{[^}]*\})?/g,"").replace(/\$.*?\$/g,"").replace(/\{|\}/g,"").replace(/\s+/g," ").trim()}async parseExtractedText(r,s,i={}){if(!r||!r.trim())throw new Error(`No text content extracted from ${s.toUpperCase()} file`);try{const{parseText:d}=await Qn(async()=>{const{parseText:h}=await Promise.resolve().then(()=>Lp);return{parseText:h}},void 0),g=(await d(r,i)).map(h=>({...h,source:`${s}_import`,originalFormat:s})),{enrichData:p=!1,showProgress:m=!0}=i;return p?await fr(g,m):g}catch(d){try{const{parseSimpleText:f}=await Qn(async()=>{const{parseSimpleText:y}=await Promise.resolve().then(()=>Ip);return{parseSimpleText:y}},void 0),g=await f(r),p=this.convertSimpleTextToCards(g,s),{enrichData:m=!1,showProgress:h=!0}=i;return m?await fr(p,h):p}catch{throw new Error(`Failed to parse extracted text: ${d.message}`)}}}convertSimpleTextToCards(r,s="txt"){return r.map(i=>({...i,source:`${s}_import`,originalFormat:s}))}async convertDekToCards(r){const{convertDekToCollection:s}=await Qn(async()=>{const{convertDekToCollection:i}=await import("./dekParser-BD3dx_UN.js");return{convertDekToCollection:i}},[]);return s(r)}static getSupportedFormats(){return{wordProcessor:[".docx",".doc",".odt",".pages"],text:[".txt",".rtf",".md"],layout:[".pdf",".html",".htm",".xml",".tex"],spreadsheet:[".xlsx",".xlsm",".xlsb",".xls",".csv",".ods",".numbers"],other:[".json",".dek"]}}static isFormatSupported(r){const s=hs.getSupportedFormats(),i="."+r.split(".").pop().toLowerCase();return Object.values(s).some(d=>d.includes(i))}}const Eb=new hs;function kb(){return hs.getSupportedFormats()}function Ab(a){return hs.isFormatSupported(a)}const eo=[],Db=500;function Qr(a,r=null){const s=new Date().toISOString(),i={timestamp:s,step:a,data:r?JSON.stringify(r,null,2):null};eo.push(i),eo.length>Db&&eo.shift(),console.log(`[IMPORT ${s}] ${a}`,r||"")}function id(a,r){const s=new Date().toISOString(),i={message:r.message,stack:r.stack,name:r.name};eo.push({timestamp:s,step:`ERROR: ${a}`,data:JSON.stringify(i,null,2)}),console.error(`[IMPORT ERROR ${s}] ${a}`,i)}function Eh(a=50){return eo.slice(-a).map(s=>{let i=`[${s.timestamp}] ${s.step}`;return s.data&&(i+=`
${s.data}`),i}).join(`
---
`)}function Rb(a=20){console.group("🔍 Import Debug Logs");const r=Eh(a);console.log(r),console.groupEnd(),console.log(`
📋 Copy this to share:`),console.log("```"),console.log(r),console.log("```")}function Nb(){eo.length=0,console.log("[DEBUG] Import logs cleared")}typeof window<"u"&&(window.debugImport={logs:()=>Rb(),clear:Nb,get:Eh});function Ob(a){return{common:"#1a1a1a",uncommon:"#c0c0c0",rare:"#ffd700",mythic:"#ff4500",special:"#d946ef",bonus:"#8b5cf6"}[a==null?void 0:a.toLowerCase()]||"#666"}function Mb(a){const r=[];return a.foil&&r.push("✨Foil"),a.signed&&r.push("✍️Signed"),a.artist_proof&&r.push("🎨AP"),a.altered&&r.push("🖌️Alt"),a.misprint&&r.push("❗MP"),a.promo&&r.push("🎁Promo"),a.textless&&r.push("📝TL"),a.tradelist_count>0&&r.push(`📈${a.tradelist_count}T`),a.wishlist_count>0&&r.push(`💝${a.wishlist_count}W`),r.length>0?r.join(" "):"—"}function zb({isOpen:a,onClose:r,onImport:s}){const[i,d]=v.useState("csv"),[f,g]=v.useState(""),[p,m]=v.useState(""),[h,y]=v.useState(""),[b,S]=v.useState(!1),[E,_]=v.useState([]),[j,T]=v.useState(!1),[N,O]=v.useState(!0),D=v.useRef(null),L=v.useRef(null),$=v.useRef(null),[V,H]=v.useState(!1),[C,I]=v.useState(null);if(!a)return null;const U=async ae=>{const re=ae.target.files[0];if(!re)return;const ue=re.name.toLowerCase(),me=ue.split(".").pop();if(Qr("File selected",{fileName:ue,fileExtension:me,fileSize:re.size,fileType:re.type}),!Ab(ue)){const Ce=kb(),Te=Object.values(Ce).flat();id("Unsupported file type",new Error(`File: ${ue}, Supported: ${Te.join(", ")}`)),ce.error(`Unsupported file type. Supported formats: ${Te.join(", ")}`);return}if(re.size>50*1024*1024){id("File too large",new Error(`File size: ${re.size} bytes`)),ce.error("File too large. Please select a file smaller than 50MB");return}Qr("Starting file processing",{fileExtension:me,enrichCards:N}),P(re,me)},A=async ae=>{const re=ae.target.files[0];if(!re)return;if(!re.name.toLowerCase().endsWith(".json")){ce.error("Please select a JSON file");return}if(re.size>50*1024*1024){ce.error("File too large. Please select a JSON file smaller than 50MB");return}const ue=new FileReader;ue.onload=me=>{const Ce=me.target.result;y(Ce),G(Ce)},ue.onerror=()=>{ce.error("Error reading JSON file. Please try again.")},ue.readAsText(re)},ee=async ae=>{if(ae.trim()){S(!0);try{const re=await vh(ae,{enrichData:N});_(re),T(!0),ce.success(`Parsed ${re.length} cards from CSV`)}catch(re){console.error("CSV parsing error:",re),ce.error(`CSV parsing failed: ${re.message}`)}finally{S(!1)}}},oe=async ae=>{if(ae.trim()){S(!0);try{let re;try{re=await Cd(ae,{enrichData:N})}catch{const ue=await _h(ae);re=Th(ue)}_(re),T(!0),ce.success(`Parsed ${re.length} cards from text`)}catch(re){console.error("Text parsing error:",re),ce.error(`Text parsing failed: ${re.message}`)}finally{S(!1)}}},G=async ae=>{if(ae.trim()){S(!0);try{let re;try{re=await bb(ae,{enrichData:N})}catch{re=await jh(ae,{enrichData:N})}_(re),T(!0),ce.success(`Parsed ${re.length} cards from Scryfall JSON`)}catch(re){console.error("JSON parsing error:",re),ce.error(`JSON parsing failed: ${re.message}`)}finally{S(!1)}}},P=async(ae,re)=>{S(!0),Qr("Document processing started",{fileName:ae.name,fileExtension:re});try{Qr("Calling document parser",{enrichCards:N});const ue=await Eb.parseDocument(ae,{enrichData:N});Qr("Document parser completed",{cardCount:ue.length,sampleCard:ue[0]||null}),_(ue),T(!0);const me=re.toUpperCase();ce.success(`Parsed ${ue.length} cards from ${me} file`),["csv"].includes(re)?g(`Imported from ${ae.name}`):["txt","rtf","md","html","xml"].includes(re)?m(`Imported from ${ae.name}`):["json"].includes(re)&&y(`Imported from ${ae.name}`)}catch(ue){id("Document processing failed",ue),console.error(`${re.toUpperCase()} parsing error:`,ue),ce.error(`${re.toUpperCase()} parsing failed: ${ue.message}`),["xlsx","xls","ods","numbers"].includes(re)?ce.info("💡 Tip: For best results with spreadsheets, export as CSV first"):["docx","doc","odt","pages"].includes(re)?ce.info("💡 Tip: For better accuracy, copy text content and use Text Import"):["pdf"].includes(re)&&ce.info("💡 Tip: Copy text from PDF and use Text Import for best results")}finally{S(!1),Qr("Document processing finished")}},R=async()=>{try{const ae=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});L.current&&(L.current.srcObject=ae,I(ae),H(!0))}catch(ae){console.error("Camera access error:",ae),ce.error("Unable to access camera. Please check permissions.")}},M=()=>{C&&(C.getTracks().forEach(ae=>ae.stop()),I(null),H(!1))},W=async()=>{if(!L.current||!$.current)return;const ae=$.current,re=L.current,ue=ae.getContext("2d");ae.width=re.videoWidth,ae.height=re.videoHeight,ue.drawImage(re,0,0),ae.toBlob(async me=>{S(!0);try{const Ce=await fb(me),Te=await Cd(Ce,{enrichData:N});_(Te),T(!0),ce.success(`Captured and parsed ${Te.length} cards`)}catch(Ce){console.error("Camera capture error:",Ce),ce.error(`Camera capture failed: ${Ce.message}`)}finally{S(!1)}},"image/jpeg",.8)},se=()=>{if(E.length===0){ce.error("No data to import");return}s(E),he()},he=()=>{M(),g(""),m(""),y(""),_([]),T(!1),d("csv"),O(!0),r()},fe={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},te={backgroundColor:"white",borderRadius:8,width:"90%",maxWidth:800,maxHeight:"90vh",overflow:"auto",padding:24},K=ae=>({padding:"8px 16px",border:"none",backgroundColor:ae?"#007bff":"#f8f9fa",color:ae?"white":"#333",cursor:"pointer",borderRadius:"4px 4px 0 0",marginRight:4});return l.jsx("div",{style:fe,onClick:ae=>ae.target===ae.currentTarget&&he(),children:l.jsxs("div",{style:te,children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[l.jsx("h2",{style:{margin:0},children:"Import Collection"}),l.jsx("button",{onClick:he,style:{background:"none",border:"none",fontSize:24,cursor:"pointer",color:"#666"},children:"×"})]}),l.jsxs("div",{style:{marginBottom:20},children:[l.jsx("button",{style:K(i==="csv"),onClick:()=>d("csv"),children:"� Universal Upload"}),l.jsx("button",{style:K(i==="text"),onClick:()=>d("text"),children:"📝 Text Input"}),l.jsx("button",{style:K(i==="json"),onClick:()=>d("json"),children:"🔗 Scryfall JSON"}),l.jsx("button",{style:K(i==="camera"),onClick:()=>d("camera"),children:"📷 Camera Scan"})]}),l.jsxs("div",{style:{marginBottom:20,padding:12,backgroundColor:"#f8f9fa",border:"1px solid #e9ecef",borderRadius:6,display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{type:"checkbox",id:"enrichCards",checked:N,onChange:ae=>O(ae.target.checked),style:{width:16,height:16,accentColor:"#007bff"}}),l.jsx("label",{htmlFor:"enrichCards",style:{cursor:"pointer",fontSize:14,fontWeight:500,color:"#333"},children:"✨ Enrich card data with complete information"}),l.jsx("div",{style:{fontSize:12,color:"#666",marginLeft:"auto"},children:"Adds missing type, colors, set names via Scryfall API"})]}),i==="csv"&&l.jsxs("div",{children:[l.jsx("h3",{children:"Upload Files - Universal Format Support"}),l.jsxs("p",{style:{color:"#666",marginBottom:16},children:[l.jsx("strong",{children:"📄 Document Formats:"})," Word (.docx, .doc), OpenDocument (.odt), Apple Pages (.pages), RTF, Markdown (.md), HTML, XML, LaTeX (.tex)",l.jsx("br",{}),l.jsx("strong",{children:"📊 Spreadsheet Formats:"})," Excel (.xlsx, .xlsm, .xlsb, .xls), OpenDocument (.ods), Apple Numbers (.numbers), CSV",l.jsx("br",{}),l.jsx("strong",{children:"📋 Text Formats:"})," Plain Text (.txt), Rich Text (.rtf), Markdown (.md)",l.jsx("br",{}),l.jsx("strong",{children:"🔗 Data Formats:"})," JSON (Scryfall), DEK (XML deck format), PDF (experimental)",l.jsx("br",{}),l.jsx("strong",{children:"🏆 Platform Support:"})," ",l.jsx("strong",{children:"Moxfield"}),", ",l.jsx("strong",{children:"Archidekt"}),", ",l.jsx("strong",{children:"EchoMTG"}),", ",l.jsx("strong",{children:"MTGGoldfish"}),", ",l.jsx("strong",{children:"Deckbox"}),", and virtually any platform",l.jsx("br",{}),l.jsx("strong",{children:"💎 All data preserved:"})," Quantities, Names, Sets, Foil, Condition, Language, Signed, Artist Proof, Altered Art, Misprints, Promos, Prices, Tradelist/Wishlist counts, Notes, Tags, and more!"]}),l.jsx("input",{ref:D,type:"file",accept:".csv,.txt,.dek,.json,.docx,.doc,.odt,.pages,.rtf,.md,.pdf,.html,.htm,.xml,.tex,.xlsx,.xlsm,.xlsb,.xls,.ods,.numbers",onChange:U,style:{marginBottom:16,padding:8,border:"1px solid #ddd",borderRadius:4,width:"100%"}}),f&&l.jsxs("div",{children:[l.jsx("h4",{children:"CSV Preview:"}),l.jsx("textarea",{value:f.substring(0,500)+(f.length>500?"...":""),readOnly:!0,style:{width:"100%",height:100,border:"1px solid #ddd",borderRadius:4,padding:8,fontFamily:"monospace",fontSize:12}}),l.jsx("button",{onClick:()=>ee(f),disabled:b,style:{marginTop:8,padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:4,cursor:b?"not-allowed":"pointer"},children:b?"Processing...":"Parse CSV"})]})]}),i==="text"&&l.jsxs("div",{children:[l.jsx("h3",{children:"Paste Text"}),l.jsxs("p",{style:{color:"#666",marginBottom:16},children:["Paste any text containing card lists. Supports various formats like:",l.jsx("br",{}),'• "4x Lightning Bolt"',l.jsx("br",{}),'• "1 Black Lotus (LEA)"',l.jsx("br",{}),'• "Mox Pearl - Alpha - Near Mint"',l.jsx("br",{}),'• "3 Counterspell [ICE]"']}),l.jsx("textarea",{value:p,onChange:ae=>m(ae.target.value),placeholder:"Paste your card list here...",style:{width:"100%",height:200,border:"1px solid #ddd",borderRadius:4,padding:12,fontSize:14,fontFamily:"monospace"}}),l.jsx("button",{onClick:()=>oe(p),disabled:b||!p.trim(),style:{marginTop:12,padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:4,cursor:b||!p.trim()?"not-allowed":"pointer"},children:b?"Processing...":"Parse Text"})]}),i==="json"&&l.jsxs("div",{children:[l.jsx("h3",{children:"Scryfall JSON Data"}),l.jsxs("p",{style:{color:"#666",marginBottom:16},children:["Upload JSON file or paste Scryfall API JSON data.",l.jsx("br",{}),"• Single card: ",l.jsx("code",{children:"https://api.scryfall.com/cards/[id]"}),l.jsx("br",{}),"• Search results: ",l.jsx("code",{children:"https://api.scryfall.com/cards/search?q=..."}),l.jsx("br",{}),"• Collection data with quantities"]}),l.jsx("input",{type:"file",accept:".json",onChange:A,style:{marginBottom:16,padding:8,border:"1px solid #ddd",borderRadius:4,width:"100%"}}),l.jsx("textarea",{value:h,onChange:ae=>y(ae.target.value),placeholder:'Paste Scryfall JSON here... (e.g., {"object": "card", "name": "Lightning Bolt", ...})',style:{width:"100%",height:200,border:"1px solid #ddd",borderRadius:4,padding:12,fontSize:12,fontFamily:"monospace"}}),l.jsx("button",{onClick:()=>G(h),disabled:b||!h.trim(),style:{marginTop:12,padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:4,cursor:b||!h.trim()?"not-allowed":"pointer"},children:b?"Processing...":"Parse JSON"})]}),i==="camera"&&l.jsxs("div",{children:[l.jsx("h3",{children:"Camera Scan"}),l.jsx("p",{style:{color:"#666",marginBottom:16},children:"Use your device's camera to scan card lists from paper, screens, or binders."}),V?l.jsxs("div",{children:[l.jsxs("div",{style:{position:"relative",width:"100%",maxWidth:500,margin:"0 auto 16px"},children:[l.jsx("video",{ref:L,autoPlay:!0,playsInline:!0,style:{width:"100%",height:"auto",border:"2px solid #007bff",borderRadius:8}}),l.jsx("canvas",{ref:$,style:{display:"none"}})]}),l.jsxs("div",{style:{textAlign:"center",gap:12,display:"flex",justifyContent:"center"},children:[l.jsx("button",{onClick:W,disabled:b,style:{padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:4,cursor:b?"not-allowed":"pointer"},children:b?"Processing...":"📸 Capture"}),l.jsx("button",{onClick:M,style:{padding:"8px 16px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:4,cursor:"pointer"},children:"Stop Camera"})]})]}):l.jsx("button",{onClick:R,style:{padding:"12px 24px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontSize:16},children:"📷 Start Camera"})]}),b&&l.jsxs("div",{style:{marginTop:20,marginBottom:20},children:[l.jsx("div",{style:{marginBottom:8,color:"#666",fontWeight:"500"},children:"Processing import..."}),l.jsx("div",{style:{width:"100%",height:"8px",backgroundColor:"#e0e0e0",borderRadius:"4px",overflow:"hidden"},children:l.jsx("div",{style:{width:"100%",height:"100%",backgroundColor:"#007bff",animation:"progressIndeterminate 2s infinite linear"}})}),l.jsx("style",{children:`
              @keyframes progressIndeterminate {
                0% { transform: translateX(-100%); }
                100% { transform: translateX(100%); }
              }
            `})]}),l.jsxs("div",{style:{marginTop:16,padding:8,backgroundColor:"#f8f9fa",border:"1px solid #dee2e6",borderRadius:4,fontSize:12},children:[l.jsx("div",{style:{marginBottom:4,fontWeight:"bold",color:"#495057"},children:"🐛 Debug Tools"}),l.jsx("button",{onClick:()=>{window.debugImport?window.debugImport.logs():console.log("Debug tools not available")},style:{padding:"4px 8px",fontSize:11,backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:3,cursor:"pointer",marginRight:4},children:"Show Console Logs"}),l.jsx("button",{onClick:()=>{window.debugImport&&window.debugImport.clear()},style:{padding:"4px 8px",fontSize:11,backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:3,cursor:"pointer"},children:"Clear Logs"}),l.jsx("div",{style:{fontSize:10,color:"#6c757d",marginTop:4},children:'Open browser console after clicking "Show Console Logs" to see formatted debug output'})]}),j&&E.length>0&&l.jsxs("div",{style:{marginTop:24,borderTop:"1px solid #eee",paddingTop:24},children:[l.jsxs("h3",{children:["Import Preview (",E.length," cards)"]}),l.jsx("div",{style:{maxHeight:200,overflow:"auto",border:"1px solid #ddd",borderRadius:4,backgroundColor:"#f8f9fa"},children:l.jsxs("table",{style:{width:"100%",fontSize:12},children:[l.jsx("thead",{children:l.jsxs("tr",{style:{backgroundColor:"#e9ecef",position:"sticky",top:0},children:[l.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:"Qty"}),l.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:"Name"}),l.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:"Set"}),l.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:"Rarity"}),l.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:"Condition"}),l.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:"Special"})]})}),l.jsxs("tbody",{children:[E.slice(0,50).map((ae,re)=>l.jsxs("tr",{style:{borderBottom:"1px solid #dee2e6"},children:[l.jsx("td",{style:{padding:"4px"},children:ae.quantity}),l.jsxs("td",{style:{padding:"4px",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis"},children:[ae.name,ae.collector_number&&l.jsxs("span",{style:{color:"#666",fontSize:"11px"},children:[" #",ae.collector_number]})]}),l.jsxs("td",{style:{padding:"4px",fontSize:"12px"},children:[ae.set_name||ae.set||"Unknown",ae.set&&ae.set_name&&l.jsxs("div",{style:{color:"#666",fontSize:"10px"},children:["(",ae.set.toUpperCase(),")"]})]}),l.jsx("td",{style:{padding:"4px"},children:ae.rarity?l.jsx("span",{style:{color:Ob(ae.rarity),fontWeight:"bold",textTransform:"capitalize",fontSize:"11px"},children:ae.rarity}):"Unknown"}),l.jsxs("td",{style:{padding:"4px",fontSize:"11px"},children:[ae.condition||"NM",ae.language&&ae.language!=="EN"&&l.jsx("div",{style:{color:"#666"},children:ae.language})]}),l.jsx("td",{style:{padding:"4px",fontSize:"10px"},children:Mb(ae)})]},re)),E.length>50&&l.jsx("tr",{children:l.jsxs("td",{colSpan:"4",style:{padding:8,textAlign:"center",fontStyle:"italic"},children:["... and ",E.length-50," more cards"]})})]})]})}),l.jsxs("div",{style:{marginTop:16,textAlign:"right"},children:[l.jsx("button",{onClick:()=>T(!1),style:{marginRight:8,padding:"8px 16px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:4,cursor:"pointer"},children:"Cancel"}),l.jsxs("button",{onClick:se,style:{padding:"8px 16px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:4,cursor:"pointer"},children:["Import ",E.length," Cards"]})]})]})]})})}const $b=({isVisible:a,phase:r="preparing",current:s=0,total:i=0,message:d="",errors:f=[],onPause:g,onResume:p,onCancel:m,isPaused:h=!1,canPause:y=!0,estimatedTimeRemaining:b=null,storageUsed:S=null,compressionRatio:E=null})=>{const[_]=v.useState(Date.now()),[j,T]=v.useState(0);if(v.useEffect(()=>{if(!a||h)return;const V=setInterval(()=>{T(Date.now()-_)},1e3);return()=>clearInterval(V)},[a,h,_]),!a)return null;const N=i>0?Math.round(s/i*100):0,O=f&&f.length>0,D=V=>{const H=Math.floor(V/1e3),C=Math.floor(H/60),I=Math.floor(C/60);return I>0?`${I}h ${C%60}m ${H%60}s`:C>0?`${C}m ${H%60}s`:`${H}s`},L=()=>{switch(r){case"preparing":return"🔧 Preparing import...";case"api":return"🌐 Fetching card data from Scryfall...";case"processing":return"⚙️ Processing card information...";case"storing":return"💾 Saving to collection...";case"complete":return"✅ Import complete!";default:return"📊 Processing..."}},$=()=>O?"bg-red-500":r==="complete"?"bg-green-500":h?"bg-yellow-500":"bg-blue-500";return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Collection Import Progress"}),r!=="complete"&&l.jsx("button",{onClick:m,className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Cancel import",children:"✖️"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:L()}),d&&l.jsx("p",{className:"text-xs text-gray-500",children:d})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[l.jsxs("span",{children:[s," of ",i]}),l.jsxs("span",{children:[N,"%"]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${$()}`,style:{width:`${N}%`}})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 text-xs",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"Elapsed:"}),l.jsx("span",{className:"ml-1 font-mono",children:D(j)})]}),b&&l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"Remaining:"}),l.jsx("span",{className:"ml-1 font-mono",children:D(b)})]}),S&&l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"Storage:"}),l.jsxs("span",{className:"ml-1 font-mono",children:[(S/1024/1024).toFixed(1),"MB"]})]}),E&&l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"Compression:"}),l.jsxs("span",{className:"ml-1 font-mono",children:[E,"%"]})]})]}),O&&l.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded",children:[l.jsxs("p",{className:"text-sm text-red-700 font-medium",children:["⚠️ ",f.length," error(s) encountered"]}),l.jsxs("details",{className:"mt-2",children:[l.jsx("summary",{className:"text-xs text-red-600 cursor-pointer hover:text-red-800",children:"View errors"}),l.jsxs("div",{className:"mt-2 max-h-24 overflow-y-auto",children:[f.slice(0,5).map((V,H)=>l.jsxs("p",{className:"text-xs text-red-600 mb-1",children:["• ",V]},H)),f.length>5&&l.jsxs("p",{className:"text-xs text-red-500 italic",children:["... and ",f.length-5," more"]})]})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[r!=="complete"&&y&&l.jsx("button",{onClick:h?p:g,className:`px-4 py-2 text-sm font-medium rounded transition-colors ${h?"bg-green-600 hover:bg-green-700 text-white":"bg-yellow-600 hover:bg-yellow-700 text-white"}`,children:h?"▶️ Resume":"⏸️ Pause"}),r==="complete"&&l.jsx("button",{onClick:m,className:"px-4 py-2 text-sm font-medium bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors",children:"Close"})]}),l.jsxs("details",{className:"mt-4",children:[l.jsx("summary",{className:"text-xs text-gray-500 cursor-pointer hover:text-gray-700",children:"Advanced Details"}),l.jsxs("div",{className:"mt-2 p-2 bg-gray-50 rounded text-xs space-y-1",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Phase:"})," ",r]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Started:"})," ",new Date(_).toLocaleTimeString()]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Cards Processed:"})," ",s,"/",i]}),h&&l.jsxs("div",{className:"text-yellow-600",children:[l.jsx("strong",{children:"Status:"})," Paused"]}),O&&l.jsxs("div",{className:"text-red-600",children:[l.jsx("strong",{children:"Errors:"})," ",f.length]})]})]})]})})};class Lb{constructor(){this.maxStorageSize=10*1024*1024,this.compressionThreshold=100*1024}getAvailableSpace(){try{const r="storage-test-"+Date.now(),s="x".repeat(1024);let i=0;for(let d in localStorage)localStorage.hasOwnProperty(d)&&(i+=(localStorage[d].length+d.length)*2);return{used:i,available:this.maxStorageSize-i,total:this.maxStorageSize,percentage:i/this.maxStorageSize*100}}catch(r){return{used:0,available:0,total:this.maxStorageSize,percentage:100,error:r.message}}}canStore(r,s=""){const i=(JSON.stringify(r).length+s.length)*2,{available:d}=this.getAvailableSpace();return i<d}compressData(r){try{const s=JSON.stringify(r);if(s.length<this.compressionThreshold)return{data:s,compressed:!1};const i=s.replace(/\s+/g," ").replace(/,\s*"/g,',"').replace(/:\s*"/g,':"').replace(/\[\s*"/g,'["').replace(/"\s*\]/g,'"]');return{data:i,compressed:!0,originalSize:s.length,compressedSize:i.length,savings:s.length-i.length}}catch(s){return console.error("Compression failed:",s),{data:JSON.stringify(r),compressed:!1}}}decompressData(r){try{return r.compressed,JSON.parse(r.data)}catch(s){return console.error("Decompression failed:",s),null}}setItem(r,s,i={}){try{const{forceStore:d=!1,clearOldData:f=!0}=i,g=this.getAvailableSpace();console.log(`📊 Storage usage: ${g.percentage.toFixed(1)}% (${(g.used/1024/1024).toFixed(1)}MB used)`);const p=this.compressData(s),m=(p.data.length+r.length)*2;if(console.log(`💾 Storing ${r}: ${(m/1024).toFixed(1)}KB ${p.compressed?"(compressed)":""}`),!this.canStore(p.data,r)){if(f){if(console.log("⚠️ Storage full, attempting to clear old data..."),this.clearOldData(),!this.canStore(p.data,r))throw new Error("Storage quota exceeded even after cleanup")}else if(!d)throw new Error("Storage quota would be exceeded")}const h={...p,timestamp:Date.now(),key:r,version:"1.0"};return localStorage.setItem(r,JSON.stringify(h)),p.compressed?console.log(`✅ Stored ${r} with ${(p.savings/1024).toFixed(1)}KB savings from compression`):console.log(`✅ Stored ${r} successfully`),!0}catch(d){return console.error(`❌ Failed to store ${r}:`,d.message),(d.name==="QuotaExceededError"||d.message.includes("quota"))&&this.handleQuotaExceeded(r,s,i),!1}}getItem(r){try{const s=localStorage.getItem(r);if(!s)return null;const i=JSON.parse(s);return i.hasOwnProperty("compressed")?i.collectionOptimized&&i.version==="2.0"?this.decompressCollectionData(i):this.decompressData(i):i}catch(s){return console.error(`❌ Failed to retrieve ${r}:`,s.message),null}}compressCollectionData(r){const s={name:"n",quantity:"q",tags:"t",set:"s",collector_number:"cn",rarity:"r",prices:"p",image_uris:"i",color_identity:"ci",mana_cost:"mc",type_line:"tl",oracle_text:"ot",power:"pw",toughness:"to",cmc:"c",legalities:"l",card_faces:"cf",layout:"ly"},i=JSON.parse(JSON.stringify(r));let d=0;Object.keys(i).forEach(p=>{const m=i[p];m.cards&&Array.isArray(m.cards)&&(d+=m.cards.length,m.cards=m.cards.map(h=>{const y={};return Object.keys(h).forEach(b=>{const S=s[b]||b;d>5e3&&["oracle_text","legalities","card_faces"].includes(b)||(y[S]=h[b])}),y}))});const f=JSON.stringify(r).length,g=JSON.stringify(i).length;return{data:i,compressed:!0,collectionOptimized:!0,version:"2.0",fieldMap:s,cardCount:d,originalSize:f,compressedSize:g,compressionRatio:Math.round((1-g/f)*100)}}decompressCollectionData(r){const{data:s,fieldMap:i}=r,d={};Object.keys(i).forEach(g=>{d[i[g]]=g});const f=JSON.parse(JSON.stringify(s));return Object.keys(f).forEach(g=>{const p=f[g];p.cards&&Array.isArray(p.cards)&&(p.cards=p.cards.map(m=>{const h={};return Object.keys(m).forEach(y=>{const b=d[y]||y;h[b]=m[y]}),h}))}),f}handleQuotaExceeded(r,s,i={}){console.log("🚨 Storage quota exceeded, implementing emergency measures...");try{const d=this.clearOldData(["production-otag-data","cache-","temp-","old-"]);if(console.log(`🗑️ Cleared ${d} old items, freed ${(d/1024).toFixed(1)}KB`),r==="cardCollection"&&Array.isArray(s)){console.log("💡 Attempting advanced collection compression...");const g=this.compressCollectionData(s);if(this.canStore(g.data,r)){const p={...g,timestamp:Date.now(),key:r,version:"2.0"};return localStorage.setItem(r,JSON.stringify(p)),console.log(`✅ Stored collection with ${(g.savings/1024).toFixed(1)}KB savings (${g.count} cards)`),!0}}const f=this.compressData(s);if(this.canStore(f.data,r))return console.log("💡 Attempting storage with maximum compression..."),this.setItem(r,s,{...i,forceStore:!0,clearOldData:!1});if(r==="cardCollection"&&Array.isArray(s)){console.log("💡 Attempting to store essential collection data only...");const g=this.extractEssentialCollectionData(s);return this.setItem(r,g,{...i,forceStore:!0,clearOldData:!1})}if(r==="cardCollections"&&typeof s=="object"&&s!==null)return console.log("💡 Using chunked storage for large collection..."),this.setItemChunked(r,s);throw new Error("All storage strategies failed")}catch(d){return console.error("❌ All storage fallback strategies failed:",d.message),this.showStorageFullError(r,s),!1}}async setItemChunked(r,s,i=1e6){try{const d=JSON.stringify(s),f=d.length;if(f<=i)return this.setItem(r,s);console.log(`📦 Chunking large data: ${(f/1024/1024).toFixed(2)}MB`);const g=Math.ceil(f/i),p={isChunked:!0,chunkCount:g,totalSize:f,timestamp:Date.now()};localStorage.setItem(`${r}_metadata`,JSON.stringify(p));for(let m=0;m<g;m++){const h=m*i,y=Math.min(h+i,f),b=d.slice(h,y);try{localStorage.setItem(`${r}_chunk_${m}`,b)}catch(S){for(let E=0;E<m;E++)localStorage.removeItem(`${r}_chunk_${E}`);throw localStorage.removeItem(`${r}_metadata`),new Error(`Failed to store chunk ${m}: ${S.message}`)}}return console.log(`✅ Stored ${g} chunks successfully`),!0}catch(d){throw console.error(`❌ Chunked storage failed for ${r}:`,d.message),d}}async getItemChunked(r){try{const s=localStorage.getItem(`${r}_metadata`);if(!s)return this.getItem(r);const i=JSON.parse(s);if(!i.isChunked)return this.getItem(r);console.log(`📦 Retrieving ${i.chunkCount} chunks...`);let d="";for(let g=0;g<i.chunkCount;g++){const p=localStorage.getItem(`${r}_chunk_${g}`);if(p===null)throw new Error(`Missing chunk ${g} of ${i.chunkCount}`);d+=p}const f=JSON.parse(d);return console.log(`✅ Retrieved ${(d.length/1024/1024).toFixed(2)}MB from chunks`),f}catch(s){return console.error(`❌ Failed to retrieve chunked data for ${r}:`,s.message),null}}extractEssentialCollectionData(r){return r.map(s=>({name:s.name,quantity:s.quantity||1,set:s.set,foil:s.foil||!1,condition:s.condition||"NM"}))}storeInChunks(r,s){try{const d=[];for(let g=0;g<s.length;g+=500)d.push(s.slice(g,g+500));const f={totalChunks:d.length,totalItems:s.length,timestamp:Date.now(),chunked:!0};localStorage.setItem(`${r}_meta`,JSON.stringify(f));for(let g=0;g<d.length;g++){const p=`${r}_chunk_${g}`;if(!this.setItem(p,d[g],{clearOldData:!1}))throw new Error(`Failed to store chunk ${g}`)}return console.log(`✅ Stored ${s.length} items in ${d.length} chunks`),!0}catch(i){return console.error("❌ Chunked storage failed:",i.message),!1}}getChunkedItem(r){try{const s=JSON.parse(localStorage.getItem(`${r}_meta`)||"{}");if(!s.chunked)return this.getItem(r);const i=[];for(let d=0;d<s.totalChunks;d++){const f=`${r}_chunk_${d}`,g=this.getItem(f);g&&i.push(...g)}return console.log(`📦 Reconstructed ${i.length} items from ${s.totalChunks} chunks`),i}catch(s){return console.error("❌ Failed to retrieve chunked data:",s.message),null}}clearOldData(r=["cache-","temp-","old-"]){let s=0;const i=[];for(let d in localStorage)if(localStorage.hasOwnProperty(d)){r.some(f=>d.startsWith(f))&&i.push(d);try{const f=JSON.parse(localStorage[d]);f.timestamp&&Date.now()-f.timestamp>7*24*60*60*1e3&&i.push(d)}catch{}}return i.forEach(d=>{const f=localStorage[d].length*2;localStorage.removeItem(d),s+=f}),console.log(`🗑️ Cleared ${i.length} old items, freed ${(s/1024).toFixed(1)}KB`),s}showStorageFullError(r,s){const i=`Storage is full! Unable to save ${r}.

Options:
1. Clear browser data
2. Export collection to file
3. Use smaller collection`;typeof window<"u"&&window.alert?alert(i):console.error("💾 Storage Full:",i)}getStats(){const r=this.getAvailableSpace();let s=0,i=0,d=0;for(let f in localStorage)localStorage.hasOwnProperty(f)&&(f.includes("Collection")||f.includes("collection")?s++:f.includes("cache")||f.includes("otag")?i++:d++);return{...r,itemCounts:{collections:s,cacheItems:i,otherItems:d,total:s+i+d}}}}const Xt=new Lb;function Ub(){for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return v.useMemo(()=>i=>{r.forEach(d=>d(i))},r)}const Yl=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function ao(a){const r=Object.prototype.toString.call(a);return r==="[object Window]"||r==="[object global]"}function Od(a){return"nodeType"in a}function gn(a){var r,s;return a?ao(a)?a:Od(a)&&(r=(s=a.ownerDocument)==null?void 0:s.defaultView)!=null?r:window:window}function Md(a){const{Document:r}=gn(a);return a instanceof r}function ms(a){return ao(a)?!1:a instanceof gn(a).HTMLElement}function kh(a){return a instanceof gn(a).SVGElement}function ro(a){return a?ao(a)?a.document:Od(a)?Md(a)?a:ms(a)||kh(a)?a.ownerDocument:document:document:document}const Zn=Yl?v.useLayoutEffect:v.useEffect;function zd(a){const r=v.useRef(a);return Zn(()=>{r.current=a}),v.useCallback(function(){for(var s=arguments.length,i=new Array(s),d=0;d<s;d++)i[d]=arguments[d];return r.current==null?void 0:r.current(...i)},[])}function Bb(){const a=v.useRef(null),r=v.useCallback((i,d)=>{a.current=setInterval(i,d)},[]),s=v.useCallback(()=>{a.current!==null&&(clearInterval(a.current),a.current=null)},[]);return[r,s]}function cs(a,r){r===void 0&&(r=[a]);const s=v.useRef(a);return Zn(()=>{s.current!==a&&(s.current=a)},r),s}function ys(a,r){const s=v.useRef();return v.useMemo(()=>{const i=a(s.current);return s.current=i,i},[...r])}function Ll(a){const r=zd(a),s=v.useRef(null),i=v.useCallback(d=>{d!==s.current&&(r==null||r(d,s.current)),s.current=d},[]);return[s,i]}function jd(a){const r=v.useRef();return v.useEffect(()=>{r.current=a},[a]),r.current}let cd={};function xs(a,r){return v.useMemo(()=>{if(r)return r;const s=cd[a]==null?0:cd[a]+1;return cd[a]=s,a+"-"+s},[a,r])}function Ah(a){return function(r){for(var s=arguments.length,i=new Array(s>1?s-1:0),d=1;d<s;d++)i[d-1]=arguments[d];return i.reduce((f,g)=>{const p=Object.entries(g);for(const[m,h]of p){const y=f[m];y!=null&&(f[m]=y+a*h)}return f},{...r})}}const to=Ah(1),ds=Ah(-1);function Ib(a){return"clientX"in a&&"clientY"in a}function $d(a){if(!a)return!1;const{KeyboardEvent:r}=gn(a.target);return r&&a instanceof r}function Hb(a){if(!a)return!1;const{TouchEvent:r}=gn(a.target);return r&&a instanceof r}function _d(a){if(Hb(a)){if(a.touches&&a.touches.length){const{clientX:r,clientY:s}=a.touches[0];return{x:r,y:s}}else if(a.changedTouches&&a.changedTouches.length){const{clientX:r,clientY:s}=a.changedTouches[0];return{x:r,y:s}}}return Ib(a)?{x:a.clientX,y:a.clientY}:null}const us=Object.freeze({Translate:{toString(a){if(!a)return;const{x:r,y:s}=a;return"translate3d("+(r?Math.round(r):0)+"px, "+(s?Math.round(s):0)+"px, 0)"}},Scale:{toString(a){if(!a)return;const{scaleX:r,scaleY:s}=a;return"scaleX("+r+") scaleY("+s+")"}},Transform:{toString(a){if(a)return[us.Translate.toString(a),us.Scale.toString(a)].join(" ")}},Transition:{toString(a){let{property:r,duration:s,easing:i}=a;return r+" "+s+"ms "+i}}}),Hp="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function qb(a){return a.matches(Hp)?a:a.querySelector(Hp)}const Fb={display:"none"};function Gb(a){let{id:r,value:s}=a;return ke.createElement("div",{id:r,style:Fb},s)}function Pb(a){let{id:r,announcement:s,ariaLiveType:i="assertive"}=a;const d={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return ke.createElement("div",{id:r,style:d,role:"status","aria-live":i,"aria-atomic":!0},s)}function Yb(){const[a,r]=v.useState("");return{announce:v.useCallback(i=>{i!=null&&r(i)},[]),announcement:a}}const Dh=v.createContext(null);function Xb(a){const r=v.useContext(Dh);v.useEffect(()=>{if(!r)throw new Error("useDndMonitor must be used within a children of <DndContext>");return r(a)},[a,r])}function Vb(){const[a]=v.useState(()=>new Set),r=v.useCallback(i=>(a.add(i),()=>a.delete(i)),[a]);return[v.useCallback(i=>{let{type:d,event:f}=i;a.forEach(g=>{var p;return(p=g[d])==null?void 0:p.call(g,f)})},[a]),r]}const Wb={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Qb={onDragStart(a){let{active:r}=a;return"Picked up draggable item "+r.id+"."},onDragOver(a){let{active:r,over:s}=a;return s?"Draggable item "+r.id+" was moved over droppable area "+s.id+".":"Draggable item "+r.id+" is no longer over a droppable area."},onDragEnd(a){let{active:r,over:s}=a;return s?"Draggable item "+r.id+" was dropped over droppable area "+s.id:"Draggable item "+r.id+" was dropped."},onDragCancel(a){let{active:r}=a;return"Dragging was cancelled. Draggable item "+r.id+" was dropped."}};function Zb(a){let{announcements:r=Qb,container:s,hiddenTextDescribedById:i,screenReaderInstructions:d=Wb}=a;const{announce:f,announcement:g}=Yb(),p=xs("DndLiveRegion"),[m,h]=v.useState(!1);if(v.useEffect(()=>{h(!0)},[]),Xb(v.useMemo(()=>({onDragStart(b){let{active:S}=b;f(r.onDragStart({active:S}))},onDragMove(b){let{active:S,over:E}=b;r.onDragMove&&f(r.onDragMove({active:S,over:E}))},onDragOver(b){let{active:S,over:E}=b;f(r.onDragOver({active:S,over:E}))},onDragEnd(b){let{active:S,over:E}=b;f(r.onDragEnd({active:S,over:E}))},onDragCancel(b){let{active:S,over:E}=b;f(r.onDragCancel({active:S,over:E}))}}),[f,r])),!m)return null;const y=ke.createElement(ke.Fragment,null,ke.createElement(Gb,{id:i,value:d.draggable}),ke.createElement(Pb,{id:p,announcement:g}));return s?ns.createPortal(y,s):y}var Bt;(function(a){a.DragStart="dragStart",a.DragMove="dragMove",a.DragEnd="dragEnd",a.DragCancel="dragCancel",a.DragOver="dragOver",a.RegisterDroppable="registerDroppable",a.SetDroppableDisabled="setDroppableDisabled",a.UnregisterDroppable="unregisterDroppable"})(Bt||(Bt={}));function Ul(){}function qp(a,r){return v.useMemo(()=>({sensor:a,options:r??{}}),[a,r])}function Kb(){for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return v.useMemo(()=>[...r].filter(i=>i!=null),[...r])}const qn=Object.freeze({x:0,y:0});function Rh(a,r){return Math.sqrt(Math.pow(a.x-r.x,2)+Math.pow(a.y-r.y,2))}function Nh(a,r){let{data:{value:s}}=a,{data:{value:i}}=r;return s-i}function Jb(a,r){let{data:{value:s}}=a,{data:{value:i}}=r;return i-s}function Fp(a){let{left:r,top:s,height:i,width:d}=a;return[{x:r,y:s},{x:r+d,y:s},{x:r,y:s+i},{x:r+d,y:s+i}]}function Oh(a,r){if(!a||a.length===0)return null;const[s]=a;return s[r]}function Gp(a,r,s){return r===void 0&&(r=a.left),s===void 0&&(s=a.top),{x:r+a.width*.5,y:s+a.height*.5}}const ev=a=>{let{collisionRect:r,droppableRects:s,droppableContainers:i}=a;const d=Gp(r,r.left,r.top),f=[];for(const g of i){const{id:p}=g,m=s.get(p);if(m){const h=Rh(Gp(m),d);f.push({id:p,data:{droppableContainer:g,value:h}})}}return f.sort(Nh)},tv=a=>{let{collisionRect:r,droppableRects:s,droppableContainers:i}=a;const d=Fp(r),f=[];for(const g of i){const{id:p}=g,m=s.get(p);if(m){const h=Fp(m),y=d.reduce((S,E,_)=>S+Rh(h[_],E),0),b=Number((y/4).toFixed(4));f.push({id:p,data:{droppableContainer:g,value:b}})}}return f.sort(Nh)};function nv(a,r){const s=Math.max(r.top,a.top),i=Math.max(r.left,a.left),d=Math.min(r.left+r.width,a.left+a.width),f=Math.min(r.top+r.height,a.top+a.height),g=d-i,p=f-s;if(i<d&&s<f){const m=r.width*r.height,h=a.width*a.height,y=g*p,b=y/(m+h-y);return Number(b.toFixed(4))}return 0}const av=a=>{let{collisionRect:r,droppableRects:s,droppableContainers:i}=a;const d=[];for(const f of i){const{id:g}=f,p=s.get(g);if(p){const m=nv(p,r);m>0&&d.push({id:g,data:{droppableContainer:f,value:m}})}}return d.sort(Jb)};function rv(a,r,s){return{...a,scaleX:r&&s?r.width/s.width:1,scaleY:r&&s?r.height/s.height:1}}function Mh(a,r){return a&&r?{x:a.left-r.left,y:a.top-r.top}:qn}function ov(a){return function(s){for(var i=arguments.length,d=new Array(i>1?i-1:0),f=1;f<i;f++)d[f-1]=arguments[f];return d.reduce((g,p)=>({...g,top:g.top+a*p.y,bottom:g.bottom+a*p.y,left:g.left+a*p.x,right:g.right+a*p.x}),{...s})}}const sv=ov(1);function lv(a){if(a.startsWith("matrix3d(")){const r=a.slice(9,-1).split(/, /);return{x:+r[12],y:+r[13],scaleX:+r[0],scaleY:+r[5]}}else if(a.startsWith("matrix(")){const r=a.slice(7,-1).split(/, /);return{x:+r[4],y:+r[5],scaleX:+r[0],scaleY:+r[3]}}return null}function iv(a,r,s){const i=lv(r);if(!i)return a;const{scaleX:d,scaleY:f,x:g,y:p}=i,m=a.left-g-(1-d)*parseFloat(s),h=a.top-p-(1-f)*parseFloat(s.slice(s.indexOf(" ")+1)),y=d?a.width/d:a.width,b=f?a.height/f:a.height;return{width:y,height:b,top:h,right:m+y,bottom:h+b,left:m}}const cv={ignoreTransform:!1};function oo(a,r){r===void 0&&(r=cv);let s=a.getBoundingClientRect();if(r.ignoreTransform){const{transform:h,transformOrigin:y}=gn(a).getComputedStyle(a);h&&(s=iv(s,h,y))}const{top:i,left:d,width:f,height:g,bottom:p,right:m}=s;return{top:i,left:d,width:f,height:g,bottom:p,right:m}}function Pp(a){return oo(a,{ignoreTransform:!0})}function dv(a){const r=a.innerWidth,s=a.innerHeight;return{top:0,left:0,right:r,bottom:s,width:r,height:s}}function uv(a,r){return r===void 0&&(r=gn(a).getComputedStyle(a)),r.position==="fixed"}function fv(a,r){r===void 0&&(r=gn(a).getComputedStyle(a));const s=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(d=>{const f=r[d];return typeof f=="string"?s.test(f):!1})}function Xl(a,r){const s=[];function i(d){if(r!=null&&s.length>=r||!d)return s;if(Md(d)&&d.scrollingElement!=null&&!s.includes(d.scrollingElement))return s.push(d.scrollingElement),s;if(!ms(d)||kh(d)||s.includes(d))return s;const f=gn(a).getComputedStyle(d);return d!==a&&fv(d,f)&&s.push(d),uv(d,f)?s:i(d.parentNode)}return a?i(a):s}function zh(a){const[r]=Xl(a,1);return r??null}function dd(a){return!Yl||!a?null:ao(a)?a:Od(a)?Md(a)||a===ro(a).scrollingElement?window:ms(a)?a:null:null}function $h(a){return ao(a)?a.scrollX:a.scrollLeft}function Lh(a){return ao(a)?a.scrollY:a.scrollTop}function Td(a){return{x:$h(a),y:Lh(a)}}var Vt;(function(a){a[a.Forward=1]="Forward",a[a.Backward=-1]="Backward"})(Vt||(Vt={}));function Uh(a){return!Yl||!a?!1:a===document.scrollingElement}function Bh(a){const r={x:0,y:0},s=Uh(a)?{height:window.innerHeight,width:window.innerWidth}:{height:a.clientHeight,width:a.clientWidth},i={x:a.scrollWidth-s.width,y:a.scrollHeight-s.height},d=a.scrollTop<=r.y,f=a.scrollLeft<=r.x,g=a.scrollTop>=i.y,p=a.scrollLeft>=i.x;return{isTop:d,isLeft:f,isBottom:g,isRight:p,maxScroll:i,minScroll:r}}const gv={x:.2,y:.2};function pv(a,r,s,i,d){let{top:f,left:g,right:p,bottom:m}=s;i===void 0&&(i=10),d===void 0&&(d=gv);const{isTop:h,isBottom:y,isLeft:b,isRight:S}=Bh(a),E={x:0,y:0},_={x:0,y:0},j={height:r.height*d.y,width:r.width*d.x};return!h&&f<=r.top+j.height?(E.y=Vt.Backward,_.y=i*Math.abs((r.top+j.height-f)/j.height)):!y&&m>=r.bottom-j.height&&(E.y=Vt.Forward,_.y=i*Math.abs((r.bottom-j.height-m)/j.height)),!S&&p>=r.right-j.width?(E.x=Vt.Forward,_.x=i*Math.abs((r.right-j.width-p)/j.width)):!b&&g<=r.left+j.width&&(E.x=Vt.Backward,_.x=i*Math.abs((r.left+j.width-g)/j.width)),{direction:E,speed:_}}function hv(a){if(a===document.scrollingElement){const{innerWidth:f,innerHeight:g}=window;return{top:0,left:0,right:f,bottom:g,width:f,height:g}}const{top:r,left:s,right:i,bottom:d}=a.getBoundingClientRect();return{top:r,left:s,right:i,bottom:d,width:a.clientWidth,height:a.clientHeight}}function Ih(a){return a.reduce((r,s)=>to(r,Td(s)),qn)}function mv(a){return a.reduce((r,s)=>r+$h(s),0)}function yv(a){return a.reduce((r,s)=>r+Lh(s),0)}function xv(a,r){if(r===void 0&&(r=oo),!a)return;const{top:s,left:i,bottom:d,right:f}=r(a);zh(a)&&(d<=0||f<=0||s>=window.innerHeight||i>=window.innerWidth)&&a.scrollIntoView({block:"center",inline:"center"})}const bv=[["x",["left","right"],mv],["y",["top","bottom"],yv]];class Ld{constructor(r,s){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const i=Xl(s),d=Ih(i);this.rect={...r},this.width=r.width,this.height=r.height;for(const[f,g,p]of bv)for(const m of g)Object.defineProperty(this,m,{get:()=>{const h=p(i),y=d[f]-h;return this.rect[m]+y},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class os{constructor(r){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(s=>{var i;return(i=this.target)==null?void 0:i.removeEventListener(...s)})},this.target=r}add(r,s,i){var d;(d=this.target)==null||d.addEventListener(r,s,i),this.listeners.push([r,s,i])}}function vv(a){const{EventTarget:r}=gn(a);return a instanceof r?a:ro(a)}function ud(a,r){const s=Math.abs(a.x),i=Math.abs(a.y);return typeof r=="number"?Math.sqrt(s**2+i**2)>r:"x"in r&&"y"in r?s>r.x&&i>r.y:"x"in r?s>r.x:"y"in r?i>r.y:!1}var zn;(function(a){a.Click="click",a.DragStart="dragstart",a.Keydown="keydown",a.ContextMenu="contextmenu",a.Resize="resize",a.SelectionChange="selectionchange",a.VisibilityChange="visibilitychange"})(zn||(zn={}));function Yp(a){a.preventDefault()}function Sv(a){a.stopPropagation()}var Qe;(function(a){a.Space="Space",a.Down="ArrowDown",a.Right="ArrowRight",a.Left="ArrowLeft",a.Up="ArrowUp",a.Esc="Escape",a.Enter="Enter",a.Tab="Tab"})(Qe||(Qe={}));const Hh={start:[Qe.Space,Qe.Enter],cancel:[Qe.Esc],end:[Qe.Space,Qe.Enter,Qe.Tab]},wv=(a,r)=>{let{currentCoordinates:s}=r;switch(a.code){case Qe.Right:return{...s,x:s.x+25};case Qe.Left:return{...s,x:s.x-25};case Qe.Down:return{...s,y:s.y+25};case Qe.Up:return{...s,y:s.y-25}}};class Ud{constructor(r){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=r;const{event:{target:s}}=r;this.props=r,this.listeners=new os(ro(s)),this.windowListeners=new os(gn(s)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(zn.Resize,this.handleCancel),this.windowListeners.add(zn.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(zn.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:r,onStart:s}=this.props,i=r.node.current;i&&xv(i),s(qn)}handleKeyDown(r){if($d(r)){const{active:s,context:i,options:d}=this.props,{keyboardCodes:f=Hh,coordinateGetter:g=wv,scrollBehavior:p="smooth"}=d,{code:m}=r;if(f.end.includes(m)){this.handleEnd(r);return}if(f.cancel.includes(m)){this.handleCancel(r);return}const{collisionRect:h}=i.current,y=h?{x:h.left,y:h.top}:qn;this.referenceCoordinates||(this.referenceCoordinates=y);const b=g(r,{active:s,context:i.current,currentCoordinates:y});if(b){const S=ds(b,y),E={x:0,y:0},{scrollableAncestors:_}=i.current;for(const j of _){const T=r.code,{isTop:N,isRight:O,isLeft:D,isBottom:L,maxScroll:$,minScroll:V}=Bh(j),H=hv(j),C={x:Math.min(T===Qe.Right?H.right-H.width/2:H.right,Math.max(T===Qe.Right?H.left:H.left+H.width/2,b.x)),y:Math.min(T===Qe.Down?H.bottom-H.height/2:H.bottom,Math.max(T===Qe.Down?H.top:H.top+H.height/2,b.y))},I=T===Qe.Right&&!O||T===Qe.Left&&!D,U=T===Qe.Down&&!L||T===Qe.Up&&!N;if(I&&C.x!==b.x){const A=j.scrollLeft+S.x,ee=T===Qe.Right&&A<=$.x||T===Qe.Left&&A>=V.x;if(ee&&!S.y){j.scrollTo({left:A,behavior:p});return}ee?E.x=j.scrollLeft-A:E.x=T===Qe.Right?j.scrollLeft-$.x:j.scrollLeft-V.x,E.x&&j.scrollBy({left:-E.x,behavior:p});break}else if(U&&C.y!==b.y){const A=j.scrollTop+S.y,ee=T===Qe.Down&&A<=$.y||T===Qe.Up&&A>=V.y;if(ee&&!S.x){j.scrollTo({top:A,behavior:p});return}ee?E.y=j.scrollTop-A:E.y=T===Qe.Down?j.scrollTop-$.y:j.scrollTop-V.y,E.y&&j.scrollBy({top:-E.y,behavior:p});break}}this.handleMove(r,to(ds(b,this.referenceCoordinates),E))}}}handleMove(r,s){const{onMove:i}=this.props;r.preventDefault(),i(s)}handleEnd(r){const{onEnd:s}=this.props;r.preventDefault(),this.detach(),s()}handleCancel(r){const{onCancel:s}=this.props;r.preventDefault(),this.detach(),s()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Ud.activators=[{eventName:"onKeyDown",handler:(a,r,s)=>{let{keyboardCodes:i=Hh,onActivation:d}=r,{active:f}=s;const{code:g}=a.nativeEvent;if(i.start.includes(g)){const p=f.activatorNode.current;return p&&a.target!==p?!1:(a.preventDefault(),d==null||d({event:a.nativeEvent}),!0)}return!1}}];function Xp(a){return!!(a&&"distance"in a)}function Vp(a){return!!(a&&"delay"in a)}class Bd{constructor(r,s,i){var d;i===void 0&&(i=vv(r.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=r,this.events=s;const{event:f}=r,{target:g}=f;this.props=r,this.events=s,this.document=ro(g),this.documentListeners=new os(this.document),this.listeners=new os(i),this.windowListeners=new os(gn(g)),this.initialCoordinates=(d=_d(f))!=null?d:qn,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:r,props:{options:{activationConstraint:s,bypassActivationConstraint:i}}}=this;if(this.listeners.add(r.move.name,this.handleMove,{passive:!1}),this.listeners.add(r.end.name,this.handleEnd),r.cancel&&this.listeners.add(r.cancel.name,this.handleCancel),this.windowListeners.add(zn.Resize,this.handleCancel),this.windowListeners.add(zn.DragStart,Yp),this.windowListeners.add(zn.VisibilityChange,this.handleCancel),this.windowListeners.add(zn.ContextMenu,Yp),this.documentListeners.add(zn.Keydown,this.handleKeydown),s){if(i!=null&&i({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Vp(s)){this.timeoutId=setTimeout(this.handleStart,s.delay),this.handlePending(s);return}if(Xp(s)){this.handlePending(s);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(r,s){const{active:i,onPending:d}=this.props;d(i,r,this.initialCoordinates,s)}handleStart(){const{initialCoordinates:r}=this,{onStart:s}=this.props;r&&(this.activated=!0,this.documentListeners.add(zn.Click,Sv,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(zn.SelectionChange,this.removeTextSelection),s(r))}handleMove(r){var s;const{activated:i,initialCoordinates:d,props:f}=this,{onMove:g,options:{activationConstraint:p}}=f;if(!d)return;const m=(s=_d(r))!=null?s:qn,h=ds(d,m);if(!i&&p){if(Xp(p)){if(p.tolerance!=null&&ud(h,p.tolerance))return this.handleCancel();if(ud(h,p.distance))return this.handleStart()}if(Vp(p)&&ud(h,p.tolerance))return this.handleCancel();this.handlePending(p,h);return}r.cancelable&&r.preventDefault(),g(m)}handleEnd(){const{onAbort:r,onEnd:s}=this.props;this.detach(),this.activated||r(this.props.active),s()}handleCancel(){const{onAbort:r,onCancel:s}=this.props;this.detach(),this.activated||r(this.props.active),s()}handleKeydown(r){r.code===Qe.Esc&&this.handleCancel()}removeTextSelection(){var r;(r=this.document.getSelection())==null||r.removeAllRanges()}}const Cv={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Id extends Bd{constructor(r){const{event:s}=r,i=ro(s.target);super(r,Cv,i)}}Id.activators=[{eventName:"onPointerDown",handler:(a,r)=>{let{nativeEvent:s}=a,{onActivation:i}=r;return!s.isPrimary||s.button!==0?!1:(i==null||i({event:s}),!0)}}];const jv={move:{name:"mousemove"},end:{name:"mouseup"}};var Ed;(function(a){a[a.RightClick=2]="RightClick"})(Ed||(Ed={}));class _v extends Bd{constructor(r){super(r,jv,ro(r.event.target))}}_v.activators=[{eventName:"onMouseDown",handler:(a,r)=>{let{nativeEvent:s}=a,{onActivation:i}=r;return s.button===Ed.RightClick?!1:(i==null||i({event:s}),!0)}}];const fd={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Tv extends Bd{constructor(r){super(r,fd)}static setup(){return window.addEventListener(fd.move.name,r,{capture:!1,passive:!1}),function(){window.removeEventListener(fd.move.name,r)};function r(){}}}Tv.activators=[{eventName:"onTouchStart",handler:(a,r)=>{let{nativeEvent:s}=a,{onActivation:i}=r;const{touches:d}=s;return d.length>1?!1:(i==null||i({event:s}),!0)}}];var ss;(function(a){a[a.Pointer=0]="Pointer",a[a.DraggableRect=1]="DraggableRect"})(ss||(ss={}));var Bl;(function(a){a[a.TreeOrder=0]="TreeOrder",a[a.ReversedTreeOrder=1]="ReversedTreeOrder"})(Bl||(Bl={}));function Ev(a){let{acceleration:r,activator:s=ss.Pointer,canScroll:i,draggingRect:d,enabled:f,interval:g=5,order:p=Bl.TreeOrder,pointerCoordinates:m,scrollableAncestors:h,scrollableAncestorRects:y,delta:b,threshold:S}=a;const E=Av({delta:b,disabled:!f}),[_,j]=Bb(),T=v.useRef({x:0,y:0}),N=v.useRef({x:0,y:0}),O=v.useMemo(()=>{switch(s){case ss.Pointer:return m?{top:m.y,bottom:m.y,left:m.x,right:m.x}:null;case ss.DraggableRect:return d}},[s,d,m]),D=v.useRef(null),L=v.useCallback(()=>{const V=D.current;if(!V)return;const H=T.current.x*N.current.x,C=T.current.y*N.current.y;V.scrollBy(H,C)},[]),$=v.useMemo(()=>p===Bl.TreeOrder?[...h].reverse():h,[p,h]);v.useEffect(()=>{if(!f||!h.length||!O){j();return}for(const V of $){if((i==null?void 0:i(V))===!1)continue;const H=h.indexOf(V),C=y[H];if(!C)continue;const{direction:I,speed:U}=pv(V,C,O,r,S);for(const A of["x","y"])E[A][I[A]]||(U[A]=0,I[A]=0);if(U.x>0||U.y>0){j(),D.current=V,_(L,g),T.current=U,N.current=I;return}}T.current={x:0,y:0},N.current={x:0,y:0},j()},[r,L,i,j,f,g,JSON.stringify(O),JSON.stringify(E),_,h,$,y,JSON.stringify(S)])}const kv={x:{[Vt.Backward]:!1,[Vt.Forward]:!1},y:{[Vt.Backward]:!1,[Vt.Forward]:!1}};function Av(a){let{delta:r,disabled:s}=a;const i=jd(r);return ys(d=>{if(s||!i||!d)return kv;const f={x:Math.sign(r.x-i.x),y:Math.sign(r.y-i.y)};return{x:{[Vt.Backward]:d.x[Vt.Backward]||f.x===-1,[Vt.Forward]:d.x[Vt.Forward]||f.x===1},y:{[Vt.Backward]:d.y[Vt.Backward]||f.y===-1,[Vt.Forward]:d.y[Vt.Forward]||f.y===1}}},[s,r,i])}function Dv(a,r){const s=r!=null?a.get(r):void 0,i=s?s.node.current:null;return ys(d=>{var f;return r==null?null:(f=i??d)!=null?f:null},[i,r])}function Rv(a,r){return v.useMemo(()=>a.reduce((s,i)=>{const{sensor:d}=i,f=d.activators.map(g=>({eventName:g.eventName,handler:r(g.handler,i)}));return[...s,...f]},[]),[a,r])}var fs;(function(a){a[a.Always=0]="Always",a[a.BeforeDragging=1]="BeforeDragging",a[a.WhileDragging=2]="WhileDragging"})(fs||(fs={}));var kd;(function(a){a.Optimized="optimized"})(kd||(kd={}));const Wp=new Map;function Nv(a,r){let{dragging:s,dependencies:i,config:d}=r;const[f,g]=v.useState(null),{frequency:p,measure:m,strategy:h}=d,y=v.useRef(a),b=T(),S=cs(b),E=v.useCallback(function(N){N===void 0&&(N=[]),!S.current&&g(O=>O===null?N:O.concat(N.filter(D=>!O.includes(D))))},[S]),_=v.useRef(null),j=ys(N=>{if(b&&!s)return Wp;if(!N||N===Wp||y.current!==a||f!=null){const O=new Map;for(let D of a){if(!D)continue;if(f&&f.length>0&&!f.includes(D.id)&&D.rect.current){O.set(D.id,D.rect.current);continue}const L=D.node.current,$=L?new Ld(m(L),L):null;D.rect.current=$,$&&O.set(D.id,$)}return O}return N},[a,f,s,b,m]);return v.useEffect(()=>{y.current=a},[a]),v.useEffect(()=>{b||E()},[s,b]),v.useEffect(()=>{f&&f.length>0&&g(null)},[JSON.stringify(f)]),v.useEffect(()=>{b||typeof p!="number"||_.current!==null||(_.current=setTimeout(()=>{E(),_.current=null},p))},[p,b,E,...i]),{droppableRects:j,measureDroppableContainers:E,measuringScheduled:f!=null};function T(){switch(h){case fs.Always:return!1;case fs.BeforeDragging:return s;default:return!s}}}function qh(a,r){return ys(s=>a?s||(typeof r=="function"?r(a):a):null,[r,a])}function Ov(a,r){return qh(a,r)}function Mv(a){let{callback:r,disabled:s}=a;const i=zd(r),d=v.useMemo(()=>{if(s||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:f}=window;return new f(i)},[i,s]);return v.useEffect(()=>()=>d==null?void 0:d.disconnect(),[d]),d}function Vl(a){let{callback:r,disabled:s}=a;const i=zd(r),d=v.useMemo(()=>{if(s||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:f}=window;return new f(i)},[s]);return v.useEffect(()=>()=>d==null?void 0:d.disconnect(),[d]),d}function zv(a){return new Ld(oo(a),a)}function Qp(a,r,s){r===void 0&&(r=zv);const[i,d]=v.useState(null);function f(){d(m=>{if(!a)return null;if(a.isConnected===!1){var h;return(h=m??s)!=null?h:null}const y=r(a);return JSON.stringify(m)===JSON.stringify(y)?m:y})}const g=Mv({callback(m){if(a)for(const h of m){const{type:y,target:b}=h;if(y==="childList"&&b instanceof HTMLElement&&b.contains(a)){f();break}}}}),p=Vl({callback:f});return Zn(()=>{f(),a?(p==null||p.observe(a),g==null||g.observe(document.body,{childList:!0,subtree:!0})):(p==null||p.disconnect(),g==null||g.disconnect())},[a]),i}function $v(a){const r=qh(a);return Mh(a,r)}const Zp=[];function Lv(a){const r=v.useRef(a),s=ys(i=>a?i&&i!==Zp&&a&&r.current&&a.parentNode===r.current.parentNode?i:Xl(a):Zp,[a]);return v.useEffect(()=>{r.current=a},[a]),s}function Uv(a){const[r,s]=v.useState(null),i=v.useRef(a),d=v.useCallback(f=>{const g=dd(f.target);g&&s(p=>p?(p.set(g,Td(g)),new Map(p)):null)},[]);return v.useEffect(()=>{const f=i.current;if(a!==f){g(f);const p=a.map(m=>{const h=dd(m);return h?(h.addEventListener("scroll",d,{passive:!0}),[h,Td(h)]):null}).filter(m=>m!=null);s(p.length?new Map(p):null),i.current=a}return()=>{g(a),g(f)};function g(p){p.forEach(m=>{const h=dd(m);h==null||h.removeEventListener("scroll",d)})}},[d,a]),v.useMemo(()=>a.length?r?Array.from(r.values()).reduce((f,g)=>to(f,g),qn):Ih(a):qn,[a,r])}function Kp(a,r){r===void 0&&(r=[]);const s=v.useRef(null);return v.useEffect(()=>{s.current=null},r),v.useEffect(()=>{const i=a!==qn;i&&!s.current&&(s.current=a),!i&&s.current&&(s.current=null)},[a]),s.current?ds(a,s.current):qn}function Bv(a){v.useEffect(()=>{if(!Yl)return;const r=a.map(s=>{let{sensor:i}=s;return i.setup==null?void 0:i.setup()});return()=>{for(const s of r)s==null||s()}},a.map(r=>{let{sensor:s}=r;return s}))}function Iv(a,r){return v.useMemo(()=>a.reduce((s,i)=>{let{eventName:d,handler:f}=i;return s[d]=g=>{f(g,r)},s},{}),[a,r])}function Fh(a){return v.useMemo(()=>a?dv(a):null,[a])}const Jp=[];function Hv(a,r){r===void 0&&(r=oo);const[s]=a,i=Fh(s?gn(s):null),[d,f]=v.useState(Jp);function g(){f(()=>a.length?a.map(m=>Uh(m)?i:new Ld(r(m),m)):Jp)}const p=Vl({callback:g});return Zn(()=>{p==null||p.disconnect(),g(),a.forEach(m=>p==null?void 0:p.observe(m))},[a]),d}function qv(a){if(!a)return null;if(a.children.length>1)return a;const r=a.children[0];return ms(r)?r:a}function Fv(a){let{measure:r}=a;const[s,i]=v.useState(null),d=v.useCallback(h=>{for(const{target:y}of h)if(ms(y)){i(b=>{const S=r(y);return b?{...b,width:S.width,height:S.height}:S});break}},[r]),f=Vl({callback:d}),g=v.useCallback(h=>{const y=qv(h);f==null||f.disconnect(),y&&(f==null||f.observe(y)),i(y?r(y):null)},[r,f]),[p,m]=Ll(g);return v.useMemo(()=>({nodeRef:p,rect:s,setRef:m}),[s,p,m])}const Gv=[{sensor:Id,options:{}},{sensor:Ud,options:{}}],Pv={current:{}},zl={draggable:{measure:Pp},droppable:{measure:Pp,strategy:fs.WhileDragging,frequency:kd.Optimized},dragOverlay:{measure:oo}};class ls extends Map{get(r){var s;return r!=null&&(s=super.get(r))!=null?s:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(r=>{let{disabled:s}=r;return!s})}getNodeFor(r){var s,i;return(s=(i=this.get(r))==null?void 0:i.node.current)!=null?s:void 0}}const Yv={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new ls,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ul},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:zl,measureDroppableContainers:Ul,windowRect:null,measuringScheduled:!1},Xv={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ul,draggableNodes:new Map,over:null,measureDroppableContainers:Ul},Wl=v.createContext(Xv),Gh=v.createContext(Yv);function Vv(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new ls}}}function Wv(a,r){switch(r.type){case Bt.DragStart:return{...a,draggable:{...a.draggable,initialCoordinates:r.initialCoordinates,active:r.active}};case Bt.DragMove:return a.draggable.active==null?a:{...a,draggable:{...a.draggable,translate:{x:r.coordinates.x-a.draggable.initialCoordinates.x,y:r.coordinates.y-a.draggable.initialCoordinates.y}}};case Bt.DragEnd:case Bt.DragCancel:return{...a,draggable:{...a.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Bt.RegisterDroppable:{const{element:s}=r,{id:i}=s,d=new ls(a.droppable.containers);return d.set(i,s),{...a,droppable:{...a.droppable,containers:d}}}case Bt.SetDroppableDisabled:{const{id:s,key:i,disabled:d}=r,f=a.droppable.containers.get(s);if(!f||i!==f.key)return a;const g=new ls(a.droppable.containers);return g.set(s,{...f,disabled:d}),{...a,droppable:{...a.droppable,containers:g}}}case Bt.UnregisterDroppable:{const{id:s,key:i}=r,d=a.droppable.containers.get(s);if(!d||i!==d.key)return a;const f=new ls(a.droppable.containers);return f.delete(s),{...a,droppable:{...a.droppable,containers:f}}}default:return a}}function Qv(a){let{disabled:r}=a;const{active:s,activatorEvent:i,draggableNodes:d}=v.useContext(Wl),f=jd(i),g=jd(s==null?void 0:s.id);return v.useEffect(()=>{if(!r&&!i&&f&&g!=null){if(!$d(f)||document.activeElement===f.target)return;const p=d.get(g);if(!p)return;const{activatorNode:m,node:h}=p;if(!m.current&&!h.current)return;requestAnimationFrame(()=>{for(const y of[m.current,h.current]){if(!y)continue;const b=qb(y);if(b){b.focus();break}}})}},[i,r,d,g,f]),null}function Zv(a,r){let{transform:s,...i}=r;return a!=null&&a.length?a.reduce((d,f)=>f({transform:d,...i}),s):s}function Kv(a){return v.useMemo(()=>({draggable:{...zl.draggable,...a==null?void 0:a.draggable},droppable:{...zl.droppable,...a==null?void 0:a.droppable},dragOverlay:{...zl.dragOverlay,...a==null?void 0:a.dragOverlay}}),[a==null?void 0:a.draggable,a==null?void 0:a.droppable,a==null?void 0:a.dragOverlay])}function Jv(a){let{activeNode:r,measure:s,initialRect:i,config:d=!0}=a;const f=v.useRef(!1),{x:g,y:p}=typeof d=="boolean"?{x:d,y:d}:d;Zn(()=>{if(!g&&!p||!r){f.current=!1;return}if(f.current||!i)return;const h=r==null?void 0:r.node.current;if(!h||h.isConnected===!1)return;const y=s(h),b=Mh(y,i);if(g||(b.x=0),p||(b.y=0),f.current=!0,Math.abs(b.x)>0||Math.abs(b.y)>0){const S=zh(h);S&&S.scrollBy({top:b.y,left:b.x})}},[r,g,p,i,s])}const Ph=v.createContext({...qn,scaleX:1,scaleY:1});var qa;(function(a){a[a.Uninitialized=0]="Uninitialized",a[a.Initializing=1]="Initializing",a[a.Initialized=2]="Initialized"})(qa||(qa={}));const e1=v.memo(function(r){var s,i,d,f;let{id:g,accessibility:p,autoScroll:m=!0,children:h,sensors:y=Gv,collisionDetection:b=av,measuring:S,modifiers:E,..._}=r;const j=v.useReducer(Wv,void 0,Vv),[T,N]=j,[O,D]=Vb(),[L,$]=v.useState(qa.Uninitialized),V=L===qa.Initialized,{draggable:{active:H,nodes:C,translate:I},droppable:{containers:U}}=T,A=H!=null?C.get(H):null,ee=v.useRef({initial:null,translated:null}),oe=v.useMemo(()=>{var ot;return H!=null?{id:H,data:(ot=A==null?void 0:A.data)!=null?ot:Pv,rect:ee}:null},[H,A]),G=v.useRef(null),[P,R]=v.useState(null),[M,W]=v.useState(null),se=cs(_,Object.values(_)),he=xs("DndDescribedBy",g),fe=v.useMemo(()=>U.getEnabled(),[U]),te=Kv(S),{droppableRects:K,measureDroppableContainers:ae,measuringScheduled:re}=Nv(fe,{dragging:V,dependencies:[I.x,I.y],config:te.droppable}),ue=Dv(C,H),me=v.useMemo(()=>M?_d(M):null,[M]),Ce=Ln(),Te=Ov(ue,te.draggable.measure);Jv({activeNode:H!=null?C.get(H):null,config:Ce.layoutShiftCompensation,initialRect:Te,measure:te.draggable.measure});const _e=Qp(ue,te.draggable.measure,Te),Pe=Qp(ue?ue.parentElement:null),rt=v.useRef({activatorEvent:null,active:null,activeNode:ue,collisionRect:null,collisions:null,droppableRects:K,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:U,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),nt=U.getNodeFor((s=rt.current.over)==null?void 0:s.id),_t=Fv({measure:te.dragOverlay.measure}),en=(i=_t.nodeRef.current)!=null?i:ue,It=V?(d=_t.rect)!=null?d:_e:null,Rt=!!(_t.nodeRef.current&&_t.rect),$n=$v(Rt?null:_e),vt=Fh(en?gn(en):null),pt=Lv(V?nt??ue:null),ht=Hv(pt),Nt=Zv(E,{transform:{x:I.x-$n.x,y:I.y-$n.y,scaleX:1,scaleY:1},activatorEvent:M,active:oe,activeNodeRect:_e,containerNodeRect:Pe,draggingNodeRect:It,over:rt.current.over,overlayNodeRect:_t.rect,scrollableAncestors:pt,scrollableAncestorRects:ht,windowRect:vt}),sn=me?to(me,I):null,Fn=Uv(pt),ya=Kp(Fn),tn=Kp(Fn,[_e]),it=to(Nt,ya),Tt=It?sv(It,Nt):null,yt=oe&&Tt?b({active:oe,collisionRect:Tt,droppableRects:K,droppableContainers:fe,pointerCoordinates:sn}):null,wn=Oh(yt,"id"),[Ht,Cn]=v.useState(null),jn=Rt?Nt:to(Nt,tn),_n=rv(jn,(f=Ht==null?void 0:Ht.rect)!=null?f:null,_e),X=v.useRef(null),Ae=v.useCallback((ot,St)=>{let{sensor:Et,options:an}=St;if(G.current==null)return;const wt=C.get(G.current);if(!wt)return;const kt=ot.nativeEvent,Be=new Et({active:G.current,activeNode:wt,event:kt,options:an,context:rt,onAbort(Ke){if(!C.get(Ke))return;const{onDragAbort:Ne}=se.current,et={id:Ke};Ne==null||Ne(et),O({type:"onDragAbort",event:et})},onPending(Ke,Je,Ne,et){if(!C.get(Ke))return;const{onDragPending:B}=se.current,q={id:Ke,constraint:Je,initialCoordinates:Ne,offset:et};B==null||B(q),O({type:"onDragPending",event:q})},onStart(Ke){const Je=G.current;if(Je==null)return;const Ne=C.get(Je);if(!Ne)return;const{onDragStart:et}=se.current,k={activatorEvent:kt,active:{id:Je,data:Ne.data,rect:ee}};ns.unstable_batchedUpdates(()=>{et==null||et(k),$(qa.Initializing),N({type:Bt.DragStart,initialCoordinates:Ke,active:Je}),O({type:"onDragStart",event:k}),R(X.current),W(kt)})},onMove(Ke){N({type:Bt.DragMove,coordinates:Ke})},onEnd:Wt(Bt.DragEnd),onCancel:Wt(Bt.DragCancel)});X.current=Be;function Wt(Ke){return async function(){const{active:Ne,collisions:et,over:k,scrollAdjustedTranslate:B}=rt.current;let q=null;if(Ne&&B){const{cancelDrop:ge}=se.current;q={activatorEvent:kt,active:Ne,collisions:et,delta:B,over:k},Ke===Bt.DragEnd&&typeof ge=="function"&&await Promise.resolve(ge(q))&&(Ke=Bt.DragCancel)}G.current=null,ns.unstable_batchedUpdates(()=>{N({type:Ke}),$(qa.Uninitialized),Cn(null),R(null),W(null),X.current=null;const ge=Ke===Bt.DragEnd?"onDragEnd":"onDragCancel";if(q){const ve=se.current[ge];ve==null||ve(q),O({type:ge,event:q})}})}}},[C]),Tn=v.useCallback((ot,St)=>(Et,an)=>{const wt=Et.nativeEvent,kt=C.get(an);if(G.current!==null||!kt||wt.dndKit||wt.defaultPrevented)return;const Be={active:kt};ot(Et,St.options,Be)===!0&&(wt.dndKit={capturedBy:St.sensor},G.current=an,Ae(Et,St))},[C,Ae]),xa=Rv(y,Tn);Bv(y),Zn(()=>{_e&&L===qa.Initializing&&$(qa.Initialized)},[_e,L]),v.useEffect(()=>{const{onDragMove:ot}=se.current,{active:St,activatorEvent:Et,collisions:an,over:wt}=rt.current;if(!St||!Et)return;const kt={active:St,activatorEvent:Et,collisions:an,delta:{x:it.x,y:it.y},over:wt};ns.unstable_batchedUpdates(()=>{ot==null||ot(kt),O({type:"onDragMove",event:kt})})},[it.x,it.y]),v.useEffect(()=>{const{active:ot,activatorEvent:St,collisions:Et,droppableContainers:an,scrollAdjustedTranslate:wt}=rt.current;if(!ot||G.current==null||!St||!wt)return;const{onDragOver:kt}=se.current,Be=an.get(wn),Wt=Be&&Be.rect.current?{id:Be.id,rect:Be.rect.current,data:Be.data,disabled:Be.disabled}:null,Ke={active:ot,activatorEvent:St,collisions:Et,delta:{x:wt.x,y:wt.y},over:Wt};ns.unstable_batchedUpdates(()=>{Cn(Wt),kt==null||kt(Ke),O({type:"onDragOver",event:Ke})})},[wn]),Zn(()=>{rt.current={activatorEvent:M,active:oe,activeNode:ue,collisionRect:Tt,collisions:yt,droppableRects:K,draggableNodes:C,draggingNode:en,draggingNodeRect:It,droppableContainers:U,over:Ht,scrollableAncestors:pt,scrollAdjustedTranslate:it},ee.current={initial:It,translated:Tt}},[oe,ue,yt,Tt,C,en,It,K,U,Ht,pt,it]),Ev({...Ce,delta:I,draggingRect:Tt,pointerCoordinates:sn,scrollableAncestors:pt,scrollableAncestorRects:ht});const Fa=v.useMemo(()=>({active:oe,activeNode:ue,activeNodeRect:_e,activatorEvent:M,collisions:yt,containerNodeRect:Pe,dragOverlay:_t,draggableNodes:C,droppableContainers:U,droppableRects:K,over:Ht,measureDroppableContainers:ae,scrollableAncestors:pt,scrollableAncestorRects:ht,measuringConfiguration:te,measuringScheduled:re,windowRect:vt}),[oe,ue,_e,M,yt,Pe,_t,C,U,K,Ht,ae,pt,ht,te,re,vt]),Kn=v.useMemo(()=>({activatorEvent:M,activators:xa,active:oe,activeNodeRect:_e,ariaDescribedById:{draggable:he},dispatch:N,draggableNodes:C,over:Ht,measureDroppableContainers:ae}),[M,xa,oe,_e,N,he,C,Ht,ae]);return ke.createElement(Dh.Provider,{value:D},ke.createElement(Wl.Provider,{value:Kn},ke.createElement(Gh.Provider,{value:Fa},ke.createElement(Ph.Provider,{value:_n},h)),ke.createElement(Qv,{disabled:(p==null?void 0:p.restoreFocus)===!1})),ke.createElement(Zb,{...p,hiddenTextDescribedById:he}));function Ln(){const ot=(P==null?void 0:P.autoScrollEnabled)===!1,St=typeof m=="object"?m.enabled===!1:m===!1,Et=V&&!ot&&!St;return typeof m=="object"?{...m,enabled:Et}:{enabled:Et}}}),t1=v.createContext(null),eh="button",n1="Draggable";function a1(a){let{id:r,data:s,disabled:i=!1,attributes:d}=a;const f=xs(n1),{activators:g,activatorEvent:p,active:m,activeNodeRect:h,ariaDescribedById:y,draggableNodes:b,over:S}=v.useContext(Wl),{role:E=eh,roleDescription:_="draggable",tabIndex:j=0}=d??{},T=(m==null?void 0:m.id)===r,N=v.useContext(T?Ph:t1),[O,D]=Ll(),[L,$]=Ll(),V=Iv(g,r),H=cs(s);Zn(()=>(b.set(r,{id:r,key:f,node:O,activatorNode:L,data:H}),()=>{const I=b.get(r);I&&I.key===f&&b.delete(r)}),[b,r]);const C=v.useMemo(()=>({role:E,tabIndex:j,"aria-disabled":i,"aria-pressed":T&&E===eh?!0:void 0,"aria-roledescription":_,"aria-describedby":y.draggable}),[i,E,j,T,_,y.draggable]);return{active:m,activatorEvent:p,activeNodeRect:h,attributes:C,isDragging:T,listeners:i?void 0:V,node:O,over:S,setNodeRef:D,setActivatorNodeRef:$,transform:N}}function r1(){return v.useContext(Gh)}const o1="Droppable",s1={timeout:25};function l1(a){let{data:r,disabled:s=!1,id:i,resizeObserverConfig:d}=a;const f=xs(o1),{active:g,dispatch:p,over:m,measureDroppableContainers:h}=v.useContext(Wl),y=v.useRef({disabled:s}),b=v.useRef(!1),S=v.useRef(null),E=v.useRef(null),{disabled:_,updateMeasurementsFor:j,timeout:T}={...s1,...d},N=cs(j??i),O=v.useCallback(()=>{if(!b.current){b.current=!0;return}E.current!=null&&clearTimeout(E.current),E.current=setTimeout(()=>{h(Array.isArray(N.current)?N.current:[N.current]),E.current=null},T)},[T]),D=Vl({callback:O,disabled:_||!g}),L=v.useCallback((C,I)=>{D&&(I&&(D.unobserve(I),b.current=!1),C&&D.observe(C))},[D]),[$,V]=Ll(L),H=cs(r);return v.useEffect(()=>{!D||!$.current||(D.disconnect(),b.current=!1,D.observe($.current))},[$,D]),v.useEffect(()=>(p({type:Bt.RegisterDroppable,element:{id:i,key:f,disabled:s,node:$,rect:S,data:H}}),()=>p({type:Bt.UnregisterDroppable,key:f,id:i})),[i]),v.useEffect(()=>{s!==y.current.disabled&&(p({type:Bt.SetDroppableDisabled,id:i,key:f,disabled:s}),y.current.disabled=s)},[i,f,s,p]),{active:g,rect:S,isOver:(m==null?void 0:m.id)===i,node:$,over:m,setNodeRef:V}}function Hd(a,r,s){const i=a.slice();return i.splice(s<0?i.length+s:s,0,i.splice(r,1)[0]),i}function i1(a,r){return a.reduce((s,i,d)=>{const f=r.get(i);return f&&(s[d]=f),s},Array(a.length))}function Dl(a){return a!==null&&a>=0}function c1(a,r){if(a===r)return!0;if(a.length!==r.length)return!1;for(let s=0;s<a.length;s++)if(a[s]!==r[s])return!1;return!0}function d1(a){return typeof a=="boolean"?{draggable:a,droppable:a}:a}const Rl={scaleX:1,scaleY:1},u1=a=>{var r;let{rects:s,activeNodeRect:i,activeIndex:d,overIndex:f,index:g}=a;const p=(r=s[d])!=null?r:i;if(!p)return null;const m=f1(s,g,d);if(g===d){const h=s[f];return h?{x:d<f?h.left+h.width-(p.left+p.width):h.left-p.left,y:0,...Rl}:null}return g>d&&g<=f?{x:-p.width-m,y:0,...Rl}:g<d&&g>=f?{x:p.width+m,y:0,...Rl}:{x:0,y:0,...Rl}};function f1(a,r,s){const i=a[r],d=a[r-1],f=a[r+1];return!i||!d&&!f?0:s<r?d?i.left-(d.left+d.width):f.left-(i.left+i.width):f?f.left-(i.left+i.width):i.left-(d.left+d.width)}const Yh=a=>{let{rects:r,activeIndex:s,overIndex:i,index:d}=a;const f=Hd(r,i,s),g=r[d],p=f[d];return!p||!g?null:{x:p.left-g.left,y:p.top-g.top,scaleX:p.width/g.width,scaleY:p.height/g.height}},Xh="Sortable",Vh=ke.createContext({activeIndex:-1,containerId:Xh,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Yh,disabled:{draggable:!1,droppable:!1}});function g1(a){let{children:r,id:s,items:i,strategy:d=Yh,disabled:f=!1}=a;const{active:g,dragOverlay:p,droppableRects:m,over:h,measureDroppableContainers:y}=r1(),b=xs(Xh,s),S=p.rect!==null,E=v.useMemo(()=>i.map(V=>typeof V=="object"&&"id"in V?V.id:V),[i]),_=g!=null,j=g?E.indexOf(g.id):-1,T=h?E.indexOf(h.id):-1,N=v.useRef(E),O=!c1(E,N.current),D=T!==-1&&j===-1||O,L=d1(f);Zn(()=>{O&&_&&y(E)},[O,E,_,y]),v.useEffect(()=>{N.current=E},[E]);const $=v.useMemo(()=>({activeIndex:j,containerId:b,disabled:L,disableTransforms:D,items:E,overIndex:T,useDragOverlay:S,sortedRects:i1(E,m),strategy:d}),[j,b,L.draggable,L.droppable,D,E,T,m,S,d]);return ke.createElement(Vh.Provider,{value:$},r)}const p1=a=>{let{id:r,items:s,activeIndex:i,overIndex:d}=a;return Hd(s,i,d).indexOf(r)},h1=a=>{let{containerId:r,isSorting:s,wasDragging:i,index:d,items:f,newIndex:g,previousItems:p,previousContainerId:m,transition:h}=a;return!h||!i||p!==f&&d===g?!1:s?!0:g!==d&&r===m},m1={duration:200,easing:"ease"},Wh="transform",y1=us.Transition.toString({property:Wh,duration:0,easing:"linear"}),x1={roleDescription:"sortable"};function b1(a){let{disabled:r,index:s,node:i,rect:d}=a;const[f,g]=v.useState(null),p=v.useRef(s);return Zn(()=>{if(!r&&s!==p.current&&i.current){const m=d.current;if(m){const h=oo(i.current,{ignoreTransform:!0}),y={x:m.left-h.left,y:m.top-h.top,scaleX:m.width/h.width,scaleY:m.height/h.height};(y.x||y.y)&&g(y)}}s!==p.current&&(p.current=s)},[r,s,i,d]),v.useEffect(()=>{f&&g(null)},[f]),f}function v1(a){let{animateLayoutChanges:r=h1,attributes:s,disabled:i,data:d,getNewIndex:f=p1,id:g,strategy:p,resizeObserverConfig:m,transition:h=m1}=a;const{items:y,containerId:b,activeIndex:S,disabled:E,disableTransforms:_,sortedRects:j,overIndex:T,useDragOverlay:N,strategy:O}=v.useContext(Vh),D=S1(i,E),L=y.indexOf(g),$=v.useMemo(()=>({sortable:{containerId:b,index:L,items:y},...d}),[b,d,L,y]),V=v.useMemo(()=>y.slice(y.indexOf(g)),[y,g]),{rect:H,node:C,isOver:I,setNodeRef:U}=l1({id:g,data:$,disabled:D.droppable,resizeObserverConfig:{updateMeasurementsFor:V,...m}}),{active:A,activatorEvent:ee,activeNodeRect:oe,attributes:G,setNodeRef:P,listeners:R,isDragging:M,over:W,setActivatorNodeRef:se,transform:he}=a1({id:g,data:$,attributes:{...x1,...s},disabled:D.draggable}),fe=Ub(U,P),te=!!A,K=te&&!_&&Dl(S)&&Dl(T),ae=!N&&M,re=ae&&K?he:null,me=K?re??(p??O)({rects:j,activeNodeRect:oe,activeIndex:S,overIndex:T,index:L}):null,Ce=Dl(S)&&Dl(T)?f({id:g,items:y,activeIndex:S,overIndex:T}):L,Te=A==null?void 0:A.id,_e=v.useRef({activeId:Te,items:y,newIndex:Ce,containerId:b}),Pe=y!==_e.current.items,rt=r({active:A,containerId:b,isDragging:M,isSorting:te,id:g,index:L,items:y,newIndex:_e.current.newIndex,previousItems:_e.current.items,previousContainerId:_e.current.containerId,transition:h,wasDragging:_e.current.activeId!=null}),nt=b1({disabled:!rt,index:L,node:C,rect:H});return v.useEffect(()=>{te&&_e.current.newIndex!==Ce&&(_e.current.newIndex=Ce),b!==_e.current.containerId&&(_e.current.containerId=b),y!==_e.current.items&&(_e.current.items=y)},[te,Ce,b,y]),v.useEffect(()=>{if(Te===_e.current.activeId)return;if(Te!=null&&_e.current.activeId==null){_e.current.activeId=Te;return}const en=setTimeout(()=>{_e.current.activeId=Te},50);return()=>clearTimeout(en)},[Te]),{active:A,activeIndex:S,attributes:G,data:$,rect:H,index:L,newIndex:Ce,items:y,isOver:I,isSorting:te,isDragging:M,listeners:R,node:C,overIndex:T,over:W,setNodeRef:fe,setActivatorNodeRef:se,setDroppableNodeRef:U,setDraggableNodeRef:P,transform:nt??me,transition:_t()};function _t(){if(nt||Pe&&_e.current.newIndex===L)return y1;if(!(ae&&!$d(ee)||!h)&&(te||rt))return us.Transition.toString({...h,property:Wh})}}function S1(a,r){var s,i;return typeof a=="boolean"?{draggable:a,droppable:!1}:{draggable:(s=a==null?void 0:a.draggable)!=null?s:r.draggable,droppable:(i=a==null?void 0:a.droppable)!=null?i:r.droppable}}function Il(a){if(!a)return!1;const r=a.data.current;return!!(r&&"sortable"in r&&typeof r.sortable=="object"&&"containerId"in r.sortable&&"items"in r.sortable&&"index"in r.sortable)}const w1=[Qe.Down,Qe.Right,Qe.Up,Qe.Left],C1=(a,r)=>{let{context:{active:s,collisionRect:i,droppableRects:d,droppableContainers:f,over:g,scrollableAncestors:p}}=r;if(w1.includes(a.code)){if(a.preventDefault(),!s||!i)return;const m=[];f.getEnabled().forEach(b=>{if(!b||b!=null&&b.disabled)return;const S=d.get(b.id);if(S)switch(a.code){case Qe.Down:i.top<S.top&&m.push(b);break;case Qe.Up:i.top>S.top&&m.push(b);break;case Qe.Left:i.left>S.left&&m.push(b);break;case Qe.Right:i.left<S.left&&m.push(b);break}});const h=tv({collisionRect:i,droppableRects:d,droppableContainers:m});let y=Oh(h,"id");if(y===(g==null?void 0:g.id)&&h.length>1&&(y=h[1].id),y!=null){const b=f.get(s.id),S=f.get(y),E=S?d.get(S.id):null,_=S==null?void 0:S.node.current;if(_&&E&&b&&S){const T=Xl(_).some((V,H)=>p[H]!==V),N=Qh(b,S),O=j1(b,S),D=T||!N?{x:0,y:0}:{x:O?i.width-E.width:0,y:O?i.height-E.height:0},L={x:E.left,y:E.top};return D.x&&D.y?L:ds(L,D)}}}};function Qh(a,r){return!Il(a)||!Il(r)?!1:a.data.current.sortable.containerId===r.data.current.sortable.containerId}function j1(a,r){return!Il(a)||!Il(r)||!Qh(a,r)?!1:a.data.current.sortable.index<r.data.current.sortable.index}const gd=a=>{if(!a&&a!==0)return!1;const r=parseFloat(a.toString().replace(/^\$/,""));return!isNaN(r)&&r>=0&&r<=1e3},pa=(a,r,s=10)=>{if(!a||typeof a!="object"||s<=0)return null;const i=r.split(".");let d=a;for(const p of i)if(d&&typeof d=="object"&&p in d)d=d[p];else{d=null;break}if(d!=null)return d;const f=(p,m,h=0)=>{if(h>=s||!p||typeof p!="object")return null;if(m in p&&p[m]!==null&&p[m]!==void 0)return p[m];for(const[y,b]of Object.entries(p))if(b&&typeof b=="object"){const S=f(b,m,h+1);if(S!=null)return S}return null},g=i[i.length-1];return f(a,g)},th=a=>pa(a,"foil")===!0,_1=a=>{if(!a)return!1;if(a.foil===!0&&a.nonfoil===!1)return!0;const r=a.finishes||[];return r.includes("foil")&&!r.includes("nonfoil")},nh=(a,r)=>{if(!a)return{type:"normal",display:"Normal"};const s=a.finishes||[],i=a.promo_types||[],d=a.frame_effects||[],f=s.includes("etched")||d.includes("etched"),g=i.some(p=>["surgefoil","rainbow","textured","boosterfun"].includes(p));return r?f?{type:"etched",display:"Etched"}:g?{type:"special_foil",display:"Special Foil"}:{type:"foil",display:"Foil"}:{type:"normal",display:"Normal"}},T1={Forest:"d232fcc2-12f6-401a-b1aa-ddff11cb9378",Island:"23635e40-d040-40b7-8b98-90ed362aa028",Mountain:"1edc5050-69bd-416d-b04c-7f82de2a1901",Plains:"4ef17ed4-a9b5-4b8e-b4cb-2ecb7e5898c3",Swamp:"13505c15-14e0-4200-82bd-fb9bce949e68",Wastes:"60682c00-c661-4a9d-8326-f3f014a04e3e","Snow-Covered Forest":"838c915d-8153-43c2-b513-dfbe4e9388a5","Snow-Covered Island":"6abf0692-07d1-4b72-af06-93d0e338589d","Snow-Covered Mountain":"0dc9a6d1-a1ca-4b8f-894d-71c2a9933f79","Snow-Covered Plains":"b1e3a010-dae3-41b6-8dd8-e31d14c3ac4a","Snow-Covered Swamp":"c4dacaf1-09b8-42bb-8064-990190fdaf81","Snow-Covered Wastes":"ad21a874-525e-4d11-bd8e-bc44918bec40"},Jt=(a,r={})=>{const{preferStoredPrice:s=!0,fallbackPrice:i=null,debugLogging:d=!1}=r;if(!a||typeof a!="object")return{price:i,source:"invalid_card_object",cardType:"unknown",finishType:"normal",isValid:!1,metadata:{error:"Invalid card data"}};const f=pa(a,"name")||"Unknown Card",g=()=>{};if(s){const D=pa(a,"modalPrice");if(gd(D)){const L=th(a),$=nh(a,L);return{price:D,source:"stored_modal_price",cardType:$.type,finishType:$.display,isValid:!0,metadata:{cardName:f,isFoil:L,wasStored:!0}}}}const p=pa(a,"scryfall_json")||{},m=p.prices||pa(a,"prices")||{},y=(pa(a,"type_line")||"").toLowerCase().includes("basic land")||T1[f],b=m&&Object.keys(m).length>0,S=th(a),E=_1(p),_=nh(p,S||E);g("[UNIFIED PRICING] Card characteristics:",{finish:_.type});let j=null,T="not_found";if(b)if(E)switch(_.type){case"etched":j=m.usd_etched||m.usd_foil||m.usd||null,T="foil_only_etched";break;case"special_foil":j=m.usd_foil||m.usd||null,T="foil_only_special";break;default:j=m.usd_foil||m.usd||null,T="foil_only_regular"}else if(S)switch(_.type){case"etched":j=m.usd_etched||m.usd_foil||m.usd||null,T="explicit_foil_etched";break;case"special_foil":j=m.usd_foil||m.usd||null,T="explicit_foil_special";break;default:j=m.usd_foil||m.usd||null,T="explicit_foil_regular"}else j=m.usd||null,T="regular_usd";if(!j){const L=a.price||a.usd||pa(a,"price")||pa(a,"usd");L&&gd(L)&&(j=L.toString(),T="legacy_fallback")}if(!j&&y&&(j="0.10",T="basic_land_fallback"),!j&&!y){const D=pa(a,"type_line")||"";D.toLowerCase().includes("token")?(j="0.00",T="token_fallback"):D.toLowerCase().includes("basic land")?(j="0.10",T="basic_land_secondary_fallback"):(j="0.05",T="generic_fallback")}!j&&i&&(j=i,T="provided_fallback");const N=j,O=gd(N);return g(`[UNIFIED PRICING] Final result for ${f}:`,{cardType:_.type}),{price:N,source:T,cardType:_.type,finishType:_.display,isValid:O,metadata:{cardName:f,isFoil:S||E,isFoilOnly:E,availablePrices:Object.keys(m),scryfallId:p.id,finishes:p.finishes||[]}}},fn=(a,r={})=>{const{showCurrency:s=!0,precision:i=2}=r;if(!a&&a!==0)return"N/A";const d=parseFloat(a.toString().replace(/^\$/,""));if(isNaN(d))return"N/A";const f=d.toFixed(i);return s?`$${f}`:f};function E1({column:a,index:r,onSort:s,sortBy:i,sortDirection:d}){const{attributes:f,listeners:g,setNodeRef:p,transform:m,transition:h,isDragging:y}=v1({id:a.id,disabled:a.fixed}),b={transform:us.Transform.toString(m),transition:h,opacity:y?.5:1};return l.jsx("th",{ref:p,style:{...b,padding:"10px 12px",textAlign:a.id==="name"?"left":["quantity","setIcon","foil","rarity","condition","language","cardNumber"].includes(a.id)?"center":["currentPrice","purchasePrice","netGain","actions"].includes(a.id)?"right":"left",fontWeight:"600",fontSize:"11px",color:"#666",textTransform:"uppercase",letterSpacing:"0.5px",width:a.width,cursor:a.sortable?"pointer":a.fixed?"default":"grab",backgroundColor:y?"#e3f2fd":"#f8f9fa",position:"relative",userSelect:"none",border:y?"2px dashed #1976d2":"1px solid #dee2e6"},...f,...a.fixed?{}:g,children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,justifyContent:a.id==="name"?"flex-start":["quantity","setIcon","foil","rarity","condition","language","cardNumber"].includes(a.id)?"center":["currentPrice","purchasePrice","netGain","actions"].includes(a.id)?"flex-end":"flex-start"},children:[l.jsxs("span",{onClick:S=>{a.sortable&&(S.stopPropagation(),s(a.id))},style:{cursor:a.sortable?"pointer":"default"},children:[a.title,a.sortable&&i===a.id&&l.jsx("span",{style:{marginLeft:4},children:d==="asc"?"↑":"↓"})]}),!a.fixed&&l.jsx("span",{style:{opacity:.5,fontSize:"10px"},children:"⋮⋮"})]})})}function k1({item:a}){const[r,s]=v.useState(null),[i,d]=v.useState(!1);return v.useEffect(()=>{if(a.scryfall_json||a.printing_id||a.name){d(!0);const f={name:a.name,foil:a.foil,price:a.price,scryfall_json:a.scryfall_json||{},set:a.set,collector_number:a.collector_number,printing_id:a.printing_id},g=Jt(f,{preferStoredPrice:!1,fallbackPrice:null,debugLogging:!1});s(g.price),d(!1)}},[a.scryfall_json,a.printing_id,a.foil,a.name]),l.jsx("div",{style:{textAlign:"right",fontSize:"12px",fontWeight:"500"},children:i?"...":r!=null&&r!==""?`$${parseFloat(r).toFixed(2)}`:"N/A"})}function A1({item:a,onUpdate:r}){const[s,i]=v.useState(!1),[d,f]=v.useState(""),g=v.useRef(null),p=a.purchase_price||0;v.useEffect(()=>{s&&g.current&&(g.current.focus(),g.current.select())},[s]);const m=()=>{let b=0;if(console.log(`[ATM DEBUG] Raw input: "${d}"`),!d||d.trim()==="")b=0,console.log(`[ATM DEBUG] Empty input, setting to: ${b}`);else{const S=d.replace(/\D/g,"");console.log(`[ATM DEBUG] Digits after cleaning: "${S}"`),S.length===0||parseInt(S)===0?(b=0,console.log(`[ATM DEBUG] All zeros detected, setting to: ${b}`)):S.length===1?(b=parseInt(S)/100,console.log(`[ATM DEBUG] Single digit, converting: ${S} -> ${b}`)):(b=parseInt(S)/100,console.log(`[ATM DEBUG] Multiple digits, converting: ${S} -> ${b}`))}if(b<0){ce.error("Please enter a valid price (0 or greater)");return}console.log(`[ATM DEBUG] Final value being saved: ${b}`),r(a.id,"purchase_price",b),i(!1),f("")},h=()=>{f(""),i(!1)},y=b=>{b.key==="Enter"?m():b.key==="Escape"&&h()};return s?l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[l.jsx("input",{ref:g,type:"text",value:d,onChange:b=>{const S=b.target.value.replace(/\D/g,"");f(S)},onKeyDown:y,placeholder:"0",style:{width:"60px",padding:"2px 4px",fontSize:"12px",border:"1px solid #ddd",borderRadius:2,textAlign:"right",backgroundColor:"white",color:"black",outline:"none",MozAppearance:"textfield"}}),l.jsx("button",{onClick:m,style:{width:16,height:16,padding:0,border:"none",borderRadius:2,backgroundColor:"#28a745",color:"white",fontSize:"10px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:"✓"})]}):l.jsx("div",{style:{textAlign:"right",fontSize:"12px",color:"#666",cursor:"pointer",padding:"2px 4px",borderRadius:2,minHeight:"16px",display:"flex",alignItems:"center",justifyContent:"flex-end"},onClick:()=>{if(p&&p>0){const b=Math.round(p*100).toString();f(b)}else f("");i(!0)},title:"Click to edit purchase price",children:p?`$${parseFloat(p).toFixed(2)}`:"Click to add"})}function D1({item:a,onUpdate:r}){const[s,i]=v.useState(!1),[d,f]=v.useState(""),g=S=>{if(!S)return"";const E=new Date(S);return isNaN(E.getTime())?"":E.toLocaleDateString("en-US")},p=S=>{if(!S)return null;const E=S.replace(/[^0-9/]/g,""),_=[/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/,/^(\d{2})(\d{2})(\d{2,4})$/,/^(\d{1})(\d{1,2})(\d{2,4})$/,/^(\d{4})(\d{1,2})(\d{1,2})$/,/^(\d{2})(\d{1,2})(\d{1,2})$/];let j,T,N;for(let D=0;D<_.length;D++){const L=E.match(_[D]);if(L){D===0||D<=2?(j=parseInt(L[1]),T=parseInt(L[2]),N=parseInt(L[3])):(N=parseInt(L[1]),j=parseInt(L[2]),T=parseInt(L[3]));break}}if(!j||!T||!N||(N<100&&(N=N<50?2e3+N:1900+N),j<1||j>12||T<1||T>31))return null;const O=new Date(N,j-1,T);return isNaN(O.getTime())?null:O.toISOString()},m=a.purchase_date||a.dateAdded,h=()=>{const S=p(d);if(!S&&d.trim()){ce.error("Please enter a valid date");return}r(a.id,"purchase_date",S),i(!1),f("")},y=()=>{i(!1),f("")},b=S=>{S.key==="Enter"?h():S.key==="Escape"&&y()};return s?l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[l.jsx("input",{type:"text",value:d,onChange:S=>f(S.target.value),onKeyDown:b,onBlur:y,placeholder:"MM/DD/YYYY",style:{width:"90px",padding:"2px 4px",border:"1px solid #007bff",borderRadius:2,fontSize:"11px",backgroundColor:"white",color:"#333"},autoFocus:!0,onFocus:S=>S.target.select()}),l.jsx("button",{onClick:h,style:{width:"16px",height:"16px",border:"none",borderRadius:2,backgroundColor:"#28a745",color:"white",cursor:"pointer",fontSize:"10px",display:"flex",alignItems:"center",justifyContent:"center"},children:"✓"})]}):l.jsx("div",{style:{textAlign:"center",fontSize:"11px",color:"#666",cursor:"pointer",padding:"2px 4px",borderRadius:2,minHeight:"16px",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>{f(g(m)),i(!0)},title:"Click to edit purchase date",children:m?g(m):"Click to add"})}function R1({item:a,onUpdate:r}){const s=()=>{r(a.id,"foil",!a.foil)},i=()=>{const d="foil-rainbow-animation";if(!document.getElementById(d)){const f=document.createElement("style");f.id=d,f.textContent=`
        @keyframes rainbow-shimmer {
          0% { 
            background-position: 0% 50%; 
            filter: hue-rotate(0deg) drop-shadow(0 0 3px rgba(255,255,255,0.8));
          }
          25% { 
            background-position: 100% 50%; 
            filter: hue-rotate(90deg) drop-shadow(0 0 3px rgba(255,255,255,0.8));
          }
          50% { 
            background-position: 100% 100%; 
            filter: hue-rotate(180deg) drop-shadow(0 0 3px rgba(255,255,255,0.8));
          }
          75% { 
            background-position: 0% 100%; 
            filter: hue-rotate(270deg) drop-shadow(0 0 3px rgba(255,255,255,0.8));
          }
          100% { 
            background-position: 0% 0%; 
            filter: hue-rotate(360deg) drop-shadow(0 0 3px rgba(255,255,255,0.8));
          }
        }
        .foil-star {
          background: linear-gradient(45deg, #ff0000, #ff8000, #ffff00, #80ff00, #00ff00, #00ff80, #00ffff, #0080ff, #0000ff, #8000ff, #ff00ff, #ff0080, #ff0000);
          background-size: 400% 400%;
          background-clip: text;
          -webkit-background-clip: text;
          color: transparent;
          animation: rainbow-shimmer 2s ease-in-out infinite;
        }
      `,document.head.appendChild(f)}};return ke.useEffect(()=>{a.foil&&i()},[a.foil]),l.jsx("div",{style:{textAlign:"center",cursor:"pointer",padding:"4px",minHeight:"20px",display:"flex",alignItems:"center",justifyContent:"center"},onClick:s,title:`Click to toggle foil status (currently ${a.foil?"foil":"non-foil"})`,children:l.jsx("span",{className:a.foil?"foil-star":"",style:{fontSize:"16px",fontWeight:"bold",color:a.foil?"transparent":"#333"},children:a.foil?"★":"☆"})})}function N1({item:a,onUpdate:r}){const[s,i]=v.useState(!1),[d,f]=v.useState(a.condition||"NM"),g=v.useRef(null),p=[{value:"M",label:"Mint (M)"},{value:"NM",label:"Near Mint (NM)"},{value:"LP",label:"Lightly Played (LP)"},{value:"MP",label:"Moderately Played (MP)"},{value:"HP",label:"Heavily Played (HP)"},{value:"DMG",label:"Damaged (DMG)"}];v.useEffect(()=>{function h(y){g.current&&!g.current.contains(y.target)&&i(!1)}if(s)return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[s]);const m=h=>{r(a.id,"condition",h),i(!1)};return s?l.jsx("div",{ref:g,style:{position:"relative",textAlign:"center"},children:l.jsx("div",{style:{position:"absolute",top:"20px",left:"50%",transform:"translateX(-50%)",backgroundColor:"white",border:"1px solid #ccc",borderRadius:4,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"150px"},children:p.map(h=>l.jsx("div",{onClick:()=>m(h.value),style:{padding:"8px 12px",cursor:"pointer",fontSize:"12px",borderBottom:"1px solid #eee",backgroundColor:h.value===d?"#e3f2fd":"white",color:"#333"},onMouseEnter:y=>y.target.style.backgroundColor="#f5f5f5",onMouseLeave:y=>y.target.style.backgroundColor=h.value===d?"#e3f2fd":"white",children:h.label},h.value))})}):l.jsx("div",{style:{textAlign:"center",fontSize:"11px",color:"#666",cursor:"pointer",padding:"4px 8px",borderRadius:2},onClick:()=>{f(a.condition||"NM"),i(!0)},onMouseEnter:h=>h.target.style.backgroundColor="#f0f0f0",onMouseLeave:h=>h.target.style.backgroundColor="transparent",title:"Click to change condition",children:a.condition||"NM"})}function O1({item:a,onUpdate:r}){const[s,i]=v.useState(!1),[d,f]=v.useState(a.language||"English"),g=v.useRef(null),p=[{value:"English",label:"English",code:"EN"},{value:"Spanish",label:"Spanish",code:"ES"},{value:"French",label:"French",code:"FR"},{value:"German",label:"German",code:"DE"},{value:"Italian",label:"Italian",code:"IT"},{value:"Portuguese",label:"Portuguese",code:"PT"},{value:"Japanese",label:"Japanese",code:"JP"},{value:"Korean",label:"Korean",code:"KO"},{value:"Russian",label:"Russian",code:"RU"},{value:"Simplified Chinese",label:"Simplified Chinese",code:"ZH"},{value:"Traditional Chinese",label:"Traditional Chinese",code:"TW"},{value:"Phyrexian",label:"Phyrexian",code:"PH"}];v.useEffect(()=>{function b(S){g.current&&!g.current.contains(S.target)&&i(!1)}if(s)return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[s]);const m=b=>{r(a.id,"language",b),i(!1)};if(s)return l.jsx("div",{ref:g,style:{position:"relative",textAlign:"center"},children:l.jsx("div",{style:{position:"absolute",top:"20px",left:"50%",transform:"translateX(-50%)",backgroundColor:"white",border:"1px solid #ccc",borderRadius:4,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"160px",maxHeight:"200px",overflowY:"auto"},children:p.map(b=>l.jsxs("div",{onClick:()=>m(b.value),style:{padding:"8px 12px",cursor:"pointer",fontSize:"12px",borderBottom:"1px solid #eee",backgroundColor:b.value===d?"#e3f2fd":"white",color:"#333",display:"flex",justifyContent:"space-between",alignItems:"center"},onMouseEnter:S=>S.target.style.backgroundColor="#f5f5f5",onMouseLeave:S=>S.target.style.backgroundColor=b.value===d?"#e3f2fd":"white",children:[l.jsx("span",{children:b.label}),l.jsx("span",{style:{fontSize:"10px",color:"#999"},children:b.code})]},b.value))})});const h=p.find(b=>b.value===(a.language||"English")),y=h?h.code:"EN";return l.jsx("div",{style:{textAlign:"center",fontSize:"11px",color:"#666",cursor:"pointer",padding:"4px 8px",borderRadius:2},onClick:()=>{f(a.language||"English"),i(!0)},onMouseEnter:b=>b.target.style.backgroundColor="#f0f0f0",onMouseLeave:b=>b.target.style.backgroundColor="transparent",title:"Click to change language",children:y})}function M1({item:a}){const[r,s]=v.useState(null),i=parseFloat(a.purchase_price||0);if(v.useEffect(()=>{if(a.scryfall_json||a.printing_id||a.name){const g={name:a.name,foil:a.foil,price:a.price,scryfall_json:a.scryfall_json||{},set:a.set,collector_number:a.collector_number,printing_id:a.printing_id},p=Jt(g,{preferStoredPrice:!1,fallbackPrice:null,debugLogging:!1}),m=parseFloat(p.price);s(isNaN(m)?null:m)}},[a.scryfall_json,a.printing_id,a.foil,a.name,i]),!i||i<=0||r===null||r<=0)return l.jsx("div",{style:{textAlign:"right",fontSize:"12px",color:"#999"},children:"-"});const d=(r-i)/i*100,f=d>=0;return l.jsxs("div",{style:{textAlign:"right",fontSize:"12px",fontWeight:"bold",color:f?"#28a745":"#dc3545"},children:[f?"+":"",d.toFixed(1),"%"]})}const ah={quantity:{id:"quantity",title:"Qty",visible:!0,width:"70px",sortable:!1},name:{id:"name",title:"Card Name",visible:!0,width:"auto",sortable:!0,fixed:!0},colorIdentity:{id:"colorIdentity",title:"Color ID",visible:!1,width:"90px",sortable:!0},cmc:{id:"cmc",title:"CMC",visible:!1,width:"60px",sortable:!0},cardType:{id:"cardType",title:"Type",visible:!1,width:"100px",sortable:!0},setIcon:{id:"setIcon",title:"Set Icon",visible:!0,width:"60px",sortable:!1},setCode:{id:"setCode",title:"Set Code",visible:!1,width:"80px",sortable:!0},setName:{id:"setName",title:"Set Name",visible:!1,width:"140px",sortable:!0},cardNumber:{id:"cardNumber",title:"#",visible:!1,width:"60px",sortable:!0},rarity:{id:"rarity",title:"Rarity",visible:!1,width:"80px",sortable:!0},condition:{id:"condition",title:"Condition",visible:!1,width:"80px",sortable:!0},language:{id:"language",title:"Lang",visible:!1,width:"60px",sortable:!0},foil:{id:"foil",title:"Foil",visible:!0,width:"70px",sortable:!0},currentPrice:{id:"currentPrice",title:"Price",visible:!1,width:"80px",sortable:!0},purchasePrice:{id:"purchasePrice",title:"Paid",visible:!0,width:"80px",sortable:!0},purchaseDate:{id:"purchaseDate",title:"Acquired Date",visible:!0,width:"110px",sortable:!0},netGain:{id:"netGain",title:"Gain %",visible:!1,width:"80px",sortable:!0},dateAdded:{id:"dateAdded",title:"Added Date",visible:!1,width:"100px",sortable:!0},actions:{id:"actions",title:"Actions",visible:!0,width:"120px",sortable:!1,fixed:!0}},pd={quantity:a=>l.jsx("div",{style:{textAlign:"center",fontWeight:"bold",fontSize:"14px"},children:a.quantity}),name:a=>l.jsx("div",{style:{fontWeight:"500",fontSize:"14px",color:"#333"},children:a.name}),colorIdentity:a=>{var i;let r=[];if(a.color_identity&&Array.isArray(a.color_identity)?r=a.color_identity:(i=a.scryfall_json)!=null&&i.color_identity&&Array.isArray(a.scryfall_json.color_identity)?r=a.scryfall_json.color_identity:a.colors&&a.colors!==""&&a.colors!=="colors"&&(Array.isArray(a.colors)?r=a.colors:typeof a.colors=="string"&&(r=a.colors.split("").filter(d=>d.trim()!==""))),!r||r.length===0)return l.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsx("img",{src:"/svgs/c.svg",alt:"Colorless",title:"Colorless",style:{width:"12px",height:"12px"},onError:d=>{d.target.style.display="none",d.target.parentNode.innerHTML='<span style="fontSize: 12px; color: #999;">C</span>'}})});const s={W:{name:"White",symbol:"w"},U:{name:"Blue",symbol:"u"},B:{name:"Black",symbol:"b"},R:{name:"Red",symbol:"r"},G:{name:"Green",symbol:"g"}};return!r||!r.length?l.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsx("img",{src:"/svgs/c.svg",alt:"Colorless",title:"Colorless",style:{width:"12px",height:"12px"}})}):l.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"2px"},children:r.map((d,f)=>{var g,p,m;return l.jsx("img",{src:`/svgs/${((g=s[d])==null?void 0:g.symbol)||d.toLowerCase()}.svg`,alt:((p=s[d])==null?void 0:p.name)||d,title:((m=s[d])==null?void 0:m.name)||d,style:{width:"12px",height:"12px"}},f)})})},cmc:a=>{var s,i;let r=0;if(a.cmc!==void 0&&a.cmc!==null)r=a.cmc;else if(((s=a.scryfall_json)==null?void 0:s.cmc)!==void 0&&a.scryfall_json.cmc!==null)r=a.scryfall_json.cmc;else if(a.mana_cost||(i=a.scryfall_json)!=null&&i.mana_cost){const d=a.mana_cost||a.scryfall_json.mana_cost;if(d&&typeof d=="string"){const f=d.match(/\d+/g)||[],g=(d.match(/\{[^}]+\}/g)||[]).filter(p=>!p.match(/\d/));r=f.reduce((p,m)=>p+parseInt(m),0)+g.length}}return l.jsx("div",{style:{textAlign:"center",fontWeight:"500",fontSize:"14px"},children:r})},cardType:a=>{var i;let r="";if(a.type_line&&a.type_line!==""?r=a.type_line:(i=a.scryfall_json)!=null&&i.type_line&&a.scryfall_json.type_line!==""?r=a.scryfall_json.type_line:a.card_type&&a.card_type!==""&&a.card_type!=="card_type"&&(r=a.card_type),!r)return l.jsx("div",{style:{fontSize:"12px",color:"#999",textAlign:"center"},children:"Unknown"});let s="";if(r){const d=r.split(/[\s—-]+/),f=["artifact","creature","enchantment","instant","land","planeswalker","sorcery","tribal","battle"];for(const g of d)if(f.includes(g.toLowerCase())){s=g;break}}return l.jsx("div",{style:{fontSize:"12px",color:"#555",textTransform:"capitalize"},children:s||"-"})},setIcon:a=>{var s;const r=i=>i?`/svgs/${i.toLowerCase()}.svg`:null;return a.set?l.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsx("img",{src:r(a.set),alt:a.set_name||a.set,title:`${a.set_name||a.set} (${(s=a.set)==null?void 0:s.toUpperCase()})`,style:{width:"18px",height:"18px",filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.1))"},onError:i=>{var f;const d=document.createElement("div");d.textContent=a.set.toUpperCase(),d.style.cssText=`
              font-size: 9px;
              font-weight: bold;
              color: #666;
              background: #f0f0f0;
              padding: 2px 3px;
              border-radius: 2px;
              border: 1px solid #ddd;
              text-transform: uppercase;
              line-height: 1;
            `,d.title=`${a.set_name||a.set} (${(f=a.set)==null?void 0:f.toUpperCase()})`,i.target.parentNode.replaceChild(d,i.target)}})}):null},setCode:a=>{var r;return l.jsx("div",{style:{textAlign:"center",fontSize:"12px",fontWeight:"bold",color:"#666"},children:((r=a.set)==null?void 0:r.toUpperCase())||"-"})},setName:a=>{var i;let r="";a.set_name&&a.set_name!==""&&a.set_name!==a.set?r=a.set_name:(i=a.scryfall_json)!=null&&i.set_name&&a.scryfall_json.set_name!==""?r=a.scryfall_json.set_name:a.edition&&a.edition!==a.set&&(r=a.edition);const s={DSC:"Dominaria Supplement Cards",RNA:"Ravnica Allegiance","2X2":"Double Masters 2022",THS:"Theros",C13:"Commander 2013"};return!r&&a.set&&s[a.set]&&(r=s[a.set]),l.jsx("div",{style:{fontSize:"13px",color:"#555"},children:r||"Unknown"})},cardNumber:a=>l.jsx("div",{style:{textAlign:"center",fontSize:"12px",color:"#666"},children:a.collector_number||a.card_number||"-"}),rarity:a=>{var i;const r={common:"#1e1e1e",uncommon:"#c0c0c0",rare:"#daa520",mythic:"#ff8c00",special:"#8b008b"},s=((i=a.rarity)==null?void 0:i.toLowerCase())||"common";return l.jsx("div",{style:{textAlign:"center",fontSize:"11px",fontWeight:"bold",color:r[s]||"#666",textTransform:"uppercase"},children:s.charAt(0)})},condition:(a,r)=>l.jsx(N1,{item:a,onUpdate:r}),language:(a,r)=>l.jsx(O1,{item:a,onUpdate:r}),foil:(a,r)=>l.jsx(R1,{item:a,onUpdate:r}),currentPrice:a=>l.jsx(k1,{item:a}),purchasePrice:(a,r)=>l.jsx(A1,{item:a,onUpdate:r}),purchaseDate:(a,r)=>l.jsx(D1,{item:a,onUpdate:r}),netGain:a=>l.jsx(M1,{item:a}),dateAdded:a=>{const r=new Date(a.dateAdded||a.date_added);return isNaN(r.getTime())?l.jsx("div",{style:{fontSize:"11px",color:"#999"},children:"-"}):l.jsx("div",{style:{fontSize:"11px",color:"#666"},children:r.toLocaleDateString()})}};function z1({collection:a,onQuantityChange:r,onRemove:s,onUpdateItem:i}){const[d,f]=v.useState(()=>{const U=localStorage.getItem("collection-table-columns");return U?JSON.parse(U):ah}),[g,p]=v.useState("name"),[m,h]=v.useState("asc"),[y,b]=v.useState(""),[S,E]=v.useState("none"),[_,j]=v.useState(!1),T=v.useRef(null),N=(U,A,ee)=>{i&&i(U,A,ee)},O=Kb(qp(Id),qp(Ud,{coordinateGetter:C1}));v.useEffect(()=>{localStorage.setItem("collection-table-columns",JSON.stringify(d))},[d]),v.useEffect(()=>{const U=A=>{T.current&&!T.current.contains(A.target)&&j(!1)};return document.addEventListener("mousedown",U),()=>document.removeEventListener("mousedown",U)},[]);const D=v.useMemo(()=>Object.values(d).filter(U=>U.visible).sort((U,A)=>(U.order||0)-(A.order||0)),[d]),L=v.useMemo(()=>{let U=a;if(y){const G=y.toLowerCase();U=a.filter(P=>{var R,M,W,se;return((R=P.name)==null?void 0:R.toLowerCase().includes(G))||((M=P.set_name)==null?void 0:M.toLowerCase().includes(G))||((W=P.set)==null?void 0:W.toLowerCase().includes(G))||((se=P.collector_number)==null?void 0:se.toLowerCase().includes(G))})}const A=U.sort((G,P)=>{var se,he,fe,te;let R=g;g==="setCode"&&(R="set"),g==="setName"&&(R="set_name"),g==="cardNumber"&&(R="collector_number"),g==="purchasePrice"&&(R="purchase_price"),g==="purchaseDate"&&(R="purchase_date");let M=G[R],W=P[R];if(g==="currentPrice"||g==="purchasePrice")M=parseFloat(M)||0,W=parseFloat(W)||0;else if(g==="netGain"){const K=parseFloat(G.purchase_price)||0,ae=parseFloat(P.purchase_price)||0,re=parseFloat(G.price)||0,ue=parseFloat(P.price)||0;M=K>0&&re>0?(re-K)/K*100:-999999,W=ae>0&&ue>0?(ue-ae)/ae*100:-999999}else if(g==="cardNumber")M=parseInt(M)||0,W=parseInt(W)||0;else if(g==="colorIdentity"){const K=G.color_identity||[],ae=P.color_identity||[],re=Array.isArray(K)?K.length:0,ue=Array.isArray(ae)?ae.length:0;re!==ue?(M=re,W=ue):(M=Array.isArray(K)?K.sort().join(""):"",W=Array.isArray(ae)?ae.sort().join(""):"")}else if(g==="cmc"){if(M=G.cmc||((se=G.scryfall_json)==null?void 0:se.cmc)||0,W=P.cmc||((he=P.scryfall_json)==null?void 0:he.cmc)||0,M===0&&(G.mana_cost||(fe=G.scryfall_json)!=null&&fe.mana_cost)){const K=G.mana_cost||G.scryfall_json.mana_cost,ae=K.match(/\d+/g)||[],re=(K.match(/\{[^}]+\}/g)||[]).filter(ue=>!ue.match(/\d/));M=ae.reduce((ue,me)=>ue+parseInt(me),0)+re.length}if(W===0&&(P.mana_cost||(te=P.scryfall_json)!=null&&te.mana_cost)){const K=P.mana_cost||P.scryfall_json.mana_cost,ae=K.match(/\d+/g)||[],re=(K.match(/\{[^}]+\}/g)||[]).filter(ue=>!ue.match(/\d/));W=ae.reduce((ue,me)=>ue+parseInt(me),0)+re.length}}else g==="cardType"?(M=(G.type_line||G.type||"").toLowerCase(),W=(P.type_line||P.type||"").toLowerCase()):g==="dateAdded"||g==="purchaseDate"?(M=new Date(M).getTime()||0,W=new Date(W).getTime()||0):typeof M=="string"&&(M=M.toLowerCase(),W=(W||"").toLowerCase());return M<W?m==="asc"?-1:1:M>W?m==="asc"?1:-1:0});if(S==="none")return{items:A,isGrouped:!1};const ee={};A.forEach(G=>{var R,M,W,se;let P="Other";switch(S){case"colorIdentity":const he=G.color_identity||((R=G.scryfall_json)==null?void 0:R.color_identity)||[];Array.isArray(he)&&he.length>0?P=he.sort().join(""):P="Colorless";break;case"set":let fe="";G.set_name&&G.set_name!==""&&G.set_name!==G.set?fe=G.set_name:(M=G.scryfall_json)!=null&&M.set_name&&G.scryfall_json.set_name!==""?fe=G.scryfall_json.set_name:G.edition&&G.edition!==G.set&&(fe=G.edition);const te={DSC:"Dominaria Supplement Cards",RNA:"Ravnica Allegiance","2X2":"Double Masters 2022","7ED":"Seventh Edition","9ED":"Ninth Edition",THS:"Theros",C13:"Commander 2013",LEA:"Limited Edition Alpha",LEB:"Limited Edition Beta",UNL:"Unlimited Edition",ARN:"Arabian Nights",ATQ:"Antiquities",LEG:"Legends",DRK:"The Dark",FEM:"Fallen Empires",ICE:"Ice Age",CHR:"Chronicles",HML:"Homelands",ALL:"Alliances",MIR:"Mirage",VIS:"Visions",WTH:"Weatherlight",TMP:"Tempest",STH:"Stronghold",EXO:"Exodus",UGL:"Unglued",USG:"Urza's Saga",ULG:"Urza's Legacy",UDS:"Urza's Destiny",MMQ:"Mercadian Masques",NEM:"Nemesis",PCY:"Prophecy",INV:"Invasion",PLS:"Planeshift",APC:"Apocalypse",ODY:"Odyssey",TOR:"Torment",JUD:"Judgment",ONS:"Onslaught",LGN:"Legions",SCG:"Scourge",MRD:"Mirrodin",DST:"Darksteel","5DN":"Fifth Dawn",CHK:"Champions of Kamigawa",BOK:"Betrayers of Kamigawa",SOK:"Saviors of Kamigawa",RAV:"Ravnica: City of Guilds",GPT:"Guildpact",DIS:"Dissension",CSP:"Coldsnap",TSP:"Time Spiral",TSB:"Time Spiral Timeshifted",PLC:"Planar Chaos",FUT:"Future Sight",LRW:"Lorwyn",MOR:"Morningtide",SHM:"Shadowmoor",EVE:"Eventide",ALA:"Shards of Alara",CON:"Conflux",ARB:"Alara Reborn",ZEN:"Zendikar",WWK:"Worldwake",ROE:"Rise of the Eldrazi",SOM:"Scars of Mirrodin",MBS:"Mirrodin Besieged",NPH:"New Phyrexia",ISD:"Innistrad",DKA:"Dark Ascension",AVR:"Avacyn Restored",RTR:"Return to Ravnica",GTC:"Gatecrash",DGM:"Dragon's Maze",M10:"Magic 2010",M11:"Magic 2011",M12:"Magic 2012",M13:"Magic 2013",M14:"Magic 2014",M15:"Magic 2015",ORI:"Magic Origins",BFZ:"Battle for Zendikar",OGW:"Oath of the Gatewatch",SOI:"Shadows over Innistrad",EMN:"Eldritch Moon",KLD:"Kaladesh",AER:"Aether Revolt",AKH:"Amonkhet",HOU:"Hour of Devastation",XLN:"Ixalan",RIX:"Rivals of Ixalan",DOM:"Dominaria",M19:"Core Set 2019",GRN:"Guilds of Ravnica",WAR:"War of the Spark",M20:"Core Set 2020",ELD:"Throne of Eldraine",THB:"Theros Beyond Death",IKO:"Ikoria: Lair of Behemoths",M21:"Core Set 2021",ZNR:"Zendikar Rising",KHM:"Kaldheim",STX:"Strixhaven: School of Mages",AFR:"Adventures in the Forgotten Realms",MID:"Innistrad: Midnight Hunt",VOW:"Innistrad: Crimson Vow",NEO:"Kamigawa: Neon Dynasty",SNC:"Streets of New Capenna",CLB:"Commander Legends: Battle for Baldur's Gate",DMU:"Dominaria United",BRO:"The Brothers' War",ONE:"Phyrexia: All Will Be One",MOM:"March of the Machine",MAT:"March of the Machine: The Aftermath",LTR:"The Lord of the Rings: Tales of Middle-earth",WOE:"Wilds of Eldraine",LCI:"The Lost Caverns of Ixalan",MKM:"Murders at Karlov Manor",OTJ:"Outlaws of Thunder Junction",BIG:"The Big Score",MH3:"Modern Horizons 3",BLB:"Bloomburrow",DSK:"Duskmourn: House of Horror"};!fe&&G.set&&te[G.set]&&(fe=te[G.set]),P=fe||G.set||"Unknown Set";break;case"cmc":P=`${G.cmc||((W=G.scryfall_json)==null?void 0:W.cmc)||0} Mana`;break;case"rarity":P=(G.rarity||"Unknown").charAt(0).toUpperCase()+(G.rarity||"Unknown").slice(1);break;case"cardType":const ae=G.type_line||((se=G.scryfall_json)==null?void 0:se.type_line)||G.type||"";ae.includes("Creature")?P="Creatures":ae.includes("Instant")?P="Instants":ae.includes("Sorcery")?P="Sorceries":ae.includes("Artifact")?P="Artifacts":ae.includes("Enchantment")?P="Enchantments":ae.includes("Planeswalker")?P="Planeswalkers":ae.includes("Land")?P="Lands":P="Other Types";break}ee[P]||(ee[P]=[]),ee[P].push(G)});const oe=[];return Object.keys(ee).sort().forEach(G=>{oe.push({isGroupHeader:!0,groupName:G,itemCount:ee[G].length}),oe.push(...ee[G])}),{items:oe,isGrouped:!0}},[a,y,g,m,S]),$=U=>{const{active:A,over:ee}=U;if(A.id!==(ee==null?void 0:ee.id)){const oe=D.findIndex(P=>P.id===A.id),G=D.findIndex(P=>P.id===ee.id);if(oe!==-1&&G!==-1){const P=Hd(D,oe,G),R={...d};P.forEach((M,W)=>{R[M.id]={...R[M.id],order:W}}),f(R)}}},V=U=>{var A;(A=d[U])!=null&&A.fixed||f(ee=>({...ee,[U]:{...ee[U],visible:!ee[U].visible}}))},H=()=>{f(ah),localStorage.removeItem("collection-table-columns")},C=U=>{var A;(A=d[U])!=null&&A.sortable&&(g===U?h(ee=>ee==="asc"?"desc":"asc"):(p(U),h("asc")))},I=U=>l.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:4},children:[l.jsx("button",{onClick:()=>r(U.id,U.quantity+1),style:{width:18,height:18,border:"1px solid #ddd",borderRadius:2,backgroundColor:"#fff",cursor:"pointer",fontSize:"10px",display:"flex",alignItems:"center",justifyContent:"center",lineHeight:1,color:"#000",fontWeight:"bold"},title:"Add another copy of this card",children:"+"}),l.jsx("button",{onClick:()=>s(U.id),style:{marginLeft:6,padding:"1px 4px",border:"1px solid #d32f2f",borderRadius:2,backgroundColor:"#fff",color:"#d32f2f",cursor:"pointer",fontSize:"10px",lineHeight:1},children:"Remove"})]});return l.jsxs("div",{children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,gap:12},children:[l.jsxs("h3",{style:{margin:0},children:["Your Cards (",a.length,")"]}),l.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[l.jsx("input",{type:"text",placeholder:"Filter cards...",value:y,onChange:U=>b(U.target.value),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:4,fontSize:14,backgroundColor:"white",color:"black",minWidth:"200px"}}),l.jsxs("div",{style:{position:"relative"},ref:T,children:[l.jsx("button",{onClick:()=>j(!_),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:4,backgroundColor:"#f8f9fa",color:"black",cursor:"pointer",fontSize:14},children:"Columns"}),_&&l.jsxs("div",{style:{position:"absolute",top:"100%",right:0,backgroundColor:"white",border:"1px solid #ddd",borderRadius:4,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"200px",maxHeight:"300px",overflowY:"auto"},children:[l.jsx("div",{style:{padding:"8px 12px",borderBottom:"1px solid #eee",fontWeight:"bold",fontSize:"12px",color:"#666",textTransform:"uppercase"},children:"Show/Hide Columns"}),Object.values(d).map(U=>l.jsxs("label",{style:{display:"flex",alignItems:"center",padding:"8px 16px",cursor:U.fixed?"default":"pointer",fontSize:"14px",color:U.fixed?"#999":"#333",backgroundColor:U.visible?"#f8f9fa":"transparent",position:"relative"},children:[l.jsxs("div",{style:{position:"relative",marginRight:12,display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18},children:[l.jsx("input",{type:"checkbox",checked:U.visible,onChange:()=>V(U.id),disabled:U.fixed,style:{width:16,height:16,cursor:U.fixed?"not-allowed":"pointer",appearance:"none",WebkitAppearance:"none",border:U.visible?"2px solid #007bff":"2px solid #ccc",borderRadius:"3px",backgroundColor:U.visible?"#007bff":"white",outline:"none",transition:"all 0.15s ease",boxShadow:U.visible?"0 0 0 1px rgba(0, 123, 255, 0.1)":"none"}}),U.visible&&l.jsx("span",{style:{position:"absolute",left:"5px",top:"2px",width:"3px",height:"7px",border:"solid white",borderWidth:"0 2px 2px 0",transform:"rotate(45deg)",pointerEvents:"none"}})]}),U.title,U.fixed&&l.jsx("span",{style:{marginLeft:"auto",fontSize:"11px",color:"#999"},children:"(Fixed)"})]},U.id)),l.jsx("div",{style:{borderTop:"1px solid #eee",padding:"8px 12px"},children:l.jsx("button",{onClick:H,style:{width:"100%",padding:"6px 12px",backgroundColor:"#f8f9fa",border:"1px solid #ddd",borderRadius:"3px",fontSize:"12px",cursor:"pointer",color:"#666"},children:"Reset to Defaults"})})]})]}),l.jsxs("select",{value:S,onChange:U=>E(U.target.value),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:4,fontSize:11,backgroundColor:"white",color:"black",minWidth:"120px"},children:[l.jsx("option",{value:"none",children:"No Grouping"}),l.jsx("option",{value:"colorIdentity",children:"Group by Color ID"}),l.jsx("option",{value:"set",children:"Group by Set"}),l.jsx("option",{value:"cmc",children:"Group by Mana Cost"}),l.jsx("option",{value:"rarity",children:"Group by Rarity"}),l.jsx("option",{value:"cardType",children:"Group by Card Type"})]}),l.jsx("select",{value:g,onChange:U=>p(U.target.value),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:4,fontSize:11,backgroundColor:"white",color:"black",minWidth:"150px"},children:Object.values(d).filter(U=>U.sortable).map(U=>l.jsxs("option",{value:U.id,children:["Sort by ",U.title]},U.id))}),l.jsx("button",{onClick:()=>h(U=>U==="asc"?"desc":"asc"),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:4,backgroundColor:"#f8f9fa",color:"black",cursor:"pointer",fontSize:14},children:m==="asc"?"↑":"↓"})]})]}),L.items.length===0?l.jsx("div",{style:{textAlign:"center",padding:48,color:"#666",border:"2px dashed #ddd",borderRadius:8},children:y?"No cards match your filter.":"Your collection is empty. Add cards from deck editing to get started!"}):l.jsx(e1,{sensors:O,collisionDetection:ev,onDragEnd:$,children:l.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",backgroundColor:"#fff",borderRadius:8,overflow:"hidden",border:"1px solid #ddd"},children:[l.jsx("thead",{children:l.jsx("tr",{style:{backgroundColor:"#f8f9fa",borderBottom:"2px solid #dee2e6"},children:l.jsx(g1,{items:D.map(U=>U.id),strategy:u1,children:D.map((U,A)=>l.jsx(E1,{column:U,index:A,onSort:C,sortBy:g,sortDirection:m},U.id))})})}),l.jsx("tbody",{children:L.items.map((U,A)=>U.isGroupHeader?l.jsx("tr",{style:{backgroundColor:"#f8f9fa",borderTop:"2px solid #dee2e6",borderBottom:"1px solid #dee2e6"},children:l.jsxs("td",{colSpan:D.length,style:{padding:"12px 16px",fontWeight:"bold",fontSize:"14px",color:"#495057",textTransform:"uppercase",letterSpacing:"0.5px"},children:[U.groupName," (",U.itemCount," cards)"]})},`group-${U.groupName}`):l.jsx("tr",{style:{borderBottom:"1px solid #eee",backgroundColor:"#fff"},children:D.map(ee=>{var oe;return l.jsx("td",{style:{padding:"8px 12px",verticalAlign:"middle",width:ee.width},children:ee.id==="actions"?I(U):((oe=pd[ee.id])==null?void 0:oe.call(pd,U,N))||l.jsx("div",{children:"-"})},ee.id)})},U.id))})]})})]})}function Zh(a){const r=[];return a.forEach(s=>{const i=s.quantity||1;for(let d=0;d<i;d++)r.push({...s,id:`${s.id||$1(s)}_copy_${d+1}`,quantity:1,copyNumber:d+1,originalId:s.id,purchase_price:s.purchase_price||null,dateAdded:s.dateAdded||new Date().toISOString(),condition:s.condition||"NM",language:s.language||"EN",foil:s.foil||!1})}),r}function $1(a){var s;return[((s=a.name)==null?void 0:s.replace(/[^a-zA-Z0-9]/g,"").toLowerCase())||"unknown",a.set||"unknown",a.printing_id||"unknown",a.foil?"foil":"nonfoil"].join("-")+"-"+Date.now()+"-"+Math.random().toString(36).substring(7)}function L1(a){return!Array.isArray(a)||a.length===0?!1:a.some(r=>(r.quantity||1)>1)}function U1(a){console.log("📦 Migrating collection from bundled to individual format..."),console.log(`Before: ${a.length} bundled items, ${a.reduce((s,i)=>s+(i.quantity||1),0)} total cards`);const r=Zh(a);return console.log(`After: ${r.length} individual items`),console.log("✅ Migration complete"),r}function B1(a){return{totalItems:a.length,totalCards:a.reduce((s,i)=>s+(i.quantity||1),0),uniqueCards:new Set(a.map(s=>`${s.name}|${s.set}`)).size,foilCards:a.filter(s=>s.foil).length,sets:new Set(a.map(s=>s.set).filter(Boolean)).size,conditions:new Set(a.map(s=>s.condition||"NM")).size,languages:new Set(a.map(s=>s.language||"EN")).size,withPurchasePrice:a.filter(s=>s.purchase_price&&parseFloat(s.purchase_price)>0).length,averageCondition:I1(a),oldestCard:H1(a),newestCard:q1(a)}}function I1(a){var s;const r={};return a.forEach(i=>{const d=i.condition||"NM";r[d]=(r[d]||0)+1}),((s=Object.entries(r).sort(([,i],[,d])=>d-i)[0])==null?void 0:s[0])||"NM"}function H1(a){return a.filter(r=>r.dateAdded).sort((r,s)=>new Date(r.dateAdded)-new Date(s.dateAdded))[0]}function q1(a){return a.filter(r=>r.dateAdded).sort((r,s)=>new Date(s.dateAdded)-new Date(r.dateAdded))[0]}function F1({collection:a}){const r=a.reduce((d,f)=>d+f.quantity,0),s=a.length,i=a.filter(d=>d.foil).reduce((d,f)=>d+f.quantity,0);return l.jsxs("div",{style:{marginBottom:24,padding:16,border:"1px solid #ddd",borderRadius:8,backgroundColor:"#ffffff"},children:[l.jsx("h3",{style:{marginTop:0},children:"Collection Summary"}),l.jsxs("div",{style:{display:"flex",gap:24,fontSize:14},children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Total Cards:"})," ",r]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Unique Cards:"})," ",s]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Foil Cards:"})," ",i]})]})]})}function G1(){const[a,r]=v.useState([]),[s,i]=v.useState(!1),[d,f]=v.useState({isVisible:!1,phase:"preparing",current:0,total:0,message:"",errors:[],isPaused:!1,canPause:!0,estimatedTimeRemaining:null,storageUsed:null,compressionRatio:null});v.useEffect(()=>{(async()=>{var j;try{console.log("📖 Loading collection with smart storage...");let T=null;const N=await Xt.getItemChunked("cardCollections");if(console.log("🔍 Chunked storage check:",{hasData:!!N,hasCollections:!!(N!=null&&N.collections),collectionsLength:((j=N==null?void 0:N.collections)==null?void 0:j.length)||0}),N!=null&&N.collections&&N.collections.length>0)console.log(`✅ Loaded ${N.collections.length} cards from chunked storage`),T=N.collections;else{const D=Xt.getItem("cardCollection");console.log("🔍 Regular storage check:",{hasData:!!D,isArray:Array.isArray(D),length:(D==null?void 0:D.length)||0}),D&&D.length>0?(console.log(`✅ Loaded ${D.length} cards from regular storage`),T=D):console.log("📝 No existing collection found, starting fresh")}if(T){if(L1(T)){console.log("🔄 Collection needs migration from bundled to individual items...");const L=U1(T);Xt.setItem("cardCollection",L,{clearOldData:!0})?(r(L),ce.success("Collection migrated to individual card format! Each card is now a separate item.")):(console.error("❌ Failed to save migrated collection"),r(T))}else r(T);const D=B1(T);console.log("📊 Collection stats:",D)}else console.log("📝 No existing collection found, starting fresh");const O=Xt.getStats();console.log("� Storage stats:",{usage:`${O.percentage.toFixed(1)}%`,used:`${(O.used/1024/1024).toFixed(1)}MB`,available:`${(O.available/1024/1024).toFixed(1)}MB`,items:O.itemCounts})}catch(T){console.error("❌ Error loading collection:",T),ce.error("Error loading collection - using empty collection")}})()},[]);const g=async _=>{try{if(console.log(`💾 Saving collection with ${_.length} cards...`),_.length>2e3){await Xt.setItemChunked("cardCollections",{collections:_});try{Xt.setItem("cardCollection",_,{clearOldData:!1})}catch{console.log("📝 Regular storage fallback failed (expected for large collections)")}}else if(!Xt.setItem("cardCollection",_,{clearOldData:!0}))throw new Error("Smart storage failed to save collection");r(_),console.log("✅ Collection saved successfully");const j=Xt.getStats();ce.success(`Collection saved! Storage: ${j.percentage.toFixed(1)}% used`)}catch(j){console.error("❌ Error saving collection:",j),j.name==="QuotaExceededError"||j.message.includes("quota")?ce.error("Collection too large for browser storage. Try exporting to file instead."):ce.error("Error saving collection: "+j.message)}},p=async(_,j)=>{if(j<1){m(_);return}if(j>1){const T=a.find(N=>N.id===_);if(T){const N=[];for(let D=1;D<j;D++)N.push({...T,id:`${T.originalId||T.id}_copy_${Date.now()}_${D}`,copyNumber:(T.copyNumber||1)+D,dateAdded:new Date().toISOString()});const O=[...a,...N];await g(O),ce.success(`Added ${j-1} more copies of ${T.name}`)}}},m=async _=>{const j=a.filter(T=>T.id!==_);await g(j),ce.success("Card removed from collection")},h=async(_,j,T)=>{const N=a.map(O=>O.id===_?{...O,[j]:T}:O);await g(N)},y=async()=>{try{console.log("🔄 Force reloading collection from storage...");const _=await Xt.getItemChunked("cardCollections");if(_!=null&&_.collections&&_.collections.length>0){console.log(`✅ Force loaded ${_.collections.length} cards from chunked storage`),r(_.collections),ce.success(`Reloaded ${_.collections.length} cards from storage!`);return}const j=Xt.getItem("cardCollection");if(j&&j.length>0){console.log(`✅ Force loaded ${j.length} cards from regular storage`),r(j),ce.success(`Reloaded ${j.length} cards from storage!`);return}ce.info("No collection found in storage")}catch(_){console.error("❌ Failed to reload collection:",_),ce.error("Failed to reload collection")}},b=async()=>{const _=a.reduce((N,O)=>N+O.quantity,0),j=a.length,T=`Are you sure you want to delete your entire collection?

This will permanently remove:
• ${_} total cards
• ${j} unique cards

This action cannot be undone!`;if(window.confirm(T)&&window.confirm("Final confirmation: Delete everything? This is your last chance to cancel."))try{console.log("🗑️ Clearing all collection storage..."),localStorage.removeItem("cardCollection");const N=localStorage.getItem("cardCollections_metadata");if(N){try{const O=JSON.parse(N);if(O.isChunked&&O.chunkCount){console.log(`🧹 Removing ${O.chunkCount} storage chunks...`);for(let D=0;D<O.chunkCount;D++)localStorage.removeItem(`cardCollections_chunk_${D}`)}}catch{console.log("⚠️ Could not parse chunk metadata, clearing anyway")}localStorage.removeItem("cardCollections_metadata")}Object.keys(localStorage).forEach(O=>{(O.startsWith("cardCollections_chunk_")||O.startsWith("cardCollection_chunk_"))&&localStorage.removeItem(O)}),await g([]),ce.success(`Collection cleared! Removed ${_} cards.`)}catch(N){console.error("Error clearing collection:",N),ce.error("Failed to clear collection. Please try again.")}},S=async _=>{if(!_||_.length===0){ce.error("No cards to import");return}const j=_.length>1e3,T=_.reduce((N,O)=>N+(O.quantity||1),0);j&&(console.log(`� Starting large collection import: ${_.length} unique cards, ${T} total items`),f({isVisible:!0,phase:"preparing",current:0,total:T,message:"Preparing import...",errors:[],isPaused:!1,canPause:!0,estimatedTimeRemaining:null,storageUsed:null,compressionRatio:null}));try{let N=_;const O=[];if(j){f(H=>({...H,phase:"api",message:"Enriching card data from Scryfall..."}));try{N=await bh(_,(H,C)=>{f(I=>({...I,current:H,total:C,message:`Enriching cards... ${H}/${C}`}))},{isLargeImport:!0,batchSize:15,maxRetries:3})}catch(H){console.warn("⚠️ Card enrichment failed, proceeding with basic data:",H.message),O.push(`Card enrichment partially failed: ${H.message}`),N=_}}j&&f(H=>({...H,phase:"processing",current:0,total:N.length,message:"Converting to individual items..."})),console.log("📥 Converting cards to individual items...");const D=Zh(N);j&&f(H=>({...H,phase:"storing",current:0,total:D.length,message:"Saving to collection..."}));const L=[...a,...D];if(await E(L,j),r(L),console.log(`🔄 UI updated with ${L.length} total cards`),j){const H=Xt.getItem("cardCollections_metadata");f(C=>({...C,phase:"complete",current:T,total:T,message:"Import complete!",compressionRatio:H==null?void 0:H.compressionRatio,errors:O})),setTimeout(()=>{f(C=>({...C,isVisible:!1}))},3e3)}const $=new Set(_.map(H=>`${H.name}|${H.set}|${H.foil}`)).size,V=O.length>0?`Import completed with ${O.length} warnings! Added ${T} cards (${$} unique).`:`Import complete! Added ${T} individual cards (${$} unique card types).`;ce.success(V),O.length>0?console.warn("⚠️ Import completed with errors:",O):console.log(`✅ Import successful: ${T} individual items added`)}catch(N){console.error("❌ Import failed:",N),j&&f(O=>({...O,phase:"complete",message:`Import failed: ${N.message}`,errors:[...O.errors,N.message]})),ce.error(`Import failed: ${N.message}`)}},E=async(_,j=!1)=>{try{if(j&&f(T=>({...T,message:"Optimizing storage..."})),await Xt.setItemChunked("cardCollections",{collections:_}),_.length<2e3&&Xt.setItem("cardCollection",_,{clearOldData:!1}),r(_),j){const T=JSON.stringify(_).length;f(N=>({...N,storageUsed:T,message:"Collection saved successfully!"}))}console.log(`💾 Collection saved: ${_.length} items`)}catch(T){throw console.error("❌ Failed to save collection:",T),new Error(`Failed to save collection: ${T.message}`)}};return l.jsxs("div",{className:"deck-container",style:{backgroundColor:"#ffffff",background:"#ffffff",minHeight:"100vh",width:"100%"},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24,backgroundColor:"#ffffff",background:"#ffffff"},children:[l.jsx("h1",{style:{margin:0},children:"Your Collection"}),l.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[l.jsx("button",{onClick:()=>i(!0),style:{padding:"10px 20px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:6,cursor:"pointer",fontSize:14,fontWeight:"500",display:"flex",alignItems:"center",gap:8},children:"📥 Import Collection"}),l.jsx("button",{onClick:y,style:{padding:"10px 20px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:6,cursor:"pointer",fontSize:14,fontWeight:"500",display:"flex",alignItems:"center",gap:8},children:"🔄 Reload"}),a.length>0&&l.jsx("button",{onClick:b,style:{padding:"10px 20px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:6,cursor:"pointer",fontSize:14,fontWeight:"500",display:"flex",alignItems:"center",gap:6},children:"🗑️ Delete Collection"})]})]}),l.jsx(F1,{collection:a}),l.jsx(z1,{collection:a,onQuantityChange:p,onRemove:m,onUpdateItem:h}),l.jsx(zb,{isOpen:s,onClose:()=>i(!1),onImport:S}),l.jsx($b,{...d,onPause:()=>f(_=>({..._,isPaused:!0})),onResume:()=>f(_=>({..._,isPaused:!1})),onCancel:()=>{f(_=>({..._,isVisible:!1})),ce.info("Import cancelled")}})]})}function P1(){return l.jsxs("div",{className:"container",children:[l.jsx("h2",{children:"Privacy Policy"}),l.jsx("p",{children:"Your privacy is important to us. We only collect information necessary to provide our services. We do not share your data with third parties except as required by law. You may request deletion of your account and data at any time."})]})}function Y1(){return l.jsxs("div",{className:"container",children:[l.jsx("h2",{children:"Terms of Service"}),l.jsx("p",{children:"By using this site, you agree to abide by our rules and policies. Do not use the site for illegal activities. We reserve the right to terminate accounts for violations. See our Privacy Policy for more information."})]})}function X1(){const[a,r]=v.useState("Verifying...");return v.useEffect(()=>{const i=new URLSearchParams(window.location.search).get("token");if(!i){r("Invalid verification link.");return}fetch(`/api/auth/verify-email?token=${i}`).then(f=>f.json()).then(f=>{f.message?r("Email verified! You can now log in."):r(f.error||"Verification failed.")}).catch(()=>r("Verification failed."))},[]),l.jsxs("div",{className:"container",children:[l.jsx("h2",{children:"Email Verification"}),l.jsx("div",{children:a})]})}function V1(){const[a,r]=v.useState(""),[s,i]=v.useState(""),[d,f]=v.useState(!1),g=ma(),p=new URLSearchParams(window.location.search).get("token"),m=async h=>{if(h.preventDefault(),a!==s){ce.error("Passwords do not match");return}if(a.length<6){ce.error("Password must be at least 6 characters long");return}f(!0);try{const b=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:p,password:a})}),S=await b.json();b.ok?(ce.success("Password reset successfully"),g("/login")):ce.error(S.error||"Failed to reset password")}catch{ce.error("Network error occurred")}finally{f(!1)}};return l.jsx("div",{className:"auth-container",children:l.jsxs("form",{onSubmit:m,className:"auth-form",children:[l.jsx("h2",{children:"Reset Password"}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"password",children:"New Password:"}),l.jsx("input",{type:"password",id:"password",value:a,onChange:h=>r(h.target.value),required:!0,minLength:6})]}),l.jsxs("div",{className:"form-group",children:[l.jsx("label",{htmlFor:"confirmPassword",children:"Confirm Password:"}),l.jsx("input",{type:"password",id:"confirmPassword",value:s,onChange:h=>i(h.target.value),required:!0,minLength:6})]}),l.jsx("button",{type:"submit",disabled:d,children:d?"Resetting...":"Reset Password"})]})})}function W1(){const a=ma(),[r,s]=v.useState([]);v.useEffect(()=>{const g=JSON.parse(localStorage.getItem("savedTrades")||"[]");s(g)},[]);const i=()=>{a("/trade/new")},d=r.filter(g=>g.status==="pending"),f=r.filter(g=>g.status==="confirmed");return l.jsxs("div",{className:"container",children:[l.jsx("h1",{children:"Trades"}),l.jsx("button",{onClick:i,className:"btn btn-primary",children:"Create New Trade"}),l.jsxs("div",{className:"trade-list",children:[l.jsx("h2",{children:"Pending Trades"}),d.length>0?d.map(g=>l.jsxs("div",{className:"trade-item",style:{border:"1px solid #ddd",borderRadius:"8px",padding:"15px",marginBottom:"10px",backgroundColor:"#f9f9f9"},children:[l.jsx("p",{children:l.jsx("strong",{children:g.name||`${g.user1_name} & ${g.user2_name}`})}),l.jsxs("p",{children:[l.jsx("strong",{children:"Date:"})," ",g.date]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Cards:"})," ",g.user1_name,"(",(g.user1_cards||[]).length,") & ",g.user2_name,"(",(g.user2_cards||[]).length,")"]}),l.jsx(Hn,{to:`/trades/${g.id}`,style:{textDecoration:"none"},children:l.jsx("button",{className:"btn btn-primary",style:{marginRight:"10px"},children:"View/Edit Trade"})}),l.jsx("button",{className:"btn btn-danger",onClick:()=>{if(confirm("Are you sure you want to delete this trade?")){const p=r.filter(m=>m.id!==g.id);s(p),localStorage.setItem("savedTrades",JSON.stringify(p))}},children:"Delete"})]},g.id)):l.jsx("p",{children:"No pending trades."})]}),l.jsxs("div",{className:"trade-list",children:[l.jsx("h2",{children:"Confirmed Trades"}),f.length>0?f.map(g=>l.jsxs("div",{className:"trade-item",style:{border:"1px solid #ddd",borderRadius:"8px",padding:"15px",marginBottom:"10px",backgroundColor:"#f0f8f0"},children:[l.jsx("p",{children:l.jsx("strong",{children:g.name||`${g.user1_name} & ${g.user2_name}`})}),l.jsxs("p",{children:[l.jsx("strong",{children:"Date:"})," ",g.date]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Cards:"})," ",g.user1_name,"(",(g.user1_cards||[]).length,") & ",g.user2_name,"(",(g.user2_cards||[]).length,")"]}),l.jsx(Hn,{to:`/trades/${g.id}`,style:{textDecoration:"none"},children:l.jsx("button",{className:"btn btn-primary",children:"View Trade"})})]},g.id)):l.jsx("p",{children:"No confirmed trades."})]})]})}var hd,rh;function Q1(){if(rh)return hd;rh=1;var a="Expected a function",r=NaN,s="[object Symbol]",i=/^\s+|\s+$/g,d=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,g=/^0o[0-7]+$/i,p=parseInt,m=typeof kl=="object"&&kl&&kl.Object===Object&&kl,h=typeof self=="object"&&self&&self.Object===Object&&self,y=m||h||Function("return this")(),b=Object.prototype,S=b.toString,E=Math.max,_=Math.min,j=function(){return y.Date.now()};function T($,V,H){var C,I,U,A,ee,oe,G=0,P=!1,R=!1,M=!0;if(typeof $!="function")throw new TypeError(a);V=L(V)||0,N(H)&&(P=!!H.leading,R="maxWait"in H,U=R?E(L(H.maxWait)||0,V):U,M="trailing"in H?!!H.trailing:M);function W(me){var Ce=C,Te=I;return C=I=void 0,G=me,A=$.apply(Te,Ce),A}function se(me){return G=me,ee=setTimeout(te,V),P?W(me):A}function he(me){var Ce=me-oe,Te=me-G,_e=V-Ce;return R?_(_e,U-Te):_e}function fe(me){var Ce=me-oe,Te=me-G;return oe===void 0||Ce>=V||Ce<0||R&&Te>=U}function te(){var me=j();if(fe(me))return K(me);ee=setTimeout(te,he(me))}function K(me){return ee=void 0,M&&C?W(me):(C=I=void 0,A)}function ae(){ee!==void 0&&clearTimeout(ee),G=0,C=oe=I=ee=void 0}function re(){return ee===void 0?A:K(j())}function ue(){var me=j(),Ce=fe(me);if(C=arguments,I=this,oe=me,Ce){if(ee===void 0)return se(oe);if(R)return ee=setTimeout(te,V),W(oe)}return ee===void 0&&(ee=setTimeout(te,V)),A}return ue.cancel=ae,ue.flush=re,ue}function N($){var V=typeof $;return!!$&&(V=="object"||V=="function")}function O($){return!!$&&typeof $=="object"}function D($){return typeof $=="symbol"||O($)&&S.call($)==s}function L($){if(typeof $=="number")return $;if(D($))return r;if(N($)){var V=typeof $.valueOf=="function"?$.valueOf():$;$=N(V)?V+"":V}if(typeof $!="string")return $===0?$:+$;$=$.replace(i,"");var H=f.test($);return H||g.test($)?p($.slice(2),H?2:8):d.test($)?r:+$}return hd=T,hd}var Z1=Q1();const K1=f0(Z1);class qd{static get(r){try{return JSON.parse(localStorage.getItem(this.STORAGE_KEY)||"{}")[r]||null}catch(s){return console.warn("[PrintingPreferences] Error reading preferences:",s),null}}static set(r,s){var i;try{const d=JSON.parse(localStorage.getItem(this.STORAGE_KEY)||"{}");d[r]={id:s.id,set:s.set,set_name:s.set_name,collector_number:s.collector_number,image_uris:s.image_uris,selectedAt:Date.now(),selectionCount:(((i=d[r])==null?void 0:i.selectionCount)||0)+1},localStorage.setItem(this.STORAGE_KEY,JSON.stringify(d)),console.log(`[PrintingPreferences] Saved preference for ${r}: ${s.set.toUpperCase()} #${s.collector_number}`)}catch(d){console.warn("[PrintingPreferences] Error saving preference:",d)}}static has(r){return this.get(r)!==null}static clear(r=null){try{if(r){const s=JSON.parse(localStorage.getItem(this.STORAGE_KEY)||"{}");delete s[r],localStorage.setItem(this.STORAGE_KEY,JSON.stringify(s)),console.log(`[PrintingPreferences] Cleared preference for ${r}`)}else localStorage.removeItem(this.STORAGE_KEY),console.log("[PrintingPreferences] Cleared all preferences")}catch(s){console.warn("[PrintingPreferences] Error clearing preferences:",s)}}static getAll(){try{return JSON.parse(localStorage.getItem(this.STORAGE_KEY)||"{}")}catch(r){return console.warn("[PrintingPreferences] Error reading all preferences:",r),{}}}static getPatterns(){const r=this.getAll(),s={preferredSets:{},recentSelections:[],totalSelections:0};return Object.values(r).forEach(i=>{s.preferredSets[i.set]=(s.preferredSets[i.set]||0)+i.selectionCount,s.recentSelections.push({set:i.set,selectedAt:i.selectedAt,count:i.selectionCount}),s.totalSelections+=i.selectionCount}),s.recentSelections.sort((i,d)=>d.selectedAt-i.selectedAt),s}}lr(qd,"STORAGE_KEY","mtg_printing_preferences");let Zr=0,md=Date.now();function Wn(a,r=null){return a?a&&a.length>=36?`https://cards.scryfall.io/normal/front/${a.substring(0,1)}/${a.substring(1,2)}/${a}.jpg`:`https://api.scryfall.com/cards/${a}?format=image&version=normal`:null}function J1({preview:a,isFixed:r,showPreview:s,externalFlipState:i}){var f,g,p,m,h,y,b,S,E,_,j,T,N,O,D,L,$,V,H,C,I,U,A,ee,oe,G,P,R,M,W,se,he,fe,te,K,ae,re,ue,me,Ce,Te,_e,Pe,rt,nt,_t,en,It,Rt,$n,vt,pt,ht,Nt,sn,Fn,ya,tn,it,Tt,yt,wn,Ht,Cn,jn,_n;Zr++;const d=Date.now();if(d-md>6e4&&(Zr=0,md=d),Zr%100===0&&console.warn(`[PERFORMANCE] CardPreview has re-rendered ${Zr} times! Possible render loop.`),Zr>200)return console.error(`[EMERGENCY] CardPreview has re-rendered ${Zr} times! Activating circuit breaker.`),l.jsxs("div",{style:{padding:"10px",border:"1px solid orange",margin:"5px",fontSize:"12px"},children:[l.jsx("strong",{children:"⚠️ CardPreview Render Loop"}),l.jsxs("p",{children:["CardPreview encountered a render loop and was stopped. Counter will reset in ",Math.ceil((6e4-(d-md))/1e3),"s."]})]});try{const X=(a==null?void 0:a.card)||a,Ae=(X==null?void 0:X.name)||((f=X==null?void 0:X.scryfall_json)==null?void 0:f.name)||((g=X==null?void 0:X.card)==null?void 0:g.name)||((m=(p=X==null?void 0:X.card)==null?void 0:p.scryfall_json)==null?void 0:m.name)||"Unknown Card";if(!s||!a||!X)return l.jsx("div",{style:{display:"none"},"data-cardpreview-hidden":"no-data"});if(typeof X!="object")return console.warn("[CardPreview] Invalid card object type:",typeof X,X),l.jsx("div",{style:{display:"none"},"data-cardpreview-hidden":"invalid-type"});if(!((X==null?void 0:X.id)||(X==null?void 0:X.scryfall_id)||((h=X==null?void 0:X.scryfall_json)==null?void 0:h.id)||((y=X==null?void 0:X.card)==null?void 0:y.id)||(X==null?void 0:X.card_faces)||((b=X==null?void 0:X.scryfall_json)==null?void 0:b.card_faces)||((E=(S=X==null?void 0:X.card)==null?void 0:S.scryfall_json)==null?void 0:E.card_faces)||(X==null?void 0:X.name)||((_=X==null?void 0:X.card)==null?void 0:_.name)||(X==null?void 0:X.printing)||((j=X==null?void 0:X.cardObj)==null?void 0:j.scryfall_id)||(X==null?void 0:X.name)&&((X==null?void 0:X.name.includes("Snow-Covered"))||(X==null?void 0:X.name.includes("Basic")))))return console.warn("[CardPreview] Card missing all basic data fields:",{card_type:typeof X,has_id:!!(X!=null&&X.id),has_scryfall_id:!!(X!=null&&X.scryfall_id),has_scryfall_json_id:!!((T=X==null?void 0:X.scryfall_json)!=null&&T.id),has_card_id:!!((N=X==null?void 0:X.card)!=null&&N.id),has_card_faces:!!(X!=null&&X.card_faces),card_keys:X?Object.keys(X):"no card",card_name:X==null?void 0:X.name,full_card_structure:JSON.stringify(X,null,2)}),l.jsx("div",{style:{display:"none"},"data-cardpreview-hidden":"no-basic-data"});const[xa,Fa]=v.useState(!1),[Kn,Ln]=v.useState(!1),[ot,St]=v.useState(!0),[Et,an]=v.useState(!1),wt=i!==void 0?i:xa;v.useEffect(()=>{Ln(!1),St(!Et)},[Ae,Et]);const kt=a.foil===!0||a.isFoil===!0||((O=a.cardObj)==null?void 0:O.foil)===!0||((D=a.cardObj)==null?void 0:D.isFoil)===!0||X.foil===!0||X.isFoil===!0||((L=X.card)==null?void 0:L.foil)===!0||(($=X.card)==null?void 0:$.isFoil)===!0,Be=X.card_faces||((V=X.scryfall_json)==null?void 0:V.card_faces)||((C=(H=X.card)==null?void 0:H.scryfall_json)==null?void 0:C.card_faces)||((I=X.card)==null?void 0:I.card_faces)||((U=a.scryfall_json)==null?void 0:U.card_faces)||((ee=(A=a.cardObj)==null?void 0:A.scryfall_json)==null?void 0:ee.card_faces),Wt=X.layout||((oe=X.scryfall_json)==null?void 0:oe.layout)||((P=(G=X.card)==null?void 0:G.scryfall_json)==null?void 0:P.layout)||((R=X.card)==null?void 0:R.layout)||((M=a.scryfall_json)==null?void 0:M.layout)||((se=(W=a.cardObj)==null?void 0:W.scryfall_json)==null?void 0:se.layout),Ke=Wt==="transform"||Wt==="modal_dfc"||Wt==="reversible_card",Je=Be&&Array.isArray(Be)&&Be.length>=2||Ke;(Ae.includes("Accursed")||Ae.includes("Infectious"))&&console.log("Transform card detected:",{cardName:Ae,isDoubleFaced:Je,isTransformCard:Ke,layout:Wt,cardFaces:(Be==null?void 0:Be.length)||0,cardFacesData:Be,cardStructure:{hasCardFaces:!!X.card_faces,hasScryfallCardFaces:!!((he=X.scryfall_json)!=null&&he.card_faces),hasNestedCardFaces:!!((te=(fe=X.card)==null?void 0:fe.scryfall_json)!=null&&te.card_faces),hasPreviewCardFaces:!!((K=a.scryfall_json)!=null&&K.card_faces),layout:Wt}});let Ne;const et=qd.get(Ae),k=X.printing||((ae=X.scryfall_json)==null?void 0:ae.id)||((ue=(re=X.card)==null?void 0:re.scryfall_json)==null?void 0:ue.id);if(Ae==="Arcane Signet"&&(console.log(`[CardPreview DEBUG] ${Ae} data structure:`,{card:X,preview:a,userPreference:et,specificPrintingId:k,printingPath1:X.printing,printingPath2:(me=X.scryfall_json)==null?void 0:me.id,printingPath3:(Te=(Ce=X.card)==null?void 0:Ce.scryfall_json)==null?void 0:Te.id,fullCardStructure:JSON.stringify(X,null,2)}),console.log(`[CardPreview DEBUG] Priority check for ${Ae}:`,{hasUserPreference:!!et,userPreferenceId:et==null?void 0:et.id,hasSpecificPrintingId:!!k,specificPrintingIdLength:k==null?void 0:k.length,willUseUserPreference:!!et,willUseSpecificPrinting:!et&&k&&k.length>=36})),Je&&i!==void 0){const be=wt?1:0,pe=Be[be],Se=X.id||((_e=X.scryfall_json)==null?void 0:_e.id)||((Pe=X.card)==null?void 0:Pe.id)||((nt=(rt=X.card)==null?void 0:rt.scryfall_json)==null?void 0:nt.id);if((Ae.includes("Miles")||Ae.includes("Spider-Man"))&&console.log("🔄 FLIP DEBUG - Double-faced card image logic (PRIORITY):",{cardName:Ae,currentFlipState:wt,faceIndex:be,cardFaces:(Be==null?void 0:Be.length)||0,selectedFace:pe?{name:pe.name,hasImageUris:!!pe.image_uris,imageUris:pe.image_uris}:null,cardId:Se,fullCardFacesArray:Be}),pe!=null&&pe.image_uris){const Ee=pe.image_uris.normal||pe.image_uris.large||pe.image_uris.png;(Ae.includes("Miles")||Ae.includes("Spider-Man"))&&console.log("🔄 FLIP DEBUG - Processing selectedFace image_uris:",{selectedFaceName:pe.name,directUrl:Ee,allImageUris:pe.image_uris}),Ee?(Ne=Ee,(Ae.includes("Miles")||Ae.includes("Spider-Man"))&&console.log("🔄 FLIP DEBUG - Using direct selectedFace image URL:",Ne)):Se&&(Ne=Wn(Se),(Ae.includes("Miles")||Ae.includes("Spider-Man"))&&console.log("🔄 FLIP DEBUG - Fallback to cardId for double-faced card:",Ne))}else Se&&(Ne=Wn(Se),(Ae.includes("Miles")||Ae.includes("Spider-Man"))&&console.log("🔄 FLIP DEBUG - Fallback to cardId for double-faced card:",Ne))}else if(et&&et.id&&!Je)Ne=Wn(et.id),Ae==="Arcane Signet"&&console.log(`[CardPreview] 🧠 Using learned preference for ${Ae}: ${et.set.toUpperCase()} #${et.collector_number} (${et.id})`);else if(Je)if(!Be||!Array.isArray(Be)||Be.length===0)console.warn("[CardPreview] Dual-faced card detected but no valid cardFaces array:",{cardName:Ae,cardFaces:Be});else{const be=wt?1:0,pe=Be[be]||Be[0],Se=X.id||((_t=X.scryfall_json)==null?void 0:_t.id)||((en=X.card)==null?void 0:en.id)||((Rt=(It=X.card)==null?void 0:It.scryfall_json)==null?void 0:Rt.id);if((Ae.includes("Miles")||Ae.includes("Spider-Man")||Ae.includes("Accursed")||Ae.includes("Infectious"))&&console.log("🔄 FLIP DEBUG - Double-faced card image logic:",{cardName:Ae,currentFlipState:wt,faceIndex:be,cardFaces:(Be==null?void 0:Be.length)||0,selectedFace:pe?{name:pe.name,hasImageUris:!!pe.image_uris,imageUris:pe.image_uris}:null,cardId:Se,fullCardFacesArray:Be}),pe!=null&&pe.image_uris){const Ee=pe.image_uris.normal||pe.image_uris.large||pe.image_uris.png;(Ae.includes("Miles")||Ae.includes("Spider-Man")||Ae.includes("Accursed")||Ae.includes("Infectious"))&&console.log("Processing selectedFace image_uris:",{selectedFaceName:pe.name,directUrl:Ee,allImageUris:pe.image_uris}),Ee?(Ne=Ee,(Ae.includes("Miles")||Ae.includes("Spider-Man")||Ae.includes("Accursed")||Ae.includes("Infectious"))&&console.log("Using direct selectedFace image URL:",Ne)):Se&&(Ne=Wn(Se),(Ae.includes("Miles")||Ae.includes("Spider-Man")||Ae.includes("Accursed")||Ae.includes("Infectious"))&&console.log("Fallback to cardId for double-faced card:",Ne))}else Se&&(Ne=Wn(Se),(Ae.includes("Accursed")||Ae.includes("Infectious"))&&console.log("Fallback to cardId for double-faced card:",Ne))}else k&&k.length>=36&&(Ne=Wn(k),Ae==="Arcane Signet"&&console.log(`[CardPreview] ✅ Using specific printing for ${Ae}: ${k}`));if(!Ne){const be=X.id||(($n=X.scryfall_json)==null?void 0:$n.id)||((vt=X.card)==null?void 0:vt.id)||((ht=(pt=X.card)==null?void 0:pt.scryfall_json)==null?void 0:ht.id)||X.printing;let pe=null;if(X.image_uris?pe=X.image_uris.normal||X.image_uris.large||X.image_uris.png:X.scryfall_json&&X.scryfall_json.image_uris?pe=X.scryfall_json.image_uris.normal||X.scryfall_json.image_uris.large||X.scryfall_json.image_uris.png:X.card&&X.card.image_uris?pe=X.card.image_uris.normal||X.card.image_uris.large||X.card.image_uris.png:X.card&&X.card.scryfall_json&&X.card.scryfall_json.image_uris?pe=X.card.scryfall_json.image_uris.normal||X.card.scryfall_json.image_uris.large||X.card.scryfall_json.image_uris.png:X.card_faces&&((Nt=X.card_faces[0])!=null&&Nt.image_uris)?pe=X.card_faces[0].image_uris.normal||X.card_faces[0].image_uris.large:(sn=a.scryfall_json)!=null&&sn.image_uris?pe=a.scryfall_json.image_uris.normal||a.scryfall_json.image_uris.large:(tn=(ya=(Fn=a.cardObj)==null?void 0:Fn.card)==null?void 0:ya.scryfall_json)!=null&&tn.image_uris&&(pe=a.cardObj.card.scryfall_json.image_uris.normal||a.cardObj.card.scryfall_json.image_uris.large),pe){const Se=pe.match(/\/([a-f0-9-]{36})\.(jpg|png)/);Se&&Se[1]?Ne=Wn(Se[1]):be&&(Ne=Wn(be))}else be&&(Ne=Wn(be));if(!Ne){const Se=X.set||((it=X.scryfall_json)==null?void 0:it.set)||((Tt=X.card)==null?void 0:Tt.set)||((wn=(yt=X.card)==null?void 0:yt.scryfall_json)==null?void 0:wn.set),Ee=X.collector_number||((Ht=X.scryfall_json)==null?void 0:Ht.collector_number)||((Cn=X.card)==null?void 0:Cn.collector_number)||((_n=(jn=X.card)==null?void 0:jn.scryfall_json)==null?void 0:_n.collector_number);be?Ne=Wn(be):Se&&Ee?Ne=`https://api.scryfall.com/cards/${Se.toLowerCase()}/${Ee}?format=image&version=normal`:Ne=`https://api.scryfall.com/cards/named?format=image&version=normal&exact=${encodeURIComponent(Ae)}`}}const{top:B,left:q}=a.position||{top:100,left:100},ge=r?{width:"100%",height:"auto"}:{position:"fixed",top:`${B}px`,left:`${q}px`,zIndex:1e3,width:"250px"},ve={width:r?"100%":"250px",height:"auto",borderRadius:"10px",display:"block"},$e=`card-preview-container ${r?"fixed-preview":""}`;return l.jsxs("div",{className:$e,style:{...ge,overflow:"hidden",borderRadius:"10px"},children:[ot&&l.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"10px",fontSize:"14px",color:"#666"},children:"Loading..."}),l.jsx("img",{src:Ne,alt:Ae,style:ve,onError:()=>{if(St(!1),!Kn){Ln(!0);const be=`https://api.scryfall.com/cards/named?format=image&version=normal&exact=${encodeURIComponent(Ae)}`;if(Ne!==be){const pe=document.querySelector(`img[alt="${Ae}"]`);pe&&(pe.src=be)}}},onLoad:()=>{Ln(!1),St(!1),an(!0)}}),kt&&l.jsx("div",{className:"fresh-foil-overlay","data-foil":kt,"data-testid":"foil-overlay"})]})}catch(X){return console.error("[CardPreview] Caught error to prevent crash:",X),console.error("[CardPreview] Error details:",{preview:a,card:(a==null?void 0:a.card)||a,error:X.message}),l.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#666",border:"1px solid #ddd",borderRadius:"8px",backgroundColor:"#f9f9f9"},children:[l.jsx("div",{children:"Preview Error"}),l.jsx("div",{style:{fontSize:"12px",marginTop:"5px"},children:"Card data unavailable"})]})}}const eS=({isOpen:a,onClose:r,card:s,onAddCard:i,onUpdateCard:d})=>{var A,ee,oe,G,P,R,M,W,se,he,fe,te;const f=v.useRef(null),[g,p]=v.useState(null),[m,h]=v.useState([]),[y,b]=v.useState(!1),[S,E]=v.useState(1),[_,j]=v.useState(!1),[T,N]=v.useState(null),[O,D]=v.useState(!1),[L,$]=v.useState(!1),[V,H]=v.useState("1");v.useEffect(()=>{if(a&&s){const K=s.editing||!1;D(K),K?(E(s.quantity||1),j(s.foil||!1),N(s.assignedTo||s.originalAssignment||null),p(s.card||s.scryfall_json||s)):(E(1),j(!1),N(null),p(s)),C()}},[a,s]);const C=async()=>{if(!s){console.log("🚫 No card provided to fetchPrintings");return}console.log("📚 Fetching printings for:",s.name),b(!0);try{const ae=`http://localhost:3001/api/cards/printings?name=${encodeURIComponent(s.name)}`;console.log("🔗 Printings URL:",ae);const re=await fetch(ae);if(!re.ok)throw new Error(`HTTP ${re.status}: ${re.statusText}`);const ue=await re.json();console.log("✅ Printings response:",ue);const me=ue.data||[];if(console.log(`📦 Found ${me.length} printings for "${s.name}"`),h(me),me.length>0){let Ce=null;const Te=s.scryfall_json||s.card||s;s.printingData&&(Ce=me.find(_e=>_e.id===s.printingData.id||_e.set===s.printingData.set&&_e.collector_number===s.printingData.collector_number),Ce&&console.log("🎯 Auto-selected from printingData:",Ce.set_name)),Ce||(Ce=me.find(_e=>_e.id===Te.id||_e.set===Te.set&&_e.collector_number===Te.collector_number),Ce&&console.log("🎯 Auto-selected from scryfall data:",Ce.set_name)),Ce||(Ce=me.find(_e=>_e.id===s.id||_e.set===s.set&&_e.collector_number===s.collector_number),Ce&&console.log("🎯 Auto-selected matching printing from search:",Ce.set_name)),Ce?p(Ce):(p(me[0]),console.log("🎯 Auto-selected first printing (no match found):",me[0].set_name))}else p(s),console.log("🎯 Fallback to original card")}catch(K){console.error("❌ Error fetching printings:",K),h([]),p(s)}b(!1)},I=()=>{if(!g)return null;const K={...g,scryfall_json:g,foil:_};return Jt(K,{preferStoredPrice:!1})},U=()=>{if(!g||!T)return;const K={id:O?s.id:`${g.id||g.name}_${Date.now()}`,name:g.name,card:g,printing:g.id,quantity:S,foil:_,price:I(),assignedTo:T,scryfall_json:g,printingData:{id:g.id,set_name:g.set_name,set:g.set,collector_number:g.collector_number,image_uris:g.image_uris}};O&&d?d(K,s.originalAssignment):i(K),r()};return a?l.jsx("div",{ref:K=>{f.current=K,a&&K&&setTimeout(()=>K.focus(),0)},className:"modal-backdrop card-actions-modal",onClick:r,tabIndex:0,autoFocus:!0,onKeyDown:K=>{K.key==="Escape"&&(K.preventDefault(),K.stopPropagation(),r())},children:l.jsxs("div",{className:"modal-content",onClick:K=>K.stopPropagation(),style:{maxWidth:"800px",width:"90%",maxHeight:"85vh",display:"flex",flexDirection:"column"},children:[l.jsxs("div",{className:"modal-header",children:[l.jsx("button",{className:"nav-arrow nav-arrow-left",title:"Previous card (Left arrow key)",style:{position:"absolute",left:"-60px",top:"50%",transform:"translateY(-50%)",background:"rgba(255, 255, 255, 0.95)",border:"2px solid #ddd",borderRadius:"50%",width:"48px",height:"48px",fontSize:"2rem",cursor:"pointer",color:"#666",display:"none",alignItems:"center",justifyContent:"center"},children:"‹"}),l.jsx("button",{onClick:r,className:"close-button",children:"×"}),l.jsx("button",{className:"nav-arrow nav-arrow-right",title:"Next card (Right arrow key)",style:{position:"absolute",right:"-60px",top:"50%",transform:"translateY(-50%)",background:"rgba(255, 255, 255, 0.95)",border:"2px solid #ddd",borderRadius:"50%",width:"48px",height:"48px",fontSize:"2rem",cursor:"pointer",color:"#666",display:"none",alignItems:"center",justifyContent:"center"},children:"›"})]}),l.jsxs("div",{className:"modal-body",style:{display:"flex",flexDirection:"row",gap:"15px",height:"100%",overflow:"hidden"},children:[l.jsxs("div",{className:"card-actions",style:{flex:"0 0 280px",display:"flex",flexDirection:"column",gap:"12px"},children:[l.jsxs("div",{className:"action-row",style:{flexDirection:"column",alignItems:"stretch"},children:[l.jsx("label",{className:"control-label",style:{marginBottom:"8px",textAlign:"left",minWidth:"auto",width:"auto"},children:"Assign to:"}),l.jsxs("div",{style:{display:"flex",gap:"8px"},children:[l.jsx("button",{onClick:()=>N("user1"),style:{flex:1,padding:"10px 16px",borderRadius:"6px",border:T==="user1"?"2px solid #1976d2":"1px solid #ddd",backgroundColor:T==="user1"?"#e3f2fd":"white",color:T==="user1"?"#1976d2":"#666",fontSize:"14px",fontWeight:T==="user1"?"600":"400",cursor:"pointer",transition:"all 0.2s ease"},children:"Me"}),l.jsx("button",{onClick:()=>N("user2"),style:{flex:1,padding:"10px 16px",borderRadius:"6px",border:T==="user2"?"2px solid #1976d2":"1px solid #ddd",backgroundColor:T==="user2"?"#e3f2fd":"white",color:T==="user2"?"#1976d2":"#666",fontSize:"14px",fontWeight:T==="user2"?"600":"400",cursor:"pointer",transition:"all 0.2s ease"},children:"Trading Partner"})]})]}),l.jsx("div",{className:"action-row",style:{display:"flex",alignItems:"center",gap:"15px"},children:l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("label",{className:"control-label",children:"Quantity:"}),l.jsxs("div",{className:"quantity-controls",style:{display:"flex",alignItems:"center",position:"relative"},children:[l.jsx("button",{className:"quantity-btn",onClick:()=>E(K=>Math.max(1,K-1)),disabled:S<=1,style:{width:"28px",height:"28px",borderRadius:"4px 0 0 4px",border:"1px solid #ddd",background:"#f8f9fa",cursor:S<=1?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:"−"}),l.jsx("input",{type:"number",value:L?V:S,onChange:K=>{L?H(K.target.value):E(Math.max(1,parseInt(K.target.value)||1))},onFocus:K=>{H(S.toString()),$(!0),setTimeout(()=>K.target.select(),0)},onBlur:()=>{if(L){const K=Math.max(1,parseInt(V)||1);E(K),$(!1)}},onKeyDown:K=>{if(K.key==="Enter"){const ae=Math.max(1,parseInt(V)||1);E(ae),$(!1),K.target.blur()}else K.key==="Escape"&&($(!1),K.target.blur())},className:`quantity-input ${L?"editing":""}`,min:"1",style:{width:"50px",height:"28px",border:L?"2px solid #1976d2":"1px solid #ddd",borderLeft:"none",borderRight:"none",textAlign:"center",fontSize:"14px",backgroundColor:L?"#f0f8ff":"white"}}),L&&l.jsx("span",{style:{position:"absolute",fontSize:"11px",color:"#666",top:"-18px",left:"50%",transform:"translateX(-50%)",whiteSpace:"nowrap",backgroundColor:"white",padding:"2px 4px",border:"1px solid #ddd",borderRadius:"3px"},children:"Enter to save, Esc to cancel"}),l.jsx("button",{className:"quantity-btn",onClick:()=>E(K=>K+1),style:{width:"28px",height:"28px",borderRadius:"0 4px 4px 0",border:"1px solid #ddd",background:"#f8f9fa",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:"+"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginLeft:"15px"},children:[l.jsx("label",{className:"control-label",children:"Foil:"}),l.jsxs("label",{className:"toggle-switch",style:{display:"flex",alignItems:"center"},children:[l.jsx("input",{type:"checkbox",checked:_,onChange:K=>j(K.target.checked),style:{margin:0}}),l.jsx("span",{className:`toggle-slider ${_?"foil-active":""}`,style:{width:"44px",height:"24px",backgroundColor:_?"#d4af37":"#ccc",borderRadius:"12px",position:"relative",cursor:"pointer",transition:"all 0.3s ease",marginLeft:"8px"},children:l.jsx("span",{style:{position:"absolute",top:"2px",left:_?"22px":"2px",width:"20px",height:"20px",backgroundColor:"white",borderRadius:"50%",transition:"all 0.3s ease",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"}})})]})]})]})}),l.jsxs("div",{style:{marginTop:"15px"},children:[l.jsx("label",{className:"control-label",style:{marginBottom:"8px",display:"block"},children:"Printing:"}),y?l.jsx("div",{style:{textAlign:"center",color:"#666",padding:"20px"},children:"Loading printings..."}):l.jsx("select",{value:(g==null?void 0:g.id)||"",onChange:K=>{const ae=m.find(re=>re.id===K.target.value);p(ae)},style:{padding:"8px 12px",borderRadius:"4px",border:"1px solid #ddd",fontSize:"14px",width:"100%",backgroundColor:"white",color:"#000",fontFamily:"inherit",cursor:"pointer",outline:"none",boxShadow:"none"},children:m.map(K=>{const ae={...K,scryfall_json:K,foil:_},re=Jt(ae,{preferStoredPrice:!1}),ue=re!=null&&re.price?fn(re.price):"N/A";return l.jsxs("option",{value:K.id,children:[K.set_name," (",K.set,") #",K.collector_number," • ",ue]},K.id)})})]}),l.jsxs("div",{className:"modal-buttons",style:{marginTop:"20px"},children:[l.jsx("button",{className:"btn btn-primary modal-btn-primary",onClick:U,disabled:!g||!T,children:O?"Update Card":"Add to Trade"}),O&&l.jsx("button",{className:"btn btn-secondary modal-btn-secondary",onClick:r,children:"Cancel"})]})]}),l.jsx("div",{className:"card-display",style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"10px"},children:(g||s)&&l.jsx(l.Fragment,{children:l.jsxs("div",{style:{width:"360px",height:"504px",border:"1px solid #ddd",borderRadius:"12px",overflow:"hidden",backgroundColor:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"15px"},children:[(A=g==null?void 0:g.image_uris)!=null&&A.normal||(ee=g==null?void 0:g.image_uris)!=null&&ee.small||(oe=s==null?void 0:s.image_uris)!=null&&oe.normal||(G=s==null?void 0:s.image_uris)!=null&&G.small?l.jsx("img",{src:((P=g==null?void 0:g.image_uris)==null?void 0:P.normal)||((R=g==null?void 0:g.image_uris)==null?void 0:R.small)||((M=s==null?void 0:s.image_uris)==null?void 0:M.normal)||((W=s==null?void 0:s.image_uris)==null?void 0:W.small),alt:(g==null?void 0:g.name)||(s==null?void 0:s.name),style:{width:"100%",height:"100%",objectFit:"contain"},onError:K=>{K.target.style.display="none",K.target.nextSibling.style.display="flex"}}):null,l.jsxs("div",{style:{display:(se=g==null?void 0:g.image_uris)!=null&&se.normal||(he=g==null?void 0:g.image_uris)!=null&&he.small||(fe=s==null?void 0:s.image_uris)!=null&&fe.normal||(te=s==null?void 0:s.image_uris)!=null&&te.small?"none":"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"#9ca3af",fontSize:"16px",textAlign:"center",flexDirection:"column",gap:"8px"},children:[l.jsx("div",{children:"🎴"}),l.jsx("div",{children:"No Image Available"})]})]})})})]})]})}):null},oh=({isNew:a})=>{const{tradeId:r}=s0(),s=ma(),[i,d]=v.useState(null),[f,g]=v.useState(!0),[p,m]=v.useState(""),[h,y]=v.useState([]),[b,S]=v.useState(!1),[E,_]=v.useState(!1),[j,T]=v.useState(-1),[N,O]=v.useState(!1),[D,L]=v.useState(""),$={id:"1b65d800-c517-4a9d-b588-757235c26fe3",name:"Trading Post",mana_cost:"{4}",cmc:4,type_line:"Artifact",oracle_text:`{1}, {T}, Discard a card: You gain 4 life.
{1}, {T}, Pay 1 life: Create a 0/1 white Goat creature token.
{1}, {T}, Sacrifice a creature: Return target artifact card from your graveyard to your hand.
{1}, {T}, Sacrifice an artifact: Draw a card.`,colors:[],color_identity:[],set:"c14",set_name:"Commander 2014",rarity:"rare",artist:"Adam Paquette",collector_number:"279",image_uris:{small:"https://cards.scryfall.io/small/front/1/b/1b65d800-c517-4a9d-b588-757235c26fe3.jpg?1561935035",normal:"https://cards.scryfall.io/normal/front/1/b/1b65d800-c517-4a9d-b588-757235c26fe3.jpg?1561935035",large:"https://cards.scryfall.io/large/front/1/b/1b65d800-c517-4a9d-b588-757235c26fe3.jpg?1561935035"},prices:{usd:"0.34",eur:"0.31"},scryfall_uri:"https://scryfall.com/card/c14/279/trading-post?utm_source=api"},[V,H]=v.useState($),[C,I]=v.useState(null),[U,A]=v.useState(!1),[ee,oe]=v.useState(!1),[G,P]=v.useState([]),[R,M]=v.useState(""),[W,se]=v.useState(""),[he,fe]=v.useState(!1),te=v.useRef(null),[K,ae]=v.useState({}),[re,ue]=v.useState({}),[me,Ce]=v.useState({}),[Te,_e]=v.useState(null),[Pe,rt]=v.useState("Me"),[nt,_t]=v.useState("Trading Partner"),[en,It]=v.useState(!1),[Rt,$n]=v.useState(!1),[vt,pt]=v.useState([]),[ht,Nt]=v.useState([]),[sn,Fn]=v.useState("name"),ya=async k=>{if(!k||!k.name)throw new Error("Card name is required");try{const q=`http://localhost:3001/api/cards/printings?name=${encodeURIComponent(k.name)}`,ge=await fetch(q);if(!ge.ok)throw new Error(`HTTP ${ge.status}: ${ge.statusText}`);return(await ge.json()).data||[]}catch(B){throw console.error("Failed to fetch printings for",k.name,":",B),B}},[tn,it]=v.useState(!1),[Tt,yt]=v.useState(!1),wn=v.useRef(null);v.useRef(0);const Ht=v.useRef(!1);v.useEffect(()=>{const k=B=>{tn&&!B.target.closest("[data-export-dropdown]")&&it(!1)};if(tn)return document.addEventListener("click",k),()=>document.removeEventListener("click",k)},[tn]),v.useEffect(()=>{if(!Ht.current)if(a){const B={id:`trade_${Date.now()}`,date:new Date().toISOString().split("T")[0],status:"pending",user1_name:"Me",user2_name:"Trading Partner",user1_cards:[],user2_cards:[]};d(B),g(!1),Ht.current=!0}else if(r){const B=JSON.parse(localStorage.getItem("savedTrades")||"[]").find(q=>q.id===r);if(B)d(B),B.sortOption&&Fn(B.sortOption),B.user1_cards&&pt(B.user1_cards),B.user2_cards&&Nt(B.user2_cards),B.user1_name&&rt(B.user1_name),B.user2_name&&_t(B.user2_name);else{ce.error("Trade not found"),s("/trade");return}g(!1),Ht.current=!0}else{const B={id:`trade_${Date.now()}`,date:new Date().toISOString().split("T")[0],status:"pending",user1_name:"Me",user2_name:"Trading Partner",user1_cards:[],user2_cards:[]};d(B),g(!1),Ht.current=!0}},[a,r]);const Cn=v.useRef();Cn.current||(Cn.current=K1(async k=>{if(!k.trim()){y([]),S(!1),L(""),_(!1),O(!1);return}wn.current&&wn.current.abort(),wn.current=new AbortController;const B=wn.current.signal;_(!0);try{const q=`/api/cards/typesense-search?q=${encodeURIComponent(k)}&limit=20`,$e=!1?q:`${q}`,be=await fetch($e,{signal:B});if(!be.ok)throw new Error(`HTTP error! status: ${be.status}`);const pe=await be.json();let Se=pe.data||pe||[];const Ee=[],ye=new Set;for(const Ie of Se)ye.has(Ie.name)||(ye.add(Ie.name),Ee.push(Ie));y(Ee.slice(0,20)),S(Ee.length>0),L(Ee.length===0?"No cards found":""),T(-1),O(!1)}catch(q){q.name!=="AbortError"&&(console.error("Search error:",q),y([]),S(!1),L("Search failed"))}_(!1)},500)),v.useEffect(()=>{te.current&&te.current.focus()},[]),v.useEffect(()=>{!ee&&te.current&&setTimeout(()=>{te.current&&te.current.focus()},100)},[ee]),v.useEffect(()=>{const k=q=>{q.key==="Escape"&&ae({})},B=q=>{!q.target.closest("[data-printing-dropdown]")&&!q.target.closest("[data-card-name]")&&ae({})};return document.addEventListener("keydown",k),document.addEventListener("mousedown",B),()=>{document.removeEventListener("keydown",k),document.removeEventListener("mousedown",B)}},[]);const jn=async k=>{if(k.trim()){fe(!0);try{const B=`/api/cards/typesense-search?q=${encodeURIComponent(k.trim())}&limit=1000`,ve=!1?B:`${B}`,$e=await fetch(ve);if(!$e.ok)throw new Error(`HTTP error! status: ${$e.status}`);const be=await $e.json();let pe=be.data||be||[];const Se=[],Ee=new Set;for(const ye of pe)Ee.has(ye.name)||(Ee.add(ye.name),Se.push(ye));P(Se),M(k.trim()),se(""),oe(!0),S(!1)}catch(B){console.error("Error fetching all search results:",B),P([])}finally{fe(!1)}}},_n=k=>{I(k),A(!0),m(""),S(!1),y([]),console.log("🔥 DEBUGGING: handleSearchCardClick finished")},X=v.useCallback(k=>{if(k)try{let B={...k};if(k.card&&typeof k.card=="object"&&(B={...k.card,...k}),!B.name||!B.id&&!B.scryfall_id&&!B.scryfall_json){console.warn("Card hover attempted with invalid card object - missing name or id:",k);return}H(B)}catch(B){console.error("Error in handleCardHover:",B,"Card object:",k)}},[]),Ae=v.useCallback(k=>{k.assignedTo==="user1"?pt(B=>[...B,k]):Nt(B=>[...B,k])},[]),Tn=v.useCallback((k,B)=>{const q=k.assignedTo;B==="user1"?pt(ge=>ge.filter(ve=>ve.id!==k.id)):Nt(ge=>ge.filter(ve=>ve.id!==k.id)),q==="user1"?pt(ge=>[...ge,k]):Nt(ge=>[...ge,k])},[]),xa=k=>{const B={id:`${k.id||k.scryfall_id}-${Date.now()}-user1`,name:k.name,quantity:1,foil:!1,scryfall_json:k,assignedTo:"user1",card:{name:k.name,image_uris:k.image_uris,mana_cost:k.mana_cost,type_line:k.type_line,oracle_text:k.oracle_text,power:k.power,toughness:k.toughness,scryfall_id:k.id||k.scryfall_id}};pt(q=>[...q,B])},Fa=k=>{const B={id:`${k.id||k.scryfall_id}-${Date.now()}-user2`,name:k.name,quantity:1,foil:!1,scryfall_json:k,assignedTo:"user2",card:{name:k.name,image_uris:k.image_uris,mana_cost:k.mana_cost,type_line:k.type_line,oracle_text:k.oracle_text,power:k.power,toughness:k.toughness,scryfall_id:k.id||k.scryfall_id}};Nt(q=>[...q,B])},Kn=(k,B)=>{B==="user1"?pt(q=>q.filter(ge=>ge.id!==k)):Nt(q=>q.filter(ge=>ge.id!==k))},Ln=k=>{const q=k.currentTarget.getBoundingClientRect(),ge=window.pageYOffset||document.documentElement.scrollTop,ve=window.pageXOffset||document.documentElement.scrollLeft;return{top:q.top+ge,left:q.left+ve,width:q.width+172,position:"fixed"}},ot=(k,B,q,ge)=>{const ve=`${q}-${k.id}`;if(K[ve]){ae(be=>({...be,[ve]:!1})),Ce(be=>{const pe={...be};return delete pe[ve],pe}),_e(null);return}const $e=Ln(ge);Ce(be=>({...be,[ve]:$e})),_e(ve),ae({[ve]:!0}),re[k.name]||ya(k).then(be=>{ue(pe=>({...pe,[k.name]:be}))}).catch(be=>{console.error("Failed to fetch printings:",be)})},St=(k,B,q)=>{const ge={...k,id:`${k.id||k.scryfall_id}-${Date.now()}-${q}`,quantity:B.quantity,foil:B.foil,assignedTo:q,scryfall_json:k,card:k};q==="user1"?pt(ve=>ve.map($e=>$e.id===B.id?ge:$e)):Nt(ve=>ve.map($e=>$e.id===B.id?ge:$e)),ae({})},Et=(k,B)=>{const q={...k,id:`${k.id}_duplicate_${Date.now()}`,quantity:1};B==="user1"?pt(ge=>[...ge,q]):Nt(ge=>[...ge,q])},an=async()=>{if(!Tt){yt(!0);try{const k=new Date,B=k.getFullYear()+"."+String(k.getMonth()+1).padStart(2,"0")+"."+String(k.getDate()).padStart(2,"0"),q=vt.length,ge=ht.length,ve=`${B} - ${Pe}(${q}) & ${nt}(${ge})`,$e={id:(i==null?void 0:i.id)||`trade_${Date.now()}`,name:ve,date:k.toISOString().split("T")[0],status:"pending",user1_name:Pe,user2_name:nt,user1_cards:vt,user2_cards:ht,sortOption:sn,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},be=JSON.parse(localStorage.getItem("savedTrades")||"[]"),pe=be.findIndex(Se=>Se.id===$e.id);pe>=0?(be[pe]={...be[pe],...$e},ce.success("Trade updated successfully!")):(be.push($e),ce.success("Trade saved successfully!")),localStorage.setItem("savedTrades",JSON.stringify(be)),d($e)}catch(k){console.error("Error saving trade:",k),ce.error("Failed to save trade")}finally{yt(!1)}}},wt=()=>{try{let k=`TRADE EXPORT
`;k+=`Date: ${new Date().toLocaleDateString()}
`,k+=`${Pe} & ${nt}
`,k+=`
${"=".repeat(50)}

`,k+=`${Pe.toUpperCase()}'S CARDS (${vt.length} items):
`,k+=`-${"-".repeat(Pe.length+15)}
`;const B=Be(vt);let q="";B.forEach(ye=>{var Ie,qe;if(ye.isSeparator)q&&(k+=`
`),k+=`
--- ${ye.groupName.toUpperCase()} ---
`,q=ye.groupName;else{const Oe=ye,ft=((Ie=Oe.scryfall_json)==null?void 0:Ie.set_name)||Oe.set||"",we=((qe=Oe.scryfall_json)==null?void 0:qe.collector_number)||Oe.collector_number||"",xe=Jt(Oe,{fallbackPrice:"0.00"}),Re=xe.price&&parseFloat(xe.price)>0?` - ${fn(xe.price)}`:" - N/A",Ue=Oe.foil?" (Foil)":"";k+=`${Oe.quantity}x ${Oe.name}`,ft&&(k+=` [${ft}${we?" #"+we:""}]`),k+=`${Ue}${Re}
`}}),k+=`
${"=".repeat(50)}

`,k+=`${nt.toUpperCase()}'S CARDS (${ht.length} items):
`,k+=`-${"-".repeat(nt.length+15)}
`;const ge=Be(ht);q="",ge.forEach(ye=>{var Ie,qe;if(ye.isSeparator)q&&(k+=`
`),k+=`
--- ${ye.groupName.toUpperCase()} ---
`,q=ye.groupName;else{const Oe=ye,ft=((Ie=Oe.scryfall_json)==null?void 0:Ie.set_name)||Oe.set||"",we=((qe=Oe.scryfall_json)==null?void 0:qe.collector_number)||Oe.collector_number||"",xe=Jt(Oe,{fallbackPrice:"0.00"}),Re=xe.price&&parseFloat(xe.price)>0?` - ${fn(xe.price)}`:" - N/A",Ue=Oe.foil?" (Foil)":"";k+=`${Oe.quantity}x ${Oe.name}`,ft&&(k+=` [${ft}${we?" #"+we:""}]`),k+=`${Ue}${Re}
`}});const ve=ye=>ye.reduce((Ie,qe)=>{const Oe=Jt(qe,{fallbackPrice:"0.00"}),ft=parseFloat(Oe.price||0),we=qe.quantity||1;return Ie+ft*we},0),$e=ve(vt),be=ve(ht);k+=`
${"=".repeat(50)}
`,k+=`TOTALS:
`,k+=`${Pe}: ${fn($e)}
`,k+=`${nt}: ${fn(be)}
`;const pe=new Blob([k],{type:"text/plain"}),Se=URL.createObjectURL(pe),Ee=document.createElement("a");Ee.href=Se,Ee.download=`trade_${Pe}_${nt}_${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(Ee),Ee.click(),document.body.removeChild(Ee),URL.revokeObjectURL(Se),it(!1),ce.success("Text file exported successfully!")}catch(k){console.error("Error exporting text:",k),ce.error("Failed to export text file")}},kt=async()=>{try{const{default:k}=await Qn(async()=>{const{default:we}=await import("./jspdf.es.min-DtPQpl4u.js").then(xe=>xe.j);return{default:we}},[]),B=new k,q=B.internal.pageSize.width,ge=B.internal.pageSize.height,ve=20,$e=(q-ve*3)/2;let be=ve;B.setFontSize(16),B.setFont(void 0,"bold"),B.text("TRADE SUMMARY",q/2,be,{align:"center"}),be+=10,B.setFontSize(10),B.setFont(void 0,"normal"),B.text(`Date: ${new Date().toLocaleDateString()}`,q/2,be,{align:"center"}),be+=5,B.text(`${Pe} & ${nt}`,q/2,be,{align:"center"}),be+=15,B.setFontSize(12),B.setFont(void 0,"bold"),B.text(`${Pe} (${vt.length} cards)`,ve,be),B.text(`${nt} (${ht.length} cards)`,ve+$e+ve,be),be+=10,B.setFontSize(8),B.setFont(void 0,"normal");const pe=(we,xe)=>{let Re=be;return Be(we).forEach(He=>{var Ct,qt;if(Re>ge-20&&(B.addPage(),Re=ve,B.setFontSize(12),B.setFont(void 0,"bold"),B.text(`${Pe} (${vt.length} cards)`,ve,Re),B.text(`${nt} (${ht.length} cards)`,ve+$e+ve,Re),Re+=10,B.setFontSize(8),B.setFont(void 0,"normal")),He.isSeparator)B.setFont(void 0,"bold"),B.text(`--- ${He.groupName} ---`,xe,Re),B.setFont(void 0,"normal"),Re+=4;else{const Ft=He,ba=((Ct=Ft.scryfall_json)==null?void 0:Ct.set_name)||Ft.set||"",Jn=((qt=Ft.scryfall_json)==null?void 0:qt.collector_number)||Ft.collector_number||"",Ga=Jt(Ft,{fallbackPrice:"0.00"}),so=Ga.price&&parseFloat(Ga.price)>0?` - ${fn(Ga.price)}`:" - N/A",Ql=Ft.foil?" (F)":"";let hr=`${Ft.quantity}x ${Ft.name}`;ba&&(hr+=` [${ba}${Jn?" #"+Jn:""}]`),hr+=`${Ql}${so}`,B.splitTextToSize(hr,$e-5).forEach(bs=>{B.text(bs,xe,Re),Re+=3})}}),Re},Se=pe(vt,ve),Ee=pe(ht,ve+$e+ve),ye=Math.max(Se,Ee)+10;ye>ge-30?(B.addPage(),be=ve):be=ye,B.setFontSize(10),B.setFont(void 0,"bold"),B.text("TOTALS:",q/2,be,{align:"center"}),be+=5;const Ie=we=>we.reduce((xe,Re)=>{const Ue=Jt(Re,{fallbackPrice:"0.00"}),He=parseFloat(Ue.price||0),Ct=Re.quantity||1;return xe+He*Ct},0),qe=Ie(vt),Oe=Ie(ht);B.text(`${Pe}: ${fn(qe)}`,ve,be),B.text(`${nt}: ${fn(Oe)}`,ve+$e+ve,be);const ft=`trade_${Pe}_${nt}_${new Date().toISOString().split("T")[0]}.pdf`;B.save(ft),it(!1),ce.success("PDF exported successfully!")}catch(k){console.error("Error exporting PDF:",k),ce.error("Failed to export PDF")}},Be=k=>{const B=[...k];let q=[];switch(sn){case"color":const ge={},ve={W:"White",U:"Blue",B:"Black",R:"Red",G:"Green"};return B.forEach(ye=>{var Oe;const Ie=((Oe=ye.scryfall_json)==null?void 0:Oe.colors)||[];let qe;Ie.length===0?qe="Colorless":Ie.length===1?qe=ve[Ie[0]]||Ie[0]:qe="Multicolor",ge[qe]||(ge[qe]=[]),ge[qe].push(ye)}),["White","Blue","Black","Red","Green","Multicolor","Colorless"].forEach((ye,Ie)=>{ge[ye]&&ge[ye].length>0&&(q.push({isSeparator:!0,groupName:ye,id:`sep-${ye}`}),q.push(...ge[ye].sort((qe,Oe)=>qe.name.localeCompare(Oe.name))))}),q;case"type":const be={};return B.forEach(ye=>{var ft,we,xe;const Ie=((xe=(we=(ft=ye.scryfall_json)==null?void 0:ft.type_line)==null?void 0:we.split("—")[0])==null?void 0:xe.trim())||"Unknown",Oe=["Artifact","Creature","Enchantment","Instant","Land","Planeswalker","Sorcery"].find(Re=>Ie.includes(Re))||Ie;be[Oe]||(be[Oe]=[]),be[Oe].push(ye)}),Object.keys(be).sort().forEach((ye,Ie)=>{q.push({isSeparator:!0,groupName:ye,id:`sep-${ye}`}),q.push(...be[ye].sort((qe,Oe)=>qe.name.localeCompare(Oe.name)))}),q;case"set":const Se={};return B.forEach(ye=>{var qe;const Ie=((qe=ye.scryfall_json)==null?void 0:qe.set_name)||ye.set||"Unknown";Se[Ie]||(Se[Ie]=[]),Se[Ie].push(ye)}),Object.keys(Se).sort().forEach((ye,Ie)=>{q.push({isSeparator:!0,groupName:ye,id:`sep-${ye}`}),q.push(...Se[ye].sort((qe,Oe)=>qe.name.localeCompare(Oe.name)))}),q;default:return Ke(B)}},Wt=k=>{const B=[...k];switch(sn){case"color":case"type":case"set":return Be(B);default:return Ke(B)}},Ke=k=>{const B=[...k];switch(sn){case"name":return B.sort((pe,Se)=>pe.name.localeCompare(Se.name));case"price":return B.sort((pe,Se)=>{const Ee=Jt(pe,{fallbackPrice:"0.00"}).price,ye=Jt(Se,{fallbackPrice:"0.00"}).price;return parseFloat(ye||0)-parseFloat(Ee||0)});case"color":const q={},ge={W:"White",U:"Blue",B:"Black",R:"Red",G:"Green"};return B.forEach(pe=>{var ye;const Se=((ye=pe.scryfall_json)==null?void 0:ye.colors)||[];let Ee;Se.length===0?Ee="Colorless":Se.length===1?Ee=ge[Se[0]]||Se[0]:Ee="Multicolor",q[Ee]||(q[Ee]=[]),q[Ee].push(pe)}),["White","Blue","Black","Red","Green","Multicolor","Colorless"].reduce((pe,Se)=>(q[Se]&&pe.push(...q[Se].sort((Ee,ye)=>Ee.name.localeCompare(ye.name))),pe),[]);case"type":const $e={};return B.forEach(pe=>{var Ie,qe,Oe;const Se=((Oe=(qe=(Ie=pe.scryfall_json)==null?void 0:Ie.type_line)==null?void 0:qe.split("—")[0])==null?void 0:Oe.trim())||"Unknown",ye=["Artifact","Creature","Enchantment","Instant","Land","Planeswalker","Sorcery"].find(ft=>Se.includes(ft))||Se;$e[ye]||($e[ye]=[]),$e[ye].push(pe)}),Object.keys($e).sort().reduce((pe,Se)=>(pe.push(...$e[Se].sort((Ee,ye)=>Ee.name.localeCompare(ye.name))),pe),[]);case"set":const be={};return B.forEach(pe=>{var Ee;const Se=((Ee=pe.scryfall_json)==null?void 0:Ee.set_name)||"Unknown Set";be[Se]||(be[Se]=[]),be[Se].push(pe)}),Object.keys(be).sort().reduce((pe,Se)=>(pe.push(...be[Se].sort((Ee,ye)=>Ee.name.localeCompare(ye.name))),pe),[]);default:return B}},Je=v.useMemo(()=>vt.reduce((k,B)=>{const q=Jt(B,{fallbackPrice:"0.00"}),ge=parseFloat(q.price||0),ve=B.quantity||1;return k+ge*ve},0),[vt]),Ne=v.useMemo(()=>ht.reduce((k,B)=>{const q=Jt(B,{fallbackPrice:"0.00"}),ge=parseFloat(q.price||0),ve=B.quantity||1;return k+ge*ve},0),[ht]),et=v.useCallback(()=>{A(!1)},[]);return f?l.jsx("div",{className:"container",children:l.jsx("h2",{children:"Loading Trade..."})}):l.jsxs("div",{className:"container",style:{maxWidth:"1200px",padding:"10px 20px",margin:"0 auto"},children:[l.jsx("div",{style:{marginBottom:"10px"},children:l.jsx("span",{onClick:()=>s("/trade"),style:{color:"#6c757d",fontSize:"14px",cursor:"pointer",textDecoration:"none",borderBottom:"1px dotted transparent",transition:"all 0.2s ease"},onMouseEnter:k=>{k.target.style.color="#007bff",k.target.style.borderBottomColor="#007bff"},onMouseLeave:k=>{k.target.style.color="#6c757d",k.target.style.borderBottomColor="transparent"},children:"← Back to Trades"})}),l.jsx("div",{style:{marginBottom:"15px"},children:l.jsx("h1",{style:{margin:"0",fontSize:"24px"},children:a?"Create New Trade":(i==null?void 0:i.name)||`Trade ${i==null?void 0:i.id}`})}),l.jsxs("div",{style:{display:"flex",gap:"15px",minHeight:"600px",maxWidth:"1400px",margin:"0 auto"},children:[l.jsxs("div",{style:{flex:"0 0 280px",display:"flex",flexDirection:"column"},children:[l.jsx("div",{style:{marginBottom:"20px",border:"1px solid #ddd",borderRadius:"8px",padding:"10px",backgroundColor:"#f9f9f9",display:"flex",flexDirection:"column"},children:V&&V.name&&(V.id||V.scryfall_id)?l.jsx(J1,{preview:V,isFixed:!0,showPreview:!0}):l.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flex:1,color:"#666"},children:"Hover over cards to preview"})}),l.jsxs("div",{className:"search-container",style:{position:"relative",marginBottom:"15px"},children:[l.jsx("input",{ref:te,type:"text",placeholder:"Search for cards to add (Scryfall syntax supported)...",value:p,"data-trade-search":"true",onChange:k=>{const B=k.target.value;m(B),B.trim()?Cn.current(B):(y([]),S(!1),L(""),_(!1),O(!1))},onBlur:k=>{const q=k.currentTarget.closest(".search-container");setTimeout(()=>{const ge=document.activeElement,ve=q==null?void 0:q.querySelector("[data-search-dropdown]");!(ve&&ve.contains(ge))&&!(q!=null&&q.contains(ge))&&(S(!1),m(""),y([]),T(-1))},150)},style:{width:"100%",padding:"8px 12px",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:"white",color:"black",fontSize:"14px"},onKeyDown:k=>{if((b||h.length>0)&&h.length>0){if(k.key==="ArrowDown"){k.preventDefault(),k.stopPropagation(),O(!0),T(B=>{const q=B<h.length-1?B+1:0,ge=h[q];return ge&&ge.name&&X(ge),q});return}if(k.key==="ArrowUp"){k.preventDefault(),k.stopPropagation(),O(!0),T(B=>{const q=B>0?B-1:h.length-1,ge=h[q];return ge&&ge.name&&X(ge),q});return}if(k.key==="Enter"){if(k.preventDefault(),k.stopPropagation(),N&&j>=0&&j<h.length){const B=h[j];if(B){_n(B);return}}p.trim()&&jn(p.trim());return}}if(k.key==="Enter"&&p.trim()){k.preventDefault(),k.stopPropagation(),j<0&&jn(p.trim());return}k.key==="Escape"&&(k.preventDefault(),k.stopPropagation(),m(""),S(!1),y([]),T(-1),O(!1))}}),b&&(h.length>0||D)&&l.jsxs("div",{"data-search-dropdown":"true",style:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"#f9f9f9",border:"1px solid #ccc",borderRadius:"4px",marginTop:"2px",maxHeight:"200px",overflowY:"auto",zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},onMouseDown:k=>{k.preventDefault()},tabIndex:-1,children:[E&&l.jsx("div",{style:{padding:"6px 8px",textAlign:"center",color:"#666",fontSize:"12px"},children:"Searching..."}),!E&&D&&l.jsx("div",{style:{padding:"6px 8px",textAlign:"center",color:"#666",fontSize:"12px"},children:D}),!E&&h.map((k,B)=>{const q=B===j;return l.jsx("div",{style:{padding:"6px 8px",cursor:"pointer",transition:"background-color 0.15s ease",borderBottom:B<h.length-1?"1px solid #eee":"none",backgroundColor:q?"#e3f2fd":"transparent"},onMouseEnter:()=>{T(B),O(!1),k&&k.name&&X(k)},onMouseDown:ge=>{ge.preventDefault()},onClick:ge=>{ge.preventDefault(),_n(k)},children:l.jsx("div",{style:{fontWeight:q?"600":"500",fontSize:"12px",color:q?"#1976d2":"#333"},children:k.name})},`${k.id||k.name}_${B}`)})]})]}),l.jsxs("div",{style:{marginBottom:"15px"},children:[l.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Sort by:"}),l.jsxs("select",{value:sn,onChange:k=>Fn(k.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:"white",fontSize:"14px"},children:[l.jsx("option",{value:"name",children:"A-Z (Name)"}),l.jsx("option",{value:"price",children:"$ - $$$ (Price)"}),l.jsx("option",{value:"color",children:"Color"}),l.jsx("option",{value:"type",children:"Card Type"}),l.jsx("option",{value:"set",children:"Set"})]})]}),l.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"15px"},children:[l.jsx("button",{className:"btn btn-success",style:{flex:1},onClick:an,disabled:Tt,children:Tt?"Saving...":"Save Trade"}),l.jsxs("div",{style:{flex:1,position:"relative"},"data-export-dropdown":!0,children:[l.jsx("button",{className:"btn btn-secondary",style:{width:"100%"},onClick:()=>it(!tn),children:"Export ▼"}),tn&&l.jsxs("div",{style:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"white",border:"1px solid #ddd",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",zIndex:1e3},children:[l.jsx("button",{style:{width:"100%",padding:"10px",border:"none",background:"none",textAlign:"left",cursor:"pointer",borderBottom:"1px solid #eee",color:"#333"},onClick:wt,onMouseEnter:k=>k.target.style.backgroundColor="#f5f5f5",onMouseLeave:k=>k.target.style.backgroundColor="transparent",children:"Export Text"}),l.jsx("button",{style:{width:"100%",padding:"10px",border:"none",background:"none",textAlign:"left",cursor:"pointer",color:"#333"},onClick:kt,onMouseEnter:k=>k.target.style.backgroundColor="#f5f5f5",onMouseLeave:k=>k.target.style.backgroundColor="transparent",children:"Export PDF"})]})]})]})]}),l.jsxs("div",{style:{flex:"1 1 350px",maxWidth:"400px",border:"1px solid #ddd",borderRadius:"8px",padding:"15px",display:"flex",flexDirection:"column"},onDragOver:k=>{k.preventDefault(),k.currentTarget.style.borderColor="#007bff",k.currentTarget.style.backgroundColor="#f8f9ff"},onDragLeave:k=>{k.preventDefault(),k.currentTarget.style.borderColor="#ddd",k.currentTarget.style.backgroundColor="transparent"},onDrop:k=>{k.preventDefault(),k.currentTarget.style.borderColor="#ddd",k.currentTarget.style.backgroundColor="transparent";try{const B=JSON.parse(k.dataTransfer.getData("application/json")),{card:q,sourceUser:ge}=B;if(ge==="user1")return;const ve={...q,assignedTo:"user1"};Tn(ve,"user2")}catch(B){console.error("Error handling drop:",B)}},children:[l.jsx("div",{style:{marginBottom:"15px"},children:en?l.jsx("input",{type:"text","data-name-input":"user1",value:Pe,onChange:k=>rt(k.target.value),onBlur:()=>It(!1),onKeyDown:k=>{k.key==="Enter"&&(k.preventDefault(),k.stopPropagation(),It(!1))},onFocus:k=>k.target.select(),autoFocus:!0,style:{fontSize:"18px",fontWeight:"bold",border:"1px solid #ddd",padding:"5px",backgroundColor:"white",color:"black",borderRadius:"4px"}}):l.jsx("h2",{onClick:()=>It(!0),style:{cursor:"pointer",margin:0},title:"Click to edit name",children:Pe})}),l.jsx("div",{className:"trade-container trade-container-user1",style:{marginBottom:"20px",height:"400px",overflowY:"auto",scrollbarWidth:"none",msOverflowStyle:"none"},children:vt.length===0?l.jsx("div",{style:{color:"#666",fontStyle:"italic",textAlign:"center",marginTop:"50px"},children:"No cards added yet"}):Wt(vt).map((k,B)=>{var ve,$e,be,pe,Se,Ee,ye,Ie,qe,Oe,ft,we;if(k.isSeparator)return l.jsx("div",{style:{borderTop:"1px solid #ddd",margin:"10px 0 5px 0",paddingTop:"5px",fontSize:"11px",fontWeight:"bold",color:"#666",textAlign:"left"},children:k.groupName},k.id);const q=k,ge=(Te==null?void 0:Te.id)===q.id&&(Te==null?void 0:Te.userType)==="user1";return l.jsxs("div",{draggable:!0,style:{display:"flex",alignItems:"center",marginBottom:"5px",cursor:"grab",transition:"all 0.2s ease",border:ge?"1px solid #007bff":"1px solid transparent",backgroundColor:ge?"#e3f2fd":"transparent",borderRadius:ge?"4px 4px 0 0":"4px",padding:ge?"2px":"0",outline:ge?"2px solid #007bff":"none",outlineOffset:ge?"1px":"0",gap:"8px"},onMouseEnter:()=>{var Re,Ue,He,Ct,qt,Ft,ba;const xe={name:q.name,card:q.card||{name:q.name,image_uris:(Re=q.scryfall_json)==null?void 0:Re.image_uris,mana_cost:(Ue=q.scryfall_json)==null?void 0:Ue.mana_cost,type_line:(He=q.scryfall_json)==null?void 0:He.type_line,oracle_text:(Ct=q.scryfall_json)==null?void 0:Ct.oracle_text,power:(qt=q.scryfall_json)==null?void 0:qt.power,toughness:(Ft=q.scryfall_json)==null?void 0:Ft.toughness},scryfall_json:q.scryfall_json,image_uris:(ba=q.scryfall_json)==null?void 0:ba.image_uris,foil:q.foil};X(xe)},onDragStart:xe=>{xe.dataTransfer.setData("application/json",JSON.stringify({card:q,sourceUser:"user1"})),xe.currentTarget.style.cursor="grabbing",xe.currentTarget.style.opacity="0.5"},onDragEnd:xe=>{xe.currentTarget.style.cursor="grab",xe.currentTarget.style.opacity="1"},children:[l.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",cursor:"pointer"},onClick:xe=>{xe.target.closest(".trade-controls")||ot(q,null,"user1",xe)},children:[l.jsx("span",{style:{fontWeight:"bold",color:"#333",minWidth:"20px",fontSize:"11px"},children:q.quantity}),l.jsxs("div",{style:{position:"relative",flex:1,minWidth:"80px"},children:[l.jsx("span",{"data-card-name":"true",onClick:xe=>{xe.stopPropagation(),ot(q,null,"user1",xe)},style:{fontWeight:"bold",color:q.foil?"#d4af37":"#333",fontSize:"11px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer",display:"block"},title:"Click to see other printings",children:q.name}),K[`user1-${q.id}`]&&re[q.name]&&l.jsxs("div",{"data-printing-dropdown":"true",style:{position:"fixed",top:`${(((ve=me[`user1-${q.id}`])==null?void 0:ve.top)||0)-4}px`,left:`${((($e=me[`user1-${q.id}`])==null?void 0:$e.left)||0)-35}px`,width:`${((be=me[`user1-${q.id}`])==null?void 0:be.width)||400}px`,backgroundColor:"white",border:"1px solid #007bff",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",zIndex:9999,maxHeight:"300px",overflowY:"auto"},children:[l.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",cursor:"pointer",backgroundColor:"#e3f2fd",borderBottom:"1px solid #007bff",padding:"0 8px",minHeight:"24px"},children:[l.jsx("span",{style:{fontWeight:"bold",color:"#333",minWidth:"20px",fontSize:"11px"}}),l.jsx("div",{style:{position:"relative",flex:1,minWidth:"80px"},children:l.jsx("span",{style:{fontWeight:"bold",color:"#d4af37",fontSize:"11px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},children:q.name})}),l.jsx("img",{alt:(pe=q.scryfall_json)==null?void 0:pe.set,src:`/svgs/${(Se=q.scryfall_json)==null?void 0:Se.set}.svg`,style:{width:"14px",height:"14px",flexShrink:0},onError:xe=>{if(xe.target.src.includes("/svgs/")){const Re=xe.target.src.split("/").pop().replace(".svg","");xe.target.src=`https://svgs.scryfall.io/sets/${Re}.svg`}else xe.target.style.display="none"}}),l.jsx("span",{style:{fontSize:"11px",color:"#666",flexShrink:0,fontFamily:"monospace",minWidth:"25px",width:"25px"},children:((ye=(Ee=q.scryfall_json)==null?void 0:Ee.set)==null?void 0:ye.toUpperCase())||"UNK"}),l.jsx("span",{style:{fontSize:"11px",color:"#666",flexShrink:0,fontFamily:"monospace",minWidth:"25px"},children:(Ie=q.scryfall_json)==null?void 0:Ie.collector_number}),l.jsx("span",{style:{fontSize:"12px",color:"#059669",fontWeight:"600",flexShrink:0,fontFamily:"monospace",minWidth:"40px",textAlign:"right"},children:q.price?`$${parseFloat(q.price).toFixed(2)}`:"$0.00"})]}),re[q.name].filter(xe=>{var Re;return xe.id!==((Re=q.scryfall_json)==null?void 0:Re.id)}).map((xe,Re)=>{var Ue;return l.jsxs("div",{onClick:He=>{He.stopPropagation(),St(xe,q,"user1")},style:{flex:1,minWidth:0,display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",cursor:"pointer",backgroundColor:"white",borderBottom:Re<re[q.name].filter(He=>{var Ct;return He.id!==((Ct=q.scryfall_json)==null?void 0:Ct.id)}).length-1?"1px solid #eee":"none",padding:"0 8px",minHeight:"24px",transition:"background-color 0.2s ease"},onMouseEnter:He=>{He.target.style.backgroundColor="#f5f5f5",X({...xe,card:xe,scryfall_json:xe,image_uris:xe.image_uris,foil:q.foil})},onMouseLeave:He=>{var Ct;He.target.style.backgroundColor="white",X({...q,card:q.card||q.scryfall_json||q,scryfall_json:q.scryfall_json,image_uris:(Ct=q.scryfall_json)==null?void 0:Ct.image_uris,foil:q.foil})},children:[l.jsx("span",{style:{fontWeight:"bold",color:"#333",minWidth:"20px",fontSize:"11px"}}),l.jsx("div",{style:{position:"relative",flex:1,minWidth:"80px"},children:l.jsx("span",{style:{fontWeight:"bold",color:"#d4af37",fontSize:"11px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},children:xe.name})}),l.jsx("img",{alt:xe.set,src:`/svgs/${xe.set.toLowerCase()}.svg`,style:{width:"14px",height:"14px",flexShrink:0},onError:He=>{if(He.target.src.includes("/svgs/")){const Ct=He.target.src.split("/").pop().replace(".svg","");He.target.src=`https://svgs.scryfall.io/sets/${Ct}.svg`}else He.target.style.display="none"}}),l.jsx("span",{style:{fontSize:"11px",color:"#666",flexShrink:0,fontFamily:"monospace",minWidth:"25px",width:"25px"},children:((Ue=xe.set)==null?void 0:Ue.toUpperCase())||"UNK"}),l.jsx("span",{style:{fontSize:"11px",color:"#666",flexShrink:0,fontFamily:"monospace",minWidth:"25px"},children:xe.collector_number}),l.jsx("span",{style:{fontSize:"12px",color:"#059669",fontWeight:"600",flexShrink:0,fontFamily:"monospace",minWidth:"40px",textAlign:"right"},children:fn(Jt(xe,{fallbackPrice:"0.00"}).price)})]},`${xe.id}-${Re}`)})]})]}),((qe=q.scryfall_json)==null?void 0:qe.set)&&l.jsx("img",{src:`/svgs/${q.scryfall_json.set.toLowerCase()}.svg`,alt:q.scryfall_json.set,style:{width:"14px",height:"14px",flexShrink:0},onError:xe=>{xe.target.style.display="none"}}),l.jsx("span",{style:{fontSize:"11px",color:"#666",flexShrink:0,fontFamily:"monospace",minWidth:"25px",width:"25px"},children:((ft=(Oe=q.scryfall_json)==null?void 0:Oe.set)==null?void 0:ft.toUpperCase())||"UNK"}),((we=q.scryfall_json)==null?void 0:we.collector_number)&&l.jsx("span",{style:{fontSize:"11px",color:"#666",flexShrink:0,fontFamily:"monospace",minWidth:"25px"},children:q.scryfall_json.collector_number}),l.jsx("span",{style:{fontSize:"12px",color:"#059669",fontWeight:"600",flexShrink:0,fontFamily:"monospace",minWidth:"40px",textAlign:"right"},children:fn(Jt(q,{fallbackPrice:"0.00"}).price)})]}),l.jsxs("div",{className:"trade-controls",style:{display:"flex",alignItems:"center",gap:"2px",flexShrink:0},children:[l.jsx("button",{onClick:xe=>{xe.stopPropagation();const Re=Math.max(1,q.quantity-1);pt(Ue=>Ue.map(He=>He.id===q.id?{...He,quantity:Re}:He))},style:{width:"18px",height:"18px",padding:"0",backgroundColor:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",borderRadius:"2px",cursor:"pointer",fontSize:"11px",display:"flex",alignItems:"center",justifyContent:"center",outline:"none"},title:"Decrease quantity",children:"-"}),l.jsx("button",{onClick:xe=>{xe.stopPropagation(),pt(Re=>Re.map(Ue=>Ue.id===q.id?{...Ue,quantity:q.quantity+1}:Ue))},style:{width:"18px",height:"18px",padding:"0",backgroundColor:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",borderRadius:"2px",cursor:"pointer",fontSize:"11px",display:"flex",alignItems:"center",justifyContent:"center",outline:"none"},title:"Increase quantity",children:"+"}),l.jsx("button",{onClick:xe=>{xe.stopPropagation(),Et(q,"user1")},style:{width:"18px",height:"18px",padding:"0",backgroundColor:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",borderRadius:"2px",cursor:"pointer",fontSize:"10px",display:"flex",alignItems:"center",justifyContent:"center",outline:"none"},title:"Duplicate as separate line item",children:"⧉"}),l.jsx("button",{onClick:xe=>{xe.stopPropagation(),pt(Re=>Re.map(Ue=>Ue.id===q.id?{...Ue,foil:!Ue.foil}:Ue))},style:{width:"20px",height:"18px",padding:"0",backgroundColor:q.foil?"#d4af37":"#f3f4f6",color:q.foil?"white":"#374151",border:"1px solid #d1d5db",borderRadius:"2px",cursor:"pointer",fontSize:"9px",display:"flex",alignItems:"center",justifyContent:"center",outline:"none"},title:"Toggle foil",children:"✨"}),l.jsx("button",{onClick:xe=>{xe.stopPropagation(),Kn(q.id,"user1")},style:{width:"18px",height:"18px",padding:"0",backgroundColor:"#dc2626",color:"white",border:"none",borderRadius:"2px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",outline:"none"},title:"Remove card",children:"×"})]})]},q.id)})}),l.jsxs("div",{style:{marginTop:"auto",padding:"10px",backgroundColor:"#f8f9fa",borderRadius:"4px",textAlign:"center",fontWeight:"bold",fontSize:"16px",borderTop:"2px solid #28a745"},children:["Total: ",fn(Je)]})]}),l.jsxs("div",{style:{flex:"1 1 350px",maxWidth:"400px",border:"1px solid #ddd",borderRadius:"8px",padding:"15px",display:"flex",flexDirection:"column"},onDragOver:k=>{k.preventDefault(),k.currentTarget.style.borderColor="#28a745",k.currentTarget.style.backgroundColor="#f8fff9"},onDragLeave:k=>{k.preventDefault(),k.currentTarget.style.borderColor="#ddd",k.currentTarget.style.backgroundColor="transparent"},onDrop:k=>{k.preventDefault(),k.currentTarget.style.borderColor="#ddd",k.currentTarget.style.backgroundColor="transparent";try{const B=JSON.parse(k.dataTransfer.getData("application/json")),{card:q,sourceUser:ge}=B;if(ge==="user2")return;const ve={...q,assignedTo:"user2"};Tn(ve,"user1")}catch(B){console.error("Error handling drop:",B)}},children:[l.jsx("div",{style:{marginBottom:"15px"},children:Rt?l.jsx("input",{type:"text","data-name-input":"user2",value:nt,onChange:k=>_t(k.target.value),onBlur:()=>$n(!1),onKeyDown:k=>{k.key==="Enter"&&(k.preventDefault(),k.stopPropagation(),$n(!1))},onFocus:k=>k.target.select(),autoFocus:!0,style:{fontSize:"18px",fontWeight:"bold",border:"1px solid #ddd",padding:"5px",backgroundColor:"white",color:"black",borderRadius:"4px"}}):l.jsx("h2",{onClick:()=>$n(!0),style:{cursor:"pointer",margin:0},title:"Click to edit name",children:nt})}),l.jsx("div",{className:"trade-container trade-container-user2",style:{marginBottom:"20px",height:"400px",overflowY:"auto",scrollbarWidth:"none",msOverflowStyle:"none"},children:ht.length===0?l.jsx("div",{style:{color:"#666",fontStyle:"italic",textAlign:"center",marginTop:"50px"},children:"No cards added yet"}):Wt(ht).map(k=>{var ge,ve,$e,be,pe,Se,Ee,ye,Ie,qe,Oe,ft;if(k.isSeparator)return l.jsx("div",{style:{borderTop:"1px solid #ddd",margin:"10px 0 5px 0",paddingTop:"5px",fontSize:"11px",fontWeight:"bold",color:"#666",textAlign:"left"},children:k.groupName},k.id);const B=k,q=(Te==null?void 0:Te.id)===B.id&&(Te==null?void 0:Te.userType)==="user2";return l.jsxs("div",{draggable:!0,style:{display:"flex",alignItems:"center",marginBottom:"5px",cursor:"grab",transition:"all 0.2s ease",border:q?"1px solid #007bff":"1px solid transparent",backgroundColor:q?"#e3f2fd":"transparent",borderRadius:q?"4px 4px 0 0":"4px",padding:q?"2px":"0",outline:q?"2px solid #007bff":"none",outlineOffset:q?"1px":"0",gap:"8px"},onMouseEnter:()=>{var xe,Re,Ue,He,Ct,qt,Ft;const we={name:B.name,card:B.card||{name:B.name,image_uris:(xe=B.scryfall_json)==null?void 0:xe.image_uris,mana_cost:(Re=B.scryfall_json)==null?void 0:Re.mana_cost,type_line:(Ue=B.scryfall_json)==null?void 0:Ue.type_line,oracle_text:(He=B.scryfall_json)==null?void 0:He.oracle_text,power:(Ct=B.scryfall_json)==null?void 0:Ct.power,toughness:(qt=B.scryfall_json)==null?void 0:qt.toughness},scryfall_json:B.scryfall_json,image_uris:(Ft=B.scryfall_json)==null?void 0:Ft.image_uris,foil:B.foil};X(we)},onDragStart:we=>{we.dataTransfer.setData("application/json",JSON.stringify({card:B,sourceUser:"user2"})),we.currentTarget.style.cursor="grabbing",we.currentTarget.style.opacity="0.5"},onDragEnd:we=>{we.currentTarget.style.cursor="grab",we.currentTarget.style.opacity="1"},children:[l.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",cursor:"pointer"},onClick:we=>{we.target.closest(".trade-controls")||ot(B,null,"user2",we)},children:[l.jsx("span",{style:{fontWeight:"bold",color:"#333",minWidth:"20px",fontSize:"11px"},children:B.quantity}),l.jsxs("div",{style:{position:"relative",flex:1,minWidth:"80px"},children:[l.jsx("span",{"data-card-name":"true",onClick:we=>{we.stopPropagation(),ot(B,null,"user2",we)},style:{fontWeight:"bold",color:B.foil?"#d4af37":"#333",fontSize:"11px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer",display:"block"},title:"Click to see other printings",children:B.name}),K[`user2-${B.id}`]&&re[B.name]&&l.jsxs("div",{"data-printing-dropdown":"true",style:{position:"fixed",top:`${(((ge=me[`user2-${B.id}`])==null?void 0:ge.top)||0)-4}px`,left:`${(((ve=me[`user2-${B.id}`])==null?void 0:ve.left)||0)-35}px`,width:`${(($e=me[`user2-${B.id}`])==null?void 0:$e.width)||400}px`,backgroundColor:"white",border:"1px solid #007bff",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",zIndex:9999,maxHeight:"300px",overflowY:"auto"},children:[l.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",cursor:"pointer",backgroundColor:"#e3f2fd",borderBottom:"1px solid #007bff",padding:"0 8px",minHeight:"24px"},children:[l.jsx("span",{style:{fontWeight:"bold",color:"#333",minWidth:"20px",fontSize:"11px"}}),l.jsx("div",{style:{position:"relative",flex:1,minWidth:"80px"},children:l.jsx("span",{style:{fontWeight:"bold",color:"#d4af37",fontSize:"11px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},children:B.name})}),l.jsx("img",{alt:(be=B.scryfall_json)==null?void 0:be.set,src:`/svgs/${(pe=B.scryfall_json)==null?void 0:pe.set}.svg`,style:{width:"14px",height:"14px",flexShrink:0},onError:we=>{if(we.target.src.includes("/svgs/")){const xe=we.target.src.split("/").pop().replace(".svg","");we.target.src=`https://svgs.scryfall.io/sets/${xe}.svg`}else we.target.style.display="none"}}),l.jsx("span",{style:{fontSize:"11px",color:"#666",flexShrink:0,fontFamily:"monospace",minWidth:"25px",width:"25px"},children:((Ee=(Se=B.scryfall_json)==null?void 0:Se.set)==null?void 0:Ee.toUpperCase())||"UNK"}),l.jsx("span",{style:{fontSize:"11px",color:"#666",flexShrink:0,fontFamily:"monospace",minWidth:"25px"},children:(ye=B.scryfall_json)==null?void 0:ye.collector_number}),l.jsx("span",{style:{fontSize:"12px",color:"#059669",fontWeight:"600",flexShrink:0,fontFamily:"monospace",minWidth:"40px",textAlign:"right"},children:B.price?`$${parseFloat(B.price).toFixed(2)}`:"$0.00"})]}),re[B.name].filter(we=>{var xe;return we.id!==((xe=B.scryfall_json)==null?void 0:xe.id)}).map((we,xe)=>{var Re;return l.jsxs("div",{onClick:Ue=>{Ue.stopPropagation(),St(we,B,"user2")},style:{flex:1,minWidth:0,display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",cursor:"pointer",backgroundColor:"white",borderBottom:xe<re[B.name].filter(Ue=>{var He;return Ue.id!==((He=B.scryfall_json)==null?void 0:He.id)}).length-1?"1px solid #eee":"none",padding:"0 8px",minHeight:"24px",transition:"background-color 0.2s ease"},onMouseEnter:Ue=>{Ue.target.style.backgroundColor="#f5f5f5",X({...we,card:we,scryfall_json:we,image_uris:we.image_uris,foil:B.foil})},onMouseLeave:Ue=>{var He;Ue.target.style.backgroundColor="white",X({...B,card:B.card||B.scryfall_json||B,scryfall_json:B.scryfall_json,image_uris:(He=B.scryfall_json)==null?void 0:He.image_uris,foil:B.foil})},children:[l.jsx("span",{style:{fontWeight:"bold",color:"#333",minWidth:"20px",fontSize:"11px"}}),l.jsx("div",{style:{position:"relative",flex:1,minWidth:"80px"},children:l.jsx("span",{style:{fontWeight:"bold",color:"#d4af37",fontSize:"11px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},children:we.name})}),l.jsx("img",{alt:we.set,src:`/svgs/${we.set.toLowerCase()}.svg`,style:{width:"14px",height:"14px",flexShrink:0},onError:Ue=>{if(Ue.target.src.includes("/svgs/")){const He=Ue.target.src.split("/").pop().replace(".svg","");Ue.target.src=`https://svgs.scryfall.io/sets/${He}.svg`}else Ue.target.style.display="none"}}),l.jsx("span",{style:{fontSize:"11px",color:"#666",flexShrink:0,fontFamily:"monospace",minWidth:"25px",width:"25px"},children:((Re=we.set)==null?void 0:Re.toUpperCase())||"UNK"}),l.jsx("span",{style:{fontSize:"11px",color:"#666",flexShrink:0,fontFamily:"monospace",minWidth:"25px"},children:we.collector_number}),l.jsx("span",{style:{fontSize:"12px",color:"#059669",fontWeight:"600",flexShrink:0,fontFamily:"monospace",minWidth:"40px",textAlign:"right"},children:fn(Jt(we,{fallbackPrice:"0.00"}).price)})]},`${we.id}-${xe}`)})]})]}),((Ie=B.scryfall_json)==null?void 0:Ie.set)&&l.jsx("img",{src:`/svgs/${B.scryfall_json.set.toLowerCase()}.svg`,alt:B.scryfall_json.set,style:{width:"14px",height:"14px",flexShrink:0},onError:we=>{we.target.style.display="none"}}),l.jsx("span",{style:{fontSize:"11px",color:"#666",flexShrink:0,fontFamily:"monospace",minWidth:"25px",width:"25px"},children:((Oe=(qe=B.scryfall_json)==null?void 0:qe.set)==null?void 0:Oe.toUpperCase())||"UNK"}),((ft=B.scryfall_json)==null?void 0:ft.collector_number)&&l.jsx("span",{style:{fontSize:"11px",color:"#666",flexShrink:0,fontFamily:"monospace",minWidth:"25px"},children:B.scryfall_json.collector_number}),l.jsx("span",{style:{fontSize:"12px",color:"#059669",fontWeight:"600",flexShrink:0,fontFamily:"monospace",minWidth:"40px",textAlign:"right"},children:fn(Jt(B,{fallbackPrice:"0.00"}).price)})]}),l.jsxs("div",{className:"trade-controls",style:{display:"flex",alignItems:"center",gap:"2px",flexShrink:0},children:[l.jsx("button",{onClick:we=>{we.stopPropagation();const xe=Math.max(1,B.quantity-1);Nt(Re=>Re.map(Ue=>Ue.id===B.id?{...Ue,quantity:xe}:Ue))},style:{width:"18px",height:"18px",padding:"0",backgroundColor:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",borderRadius:"2px",cursor:"pointer",fontSize:"11px",display:"flex",alignItems:"center",justifyContent:"center",outline:"none"},title:"Decrease quantity",children:"-"}),l.jsx("button",{onClick:we=>{we.stopPropagation(),Nt(xe=>xe.map(Re=>Re.id===B.id?{...Re,quantity:B.quantity+1}:Re))},style:{width:"18px",height:"18px",padding:"0",backgroundColor:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",borderRadius:"2px",cursor:"pointer",fontSize:"11px",display:"flex",alignItems:"center",justifyContent:"center",outline:"none"},title:"Increase quantity",children:"+"}),l.jsx("button",{onClick:we=>{we.stopPropagation(),Et(B,"user2")},style:{width:"18px",height:"18px",padding:"0",backgroundColor:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db",borderRadius:"2px",cursor:"pointer",fontSize:"10px",display:"flex",alignItems:"center",justifyContent:"center",outline:"none"},title:"Duplicate as separate line item",children:"⧉"}),l.jsx("button",{onClick:we=>{we.stopPropagation(),Nt(xe=>xe.map(Re=>Re.id===B.id?{...Re,foil:!Re.foil}:Re))},style:{width:"20px",height:"18px",padding:"0",backgroundColor:B.foil?"#d4af37":"#f3f4f6",color:B.foil?"white":"#374151",border:"1px solid #d1d5db",borderRadius:"2px",cursor:"pointer",fontSize:"9px",display:"flex",alignItems:"center",justifyContent:"center",outline:"none"},title:"Toggle foil",children:"✨"}),l.jsx("button",{onClick:we=>{we.stopPropagation(),Kn(B.id,"user2")},style:{width:"18px",height:"18px",padding:"0",backgroundColor:"#dc2626",color:"white",border:"none",borderRadius:"2px",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center",outline:"none"},title:"Remove card",children:"×"})]})]},B.id)})}),l.jsxs("div",{style:{marginTop:"auto",padding:"10px",backgroundColor:"#f8f9fa",borderRadius:"4px",textAlign:"center",fontWeight:"bold",fontSize:"16px",borderTop:"2px solid #dc3545"},children:["Total: ",fn(Ne)]})]})]}),l.jsx(eS,{isOpen:U,onClose:et,card:C,onAddCard:Ae,onUpdateCard:Tn}),ee&&l.jsx("div",{"data-search-modal":"true",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:1e4,display:"flex",justifyContent:"center",alignItems:"center",padding:"20px",outline:"none"},onClick:k=>{k.target===k.currentTarget&&oe(!1)},onKeyDown:k=>{k.key==="Escape"&&oe(!1)},tabIndex:0,children:l.jsxs("div",{style:{backgroundColor:"white",borderRadius:"8px",width:"90%",maxWidth:"1200px",height:"80%",maxHeight:"800px",display:"flex",flexDirection:"column",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.2)"},onClick:k=>k.stopPropagation(),children:[l.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #eee",position:"relative"},children:[l.jsx("button",{onClick:()=>oe(!1),style:{position:"absolute",top:"10px",right:"10px",width:"30px",height:"30px",borderRadius:"50%",border:"none",backgroundColor:"#f5f5f5",color:"#666",fontSize:"18px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},onMouseEnter:k=>{k.target.style.backgroundColor="#e0e0e0",k.target.style.color="#333"},onMouseLeave:k=>{k.target.style.backgroundColor="#f5f5f5",k.target.style.color="#666"},children:"×"}),l.jsxs("h3",{style:{margin:0,marginBottom:"10px",color:"#333"},children:['Search Results for "',R,'"']}),l.jsx("div",{style:{marginTop:"10px"},children:l.jsx("input",{type:"text",placeholder:"Search for cards...",value:p,onChange:k=>m(k.target.value),onKeyDown:k=>{k.key==="Enter"&&p.trim()&&(M(p.trim()),p.trim()&&Cn.current(p))},style:{width:"100%",padding:"8px 12px",border:"2px solid #ddd",borderRadius:"4px",fontSize:"16px",outline:"none",transition:"border-color 0.2s ease",backgroundColor:"white",color:"#333"},onFocus:k=>{k.target.style.borderColor="#007bff"},onBlur:k=>{k.target.style.borderColor="#ddd"},autoFocus:!0})})]}),l.jsx("div",{style:{flex:1,padding:"20px",overflowY:"auto"},children:he?l.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",fontSize:"16px",color:"#666"},children:"Loading search results..."}):G.length>0?l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{marginBottom:"16px",fontSize:"14px",color:"#666"},children:["Found ",G.length," result",G.length!==1?"s":""]}),l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(240px, 240px))",gap:"20px",justifyContent:"center"},children:G.map((k,B)=>l.jsxs("div",{style:{border:"1px solid #ddd",borderRadius:"8px",padding:"12px",backgroundColor:"#fafafa",transition:"all 0.2s ease",display:"flex",flexDirection:"column",alignItems:"center",cursor:"pointer"},onMouseEnter:q=>{q.currentTarget.style.borderColor="#1976d2",q.currentTarget.style.boxShadow="0 2px 8px rgba(25, 118, 210, 0.15)",q.currentTarget.style.backgroundColor="#f8fbff"},onMouseLeave:q=>{q.currentTarget.style.borderColor="#ddd",q.currentTarget.style.boxShadow="none",q.currentTarget.style.backgroundColor="#fafafa"},onClick:q=>{q.target.closest(".add-card-buttons")||(I(k),A(!0),oe(!1))},children:[l.jsx("div",{style:{width:"100%",height:"240px",display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"12px"},children:l.jsx("img",{src:`https://cards.scryfall.io/normal/front/${(k.id||k.scryfall_id)[0]}/${(k.id||k.scryfall_id)[1]}/${k.id||k.scryfall_id}.jpg`,alt:k.name,style:{maxWidth:"100%",maxHeight:"100%",borderRadius:"8px",objectFit:"contain"},onError:q=>{var ve,$e;const ge=((ve=k.image_uris)==null?void 0:ve.normal)||(($e=k.image_uris)==null?void 0:$e.small);ge&&q.target.src!==ge?q.target.src=ge:q.target.style.display="none"}})}),l.jsx("div",{style:{fontWeight:"bold",fontSize:"16px",textAlign:"center",color:"#333",lineHeight:"1.3",marginBottom:"12px",padding:"0 8px"},children:k.name}),l.jsxs("div",{className:"add-card-buttons",style:{display:"flex",gap:"8px",width:"100%",justifyContent:"space-between"},children:[l.jsx("button",{onClick:q=>{q.stopPropagation(),xa(k)},style:{flex:1,padding:"8px 12px",backgroundColor:"#1976d2",color:"white",border:"none",borderRadius:"4px",fontSize:"12px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:q=>{q.target.style.backgroundColor="#1565c0"},onMouseLeave:q=>{q.target.style.backgroundColor="#1976d2"},children:"Add to Me"}),l.jsx("button",{onClick:q=>{q.stopPropagation(),Fa(k)},style:{flex:1,padding:"8px 12px",backgroundColor:"#dc004e",color:"white",border:"none",borderRadius:"4px",fontSize:"12px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:q=>{q.target.style.backgroundColor="#c2185b"},onMouseLeave:q=>{q.target.style.backgroundColor="#dc004e"},children:"Add to Pal"})]})]},`${k.scryfall_id||k.id}-${B}`))})]}):l.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",fontSize:"16px",color:"#666"},children:['No cards found for "',R,'"']})})]})})]})};function tS(){const[a,r]=v.useState([]),[s,i]=v.useState(!0),[d,f]=v.useState(0);v.useEffect(()=>{try{const S=localStorage.getItem("shoppingCart");if(S){const E=JSON.parse(S);r(E),g(E)}}catch(S){console.error("Error loading shopping cart:",S),ce.error("Error loading shopping cart")}finally{i(!1)}},[]);const g=S=>{const E=S.reduce((_,j)=>{const T=parseFloat(j.price)||0,N=parseInt(j.quantity)||1;return _+T*N},0);f(E)},p=S=>{try{localStorage.setItem("shoppingCart",JSON.stringify(S)),r(S),g(S),window.dispatchEvent(new CustomEvent("cartUpdated"))}catch(E){console.error("Error saving shopping cart:",E),ce.error("Error saving shopping cart")}},m=S=>{const E=a.filter(_=>_.id!==S);p(E),ce.success("Item removed from shopping cart")},h=(S,E)=>{if(E<=0){m(S);return}const _=a.map(j=>j.id===S?{...j,quantity:E}:j);p(_)},y=()=>{a.length!==0&&window.confirm("Are you sure you want to clear your entire shopping cart?")&&(p([]),ce.success("Shopping cart cleared"))},b=S=>(parseFloat(S)||0).toFixed(2);return s?l.jsx("div",{className:"container",style:{padding:"40px 20px"},children:l.jsxs("div",{style:{textAlign:"center"},children:[l.jsx("div",{style:{width:"40px",height:"40px",border:"4px solid #e2e8f0",borderTop:"4px solid #6366f1",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 16px"}}),l.jsx("p",{children:"Loading shopping cart..."})]})}):l.jsxs("div",{className:"container",style:{padding:"40px 20px",maxWidth:"1200px",margin:"0 auto"},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px",borderBottom:"2px solid #e5e7eb",paddingBottom:"16px"},children:[l.jsxs("div",{children:[l.jsx("h1",{style:{margin:"0 0 8px 0",fontSize:"28px",fontWeight:"700",color:"#1e293b"},children:"🛒 Shopping Cart"}),l.jsx("p",{style:{margin:0,color:"#64748b",fontSize:"16px"},children:"Track cards you want to buy someday"})]}),a.length>0&&l.jsxs("div",{style:{textAlign:"right"},children:[l.jsxs("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669",marginBottom:"8px"},children:["Total: $",b(d)]}),l.jsx("button",{onClick:y,style:{background:"#dc2626",color:"white",border:"none",padding:"8px 16px",borderRadius:"6px",fontSize:"14px",cursor:"pointer",transition:"background-color 0.2s ease"},onMouseEnter:S=>S.target.style.backgroundColor="#b91c1c",onMouseLeave:S=>S.target.style.backgroundColor="#dc2626",children:"Clear Cart"})]})]}),a.length===0?l.jsxs("div",{style:{textAlign:"center",padding:"80px 20px",color:"#64748b"},children:[l.jsx("div",{style:{fontSize:"64px",marginBottom:"16px"},children:"🛒"}),l.jsx("h2",{style:{margin:"0 0 12px 0",color:"#374151"},children:"Your shopping cart is empty"}),l.jsx("p",{style:{margin:"0 0 24px 0",fontSize:"16px"},children:"Add cards from search results to start building your wishlist!"}),l.jsxs("div",{style:{background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"8px",padding:"16px",maxWidth:"500px",margin:"0 auto",textAlign:"left"},children:[l.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:"16px",color:"#374151"},children:"How to add cards:"}),l.jsxs("ol",{style:{margin:0,paddingLeft:"20px",color:"#64748b"},children:[l.jsx("li",{children:"Go to any deck and search for cards"}),l.jsx("li",{children:'Click "Show all results" to open the search modal'}),l.jsx("li",{children:'Click "Add to Shopping Cart" on any card'}),l.jsx("li",{children:"Come back here to track your wishlist!"})]})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",marginBottom:"32px"},children:[l.jsxs("div",{style:{background:"#f0f9ff",border:"1px solid #bae6fd",borderRadius:"8px",padding:"16px",textAlign:"center"},children:[l.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#0369a1"},children:a.length}),l.jsx("div",{style:{fontSize:"14px",color:"#0369a1"},children:"Unique Cards"})]}),l.jsxs("div",{style:{background:"#f0fdf4",border:"1px solid #bbf7d0",borderRadius:"8px",padding:"16px",textAlign:"center"},children:[l.jsx("div",{style:{fontSize:"24px",fontWeight:"700",color:"#059669"},children:a.reduce((S,E)=>S+parseInt(E.quantity||1),0)}),l.jsx("div",{style:{fontSize:"14px",color:"#059669"},children:"Total Quantity"})]}),l.jsxs("div",{style:{background:"#fefce8",border:"1px solid #fde047",borderRadius:"8px",padding:"16px",textAlign:"center"},children:[l.jsxs("div",{style:{fontSize:"24px",fontWeight:"700",color:"#ca8a04"},children:["$",b(d)]}),l.jsx("div",{style:{fontSize:"14px",color:"#ca8a04"},children:"Estimated Total"})]})]}),l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"20px"},children:a.map(S=>l.jsxs("div",{style:{background:"white",border:"1px solid #e5e7eb",borderRadius:"12px",overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",transition:"all 0.2s ease"},onMouseEnter:E=>{E.currentTarget.style.transform="translateY(-2px)",E.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.15)"},onMouseLeave:E=>{E.currentTarget.style.transform="translateY(0)",E.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.1)"},children:[S.image_url&&l.jsx("div",{style:{width:"100%",aspectRatio:"5/7",backgroundImage:`url(${S.image_url})`,backgroundSize:"cover",backgroundPosition:"center",cursor:"zoom-in"},onClick:()=>window.open(S.image_url,"_blank"),title:"Click to view larger"}),l.jsxs("div",{style:{padding:"16px"},children:[l.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"16px",fontWeight:"600",color:"#1e293b",lineHeight:"1.3"},children:S.name}),S.set_name&&l.jsx("div",{style:{fontSize:"13px",color:"#64748b",marginBottom:"4px"},children:S.set_name}),S.type_line&&l.jsx("div",{style:{fontSize:"13px",color:"#64748b",marginBottom:"12px"},children:S.type_line}),l.jsxs("div",{style:{fontSize:"14px",color:"#059669",fontWeight:"600",marginBottom:"12px"},children:["$",b(S.price)," each"]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[l.jsx("label",{style:{fontSize:"14px",color:"#374151",fontWeight:"500"},children:"Qty:"}),l.jsx("button",{onClick:()=>h(S.id,(S.quantity||1)-1),style:{background:"#f3f4f6",border:"1px solid #d1d5db",borderRadius:"4px",width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"16px",fontWeight:"600"},children:"−"}),l.jsx("span",{style:{minWidth:"24px",textAlign:"center",fontSize:"14px",fontWeight:"600"},children:S.quantity||1}),l.jsx("button",{onClick:()=>h(S.id,(S.quantity||1)+1),style:{background:"#f3f4f6",border:"1px solid #d1d5db",borderRadius:"4px",width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"16px",fontWeight:"600"},children:"+"}),l.jsxs("div",{style:{marginLeft:"auto",fontSize:"14px",color:"#374151",fontWeight:"600"},children:["$",b(parseFloat(S.price||0)*parseInt(S.quantity||1))]})]}),l.jsx("button",{onClick:()=>m(S.id),style:{background:"#fef2f2",color:"#dc2626",border:"1px solid #fecaca",padding:"8px 12px",borderRadius:"6px",fontSize:"13px",cursor:"pointer",width:"100%",transition:"all 0.2s ease"},onMouseEnter:E=>{E.target.style.backgroundColor="#fee2e2",E.target.style.borderColor="#fca5a5"},onMouseLeave:E=>{E.target.style.backgroundColor="#fef2f2",E.target.style.borderColor="#fecaca"},children:"Remove from Cart"})]})]},S.id))})]})]})}function nS(){const[a,r]=v.useState([]),[s,i]=v.useState(!0),[d,f]=v.useState(0),[g,p]=v.useState("none");v.useEffect(()=>{try{const T=localStorage.getItem("global-wishlist");if(T){const N=JSON.parse(T);r(N),m(N)}}catch(T){console.error("Error loading wishlist:",T),ce.error("Error loading wishlist")}finally{i(!1)}},[]),v.useEffect(()=>{const T=N=>{const O=N.detail;r(O),m(O)};return window.addEventListener("wishlistUpdated",T),()=>window.removeEventListener("wishlistUpdated",T)},[]);const m=T=>{const N=T.reduce((O,D)=>{var V,H;const L=parseFloat((H=(V=D.cardObj)==null?void 0:V.prices)==null?void 0:H.usd)||0,$=parseInt(D.count)||1;return O+L*$},0);f(N)},h=T=>{try{localStorage.setItem("global-wishlist",JSON.stringify(T)),r(T),m(T),window.dispatchEvent(new CustomEvent("wishlistUpdated",{detail:T}))}catch(N){console.error("Error saving wishlist:",N),ce.error("Error saving wishlist")}},y=T=>{const N=a.filter(O=>O.printing!==T);h(N),ce.success("Item removed from wishlist")},b=(T,N)=>{if(N<=0){y(T);return}const O=a.map(D=>D.printing===T?{...D,count:N}:D);h(O)},S=()=>{a.length!==0&&window.confirm("Are you sure you want to clear your entire wishlist?")&&(h([]),ce.success("Wishlist cleared"))},E=T=>(parseFloat(T)||0).toFixed(2),_=()=>{if(g==="none")return{"All Cards":a};const T={};return a.forEach(N=>{var D,L,$,V,H;let O="Other";if(g==="type"){const C=((D=N.cardObj)==null?void 0:D.type_line)||"";C.includes("Creature")?O="Creatures":C.includes("Instant")?O="Instants":C.includes("Sorcery")?O="Sorceries":C.includes("Enchantment")?O="Enchantments":C.includes("Artifact")?O="Artifacts":C.includes("Planeswalker")?O="Planeswalkers":C.includes("Land")&&(O="Lands")}else g==="set"?O=((L=N.cardObj)==null?void 0:L.set_name)||((V=($=N.cardObj)==null?void 0:$.set)==null?void 0:V.toUpperCase())||"Unknown Set":g==="cmc"&&(O=`${((H=N.cardObj)==null?void 0:H.cmc)||0} CMC`);T[O]||(T[O]=[]),T[O].push(N)}),T};if(s)return l.jsx("div",{className:"container",style:{padding:"40px 20px"},children:l.jsxs("div",{style:{textAlign:"center"},children:[l.jsx("div",{style:{width:"40px",height:"40px",border:"4px solid #e2e8f0",borderTop:"4px solid #6366f1",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 16px"}}),l.jsx("p",{children:"Loading wishlist..."})]})});const j=_();return l.jsxs("div",{className:"container",style:{padding:"20px",maxWidth:"1200px"},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",flexWrap:"wrap",gap:"10px"},children:[l.jsx("h1",{style:{margin:0,color:"#1f2937"},children:"My Wishlist"}),l.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center",flexWrap:"wrap"},children:[l.jsx("label",{htmlFor:"groupBy",style:{fontSize:"14px",color:"#6b7280"},children:"Group by:"}),l.jsxs("select",{id:"groupBy",value:g,onChange:T=>p(T.target.value),style:{padding:"6px 10px",borderRadius:"4px",border:"1px solid #d1d5db",fontSize:"14px"},children:[l.jsx("option",{value:"none",children:"None"}),l.jsx("option",{value:"type",children:"Card Type"}),l.jsx("option",{value:"set",children:"Set"}),l.jsx("option",{value:"cmc",children:"Mana Cost"})]}),a.length>0&&l.jsx("button",{onClick:S,style:{backgroundColor:"#ef4444",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",fontSize:"14px",cursor:"pointer"},children:"Clear Wishlist"})]})]}),a.length===0?l.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",backgroundColor:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[l.jsx("h3",{style:{color:"#6b7280",marginBottom:"12px"},children:"Your wishlist is empty"}),l.jsx("p",{style:{color:"#9ca3af",marginBottom:"20px"},children:"Add cards from deck builders or search results to start building your wishlist!"}),l.jsx("p",{style:{color:"#9ca3af",fontSize:"14px"},children:'Use the "Add to Wishlist" button when viewing cards to save them here.'})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{style:{padding:"16px",backgroundColor:"#f3f4f6",borderRadius:"8px",marginBottom:"20px"},children:l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[l.jsxs("span",{style:{fontWeight:"bold",color:"#374151"},children:["Total Items: ",a.reduce((T,N)=>T+N.count,0)]}),l.jsxs("span",{style:{fontWeight:"bold",color:"#374151"},children:["Est. Total Value: $",E(d)]})]})}),Object.entries(j).map(([T,N])=>l.jsxs("div",{style:{marginBottom:"30px"},children:[g!=="none"&&l.jsxs("h3",{style:{color:"#374151",borderBottom:"2px solid #e5e7eb",paddingBottom:"8px",marginBottom:"16px"},children:[T," (",N.length," cards)"]}),l.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:"16px"},children:N.map(O=>{var D,L,$,V,H,C,I,U,A;return l.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:"8px",padding:"16px",backgroundColor:"white",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[l.jsxs("div",{style:{flex:1},children:[l.jsx("h4",{style:{margin:"0 0 8px 0",color:"#1f2937"},children:O.name}),l.jsxs("p",{style:{margin:"0 0 8px 0",fontSize:"14px",color:"#6b7280"},children:[((D=O.cardObj)==null?void 0:D.set_name)||(($=(L=O.cardObj)==null?void 0:L.set)==null?void 0:$.toUpperCase()),((V=O.cardObj)==null?void 0:V.collector_number)&&` #${O.cardObj.collector_number}`]}),l.jsx("p",{style:{margin:"0 0 12px 0",fontSize:"14px",color:"#9ca3af"},children:(H=O.cardObj)==null?void 0:H.type_line}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Qty:"}),l.jsx("input",{type:"number",value:O.count,min:"1",max:"999",onChange:ee=>b(O.printing,parseInt(ee.target.value)),style:{width:"60px",padding:"4px 8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]}),l.jsxs("div",{style:{fontSize:"16px",fontWeight:"bold",color:"#059669"},children:["$",E(((I=(C=O.cardObj)==null?void 0:C.prices)==null?void 0:I.usd)||"0")]})]})]}),l.jsx("button",{onClick:()=>y(O.printing),style:{backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"4px",padding:"6px 12px",fontSize:"12px",cursor:"pointer",marginLeft:"12px"},children:"Remove"})]}),((A=(U=O.cardObj)==null?void 0:U.image_uris)==null?void 0:A.small)&&l.jsx("div",{style:{marginTop:"12px",textAlign:"center"},children:l.jsx("img",{src:O.cardObj.image_uris.small,alt:O.name,style:{maxWidth:"100px",height:"auto",borderRadius:"4px",border:"1px solid #e5e7eb"}})})]},`${O.printing}-${O.name}`)})})]},T))]})]})}const aS=()=>{const[a,r]=v.useState({browser:"Unknown",platform:"Unknown",online:!1,localStorage:!1,sessionStorage:!1,cookies:!1,apiConnection:"Untested"}),[s,i]=v.useState([]),[d,f]=v.useState(!1),g=(h,y,b)=>{i(S=>[...S,{test:h,status:y,message:b,timestamp:new Date().toISOString()}])},p=async()=>{var y;f(!0),i([]),g("Starting diagnostics","info","Beginning comprehensive network and browser tests...");const h={userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,isBrave:!!(navigator.brave&&navigator.brave.isBrave)};g("Browser Detection","info",JSON.stringify(h,null,2));try{localStorage.setItem("test","test"),localStorage.removeItem("test"),g("localStorage","success","localStorage is working")}catch(b){g("localStorage","error",`localStorage failed: ${b.message}`)}try{sessionStorage.setItem("test","test"),sessionStorage.removeItem("test"),g("sessionStorage","success","sessionStorage is working")}catch(b){g("sessionStorage","error",`sessionStorage failed: ${b.message}`)}try{const b="https://constant-lists-api.onrender.com";g("API URL","info",`Testing connection to: ${b}`);const S=await fetch(`${b}/api/health`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"omit"});if(S.ok){const E=await S.text();g("API Connection","success",`Server responded: ${S.status} - ${E}`)}else g("API Connection","warning",`Server responded with ${S.status}: ${S.statusText}`)}catch(b){g("API Connection","error",`Network error: ${b.message}`)}try{const b="https://constant-lists-api.onrender.com";g("Auth Test","info","Testing authentication endpoint...");const S=await fetch(`${b}/api/auth/debug-users`,{method:"GET",headers:{"Content-Type":"application/json"}});if(S.ok){const E=await S.json();g("Auth Endpoint","success",`Auth endpoint accessible. Users in DB: ${((y=E.users)==null?void 0:y.length)||0}`)}else g("Auth Endpoint","warning",`Auth endpoint responded with ${S.status}`)}catch(b){g("Auth Endpoint","error",`Auth endpoint error: ${b.message}`)}try{g("CORS Test","info","Testing CORS policy...");const S=await fetch("https://constant-lists-api.onrender.com/api/health",{method:"OPTIONS"});g("CORS Test","success","CORS preflight successful")}catch(b){g("CORS Test","error",`CORS error: ${b.message}`)}if(navigator.connection){const b=navigator.connection;g("Connection Quality","info",JSON.stringify({effectiveType:b.effectiveType,downlink:b.downlink,rtt:b.rtt,saveData:b.saveData},null,2))}else g("Connection Quality","warning","Connection API not available");f(!1),g("Diagnostics Complete","success","All tests completed. Share these results with support.")},m=()=>{const h={timestamp:new Date().toISOString(),browser:navigator.userAgent,platform:navigator.platform,tests:s},y=new Blob([JSON.stringify(h,null,2)],{type:"application/json"}),b=URL.createObjectURL(y),S=document.createElement("a");S.href=b,S.download=`network-diagnostics-${Date.now()}.json`,document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(b)};return l.jsxs("div",{style:{padding:"20px",maxWidth:"800px",margin:"0 auto"},children:[l.jsx("h1",{children:"🔧 Network Diagnostics"}),l.jsx("p",{children:"This page helps diagnose login and network issues, especially for Windows 11/Brave browser users."}),l.jsxs("div",{style:{marginBottom:"20px"},children:[l.jsx("button",{onClick:p,disabled:d,style:{padding:"10px 20px",backgroundColor:d?"#ccc":"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:d?"not-allowed":"pointer",marginRight:"10px"},children:d?"Running Tests...":"Run Diagnostics"}),s.length>0&&l.jsx("button",{onClick:m,style:{padding:"10px 20px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Export Results"})]}),s.length>0&&l.jsxs("div",{style:{backgroundColor:"#f8f9fa",border:"1px solid #dee2e6",borderRadius:"4px",padding:"20px",maxHeight:"600px",overflowY:"auto"},children:[l.jsx("h3",{children:"Test Results:"}),s.map((h,y)=>l.jsxs("div",{style:{padding:"10px",marginBottom:"10px",borderLeft:`4px solid ${h.status==="success"?"#28a745":h.status==="error"?"#dc3545":h.status==="warning"?"#ffc107":"#17a2b8"}`,backgroundColor:"white",borderRadius:"0 4px 4px 0"},children:[l.jsx("div",{style:{fontWeight:"bold",color:h.status==="success"?"#155724":h.status==="error"?"#721c24":h.status==="warning"?"#856404":"#0c5460"},children:h.test}),l.jsx("div",{style:{marginTop:"5px",fontSize:"14px",fontFamily:"monospace",whiteSpace:"pre-wrap"},children:h.message})]},y))]}),l.jsxs("div",{style:{marginTop:"30px"},children:[l.jsx("h3",{children:"Manual Steps for Brave Browser:"}),l.jsxs("ol",{children:[l.jsxs("li",{children:[l.jsx("strong",{children:"Disable Shields:"}),' Click the Brave shield icon and turn off "Shields"']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Allow All Cookies:"}),' Settings → Privacy → Cookies → "Allow all cookies"']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Disable Strict Site Isolation:"}),' brave://flags/#site-isolation-trial-opt-out → "Disabled"']}),l.jsxs("li",{children:[l.jsx("strong",{children:"Clear Site Data:"})," Settings → Additional Settings → Privacy → Clear browsing data"]}),l.jsxs("li",{children:[l.jsx("strong",{children:"Try Incognito Mode:"})," Open the site in a private window"]})]})]})]})},sh=ke.lazy(()=>Qn(()=>import("./DeckViewEdit-BphapFfS.js"),__vite__mapDeps([2,3,1,4,5,6])));function rS(){return l.jsxs("div",{className:"container",children:[l.jsx("h1",{children:"Constant Lists"}),l.jsx("p",{children:"Welcome to Constant Lists! This is your Magic: The Gathering deck-building and collection hub."}),l.jsxs("ul",{children:[l.jsx("li",{children:"Research cards"}),l.jsx("li",{children:"Build and manage decks"}),l.jsx("li",{children:"Track your collection"}),l.jsx("li",{children:"Advanced security and privacy features"})]})]})}function oS(){const a=ma(),[r,s]=v.useState(null);return v.useEffect(()=>{const d=new URLSearchParams(window.location.search).get("token");s(d),d&&(localStorage.setItem("token",d),setTimeout(()=>a("/profile"),2e3))},[]),l.jsxs("div",{className:"container",children:[l.jsx("h2",{children:"OAuth Success Debug"}),l.jsxs("div",{children:["Token: ",r||"No token found in URL params"]}),l.jsx("div",{children:r?"Redirecting to profile in 2 seconds...":"Waiting for token..."})]})}function sS(){console.log("App loaded"),v.useEffect(()=>{const s=setTimeout(()=>{Jr.preloadCommonCards().catch(i=>{console.warn("[App] Background preload of common cards failed (non-critical):",i)})},1e3);return()=>clearTimeout(s)},[]),v.useEffect(()=>{const s=i=>{if(i.key===" "||i.key==="Spacebar"){const d=document.activeElement;d&&(d.tagName==="INPUT"||d.tagName==="TEXTAREA"||d.tagName==="SELECT"||d.isContentEditable)||i.preventDefault()}};return window.addEventListener("keydown",s,{capture:!0}),()=>window.removeEventListener("keydown",s,{capture:!0})},[]);const[a,r]=v.useState(0);return l.jsxs(l0,{children:[l.jsx(px,{}),l.jsxs("div",{className:"content-container",children:[l.jsxs(i0,{children:[l.jsx(xt,{path:"/",element:l.jsx(c0,{to:"/home",replace:!0})}),l.jsx(xt,{path:"/home",element:l.jsx(rS,{})}),l.jsx(xt,{path:"/research",element:l.jsx(Cx,{})}),l.jsx(xt,{path:"/build",element:l.jsx(Nx,{})}),l.jsx(xt,{path:"/collect",element:l.jsx(as,{children:l.jsx(G1,{})})}),l.jsx(xt,{path:"/trade",element:l.jsx(W1,{})}),l.jsx(xt,{path:"/trade/new",element:l.jsx(oh,{isNew:!0})}),l.jsx(xt,{path:"/trades/:tradeId",element:l.jsx(oh,{})}),l.jsx(xt,{path:"/shopping-cart",element:l.jsx(tS,{})}),l.jsx(xt,{path:"/wishlist",element:l.jsx(nS,{})}),l.jsx(xt,{path:"/search",element:l.jsx(k0,{})}),l.jsx(xt,{path:"/login",element:l.jsx(Ap,{mode:"login"})}),l.jsx(xt,{path:"/register",element:l.jsx(Ap,{mode:"register"})}),l.jsx(xt,{path:"/deck-builder",element:l.jsx(as,{children:l.jsxs("div",{className:"container",children:[l.jsx("h2",{children:"Deck Builder Page"}),l.jsx(ux,{})]})})}),l.jsx(xt,{path:"/profile",element:l.jsx(as,{children:l.jsxs("div",{className:"container",children:[l.jsx("h2",{children:"Profile Page"}),l.jsx(fx,{})]})})}),l.jsx(xt,{path:"/admin",element:l.jsx(as,{children:l.jsx(gx,{})})}),l.jsx(xt,{path:"/decks/:id",element:l.jsx(Np,{children:l.jsx(Rp,{children:l.jsx(ke.Suspense,{fallback:l.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[l.jsx("h2",{children:"Loading Deck Editor..."}),l.jsx("p",{children:"Loading the deck editor (this may take a moment due to its size)"})]}),children:l.jsx(sh,{})})})})}),l.jsx(xt,{path:"/public/decks/:id",element:l.jsx(Np,{children:l.jsx(Rp,{children:l.jsx(ke.Suspense,{fallback:l.jsxs("div",{style:{padding:"2rem",textAlign:"center"},children:[l.jsx("h2",{children:"Loading Public Deck..."}),l.jsx("p",{children:"Loading the public deck view (read-only)"})]}),children:l.jsx(sh,{isPublic:!0})})})})}),l.jsx(xt,{path:"/privacy",element:l.jsx(P1,{})}),l.jsx(xt,{path:"/terms",element:l.jsx(Y1,{})}),l.jsx(xt,{path:"/verify-email",element:l.jsx(X1,{})}),l.jsx(xt,{path:"/reset-password",element:l.jsx(V1,{})}),l.jsx(xt,{path:"/network-diagnostics",element:l.jsx(aS,{})}),l.jsx(xt,{path:"/oauth-success",element:l.jsx(oS,{})}),l.jsx(xt,{path:"*",element:l.jsx("h2",{style:{textAlign:"center",marginTop:40},children:"404 – Page Not Found"})})]}),l.jsx(cx,{position:"top-center",autoClose:2e3})]})]})}class lS{constructor(){this.enabled=localStorage.getItem("storage-debug")==="true"}enable(){this.enabled=!0,localStorage.setItem("storage-debug","true"),console.log("📊 Storage debugging enabled")}disable(){this.enabled=!1,localStorage.removeItem("storage-debug"),console.log("📊 Storage debugging disabled")}log(r,s=null){this.enabled&&console.log(`[StorageDebug] ${r}`,s||"")}analyzeStorage(){console.log(`
📊 === STORAGE ANALYSIS ===`);const r=Xt.getStats();console.log("💾 Overall Storage:",{used:`${(r.used/1024/1024).toFixed(2)}MB`,available:`${(r.available/1024/1024).toFixed(2)}MB`,percentage:`${r.percentage.toFixed(1)}%`,items:r.itemCounts});const s=[];for(let f in localStorage)if(localStorage.hasOwnProperty(f)){const g=localStorage[f],p=(g.length+f.length)*2;s.push({key:f,size:p,sizeKB:(p/1024).toFixed(1),sizeMB:(p/1024/1024).toFixed(3),preview:g.substring(0,100)})}s.sort((f,g)=>g.size-f.size),console.log(`
📋 Largest Storage Items:`),s.slice(0,10).forEach((f,g)=>{console.log(`${g+1}. ${f.key}: ${f.sizeMB}MB`)});const i=s.filter(f=>f.key.includes("collection")||f.key.includes("Collection")||f.key.includes("cardCollection"));i.length>0&&(console.log(`
📚 Collection Items:`),i.forEach(f=>{console.log(`- ${f.key}: ${f.sizeMB}MB`);try{const g=JSON.parse(f.preview);Array.isArray(g)?console.log(`  └─ Array with ${g.length} items`):g.chunked&&console.log(`  └─ Chunked data: ${g.totalItems} items in ${g.totalChunks} chunks`)}catch{console.log("  └─ Could not parse preview")}}));const d=s.filter(f=>f.key.includes("otag")||f.key.includes("oracle")||f.key.includes("production-otag"));return d.length>0&&(console.log(`
🏷️ Oracle Tag Items:`),d.forEach(f=>{console.log(`- ${f.key}: ${f.sizeMB}MB`)})),{stats:r,items:s,collectionItems:i,otagItems:d}}testStorageLimits(){console.log(`
🧪 === STORAGE LIMIT TEST ===`);const r="storage-test-"+Date.now();let s=1024,i=0;try{for(;s<50*1024*1024;){const d="x".repeat(s);try{localStorage.setItem(r,d),localStorage.removeItem(r),i=s,s*=2}catch(f){console.log(`❌ Failed at ${(s/1024/1024).toFixed(2)}MB: ${f.message}`);break}}console.log(`✅ Maximum test size: ${(i/1024/1024).toFixed(2)}MB`)}catch(d){console.error("❌ Storage test failed:",d.message)}return i}simulateCollectionImport(r=1e3){console.log(`
📤 === SIMULATING IMPORT OF ${r} CARDS ===`);const s=[];for(let d=0;d<r;d++)s.push({id:`test-card-${d}`,name:`Test Card ${d}`,set:"TST",quantity:Math.floor(Math.random()*4)+1,foil:Math.random()>.8,condition:"NM",printing_id:`print-${d}`,collector_number:String(d),dateAdded:new Date().toISOString()});const i="test-collection-"+Date.now();try{const d=performance.now(),f=Xt.setItem(i,s,{clearOldData:!0}),g=performance.now();if(f){const p=Xt.getStats();console.log(`✅ Successfully stored ${r} cards in ${(g-d).toFixed(2)}ms`),console.log(`📊 Storage now at ${p.percentage.toFixed(1)}%`),localStorage.removeItem(i)}else console.log(`❌ Failed to store ${r} cards`);return f}catch(d){return console.error("❌ Simulation failed:",d.message),!1}}startMonitoring(){this.monitoringInterval&&clearInterval(this.monitoringInterval),console.log("🔍 Starting storage monitoring...");let r=Xt.getStats();this.monitoringInterval=setInterval(()=>{const s=Xt.getStats();Math.abs(s.percentage-r.percentage)>1&&(console.log(`📊 Storage change detected: ${s.percentage.toFixed(1)}% (${s.percentage>r.percentage?"↑":"↓"}${Math.abs(s.percentage-r.percentage).toFixed(1)}%)`),r=s)},1e3)}stopMonitoring(){this.monitoringInterval&&(clearInterval(this.monitoringInterval),this.monitoringInterval=null,console.log("🔍 Storage monitoring stopped"))}exportAnalysis(){const r=this.analyzeStorage(),s={timestamp:new Date().toISOString(),stats:r.stats,largestItems:r.items.slice(0,20),collectionItems:r.collectionItems,otagItems:r.otagItems,recommendations:this.generateRecommendations(r)},i=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),d=URL.createObjectURL(i),f=document.createElement("a");f.href=d,f.download=`storage-analysis-${new Date().toISOString().split("T")[0]}.json`,f.click(),URL.revokeObjectURL(d),console.log("📁 Storage analysis exported")}generateRecommendations(r){const s=[];return r.stats.percentage>80&&s.push("Storage is over 80% full - consider clearing old data"),r.otagItems.some(i=>i.size>5*1024*1024)&&s.push("Large OTAG cache detected - this may be compressed or cleared"),r.collectionItems.length>1&&s.push("Multiple collection items found - consolidation may be needed"),s}}const Kr=new lS;typeof window<"u"&&(window.analyzeStorage=()=>Kr.analyzeStorage(),window.testStorageLimits=()=>Kr.testStorageLimits(),window.simulateImport=a=>Kr.simulateCollectionImport(a),window.enableStorageDebug=()=>Kr.enable(),window.disableStorageDebug=()=>Kr.disable(),window.exportStorageAnalysis=()=>Kr.exportAnalysis(),console.log("🔧 Storage debugging functions available:"),console.log("  - analyzeStorage() - Show detailed storage analysis"),console.log("  - testStorageLimits() - Test maximum storage capacity"),console.log("  - simulateImport(size) - Test importing N cards"),console.log("  - enableStorageDebug() - Enable detailed logging"),console.log("  - exportStorageAnalysis() - Export analysis to file"));class Ad{constructor(){this.isReady=!1,this.isLoaded=!1,this.otagDatabase=new Map,this.cardNameMap=new Map,this.searchCache=new Map,this.memoryCache=null,this.stats={totalCards:0,totalOtags:0,topOtags:[]},console.log("🏷️ Production OTAG System initializing..."),this.initialize()}async initialize(){try{this.clearOldCaches(),this.isReady=!0,console.log("✅ Production OTAG System ready (lazy loading enabled)"),this.startModalMonitoring(),this.setupSearchIntegration(),this.isReady=!0,console.log("✅ Production OTAG System ready"),window.dispatchEvent(new CustomEvent("otagSystemReady",{detail:{stats:this.stats}}))}catch(r){console.error("❌ Failed to initialize OTAG system:",r)}}clearOldCaches(){const r=["production-otag-data-v1","production-otag-timestamp-v1","production-otag-data-v2","production-otag-timestamp-v2","production-otag-data-v3-full","production-otag-timestamp-v3-full"];let s=0;for(const f of r)localStorage.getItem(f)&&(localStorage.removeItem(f),s++);s>0&&console.log(`🧹 Cleared ${s} old cache entries`);const i="production-otag-data-v4-api",d=localStorage.getItem(i);if(d)try{const f=JSON.parse(d);f&&f.length<1e3&&(localStorage.removeItem(i),localStorage.removeItem("production-otag-timestamp-v4-api"),console.log(`🚫 Cleared current cache (only ${f.length} entries - insufficient data)`))}catch{localStorage.removeItem(i),localStorage.removeItem("production-otag-timestamp-v4-api"),console.log("🚫 Cleared corrupted cache data")}}async loadOtagDataFromServer(){const r="production-otag-data-v4-api",s="production-otag-timestamp-v4-api";try{if(this.memoryCache&&this.memoryCache.data&&Date.now()-this.memoryCache.timestamp<864e5){console.log("🧠 Using memory cache from previous load..."),this.processOtagData(this.memoryCache.data);return}const d=[{key:r,time:s,format:"standard"},{key:r+"-compact",time:s,format:"compact"},{key:r+"-session",time:s+"-session",format:"session"}];console.log("🔍 Checking multiple cache formats...");let f=!1,g=null,p=null;for(const h of d){const y=h.format==="session"?sessionStorage:localStorage,b=y.getItem(h.key),S=y.getItem(h.time);if(b&&S&&b.trim()!=="")try{let E=JSON.parse(b);const _=Date.now()-parseInt(S);if(console.log(`🕐 ${h.format} cache age: ${Math.round(_/1e3/60)} minutes`),(h.format==="compact"||h.format==="session")&&(E=E.map(j=>({cardName:j.n,otags:j.t||[]}))),E.length<1e3){console.log(`🚫 ${h.format} cache contains only ${E.length} entries (insufficient data)`);continue}else if(_<864e5&&E&&E.length>0){f=!0,g=E,p=h.format,console.log(`📋 Loading OTAG data from ${h.format} cache...`),console.log(`📊 Cached data contains: ${g.length} entries`);break}else console.log(`🔄 ${h.format} cache expired or empty`)}catch(E){console.log(`⚠️ ${h.format} cache parse error:`,E.message),y.removeItem(h.key),y.removeItem(h.time)}}if(f||console.log("🚫 No valid cache found in any format, will fetch fresh data"),f&&g){this.processOtagData(g);return}console.log("🌐 Loading OTAG data from server..."),console.log("🌐 Loading OTAG data from server...");const m=["https://constant-lists-api.onrender.com/api/oracle-tags",`${window.location.origin}/api/oracle-tags`,"https://constant-lists-api.onrender.com/api/otag-data",`${window.location.origin}/api/otag-data`,"./oracle-tags.csv","./oracle-tags.csv.gz","./scryfall-COMPLETE-oracle-tags-2025-08-08.csv","./FULL OTAGS.csv","./otag-medium-dataset.csv","./test-otag-data.csv"];for(const h of m)try{console.log(`🔍 Trying to load from: ${h}`),h.startsWith("http")&&console.log("🌐 Loading full dataset from external source (this may take 10-30 seconds)...");let b,S;if(h.startsWith("./")){console.log(`🔍 Attempting to load large local file: ${h}`);try{if(b=await fetch(h,{method:"GET",headers:{"Cache-Control":"no-cache"}}),console.log(`📡 Response status for ${h}:`,b.status,b.statusText),b.ok){const E=b.headers.get("content-length");if(console.log(`📏 Content-Length header: ${E}`),E&&parseInt(E)>1e6&&console.log(`📊 Large file detected (${(parseInt(E)/(1024*1024)).toFixed(1)}MB), attempting stream read...`),h.endsWith(".gz")){console.log("📦 Decompressing gzipped file...");const _=await b.arrayBuffer();S=await this.decompressGzip(_)}else S=await b.text()}}catch(E){throw console.warn(`⚠️ Standard fetch failed for ${h}:`,E.message),E}}else{console.log("⏱️ Attempting fetch with 30 second timeout...");const E=new AbortController,_=setTimeout(()=>E.abort(),3e4);try{b=await fetch(h,{method:"GET",signal:E.signal,headers:{Accept:"text/csv,application/csv,text/plain,*/*","Cache-Control":"no-cache"}}),clearTimeout(_),console.log(`📡 Response status for ${h}:`,b.status,b.statusText)}catch(j){throw clearTimeout(_),j.name==="AbortError"?(console.log(`⏰ Fetch timeout after 30 seconds for ${h}`),new Error("Fetch timeout - API response too slow")):j}if(b.ok){const j=b.headers.get("content-length");if(j&&h.startsWith("http")){const T=(parseInt(j)/1048576).toFixed(1);console.log(`📊 Downloading ${T}MB of Oracle Tag data...`)}if(h.endsWith(".gz")){console.log("📦 Decompressing external gzipped file...");const T=await b.arrayBuffer();S=await this.decompressGzip(T)}else S=await b.text()}}if(b.ok){if(console.log(`✅ Loaded OTAG data from: ${h} (${S.length} characters)`),console.log("🔍 First 200 chars:",S.substring(0,200)),console.log("🔍 Last 200 chars:",S.substring(S.length-200)),S.length<1e5&&console.warn(`⚠️ File seems truncated! Got ${S.length} chars, expected ~7,000,000`),S.length<1e3&&!S.includes("card_name"))throw new Error(`Invalid CSV data received (too short: ${S.length} chars)`);console.log("🔄 Processing Oracle Tag database...");const E=this.parseCSV(S);this.processOtagData(E),await this.emergencySmartCache(E,r,s);return}}catch(y){console.log(`⚠️ Could not load from ${h}:`,y.message)}console.log("📝 Creating fallback OTAG data..."),this.createFallbackData()}catch(d){console.error("❌ Error loading OTAG data:",d),this.createFallbackData()}}async decompressGzip(r){try{if("DecompressionStream"in window){console.log("🔧 Using browser DecompressionStream...");const s=new DecompressionStream("gzip"),d=new ReadableStream({start(h){h.enqueue(new Uint8Array(r)),h.close()}}).pipeThrough(s).getReader(),f=[];for(;;){const{done:h,value:y}=await d.read();if(h)break;f.push(y)}const g=f.reduce((h,y)=>h+y.length,0),p=new Uint8Array(g);let m=0;for(const h of f)p.set(h,m),m+=h.length;return new TextDecoder("utf-8").decode(p)}else throw console.warn("⚠️ DecompressionStream not available, cannot decompress gzip file"),new Error("Gzip decompression not supported in this browser")}catch(s){throw console.error("❌ Error decompressing gzip file:",s),s}}async emergencySmartCache(r,s,i){console.log("🚨 EMERGENCY: Implementing intelligent caching system...");try{const d=JSON.stringify(r);localStorage.setItem(s,d),localStorage.setItem(i,Date.now().toString()),console.log("✅ Standard cache successful");return}catch(d){console.log("⚠️ Standard cache failed:",d.message)}try{console.log("🧹 Clearing old storage data...");const d=[];for(let g=0;g<localStorage.length;g++){const p=localStorage.key(g);p&&(p.includes("otag")||p.includes("production-"))&&d.push(p)}d.forEach(g=>localStorage.removeItem(g));const f=JSON.stringify(r);localStorage.setItem(s,f),localStorage.setItem(i,Date.now().toString()),console.log("✅ Cache successful after cleanup");return}catch(d){console.log("⚠️ Cache failed even after cleanup:",d.message)}try{console.log("🗜️ Attempting compressed chunked storage...");const d=r.map(g=>({n:g.cardName,t:g.otags||[]})),f=JSON.stringify(d);console.log(`📊 Compact data size: ${(f.length/1024/1024).toFixed(1)}MB (was ${(JSON.stringify(r).length/1024/1024).toFixed(1)}MB)`),localStorage.setItem(s+"-compact",f),localStorage.setItem(i,Date.now().toString()),localStorage.setItem(s+"-format","compact"),console.log("✅ Compact cache successful");return}catch(d){console.log("⚠️ Compact cache also failed:",d.message)}try{console.log("💾 Trying sessionStorage fallback...");const d=r.map(f=>({n:f.cardName,t:f.otags||[]}));sessionStorage.setItem(s+"-session",JSON.stringify(d)),sessionStorage.setItem(i+"-session",Date.now().toString()),console.log("✅ Session storage cache successful");return}catch(d){console.log("⚠️ Session storage also failed:",d.message)}console.log("🧠 Falling back to memory-only storage (no persistence)"),this.memoryCache={data:r,timestamp:Date.now(),persistent:!1},console.log("⚠️ WARNING: OTAG data will not persist between page loads due to storage limitations"),console.log("💡 Consider clearing browser data or using a different browser for better caching")}parseCSV(r){const s=r.split(`
`),i=[];for(let d=1;d<s.length;d++){const f=s[d].trim();if(f)try{const g=this.parseCSVLine(f);if(g.length>=8)i.push({cardId:g[0],cardName:g[1],colors:g[2],cmc:parseInt(g[3])||0,typeLine:g[4],set:g[5],otagCount:parseInt(g[6])||0,otags:g[7]?g[7].split("|").filter(Boolean):[]});else if(g.length>=2){const p=g[0].replace(/^"|"$/g,""),m=g[1].replace(/^"|"$/g,""),h=m?m.split("|").filter(Boolean):[];i.push({cardId:p.toLowerCase().replace(/[^a-z0-9]/g,""),cardName:p,colors:"",cmc:0,typeLine:"",set:"",otagCount:h.length,otags:h})}}catch{}}return i}parseCSVLine(r){const s=[];let i="",d=!1;for(let f=0;f<r.length;f++){const g=r[f];g==='"'?d=!d:g===","&&!d?(s.push(i),i=""):i+=g}return s.push(i),s}processOtagData(r){console.log(`🔄 Processing ${r.length} cards...`),this.otagDatabase.clear(),this.cardNameMap.clear();const s=new Map;for(const i of r){if(!i.cardName||!i.otags)continue;const d=i.cardName.toLowerCase().trim();this.otagDatabase.set(d,i),this.cardNameMap.set(d,i.cardName);for(const f of i.otags)s.set(f,(s.get(f)||0)+1)}this.stats={totalCards:this.otagDatabase.size,totalOtags:s.size,topOtags:Array.from(s.entries()).sort((i,d)=>d[1]-i[1]).slice(0,20)},this.isLoaded=!0,console.log(`✅ OTAG database ready: ${this.stats.totalCards} cards, ${this.stats.totalOtags} categories`),window.dispatchEvent(new CustomEvent("otagDatabaseLoaded",{detail:{stats:this.stats,isReady:!0,isLoaded:!0}}))}createFallbackData(){console.log("🚨 EMERGENCY: Creating comprehensive fallback OTAG data...");const r=[{name:"Jason Bright, Glowing Prophet",otags:["commander","legendary","creature","fallout","glow","prophet","multicolor"]},{name:"Benthic Biomancer",otags:["creature","merfolk","wizard","blue","mono-blue","card-draw","evolve","simic"]},{name:"Cloudfin Raptor",otags:["creature","bird","mutant","blue","mono-blue","flying","evolve","simic"]},{name:"Cytoplast Manipulator",otags:["creature","human","wizard","blue","mono-blue","graft","steal-creature","simic"]},{name:"Novijen Sages",otags:["creature","human","advisor","blue","mono-blue","graft","card-draw","simic"]},{name:"Simic Manipulator",otags:["creature","mutant","wizard","blue","mono-blue","evolve","steal-creature","simic"]},{name:"Skatewing Spy",otags:["creature","human","rogue","blue","mono-blue","flying","evolve","simic"]},{name:"Vexing Radgull",otags:["creature","bird","mutant","blue","mono-blue","flying","fallout"]},{name:"Mirelurk Queen",otags:["creature","crab","mutant","blue","mono-blue","fallout","tokens"]},{name:"Geralf, the Fleshwright",otags:["legendary","creature","human","wizard","blue","mono-blue","zombie","graveyard"]},{name:"Geralf, Visionary Stitcher",otags:["legendary","creature","human","wizard","blue","mono-blue","zombie","graveyard"]},{name:"Cleaver Skaab",otags:["creature","zombie","blue","mono-blue","graveyard","exploit"]},{name:"Hordewing Skaab",otags:["creature","zombie","blue","mono-blue","flying","graveyard"]},{name:"Prophet of the Scarab",otags:["creature","human","wizard","blue","mono-blue","cycling","graveyard"]},{name:"Rooftop Storm",otags:["enchantment","blue","mono-blue","zombie","cost-reduction","tribal"]},{name:"Necroduality",otags:["enchantment","blue","mono-blue","zombie","token-copy","graveyard"]},{name:"Poppet Stitcher",otags:["creature","human","wizard","blue","mono-blue","transform","tokens"]},{name:"Danny Pink",otags:["legendary","creature","human","soldier","blue","mono-blue","doctor-who"]},{name:"Cyclonic Rift",otags:["instant","blue","mono-blue","bounce","overload","board-wipe"]},{name:"Training Grounds",otags:["enchantment","blue","mono-blue","cost-reduction","activated-abilities"]},{name:"Heartstone",otags:["artifact","colorless","cost-reduction","activated-abilities"]},{name:"Ashnods Altar",otags:["artifact","colorless","sacrifice","mana-acceleration","combo"]},{name:"Phyrexian Altar",otags:["artifact","colorless","sacrifice","mana-acceleration","combo"]},{name:"Metallic Mimic",otags:["artifact","creature","shapeshifter","colorless","tribal","counters"]},{name:"Adaptive Automaton",otags:["artifact","creature","construct","colorless","tribal","lords"]},{name:"Kindred Discovery",otags:["enchantment","blue","mono-blue","tribal","card-draw"]},{name:"Island",otags:["land","basic","blue","mana-acceleration"]},{name:"Sol Ring",otags:["artifact","colorless","mana-acceleration","ramp","staple"]},{name:"Lightning Bolt",otags:["instant","red","mono-red","removal","direct-damage","burn"]},{name:"Counterspell",otags:["instant","blue","mono-blue","counterspell","control"]},{name:"Birds of Paradise",otags:["creature","bird","green","mono-green","mana-acceleration","flying"]},{name:"Path to Exile",otags:["instant","white","mono-white","removal","exile"]},{name:"Llanowar Elves",otags:["creature","elf","druid","green","mono-green","mana-acceleration"]},{name:"Command Tower",otags:["land","commander","multicolor","mana-fixing"]},{name:"Arcane Signet",otags:["artifact","colorless","mana-acceleration","commander","mana-fixing"]}];for(const s of r){const i=s.name.toLowerCase();this.otagDatabase.set(i,{cardName:s.name,otags:s.otags,typeLine:"Unknown",colors:"",cmc:0}),this.cardNameMap.set(i,s.name)}this.stats={totalCards:r.length,totalOtags:r.reduce((s,i)=>s+i.otags.length,0),topOtags:this.calculateTopTags(r)},this.isLoaded=!0,this.isReady=!0,console.log(`� EMERGENCY FALLBACK: Loaded ${r.length} cards with ${this.stats.totalOtags} total tags`),console.log("⚡ OTAG system now operational with emergency data")}calculateTopTags(r){const s=new Map;for(const i of r)for(const d of i.otags)s.set(d,(s.get(d)||0)+1);return Array.from(s.entries()).sort((i,d)=>d[1]-i[1]).slice(0,20).map(([i,d])=>({tag:i,count:d}))}startModalMonitoring(){new MutationObserver(s=>{for(const i of s){if(i.type==="childList")for(const d of i.addedNodes)d.nodeType===Node.ELEMENT_NODE&&this.checkForCardModal(d);i.type==="attributes"&&(i.attributeName==="class"||i.attributeName==="style")&&this.checkForCardModal(i.target)}}).observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","style"]}),setTimeout(()=>this.scanExistingModals(),3e3),console.log("👀 Modal monitoring active (optimized)")}scanExistingModals(){const r=['[id*="modal"]','[class*="modal"]','[id*="popup"]','[class*="popup"]','[class*="dialog"]'];for(const s of r){const i=document.querySelectorAll(s);for(const d of i)this.isVisible(d)&&this.checkForCardModal(d)}}checkForCardModal(r){!r||!this.isLoaded||this.isCardModal(r)&&setTimeout(()=>this.enhanceModal(r),100)}isCardModal(r){if(!r||r.nodeType!==Node.ELEMENT_NODE||r.querySelector(".otag-enhancement")||!this.isVisible(r))return!1;const s=r.className.toLowerCase(),i=(r.id||"").toLowerCase();if(!["modal","popup","dialog","overlay","card-detail","card-info","card-preview"].some(p=>s.includes(p)||i.includes(p)))return!1;const g=this.extractCardName(r);return g&&g.length>2}isVisible(r){if(!r)return!1;const s=window.getComputedStyle(r);return s.display!=="none"&&s.visibility!=="hidden"&&s.opacity!=="0"&&r.offsetParent!==null}extractCardName(r){var d;const s=["[data-card-name]",".card-name",".card-title","h1, h2, h3",".modal-title",".popup-title",".dialog-title"];for(const f of s){const g=r.querySelector(f);if(g){let p=(d=g.textContent)==null?void 0:d.trim();if(p&&p.length>2)return p=p.replace(/^\d+x?\s*/,""),p=p.replace(/\s*\([^)]*\)$/,""),p}}const i=r.getAttribute("data-card-name")||r.getAttribute("data-name")||r.getAttribute("title");return i&&i.length>2?i.trim():null}enhanceModal(r){if(!r||!this.isLoaded)return;const s=this.extractCardName(r);if(!s)return;const i=this.getCardOtags(s);if(!i||!i.otags||i.otags.length===0){console.log(`🔍 No OTAG data found for: ${s}`);return}console.log(`🏷️ Enhancing modal for: ${s}`);const d=this.createOtagDisplay(i),f=this.findInsertionPoint(r);f&&(f.appendChild(d),console.log(`✅ OTAG enhancement added to ${s} modal`))}getCardOtags(r){if(!r)return null;const s=r.toLowerCase().trim();return this.otagDatabase.get(s)||null}createOtagDisplay(r){const s=document.createElement("div");s.className="otag-enhancement",s.style.cssText=`
            margin: 15px 0;
            padding: 15px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 12px;
            border: 2px solid #cbd5e1;
            font-family: 'Segoe UI', system-ui, sans-serif;
        `;const i=document.createElement("div");i.style.cssText=`
            font-size: 16px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        `,i.innerHTML=`🏷️ Functional Tags (${r.otags.length})`,s.appendChild(i);const d=this.groupOtags(r.otags);for(const[g,p]of Object.entries(d)){if(p.length===0)continue;const m=document.createElement("div");m.style.marginBottom="10px";const h=document.createElement("div");h.style.cssText=`
                font-size: 12px;
                font-weight: 600;
                color: #64748b;
                margin-bottom: 6px;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            `,h.textContent=`${g} (${p.length})`,m.appendChild(h);const y=document.createElement("div");y.style.cssText=`
                display: flex;
                flex-wrap: wrap;
                gap: 6px;
                margin-bottom: 8px;
            `;for(const b of p){const S=this.createOtagTag(b,g);y.appendChild(S)}m.appendChild(y),s.appendChild(m)}const f=document.createElement("div");return f.style.cssText=`
            font-size: 11px;
            color: #64748b;
            font-style: italic;
            margin-top: 8px;
            text-align: center;
        `,f.textContent="💡 Click any tag to search for similar cards",s.appendChild(f),s}groupOtags(r){const s={FUNCTIONS:[],COLORS:[],FORMATS:[],MECHANICS:[],TYPES:[],OTHER:[]};for(const i of r){const d=i.toLowerCase();d.includes("removal")||d.includes("damage")||d.includes("counter")||d.includes("draw")||d.includes("ramp")||d.includes("acceleration")?s.FUNCTIONS.push(i):d.includes("color")||d.includes("red")||d.includes("blue")||d.includes("green")||d.includes("white")||d.includes("black")||d.includes("mono")?s.COLORS.push(i):d.includes("legal")||d.includes("format")||d.includes("standard")||d.includes("modern")||d.includes("legacy")||d.includes("commander")?s.FORMATS.push(i):d.includes("flying")||d.includes("haste")||d.includes("trample")||d.includes("lifelink")?s.MECHANICS.push(i):d.includes("creature")||d.includes("instant")||d.includes("sorcery")||d.includes("artifact")||d.includes("enchantment")?s.TYPES.push(i):s.OTHER.push(i)}return s}createOtagTag(r,s){const i=document.createElement("button");i.textContent=this.formatOtagName(r),i.setAttribute("data-otag",r),i.setAttribute("data-category",s);const d={FUNCTIONS:{bg:"#dbeafe",border:"#3b82f6",text:"#1e40af"},COLORS:{bg:"#fef3c7",border:"#f59e0b",text:"#92400e"},FORMATS:{bg:"#d1fae5",border:"#10b981",text:"#065f46"},MECHANICS:{bg:"#f3e8ff",border:"#8b5cf6",text:"#5b21b6"},TYPES:{bg:"#fee2e2",border:"#ef4444",text:"#991b1b"},OTHER:{bg:"#f1f5f9",border:"#64748b",text:"#334155"}},f=d[s]||d.OTHER;return i.style.cssText=`
            background: ${f.bg};
            border: 1px solid ${f.border};
            color: ${f.text};
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        `,i.addEventListener("mouseenter",()=>{i.style.transform="translateY(-1px)",i.style.boxShadow=`0 2px 8px ${f.border}40`}),i.addEventListener("mouseleave",()=>{i.style.transform="translateY(0)",i.style.boxShadow="none"}),i.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),this.handleOtagSearch(r)}),i}formatOtagName(r){return r.replace(/-/g," ").replace(/\b\w/g,s=>s.toUpperCase())}async handleOtagSearch(r){console.log(`🔍 Searching for OTAG: ${r}`);const s=await this.searchCardsByOtag(r);if(console.log(`Found ${s.length} cards with OTAG: ${r}`),s.length===0){alert(`No cards found with the tag "${this.formatOtagName(r)}"`);return}const i={data:s.map(d=>({name:d.cardName,type_line:d.typeLine||"Unknown",mana_cost:d.manaCost||"",colors:d.colors?d.colors.split(""):[],cmc:d.cmc||0,set_name:d.set||"Unknown",otags:d.otags||[]})),total_cards:s.length,has_more:!1,object:"list"};if(typeof window.createModalWithData=="function"){const d=this.formatOtagName(r);window.createModalWithData(i,d),console.log(`✅ Opened search modal for: ${d}`)}else{const d=s.slice(0,10).map(g=>g.cardName).join(", "),f=`Cards with "${this.formatOtagName(r)}" (${s.length} total):

${d}${s.length>10?`

...and more`:""}`;alert(f)}}async searchCardsByOtag(r){this.isLoaded||(console.log("🔄 Lazy loading OTAG data for OTAG search..."),await this.loadOtagDataFromServer());const s=r.toLowerCase(),i=[];for(const[d,f]of this.otagDatabase)f.otags&&f.otags.some(g=>g.toLowerCase().includes(s)||s.includes(g.toLowerCase()))&&i.push(f);return i.sort((d,f)=>d.cardName.localeCompare(f.cardName))}findInsertionPoint(r){const s=[r.querySelector(".card-text"),r.querySelector(".card-description"),r.querySelector(".modal-body"),r.querySelector(".popup-content"),r.querySelector(".content"),r];for(const i of s)if(i)return i;return r}setupSearchIntegration(){if(typeof window.createModalWithData=="function"){const r=window.createModalWithData;window.createModalWithData=(s,i)=>{const d=r(s,i);return setTimeout(()=>{const f=document.getElementById("show-all-modal")||document.querySelector('[id*="modal"]')||document.querySelector(".modal:last-child");f&&this.isVisible(f)&&this.enhanceSearchResults(f,s)},200),d},console.log("🔗 Search integration active")}}enhanceSearchResults(r,s){var d;if(!s||!s.data)return;const i=r.querySelectorAll("[data-card-name], .search-result, .card-result");for(const f of i){const g=f.getAttribute("data-card-name")||((d=f.textContent)==null?void 0:d.trim().split(`
`)[0]);if(g){const p=this.getCardOtags(g);if(p&&p.otags&&p.otags.length>0){const m=document.createElement("div");m.style.cssText=`
                        font-size: 10px;
                        color: #64748b;
                        margin-top: 4px;
                    `,m.textContent=`🏷️ ${p.otags.length} tags`,f.appendChild(m)}}}}getStats(){return{...this.stats}}async searchCards(r){this.isLoaded||(console.log("🔄 Lazy loading OTAG data for search..."),await this.loadOtagDataFromServer());const s=r.toLowerCase(),i=[];for(const[d,f]of this.otagDatabase)(f.cardName.toLowerCase().includes(s)||f.otags.some(g=>g.toLowerCase().includes(s)))&&i.push(f);return i}isSystemReady(){return this.isReady}isDataLoaded(){return this.isLoaded}getTagsForCard(r){if(!this.isReady||!r)return[];if(!this.isLoaded)return console.log("🔄 Triggering lazy load for OTAG data..."),this.loadOtagDataFromServer().catch(console.error),[];const s=r.toLowerCase(),i=this.otagDatabase.get(s);return i&&i.otags?(console.log(`[ProductionOtagSystem] Found ${i.otags.length} tags for "${r}":`,i.otags),i.otags):(console.log(`[ProductionOtagSystem] No tags found for "${r}"`),[])}async getTagsForCardAsync(r){if(!this.isReady||!r)return[];this.isLoaded||(console.log("🔄 Lazy loading OTAG data for card tags..."),await this.loadOtagDataFromServer());const s=r.toLowerCase(),i=this.otagDatabase.get(s);return i&&i.otags?(console.log(`[ProductionOtagSystem] Found ${i.otags.length} tags for "${r}":`,i.otags),i.otags):(console.log(`[ProductionOtagSystem] No tags found for "${r}"`),[])}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{window.productionOtagSystem=new Ad}):window.productionOtagSystem=new Ad;typeof module<"u"&&module.exports&&(module.exports=Ad);console.log("🚀 Production OTAG System script loaded");(function(){console.log("[NUCLEAR FOREACH] Installing nuclear forEach protection...");const r=window.__originalForEach||Array.prototype.forEach;[Array.prototype.forEach,window.__originalForEach,[].forEach,Array.from([]).forEach].filter(Boolean);const s=function(d,f){var p;const g=this;if(!Array.isArray(g)){if(console.error("[NUCLEAR FOREACH] Non-array forEach detected:",{type:typeof g,value:g,constructor:(p=g==null?void 0:g.constructor)==null?void 0:p.name,isNull:g===null,isUndefined:g===void 0,hasLength:g&&"length"in g,length:g==null?void 0:g.length,toString:typeof(g==null?void 0:g.toString)=="function"?g.toString():"[toString unavailable]"}),console.trace(),g&&typeof g.length=="number"&&g.length>=0){console.warn("[NUCLEAR FOREACH] Attempting array conversion...");try{return r.call(Array.from(g),d,f)}catch(m){console.error("[NUCLEAR FOREACH] Array.from failed:",m);try{return r.call([...g],d,f)}catch(h){console.error("[NUCLEAR FOREACH] Spread operator failed:",h)}}}console.warn("[NUCLEAR FOREACH] All conversion attempts failed - returning undefined");return}return r.call(g,d,f)};Array.prototype.forEach=s,window.__originalForEach&&(window.__originalForEach=s);const i=Object.defineProperty;Object.defineProperty=function(d,f,g){if(f==="forEach"&&g&&g.value){console.log("[NUCLEAR FOREACH] Intercepting forEach property definition");const p=g.value;g.value=function(m,h){return Array.isArray(this)?p.call(this,m,h):(console.error("[NUCLEAR FOREACH] Intercepted forEach on non-array via defineProperty"),s.call(this,m,h))}}return i.call(this,d,f,g)},console.log("[NUCLEAR FOREACH] Nuclear forEach protection installed")})();console.log("main.jsx loaded");(function(){console.log("🚀 Initializing production modal fix...");let r=[],s="";window.originalFetch||(window.originalFetch=window.fetch,window.fetch=async function(...d){const f=await window.originalFetch.apply(this,d),g=d[0];if(typeof g=="string"&&g.includes("scryfall.com")){const p=f.clone();try{const m=await p.json();if(m&&m.data&&Array.isArray(m.data)){const y=new URL(g).searchParams.get("q")||"search";y!==s&&(r=[],s=y),r=[...r,...m.data],window.lastCapturedResults=r,window.lastCapturedQuery=y,console.log(`📦 Captured ${m.data.length} cards (${r.length} total) for "${y}"`)}}catch{}}return f},console.log("🕷️ Fetch interceptor installed")),new MutationObserver(d=>{d.forEach(f=>{f.addedNodes.forEach(g=>{g.nodeType===1&&g.id==="show-all-modal"&&setTimeout(()=>{const p=document.getElementById("show-all-modal");if(p&&window.lastCapturedResults&&window.lastCapturedResults.length>0){const m=p.querySelectorAll('h3, [style*="cursor: pointer"]');Array.from(m).some(y=>{var S;const b=(S=y.textContent)==null?void 0:S.trim();return b&&b.length>2&&b.length<100&&!b.includes("Close")&&!b.includes("cards found")})||(console.log("🔄 Replacing broken modal with working version..."),window.createProductionModal())}},300)})})}).observe(document.body,{childList:!0,subtree:!0}),window.createProductionModal=function(){if(!window.lastCapturedResults||window.lastCapturedResults.length===0)return console.log("❌ No captured results available"),!1;const d=window.lastCapturedResults,f=window.lastCapturedQuery||"search",g=document.getElementById("show-all-modal");g&&g.remove();const p=`
      <div id="show-all-modal" style="position: fixed !important; top: 0 !important; left: 0 !important; right: 0 !important; bottom: 0 !important; background: rgba(0,0,0,0.5) !important; z-index: 9999999 !important; display: flex !important; align-items: center !important; justify-content: center !important; padding: 20px !important;">
        <div style="background: white !important; border-radius: 8px !important; width: 90% !important; max-width: 1200px !important; height: 80% !important; max-height: 800px !important; display: flex !important; flex-direction: column !important; overflow: hidden !important; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2) !important;">
          <div style="background: white !important; color: #333 !important; padding: 20px !important; border-bottom: 1px solid #eee !important; display: flex !important; justify-content: space-between !important; align-items: center !important;">
            <h2 style="margin: 0 !important; font-size: 20px !important; color: #333 !important;">🔍 All Results: "${f}" (${d.length} cards)</h2>
            <button onclick="document.getElementById('show-all-modal').remove();" style="background: #f8f9fa !important; color: #333 !important; border: 1px solid #ddd !important; border-radius: 4px !important; padding: 8px 12px !important; cursor: pointer !important; font-size: 18px !important;">✕</button>
          </div>
          <div style="flex: 1 !important; overflow-y: auto !important; padding: 20px !important;">
            <div style="display: grid !important; grid-template-columns: repeat(auto-fill, minmax(380px, 1fr)) !important; gap: 20px !important;">
              ${d.slice(0,100).map(m=>`
                <div style="background: white !important; border: 2px solid #e2e8f0 !important; border-radius: 12px !important; padding: 20px !important; cursor: pointer !important; transition: all 0.2s !important;" onclick="navigator.clipboard.writeText('${m.name}'); console.log('✅ Copied: ${m.name}'); this.style.background='#dcfce7'; setTimeout(() => this.style.background='white', 1000);" onmouseover="this.style.borderColor='#667eea'; this.style.transform='translateY(-4px)';" onmouseout="this.style.borderColor='#e2e8f0'; this.style.transform='translateY(0)';">
                  <h3 style="margin: 0 0 10px 0 !important; color: #1e293b !important; font-size: 18px !important;">${m.name}</h3>
                  ${m.mana_cost?`<div style="color: #f59e0b !important; margin-bottom: 8px !important; font-family: monospace !important;">${m.mana_cost}</div>`:""}
                  ${m.type_line?`<div style="color: #64748b !important; margin-bottom: 8px !important; font-style: italic !important;">${m.type_line}</div>`:""}
                  ${m.set_name?`<div style="color: #9ca3af !important; font-size: 12px !important; margin-bottom: 10px !important;">${m.set_name}</div>`:""}
                  ${m.oracle_text?`<div style="color: #475569 !important; font-size: 13px !important; line-height: 1.4 !important; margin-bottom: 15px !important; max-height: 80px !important; overflow: auto !important;">${m.oracle_text.length>200?m.oracle_text.substring(0,200)+"...":m.oracle_text}</div>`:""}
                  <div style="display: grid !important; grid-template-columns: 1fr 1fr !important; gap: 10px !important;">
                    <button onclick="event.stopPropagation(); console.log('🎯 Adding to deck:', '${m.name}'); this.textContent='✅ Added!'; setTimeout(() => this.textContent='➕ Add to Deck', 2000);" style="background: #10b981 !important; color: white !important; border: none !important; border-radius: 8px !important; padding: 10px !important; cursor: pointer !important; font-weight: 600 !important;">➕ Add to Deck</button>
                    <button onclick="event.stopPropagation(); console.log('🔄 Adding to sideboard:', '${m.name}'); this.textContent='✅ Added!'; setTimeout(() => this.textContent='🔄 Sideboard', 2000);" style="background: #0ea5e9 !important; color: white !important; border: none !important; border-radius: 8px !important; padding: 10px !important; cursor: pointer !important; font-weight: 600 !important;">🔄 Sideboard</button>
                  </div>
                </div>
              `).join("")}
              ${d.length>100?`<div style="grid-column: 1 / -1; text-align: center; padding: 20px; background: #fef3c7; border-radius: 12px; color: #92400e;">📝 Showing first 100 of ${d.length} cards for performance</div>`:""}
            </div>
          </div>
        </div>
      </div>
    `;return document.body.insertAdjacentHTML("beforeend",p),console.log(`✅ Production modal created with ${d.length} real cards!`),!0},console.log("✅ Production modal fix ready!")})();function lh(){console.log('🔧 Implementing permanent "Show all results..." fix...');async function a(f){var g;console.log("🔍 Getting ALL results for:",f);try{console.log("🌐 Using Scryfall directly to ensure we get all results...");const p=await r(f);if(p.length>0)return console.log(`✅ Got ${p.length} results from Scryfall`),p;console.log("🔄 Scryfall failed, trying backend...");let m=`/api/cards/search?q=${encodeURIComponent(f.trim())}`;console.log("📡 Fetching from backend:",m);const h=await fetch(m);if(h.ok){const y=await h.json();return console.log("📦 Backend response:",{total:y.total_cards,returned:(g=y.data)==null?void 0:g.length,has_more:y.has_more}),y.data||[]}return[]}catch(p){return console.error("❌ Error fetching results:",p),[]}}async function r(f){var g;console.log("🌐 Fetching ALL pages from Scryfall API...");try{let p=f;f.includes("otag:")&&(p=f.replace(/\botag:/gi,"function:"),console.log("🔄 [Main.jsx] OTAG translation:",f,"→",p));let m=`${p} game:paper id:gr legal:commander`;const h=[];let y=1,b=!0;for(;b&&y<=20;){const S=`https://api.scryfall.com/cards/search?q=${encodeURIComponent(m)}&page=${y}`;console.log(`🔗 Fetching Scryfall page ${y}...`);const E=await fetch(S);if(E.ok){const _=await E.json();if(console.log(`📦 Page ${y}: ${((g=_.data)==null?void 0:g.length)||0} cards`),_.data&&_.data.length>0)h.push(..._.data),b=_.has_more,y++,b&&await new Promise(j=>setTimeout(j,100));else break}else if(E.status===404){console.log(`📭 No more results at page ${y}`);break}else{console.error(`❌ Scryfall error on page ${y}:`,E.status);break}}return console.log(`✅ Scryfall complete: ${h.length} total cards from ${y-1} pages`),h}catch(p){return console.error("❌ Scryfall fetch failed:",p),[]}}function s(f,g){console.log(`🎭 Showing production-ready modal with ${f.length} results for "${g}"`);const p=document.getElementById("show-all-modal");p&&p.remove();const m=`
      <div id="show-all-modal" style="
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 100vw !important;
        height: 100vh !important;
        background: rgba(0,0,0,0.9) !important;
        z-index: 9999999 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        padding: 20px !important;
        box-sizing: border-box !important;
        overflow: hidden !important;
      ">
        <div style="
          background: white !important;
          border-radius: 12px !important;
          width: 95vw !important;
          height: 95vh !important;
          display: flex !important;
          flex-direction: column !important;
          box-shadow: 0 25px 80px rgba(0,0,0,0.8) !important;
          overflow: hidden !important;
          position: relative !important;
        ">
          <!-- Header -->
          <div style="
            background: white !important;
            color: #333 !important;
            padding: 20px !important;
            border-bottom: 1px solid #eee !important;
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
            flex-shrink: 0 !important;
            z-index: 10 !important;
          ">
            <h2 style="
              margin: 0 !important;
              font-size: 20px !important;
              font-weight: 600 !important;
              color: #333 !important;
            ">🔍 All Results: "${g}" (${f.length} cards)</h2>
            <button onclick="document.getElementById('show-all-modal').remove(); console.log('✅ Modal closed');" style="
              background: #f8f9fa !important;
              color: #333 !important;
              border: 1px solid #ddd !important;
              border-radius: 4px !important;
              padding: 8px 12px !important;
              cursor: pointer !important;
              font-size: 18px !important;
            ">✕</button>
          </div>
          
          <!-- Cards Container -->
          <div style="
            flex: 1 !important;
            overflow-y: auto !important;
            padding: 20px !important;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%) !important;
            position: relative !important;
          ">
            <div style="
              display: grid !important;
              grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)) !important;
              gap: 20px !important;
              padding: 15px !important;
              align-items: start !important;
            ">
              ${f.slice(0,100).map(y=>{const b=y.image_uris&&y.image_uris.normal?y.image_uris.normal:`https://api.scryfall.com/cards/named?format=image&version=normal&fuzzy=${encodeURIComponent(y.name||"Sol Ring")}`,S=(y.name||"Unknown Card").replace(/"/g,"&quot;"),E=S.replace(/'/g,"&#39;");return`
                <div style="
                  background: linear-gradient(135deg, #ffffff 0%, #f9fafb 100%) !important;
                  border: 2px solid #e2e8f0 !important;
                  border-radius: 16px !important;
                  padding: 16px !important;
                  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
                  cursor: pointer !important;
                  box-shadow: 0 4px 12px rgba(0,0,0,0.1) !important;
                  position: relative !important;
                  overflow: hidden !important;
                  display: flex !important;
                  flex-direction: column !important;
                " 
                onmouseover="
                  this.style.transform='translateY(-4px)';
                  this.style.boxShadow='0 12px 24px rgba(102,126,234,0.15)';
                  this.style.borderColor='#667eea';
                "
                onmouseout="
                  this.style.transform='translateY(0)';
                  this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)';
                  this.style.borderColor='#e2e8f0';
                "
                onclick="
                  navigator.clipboard.writeText('${S.replace(/'/g,"\\'")}');
                  console.log('✅ Copied: ${S.replace(/'/g,"\\'")}');
                  
                  const feedback = document.createElement('div');
                  feedback.textContent = '📋 Copied!';
                  feedback.style.cssText = 'position: absolute; top: 8px; right: 8px; background: #059669; color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; z-index: 100; animation: fadeInOut 2s ease;';
                  this.appendChild(feedback);
                  setTimeout(() => feedback.remove(), 2000);
                ">
                  <!-- Card Preview Image (Clean, No Container) -->
                  <div style="
                    width: 100% !important;
                    height: 330px !important;
                    margin-bottom: 12px !important;
                    border-radius: 12px !important;
                    overflow: hidden !important;
                    position: relative !important;
                    display: flex !important;
                    align-items: center !important;
                    justify-content: center !important;
                    cursor: pointer !important;
                    transition: transform 0.2s ease !important;
                  " onclick="
                    event.stopPropagation();
                    console.log('🎴 Opening card modal for:', '${S.replace(/'/g,"\\'")}');
                    
                    const deckEditApp = window.deckEditApp;
                    
                    if (deckEditApp && typeof deckEditApp.openCardModal === 'function') {
                      const cardData = {
                        name: '${S.replace(/'/g,"\\'")}',
                        scryfall_id: '${y.id||""}',
                        id: '${y.id||""}',
                        type_line: '${(y.type_line||"").replace(/'/g,"\\'")}',
                        set: '${(y.set||"").replace(/'/g,"\\'")}',
                        collector_number: '${(y.collector_number||"").replace(/'/g,"\\'")}',
                        image_uris: ${JSON.stringify(y.image_uris||{})},
                        mana_cost: '${(y.mana_cost||"").replace(/'/g,"\\'")}',
                        oracle_text: '${(y.oracle_text||"").replace(/'/g,"\\'")}',
                        power: '${y.power||""}',
                        toughness: '${y.toughness||""}',
                        cmc: ${y.cmc||y.converted_mana_cost||0},
                        rarity: '${(y.rarity||"").replace(/'/g,"\\'")}',
                        prices: ${JSON.stringify(y.prices||{})}
                      };
                      deckEditApp.openCardModal(cardData);
                    } else {
                      console.log('⚠️ CardActionsModal functions not available');
                    }
                  " onmouseover="this.style.transform='scale(1.02)'" onmouseout="this.style.transform='scale(1)'">
                    <img src="${b}" 
                         style="height: 100% !important; object-fit: contain !important; object-position: center !important; border-radius: 10px !important; max-width: 100% !important;"
                         onload="this.style.opacity='1'"
                         onerror="this.style.display='none'; this.parentElement.innerHTML='<div style=&quot;display: flex; align-items: center; justify-content: center; height: 100%; color: #9ca3af; font-size: 16px; text-align: center;&quot;>🎴<br>No Image Available</div>'"
                         alt="${E}"
                    />
                  </div>
                  
                  <!-- Action Buttons -->
                  <div style="
                    display: grid !important;
                    grid-template-columns: 1fr 1fr !important;
                    gap: 8px !important;
                  ">
                    <button onclick="
                      event.stopPropagation();
                      console.log('🎯 Adding to deck:', '${S.replace(/'/g,"\\'")}');
                      
                      // Get the current deck editing component and its handleAddCard function
                      const deckEditApp = window.deckViewEditComponent || window.deckEditApp;
                      
                      if (deckEditApp && typeof deckEditApp.handleAddCard === 'function') {
                        // Use the real deck editing function
                        const cardData = {
                          name: '${S.replace(/'/g,"\\'")}',
                          scryfall_id: '${y.id||y.scryfall_id||""}',
                          id: '${y.id||y.scryfall_id||""}',
                          foil: false,
                          finishes: ${JSON.stringify(y.finishes||[])},
                          set: '${y.set||""}',
                          collector_number: '${y.collector_number||""}'
                        };
                        
                        deckEditApp.handleAddCard(cardData);
                        this.textContent='✅ Added!';
                        this.style.background='linear-gradient(135deg, #059669 0%, #047857 100%)';
                        setTimeout(() => {
                          this.textContent='➕ Add to Deck';
                          this.style.background='linear-gradient(135deg, #10b981 0%, #059669 100%)';
                        }, 2000);
                      } else {
                        console.log('⚠️ Deck editing functions not available - copying name to clipboard instead');
                        navigator.clipboard.writeText('${S.replace(/'/g,"\\'")}');
                        this.textContent='📋 Copied!';
                        this.style.background='linear-gradient(135deg, #059669 0%, #047857 100%)';
                        setTimeout(() => {
                          this.textContent='➕ Add to Deck';
                          this.style.background='linear-gradient(135deg, #10b981 0%, #059669 100%)';
                        }, 2000);
                      }
                    " style="
                      background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important;
                      color: white !important;
                      border: none !important;
                      border-radius: 8px !important;
                      padding: 10px 14px !important;
                      font-size: 13px !important;
                      font-weight: 600 !important;
                      cursor: pointer !important;
                      transition: all 0.2s ease !important;
                      box-shadow: 0 2px 4px rgba(16,185,129,0.3) !important;
                    " onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">➕ Add to Deck</button>
                    
                    <button onclick="
                      event.stopPropagation();
                      console.log('🔄 Adding to sideboard:', '${S.replace(/'/g,"\\'")}');
                      
                      // Get the current deck editing component 
                      const deckEditApp = window.deckEditApp;
                      
                      if (deckEditApp && typeof deckEditApp.handleAddToSideboard === 'function') {
                        console.log('✅ Adding to sideboard using localStorage system');
                        // Create a card object from the search result
                        const cardObj = {
                          name: '${S.replace(/'/g,"\\'")}',
                          scryfall_id: '${y.id||""}',
                          id: '${y.id||""}',
                          type_line: '${(y.type_line||"").replace(/'/g,"\\'")}',
                          set: '${(y.set||"").replace(/'/g,"\\'")}',
                          collector_number: '${(y.collector_number||"").replace(/'/g,"\\'")}',
                          image_uris: ${JSON.stringify(y.image_uris||{})}
                        };
                        deckEditApp.handleAddToSideboard(cardObj);
                        this.textContent='✅ Added!';
                      } else {
                        console.log('⚠️ Sideboard functions not available - copying name to clipboard instead');
                        navigator.clipboard.writeText('${S.replace(/'/g,"\\'")}');
                        this.textContent='📋 Copied!';
                      }
                      
                      this.style.background='linear-gradient(135deg, #0369a1 0%, #075985 100%)';
                      setTimeout(() => {
                        this.textContent='🔄 Sideboard';
                        this.style.background='linear-gradient(135deg, #0ea5e9 0%, #0369a1 100%)';
                      }, 2000);
                    " style="
                      background: linear-gradient(135deg, #0ea5e9 0%, #0369a1 100%) !important;
                      color: white !important;
                      border: none !important;
                      border-radius: 8px !important;
                      padding: 10px 14px !important;
                      font-size: 13px !important;
                      font-weight: 600 !important;
                      cursor: pointer !important;
                      transition: all 0.2s ease !important;
                      box-shadow: 0 2px 4px rgba(14,165,233,0.3) !important;
                    " onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">🔄 Sideboard</button>
                    
                    <button onclick="
                      event.stopPropagation();
                      console.log('💡 Adding to tech ideas:', '${S.replace(/'/g,"\\'")}');
                      
                      // Get the current deck editing component 
                      const deckEditApp = window.deckEditApp;
                      
                      if (deckEditApp && typeof deckEditApp.handleAddToTechIdeas === 'function') {
                        console.log('✅ Adding to tech ideas using localStorage system');
                        // Create a card object from the search result
                        const cardObj = {
                          name: '${S.replace(/'/g,"\\'")}',
                          scryfall_id: '${y.id||""}',
                          id: '${y.id||""}',
                          type_line: '${(y.type_line||"").replace(/'/g,"\\'")}',
                          set: '${(y.set||"").replace(/'/g,"\\'")}',
                          collector_number: '${(y.collector_number||"").replace(/'/g,"\\'")}',
                          image_uris: ${JSON.stringify(y.image_uris||{})}
                        };
                        deckEditApp.handleAddToTechIdeas(cardObj);
                        this.textContent='✅ Added!';
                      } else {
                        console.log('⚠️ Tech ideas functions not available - copying name to clipboard instead');
                        navigator.clipboard.writeText('${S.replace(/'/g,"\\'")}');
                        this.textContent='📋 Copied!';
                      }
                      
                      this.style.background='linear-gradient(135deg, #5b21b6 0%, #4c1d95 100%)';
                      setTimeout(() => {
                        this.textContent='💡 Tech Ideas';
                        this.style.background='linear-gradient(135deg, #7c3aed 0%, #5b21b6 100%)';
                      }, 2000);
                    " style="
                      background: linear-gradient(135deg, #7c3aed 0%, #5b21b6 100%) !important;
                      color: white !important;
                      border: none !important;
                      border-radius: 8px !important;
                      padding: 10px 14px !important;
                      font-size: 13px !important;
                      font-weight: 600 !important;
                      cursor: pointer !important;
                      transition: all 0.2s ease !important;
                      box-shadow: 0 2px 4px rgba(124,58,237,0.3) !important;
                    " onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">💡 Tech Ideas</button>
                  </div>
                </div>
              `}).join("")}
              ${f.length>100?`
                <div style="
                  grid-column: 1 / -1;
                  text-align: center;
                  padding: 20px;
                  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
                  border-radius: 12px;
                  border: 2px solid #f59e0b;
                  color: #92400e;
                  font-weight: 600;
                ">
                  📝 Showing first 100 cards (${f.length} total found)
                  <br>
                  <small style="opacity: 0.8;">Limiting display for performance</small>
                </div>
              `:""}
            </div>
          </div>
          
          <!-- Footer -->
          <div style="
            padding: 16px 20px !important;
            border-top: 2px solid #f1f5f9 !important;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%) !important;
            text-align: center !important;
            color: #6b7280 !important;
            font-size: 14px !important;
            flex-shrink: 0 !important;
            font-weight: 500 !important;
          ">
            ${f.length>100?`Showing 100 of ${f.length} results • `:`All ${f.length} results displayed • `}
            💡 Click card names to copy • Use buttons to add to deck/sideboard
          </div>
        </div>
      </div>
    `;if(!document.getElementById("modal-animations-style")){const y=document.createElement("style");y.id="modal-animations-style",y.textContent=`
        @keyframes fadeInOut {
          0% { opacity: 0; transform: scale(0.8); }
          20% { opacity: 1; transform: scale(1.1); }
          80% { opacity: 1; transform: scale(1); }
          100% { opacity: 0; transform: scale(0.8); }
        }
      `,document.head.appendChild(y)}document.body.insertAdjacentHTML("beforeend",m);const h=y=>{if(y.key==="Escape"){const b=document.getElementById("show-all-modal");b&&y.target!==document.querySelector('input[type="text"]')&&(b.remove(),console.log("✅ Modal closed with Escape key"),document.removeEventListener("keydown",h))}};document.addEventListener("keydown",h),window.lastModal=document.getElementById("show-all-modal"),console.log("✅ Production-ready modal created successfully!"),console.log(`🎯 Modal displays ${Math.min(f.length,100)} of ${f.length} cards for "${g}"`),console.log("💡 Click any card name to copy it to clipboard"),console.log("💡 Use the action buttons to add cards to deck/sideboard")}function i(){window.addCardToDeck=function(f,g="mainboard"){console.log(`➕ Adding "${f}" to ${g}`);try{const p=JSON.parse(localStorage.getItem("pendingCardAdds")||"[]");return p.push({name:f,location:g,timestamp:Date.now(),action:"add-to-deck"}),localStorage.setItem("pendingCardAdds",JSON.stringify(p)),console.log("📝 Stored card add request in localStorage"),!0}catch(p){return console.error("❌ Error adding card to deck:",p),!1}},window.addCardToTechIdeas=function(f){console.log(`💡 Adding "${f}" to tech ideas`);try{const g=JSON.parse(localStorage.getItem("techIdeas")||"[]");return g.find(p=>p.name===f)?console.log("ℹ️ Card already in tech ideas"):(g.push({name:f,addedDate:new Date().toISOString(),notes:"Added from search modal"}),localStorage.setItem("techIdeas",JSON.stringify(g)),console.log("✅ Added to tech ideas storage")),!0}catch(g){return console.error("❌ Error adding to tech ideas:",g),!1}},window.addCardToCollection=function(f){console.log(`📚 Adding "${f}" to collection`);try{const g=JSON.parse(localStorage.getItem("collection")||"[]"),p=g.find(m=>m.name===f);return p?(p.quantity=(p.quantity||1)+1,console.log(`✅ Increased quantity to ${p.quantity}`)):(g.push({name:f,quantity:1,addedDate:new Date().toISOString(),source:"search-modal"}),console.log("✅ Added new card to collection")),localStorage.setItem("collection",JSON.stringify(g)),!0}catch(g){return console.error("❌ Error adding to collection:",g),!1}},window.viewStoredData=function(){console.log("📊 Stored Data Summary:"),console.log("Pending card adds:",JSON.parse(localStorage.getItem("pendingCardAdds")||"[]")),console.log("Tech ideas:",JSON.parse(localStorage.getItem("techIdeas")||"[]")),console.log("Collection:",JSON.parse(localStorage.getItem("collection")||"[]"))},console.log("✅ Improved deck management functions installed"),console.log("💡 Use viewStoredData() to see stored cards")}async function d(f){console.log('🖱️ "Show all results..." clicked - fetching all cards!');const g=document.querySelectorAll('input[type="text"]');let p="";for(const h of g)if(h.value&&h.value.trim()){p=h.value.trim();break}if(!p){console.log("❌ No search query found"),alert("No search query found. Please search for something first.");return}console.log("🔍 Fetching all results for query:",p);const m=document.createElement("div");m.id="loading-all-results",m.innerHTML=`
      <div style="
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(0,0,0,0.9);
        color: white;
        padding: 30px 40px;
        border-radius: 12px;
        z-index: 100000;
        font-size: 18px;
        text-align: center;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        backdrop-filter: blur(10px);
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      ">
        <div style="margin-bottom: 15px;">🔍 Fetching all results for</div>
        <div style="font-weight: 600; color: #60a5fa; font-size: 20px; margin-bottom: 15px;">"${p}"</div>
        <div style="font-size: 14px; opacity: 0.8;">This may take a moment...</div>
        <div style="
          width: 40px;
          height: 4px;
          background: #374151;
          border-radius: 2px;
          margin: 20px auto 0;
          overflow: hidden;
        ">
          <div style="
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, #60a5fa, transparent);
            animation: loading 2s infinite;
          "></div>
        </div>
      </div>
      <style>
        @keyframes loading {
          0% { transform: translateX(-100%); }
          100% { transform: translateX(100%); }
        }
      </style>
    `,document.body.appendChild(m);try{const h=await a(p);m.remove(),h.length>0?(console.log(`✅ Got ${h.length} results, showing enhanced modal`),s(h,p)):(console.log("❌ No results found"),alert(`No results found for "${p}"`))}catch(h){console.error("❌ Error in handleShowAllClick:",h),m.remove(),alert("Error fetching results. Check console for details.")}}i(),window.triggerShowAll=function(f){if(!f){const p=document.querySelector('input[type="text"]');f=p?p.value.trim():"fight"}console.log(`🚀 Manually triggering show all for: "${f}"`);const g=document.querySelector('input[type="text"]');g&&f&&(g.value=f),d()},console.log('✅ Permanent "Show all results..." fix installed'),console.log('💡 Test with: triggerShowAll("fight")')}async function ih(){try{console.log("🚫 Skipping search-modal-fix.js to prevent Oracle Tag interference"),console.log("✅ React components now handle Oracle Tag searches directly"),ch()}catch(a){console.log("⚠️ Error in search modal fix, using inline implementation:",a),ch()}}function ch(){console.log("✅ Inline search fix disabled to prevent React interference")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{setTimeout(lh,1e3),setTimeout(ih,1500)}):(setTimeout(lh,1e3),setTimeout(ih,1500));window.PrintingPreferences=qd;window.PrintingCache=Jr;b0.createRoot(document.getElementById("root")).render(l.jsx(sS,{}));export{J1 as C,hx as O,Jr as P,Qn as _,qd as a,K1 as d,fn as f,Jt as g,gd as i,l as j,Xt as s,ce as y};
